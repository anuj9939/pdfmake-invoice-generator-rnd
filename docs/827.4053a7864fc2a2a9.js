"use strict";(self.webpackChunklms_web_app=self.webpackChunklms_web_app||[]).push([[827],{1532:(Ht,re,m)=>{m.r(re),m.d(re,{BillingModule:()=>Xt});var y=m(6814),se=m(1896),w=m(5861),u=m(6223),H=m(8),P=m(5619),j=m(8645),Z=m(7328),h=m(9773),e=m(5879),W=m(7270),N=m(8586),k=m(8394),L=m(9250),R=m(3493),O=m(8738),ee=m(2603),K=m(2198),Q=m(2242),C=m(2296),v=m(5195),S=m(8034),M=m(2032),b=m(5683),oe=m(2599),Y=m(3424),te=m(2154),ie=m(5986),fe=m(2333);function he(r,d){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Please enter reason for refund!. "),e.qZA())}function ge(r,d){1&r&&(e.TgZ(0,"div",21)(1,"div",22),e._uU(2," Please choose the checkbox you need for a refund* "),e.qZA()())}function be(r,d){if(1&r){const s=e.EpF();e.TgZ(0,"div",23)(1,"mat-card",24),e.NdJ("click",function(){const n=e.CHM(s).$implicit,a=e.oxw();return e.KtG(a.checkTestForRefund(n))}),e.TgZ(2,"mat-card-header",25)(3,"div",26),e._uU(4),e.ALo(5,"firstLetter"),e.qZA(),e.TgZ(6,"mat-card-title"),e._uU(7),e.qZA(),e._UZ(8,"mat-checkbox",27),e.qZA(),e.TgZ(9,"mat-card-content")(10,"div",2)(11,"div",28)(12,"div"),e._uU(13,"Test Name :"),e.qZA(),e.TgZ(14,"div",29),e._uU(15),e.qZA()(),e.TgZ(16,"div",28)(17,"div"),e._uU(18,"Rate :"),e.qZA(),e.TgZ(19,"div",29),e._uU(20),e.qZA()(),e.TgZ(21,"div",28)(22,"div"),e._uU(23,"Final Amount :"),e.qZA(),e.TgZ(24,"div",29),e._uU(25),e.qZA()(),e.TgZ(26,"div",28)(27,"div"),e._uU(28,"Sample Collected :"),e.qZA(),e.TgZ(29,"div",29),e._uU(30),e.qZA()(),e.TgZ(31,"div",28)(32,"div"),e._uU(33,"Status :"),e.qZA(),e.TgZ(34,"div",29),e._uU(35),e.qZA()()()()()()}if(2&r){const s=d.$implicit;e.xp6(1),e.Tol(s.isChecked?"mat-elevation-z12":"mat-elevation-z2"),e.Udp("background-color",s.isChecked?"#fff6f6":"#ffffff"),e.Q6J("ngClass",1==s.isSampleCollected?"disable-test-card":null),e.xp6(3),e.hij(" ",e.lcZ(5,13,(null==s?null:s.entityBusinessName)||"")," "),e.xp6(3),e.hij(" ",(null==s?null:s.entityBusinessName)||""," "),e.xp6(1),e.Q6J("checked",s.isChecked),e.xp6(7),e.hij(" ",s.entityBusinessName||""," "),e.xp6(5),e.hij(" ",s.entityrate||""," "),e.xp6(5),e.hij(" ",s.entityFinalAmount||""," "),e.xp6(5),e.hij(" ",0===s.isSampleCollected?"No":"Yes"," "),e.xp6(5),e.hij(" ",0===s.isSampleCollected?"Refundable":"Not Refundable"," ")}}let ye=(()=>{var r;class d{constructor(i,t,n,a,l){this.loader=i,this.fb=t,this.toastrService=n,this.authService=a,this.masterService=l,this.billDetail={},this.closePanelEvent=new e.vpe,this.destroySubscription$=new Z.t(1),this.testListForSelectedBillID={},this.totalBillRefundAmount=0}ngOnInit(){this.billRefundFormGroup=this.fb.group({remarks:new u.NI(null,[u.kI.required])})}fetchDuesDiscountAmount(){return new Promise((i,t)=>{this.loader.showSpinner("Finding test detail for BillID: "+this.billDetail.entityBusinessID),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W",entityBillID:this.billDetail.entityBusinessID,isDues:!1}},"billservice/getAllBillReferenceEntity").pipe((0,h.R)(this.destroySubscription$)).subscribe(a=>{"200"===a.statusCode?i({duesDiscount:null==a.responseList?0:a.responseList[0][0].duesDiscount}):t(a.errorMessage)},a=>{this.loader.hideSpinner(),t("Either Internet is not working or some internal server issue")})})}ngOnChanges(){this.billDetail.isBillRefunded&&setTimeout(()=>{this.fetchDuesDiscountAmount().then(i=>{this.loader.showSpinner("Finding test detail for BillID: "+this.billDetail.entityBusinessID),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W",entityBillID:this.billDetail.entityBusinessID}},"billservice/getAllEntity").pipe((0,h.R)(this.destroySubscription$)).subscribe(n=>{this.loader.hideSpinner(),"200"===n.statusCode||"300"===n.statusCode?(n.responseList=null==n.responseList?[]:n.responseList[0],n.responseList[0].billServiceDetailEntities=n.responseList[0].billServiceDetailEntities.map(a=>({...a,isChecked:!1})),n.responseList[0].duesDiscount=i.duesDiscount,this.testListForSelectedBillID=n.responseList[0]):(this.toastrService.show({type:"error",text:n.errorMessage}),this.testListForSelectedBillID={})},n=>{this.loader.hideSpinner(),this.testListForSelectedBillID={},this.toastrService.show({type:"error",text:"Either Internet is not working or some internal server issue"})})}).catch(i=>{this.testListForSelectedBillID={},this.toastrService.show({type:"error",text:i})})},500)}onChangeStatus(i){this.checkTestForRefund(i)}checkTestForRefund(i){i.isChecked=!i.isChecked,this.totalBillRefundAmount=this.testListForSelectedBillID.billServiceDetailEntities.reduce(function(t,n){return!0!==n.isChecked?t:t+n.entityFinalAmount},0)}ngOnDestroy(){this.destroySubscription$.next(null),this.destroySubscription$.complete()}closeClearDuesBlock(){this.closePanelEvent.emit(!1)}refundAmountForSelectedTest(i){const t=this.testListForSelectedBillID.billServiceDetailEntities.filter(n=>{if(!1===n.isChecked)return n}).map(({isChecked:n,...a})=>a);if(0===t.length)this.toastrService.show({type:"error",text:"You have checked all test , you should cancel this bill."});else{this.loader.showSpinner("Refunding Bill for BillID : "+this.testListForSelectedBillID.entityBusinessID);const n=this.testListForSelectedBillID.billServiceDetailEntities.filter(l=>{if(l.isChecked)return l}).map(l=>l.entityBusinessName).join(", ");this.masterService.requestApiForGeneralMaster({billRefundEntity:{createdBy:this.authService.employeeID,companyID:this.authService.companyID,entityParentBusinessID:this.testListForSelectedBillID.entityBusinessID,patitentID:this.testListForSelectedBillID.entityPatientID,refundAmount:this.totalBillRefundAmount,refundTestsName:n,auditAction:"C",mode:"W",billEntity:{auditAction:"D",billServiceDetailEntities:t,createdBy:this.authService.employeeID,companyID:this.authService.companyID,entityBusinessID:this.testListForSelectedBillID.entityBusinessID,entityPatientID:this.testListForSelectedBillID.entityPatientID,remarks:i.remarks}}},"billservice/createRefundEntity").pipe((0,h.R)(this.destroySubscription$)).subscribe(l=>{this.loader.hideSpinner(),"200"==l.statusCode?(this.toastrService.show({type:"success",text:"Bill refunded for BillID "+this.billDetail.entityBusinessID+" for "+this.billDetail.entityPatientName}),this.closePanelEvent.emit(!0)):this.toastrService.show({type:"error",text:"There is some issue in refunding bill"})},l=>{this.loader.hideSpinner(),this.toastrService.show({type:"error",text:"Either Internet is not working or some internal server issue"})})}}}return(r=d).\u0275fac=function(i){return new(i||r)(e.Y36(L.D),e.Y36(u.qu),e.Y36(k.k),e.Y36(N.$),e.Y36(R.c))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-bill-refund-form"]],inputs:{billDetail:"billDetail"},outputs:{closePanelEvent:"closePanelEvent"},features:[e.TTD],decls:111,vars:20,consts:[["autocomplete","off",3,"formGroup"],[1,"container-fluid"],[1,"row"],[1,"col-6"],[2,"font-size","1rem","padding-top","8px"],["mat-icon-button","",2,"float","right","padding-top","8px",3,"disableRipple","click"],["aria-label","clear-icon",1,"lms-clear-icon"],[1,"col-12"],[1,"row","detail-block"],[1,"col-lg-4","col-md-4","col-6"],[1,"col-lg-8","col-md-8","col-6"],[1,"row","input-block"],[1,"col-lg-4","col-md-4","col-6",2,"margin-top","14px"],["appearance","outline",1,"clear-dues-mat-form-field"],["matInput","","type","text","placeholder","Reason for refund","id","clear-dues-input-1","formControlName","remarks","required",""],[4,"ngIf"],["class","col-12","style","margin-bottom: 12px",4,"ngIf"],["class","col-12","style","margin-bottom: 15px",4,"ngFor","ngForOf"],[1,"row",2,"margin-top","12px"],[1,"col-12",2,"display","flex","flex-direction","row","justify-content","space-around"],["mat-raised-button","","type","button","color","primary",1,"primary-action-btn",2,"width","35%",3,"disabled","click"],[1,"col-12",2,"margin-bottom","12px"],[2,"font-size","15px","text-align","center","color","#ff0000"],[1,"col-12",2,"margin-bottom","15px"],[1,"bill-refund-card",3,"ngClass","click"],[1,"bill-refund-test-card-header"],["mat-card-avatar","",1,"bill-refund-card-avatar"],["color","primary",2,"pointer-events","none",3,"checked"],[1,"col-lg-12","bill-refund-label"],[1,"bill-refund-label-value"]],template:function(i,t){1&i&&(e.TgZ(0,"form",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),e._uU(5),e.qZA()(),e.TgZ(6,"div",3)(7,"button",5),e.NdJ("click",function(){return t.closeClearDuesBlock()}),e._UZ(8,"div",6),e.qZA()()(),e.TgZ(9,"div",2)(10,"div",7)(11,"div",8)(12,"div",9)(13,"b"),e._uU(14,"Bill No.: "),e.qZA()(),e.TgZ(15,"div",10),e._uU(16),e.qZA()()(),e.TgZ(17,"div",7)(18,"div",8)(19,"div",9)(20,"b"),e._uU(21,"Patient Name: "),e.qZA()(),e.TgZ(22,"div",10),e._uU(23),e.qZA()()(),e.TgZ(24,"div",7)(25,"div",8)(26,"div",9)(27,"b"),e._uU(28,"Patient Age: "),e.qZA()(),e.TgZ(29,"div",10),e._uU(30),e.qZA()()(),e.TgZ(31,"div",7)(32,"div",8)(33,"div",9)(34,"b"),e._uU(35,"Gender: "),e.qZA()(),e.TgZ(36,"div",10),e._uU(37),e.qZA()()(),e.TgZ(38,"div",7)(39,"div",8)(40,"div",9)(41,"b"),e._uU(42,"Total Bill Amount: "),e.qZA()(),e.TgZ(43,"div",10),e._uU(44),e.qZA()()(),e.TgZ(45,"div",7)(46,"div",8)(47,"div",9)(48,"b"),e._uU(49,"Discount On Bill: "),e.qZA()(),e.TgZ(50,"div",10),e._uU(51),e.qZA()()(),e.TgZ(52,"div",7)(53,"div",8)(54,"div",9)(55,"b"),e._uU(56,"Payable Amount: "),e.qZA()(),e.TgZ(57,"div",10),e._uU(58),e.qZA()()(),e.TgZ(59,"div",7)(60,"div",8)(61,"div",9)(62,"b"),e._uU(63,"Received Amount: "),e.qZA()(),e.TgZ(64,"div",10),e._uU(65),e.qZA()()(),e.TgZ(66,"div",7)(67,"div",8)(68,"div",9)(69,"b"),e._uU(70,"Dues Amount: "),e.qZA()(),e.TgZ(71,"div",10),e._uU(72),e.qZA()()(),e.TgZ(73,"div",7)(74,"div",8)(75,"div",9)(76,"b"),e._uU(77,"Discount on dues: "),e.qZA()(),e.TgZ(78,"div",10),e._uU(79),e.qZA()()(),e.TgZ(80,"div",7)(81,"div",8)(82,"div",9)(83,"b"),e._uU(84,"Dues Paid: "),e.qZA()(),e.TgZ(85,"div",10),e._uU(86),e.qZA()()(),e.TgZ(87,"div",7)(88,"div",8)(89,"div",9)(90,"b"),e._uU(91,"Refund Amount: "),e.qZA()(),e.TgZ(92,"div",10),e._uU(93),e.qZA()()(),e.TgZ(94,"div",7)(95,"div",11)(96,"div",12)(97,"b"),e._uU(98,"Reason for refund: "),e.qZA()(),e.TgZ(99,"div",10)(100,"mat-form-field",13),e._UZ(101,"input",14),e.YNc(102,he,2,0,"mat-error",15),e.qZA()()()(),e.YNc(103,ge,3,0,"div",16),e.TgZ(104,"div",7)(105,"div",2),e.YNc(106,be,36,15,"div",17),e.qZA()()(),e.TgZ(107,"div",18)(108,"div",19)(109,"button",20),e.NdJ("click",function(){return t.refundAmountForSelectedTest(t.billRefundFormGroup.value)}),e._uU(110),e.qZA()()()()()),2&i&&(e.Q6J("formGroup",t.billRefundFormGroup),e.xp6(5),e.hij(" ","Bill Refund Form"," "),e.xp6(2),e.Q6J("disableRipple",!0),e.xp6(9),e.hij(" ",null==t.billDetail?null:t.billDetail.entityBusinessShortCode," "),e.xp6(7),e.hij(" ",null==t.billDetail?null:t.billDetail.entityPatientName," "),e.xp6(7),e.hij(" ",null==t.billDetail?null:t.billDetail.entityPatientAge," "),e.xp6(7),e.hij(" ",null==t.billDetail?null:t.billDetail.entityPatientGender," "),e.xp6(7),e.hij(" ",(null==t.billDetail?null:t.billDetail.entityTotalBillAmount)||0," "),e.xp6(7),e.hij(" ",(null==t.billDetail?null:t.billDetail.entityTotalDiscountAmount)||0," "),e.xp6(7),e.hij(" ",(null==t.billDetail?null:t.billDetail.entityTotalPayableAmount)||0," "),e.xp6(7),e.hij(" ",(null==t.billDetail?null:t.billDetail.entityTotalReceiveAmount)||0," "),e.xp6(7),e.hij(" ",(null==t.testListForSelectedBillID?null:t.testListForSelectedBillID.entityTotalDuesAmount)||0," "),e.xp6(7),e.hij(" ",(null==t.testListForSelectedBillID?null:t.testListForSelectedBillID.duesDiscount)||0," "),e.xp6(7),e.hij(" ",(null==t.testListForSelectedBillID?null:t.testListForSelectedBillID.entityTotalDuesAmount)-(null==t.testListForSelectedBillID?null:t.testListForSelectedBillID.duesDiscount)||0," "),e.xp6(7),e.Oqu(t.totalBillRefundAmount),e.xp6(9),e.Q6J("ngIf",null==t.billRefundFormGroup.controls.remarks||null==t.billRefundFormGroup.controls.remarks.errors?null:t.billRefundFormGroup.controls.remarks.errors.required),e.xp6(1),e.Q6J("ngIf",(null==t.testListForSelectedBillID.billServiceDetailEntities?null:t.testListForSelectedBillID.billServiceDetailEntities.length)>0),e.xp6(3),e.Q6J("ngForOf",t.testListForSelectedBillID.billServiceDetailEntities),e.xp6(3),e.Q6J("disabled",0==t.totalBillRefundAmount||t.billRefundFormGroup.invalid),e.xp6(1),e.hij(" ","Continue to refund"," "))},dependencies:[y.mk,y.sg,y.O5,u._Y,u.Fj,u.JJ,u.JL,u.Q7,u.sg,u.u,C.lW,C.RK,v.a8,v.kc,v.dn,v.dk,v.n5,ie.oG,M.Nt,b.KE,b.TO,fe.q],styles:[".detail-block[_ngcontent-%COMP%]{padding:10px 0}.clear-dues-mat-form-field[_ngcontent-%COMP%]{width:100%}.input-block[_ngcontent-%COMP%]{padding-top:20px}.bill-refund-container[_ngcontent-%COMP%]{margin-top:10px}.bill-refund-card-avatar[_ngcontent-%COMP%]{background-size:cover;background-color:#f5f5f5;text-align:center;line-height:40px}.bill-refund-card[_ngcontent-%COMP%]{max-width:500px;height:auto;cursor:pointer}.mat-card-header[_ngcontent-%COMP%]   .mat-card-title[_ngcontent-%COMP%]{font-size:15px!important;word-break:break-word}.bill-refund-label[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between}@media (max-width: 766px){.bill-refund-label[_ngcontent-%COMP%]{flex-direction:column}}.mat-card[_ngcontent-%COMP%]   .last-child[_ngcontent-%COMP%]{margin-bottom:0}.bill-refund-label-value[_ngcontent-%COMP%]{font-size:13px}.disable-test-card[_ngcontent-%COMP%]{pointer-events:none;opacity:.5}.bill-refund-test-card-header[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;align-items:baseline;margin-bottom:12px}"]}),d})();function ve(r,d){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Please enter bill ID. "),e.qZA())}function De(r,d){if(1&r){const s=e.EpF();e.TgZ(0,"button",31),e.NdJ("click",function(){e.CHM(s);const t=e.oxw(2);return e.KtG(t.exportData("xlsx"))}),e._UZ(1,"div",32),e.qZA()}2&r&&e.Q6J("disableRipple",!0)}function Ae(r,d){if(1&r){const s=e.EpF();e.TgZ(0,"button",31),e.NdJ("click",function(){e.CHM(s);const t=e.oxw(2);return e.KtG(t.exportData("csv"))}),e._UZ(1,"div",33),e.qZA()}2&r&&e.Q6J("disableRipple",!0)}function we(r,d){if(1&r){const s=e.EpF();e.TgZ(0,"div",1)(1,"div",2)(2,"div",3),e._UZ(3,"app-breadcrumb",4),e.qZA(),e.TgZ(4,"div",5)(5,"form",6)(6,"div",7)(7,"mat-form-field",8)(8,"mat-label"),e._uU(9,"Start Date"),e.qZA(),e.TgZ(10,"input",9),e.NdJ("click",function(){e.CHM(s);const t=e.MAs(14);return e.KtG(t.open())}),e.qZA(),e.TgZ(11,"mat-datepicker-toggle",10),e._UZ(12,"div",11),e.qZA(),e._UZ(13,"mat-datepicker",null,12),e.qZA()(),e.TgZ(15,"div",7)(16,"mat-form-field",8)(17,"mat-label"),e._uU(18,"End Date"),e.qZA(),e.TgZ(19,"input",13),e.NdJ("click",function(){e.CHM(s);const t=e.MAs(23);return e.KtG(t.open())}),e.qZA(),e.TgZ(20,"mat-datepicker-toggle",10),e._UZ(21,"div",11),e.qZA(),e._UZ(22,"mat-datepicker",null,14),e.qZA()(),e.TgZ(24,"div",15)(25,"mat-form-field",8)(26,"mat-label"),e._uU(27,"Bill ID*"),e.qZA(),e._UZ(28,"input",16),e.YNc(29,ve,2,0,"mat-error",17),e.qZA()()()(),e.TgZ(30,"div",18)(31,"button",19),e.NdJ("click",function(){e.CHM(s);const t=e.oxw();return e.KtG(t.resetDateFilter())}),e._uU(32," Reset "),e.qZA(),e.TgZ(33,"button",20),e.NdJ("click",function(){e.CHM(s);const t=e.oxw();return e.KtG(t.searchRefundedBillSelectedDate())}),e._uU(34," Search "),e.qZA(),e.TgZ(35,"button",20),e.NdJ("click",function(){e.CHM(s);const t=e.oxw();return e.KtG(t.findRefundableListForSelectedDate(t.searchRefundedBillFormGroup.value))}),e._uU(36," Find Bill "),e.qZA()()(),e.TgZ(37,"div",2)(38,"div",21)(39,"div",22)(40,"app-bill-refund-form",23),e.NdJ("closePanelEvent",function(t){e.CHM(s);const n=e.oxw();return e.KtG(n.closeBillRefundForm(t))}),e.qZA()()(),e.TgZ(41,"mat-card",24)(42,"mat-card-title-group",25),e.YNc(43,De,2,1,"button",26),e.YNc(44,Ae,2,1,"button",26),e._UZ(45,"span",27),e.TgZ(46,"div",28)(47,"mat-label",29),e._uU(48,"Refunded Bill List "),e.qZA(),e.TgZ(49,"mat-slide-toggle",30),e.NdJ("change",function(t){e.CHM(s);const n=e.oxw();return e.KtG(n.onChangeOfToggle(t.checked))}),e.qZA(),e.TgZ(50,"mat-label",29),e._uU(51,"Bill Refund Section "),e.qZA()()()()()()}if(2&r){const s=e.MAs(14),i=e.MAs(23),t=e.oxw();e.xp6(5),e.Q6J("formGroup",t.searchRefundedBillFormGroup),e.xp6(5),e.Q6J("matDatepicker",s)("max",t.currentDate),e.xp6(1),e.Q6J("for",s),e.xp6(8),e.Q6J("matDatepicker",i)("max",t.currentDate)("min",t.searchRefundedBillFormGroup.controls.fromDate.value),e.xp6(1),e.Q6J("for",i),e.xp6(4),e.Q6J("hidden",!t.toggleFlag),e.xp6(5),e.Q6J("ngIf",null==t.searchRefundedBillFormGroup.controls.entityBillID||null==t.searchRefundedBillFormGroup.controls.entityBillID.errors?null:t.searchRefundedBillFormGroup.controls.entityBillID.errors.required),e.xp6(4),e.Q6J("hidden",t.toggleFlag)("disabled",t.searchRefundedBillFormGroup.invalid),e.xp6(2),e.Q6J("hidden",!t.toggleFlag)("disabled",t.searchRefundedBillFormGroup.invalid),e.xp6(5),e.Q6J("billDetail",t.selectedBillDetails),e.xp6(3),e.Q6J("ngIf",!t.toggleFlag),e.xp6(1),e.Q6J("ngIf",!t.toggleFlag),e.xp6(3),e.Q6J("ngClass",t.toggleFlag?"inactive":"active"),e.xp6(3),e.Q6J("ngClass",t.toggleFlag?"active":"inactive")}}function Ce(r,d){1&r&&(e.TgZ(0,"div",1),e._UZ(1,"app-access-denied",34),e.qZA())}let xe=(()=>{var r;class d{constructor(i,t,n,a,l,c,o,p,g){this._fb=i,this.exportService=t,this.authService=n,this.toastrService=a,this.loader=l,this.masterService=c,this.commonService=o,this.numberToWordService=p,this.winRef=g,this.refundedBillList$=new P.X([]),this.inlineEditFlag=!1,this.showLogCheckedFlag=!1,this.gridOptions=new H.s8,this.changeDetection=new j.x,this.destroySubscription$=new Z.t(1),this.currentDate=new Date,this.selectedStartDate=new Date,this.selectedEndDate=new Date,this.enteredBillID=null,this.selectedBillDetails={},this.screenWidth=screen.width,this.toggleFlag=!1,this.canViewRecord=!0}ngOnInit(){this.getPageAccessDetail().then(i=>{this.pageAccessDetail=i,this.canViewRecord=1==this.pageAccessDetail?.data?.entityIsBillView,this.canViewRecord?this.getRefundedBillList(!1).then(t=>{this.setFooterValue(t),this.refundedBillList$.next(t)}).catch(t=>{this.refundedBillList$.next([]),this.toastrService.show({type:"error",text:t})}):this.loader.hideSpinner()}).catch(i=>{this.toastrService.show({type:"error",text:i})}),this.searchRefundedBillFormGroup=this._fb.group({fromDate:new u.NI(this.selectedStartDate,[u.kI.required]),toDate:new u.NI(this.selectedStartDate,[u.kI.required]),entityBillID:new u.NI(this.enteredBillID)}),this.updateGridOptions()}updateGridOptions(){this.gridOptions={searchPlaceholder:"Search Patient",pageSize:this.authService.pageSize,dateFormat:"yyyy-MM-dd",keyCodeForNextCell:13,showInlineEdit:this.inlineEditFlag,titleForMobileView:"entityPatientName",pageSizeArray:[5,10,20],showDeleteButton:!1,showAddButton:!1,showEditButton:!1,showActivateDeactivateButton:!1,showSearchInput:!0,activateDeactivateCondition:{conditionalProperty:"activeFlag",valueForActivation:"1",valueForDeactivation:"0"},columns:this.toggleFlag?[{name:"entityBusinessShortCode",label:"Bill Receipt No.",enable:!0,searchable:!0,sortable:!0,type:"text",editable:!1,isRequired:!1},{name:"entityPatientID",label:"Patient ID",enable:!0,searchable:!1,sortable:!0,type:"text",editable:!1,isRequired:!1},{name:"entityPatientName",label:"Patient Name",enable:!0,searchable:!0,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"entityPatientAge",label:"Age",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"entityPatientGender",label:"Gender",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"effectiveDateFrom",label:"Date",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"entityTotalBillAmount",label:"Bill Amount",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"entityTotalDiscountAmount",label:"Discount",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"entityTotalPayableAmount",label:"Payable Amount",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"entityTotalDuesAmount",label:"Dues Amount",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"entityTotalReceiveAmount",label:"Recieved Amount",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"entityRefundStatus",label:"Bill Refunded",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1}]:[{name:"entityParentBusinessName",label:"Old Bill No.",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"effectiveDateTo",label:"Old Bill Date",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"entityBusinessShortCode",label:"New Bill ID",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"effectiveDateFrom",label:"New Bill Date",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"entityPatientName",label:"Patient Name",enable:!0,searchable:!0,sortable:!0,type:"text",editable:!1,isRequired:!1},{name:"entityPatientAge",label:"Patient Age",enable:!0,searchable:!1,sortable:!0,type:"text",editable:!1,isRequired:!1},{name:"entityPatientGender",label:"Gender",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"amountPaidInLastBill",label:"Amount Paid",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1,footerValue:0},{name:"refundAmount",label:"Refunded Amount",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1,footerValue:0},{name:"entityCollectedAmount",label:"Collected Amount",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1,footerValue:0},{name:"createdByName",label:"Refunded By",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"refundTestsName",label:"Refund Test Name",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1}]}}exportData(i){this.exportService.generateFile(this.refundedBillList$.getValue(),"Refunded Bill List."+i,[{property:"entityParentBusinessName",label:"Old Bill No."},{property:"effectiveDateTo",label:"Old Bill Date"},{property:"entityBusinessShortCode",label:"New Bill ID"},{property:"effectiveDateFrom",label:"New Bill Date"},{property:"entityPatientName",label:"Patient Name"},{property:"entityPatientAge",label:"Patient Age"},{property:"entityPatientGender",label:"Gender"},{property:"amountPaidInLastBill",label:"Amount Paid"},{property:"refundAmount",label:"Refunded Amount"},{property:"entityCollectedAmount",label:"Collected Amount"},{property:"createdByName",label:"Refunded By"},{property:"refundTestsName",label:"Refund Test Name"}])}setFooterValue(i){this.gridOptions.columns.find(l=>"entityBusinessShortCode"==l.name).footerValue=i.length||0;const t=i.reduce((l,c)=>l+c.amountPaidInLastBill,0),n=i.reduce((l,c)=>l+c.refundAmount,0),a=i.reduce((l,c)=>l+c.entityCollectedAmount,0);this.gridOptions.columns.find(l=>"amountPaidInLastBill"==l.name).footerValue=t||0,this.gridOptions.columns.find(l=>"refundAmount"==l.name).footerValue=n||0,this.gridOptions.columns.find(l=>"entityCollectedAmount"==l.name).footerValue=a||0}onChangeOfToggle(i){this.refundedBillList$.next([]),this.toggleFlag=i,i?(this.searchRefundedBillFormGroup.controls.entityBillID.setValue(null),this.searchRefundedBillFormGroup.controls.entityBillID.setErrors({required:!0})):this.searchRefundedBillFormGroup.controls.entityBillID.setErrors(null),this.searchRefundedBillFormGroup.updateValueAndValidity(),this.updateGridOptions()}getPageAccessDetail(){return new Promise((i,t)=>{this.loader.showSpinner("Loading..."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,roleID:this.authService.employeeID,entityBusinessID:3,mode:"W"}},"pageaccessservice/getAllEntity").pipe((0,h.R)(this.destroySubscription$)).subscribe(a=>{"200"===a.statusCode||"300"===a.statusCode?(a.responseList=null==a?.responseList?null:a?.responseList[0]?.pageList.find(l=>3===l.pageID)||null,i({data:a.responseList,currentDate:a?.date})):(this.loader.hideSpinner(),t(a.errorMessage))},a=>{this.loader.hideSpinner(),t("Either Internet is not working or facing internal server issue")})})}getRefundedBillList(i){var t=this;return new Promise((n,a)=>{this.loader.showSpinner("Cleared Dues list on the way!");const l={genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W",detailFlag:i,dropDown:!1,fromDate:this.commonService.parseDate(this.searchRefundedBillFormGroup.controls.fromDate.value,"yyyy-MM-dd"),toDate:this.commonService.parseDate(this.searchRefundedBillFormGroup.controls.toDate.value,"yyyy-MM-dd")}};this.masterService.requestApiForGeneralMaster(l,"billservice/getAllBillRefundEntity").pipe((0,h.R)(this.destroySubscription$)).subscribe(function(){var c=(0,w.Z)(function*(o){t.loader.hideSpinner(),"200"===o.statusCode||"300"===o.statusCode?(o.responseList=null==o.responseList?[]:yield t.assignPermissionForBillList(o.responseList[0],"patitentName"),n(o.responseList)):a(o.errorMessage)});return function(o){return c.apply(this,arguments)}}(),c=>{this.loader.hideSpinner(),a("Either Internet is not working or some internal server issue")})})}assignPermissionForBillList(i,t){var n=this;return(0,w.Z)(function*(){const a=(new Date).toISOString().slice(0,10);let l=n.pageAccessDetail?.currentDate||new Date,c=n.pageAccessDetail?.data?.entityDays||1,o=1==n.pageAccessDetail?.data?.entityIsUpdate,p=new Date(l).setDate(new Date(l).getDate()-c),g=new Date(p).toISOString().substring(0,10);return i=yield i.map(f=>{let A=null===f[t]?["",a,""]:f[t].split(","),x=A[0],B=n.commonService.findValuesOfYearMonthAndDays(A[1],f.effectiveDateFrom),_=A[2];return{...f,entityPatientName:x,entityPatientAge:0==B.years?B.months+" M , "+B.days+" D":B.years+" Y",entityPatientGender:_,totalDiscountAmount:null==f.totalDiscountAmount?0:f.totalDiscountAmount,entityCollectedAmount:n.toggleFlag?null:f.amountPaidInLastBill-f.refundAmount,entityTotalDuesAmount:1==f.paymentStatus?0:f.entityTotalDuesAmount,entityRefundStatus:n.toggleFlag?1===f.refundStatus?"Yes":"No":null,entityFinalAmount:f.totalDuesAmount-(null==f.totalDiscountAmount?0:f.totalDiscountAmount),showEditButton:!!(o&&Date.parse(f.effectiveDateFrom.substring(0,10))>=Date.parse(g))}}).sort((f,A)=>Date.parse(f.effectiveDateFrom)>Date.parse(A.effectiveDateFrom)?-1:0)})()}ngOnDestroy(){this.destroySubscription$.next(null),this.destroySubscription$.complete()}searchRefundedBillSelectedDate(){this.getRefundedBillList(!1).then(i=>{this.setFooterValue(i),this.refundedBillList$.next(i)}).catch(i=>{this.refundedBillList$.next([]),this.toastrService.show({type:"error",text:i})})}findRefundableListForSelectedDate(i){var t=this;this.loader.showSpinner("Finding bill detail for ID: "+i.entityBillID);const n={genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W",detailFlag:!1,dropDown:!1,entityBillID:i.entityBillID.replace(/\D/g,""),fromDate:this.commonService.parseDate(i.fromDate,"yyyy-MM-dd"),toDate:this.commonService.parseDate(i.toDate,"yyyy-MM-dd")}};this.masterService.requestApiForGeneralMaster(n,"billservice/getAllBillReferenceEntity").pipe((0,h.R)(this.destroySubscription$)).subscribe(function(){var a=(0,w.Z)(function*(l){t.loader.hideSpinner(),"200"===l.statusCode||"300"===l.statusCode?(l.responseList=null==l.responseList?[]:yield t.assignPermissionForBillList(l.responseList[0],"entityBusinessName"),t.refundedBillList$.next(l.responseList)):t.toastrService.show({type:"error",text:l.errorMessage})});return function(l){return a.apply(this,arguments)}}(),a=>{this.loader.hideSpinner(),this.toastrService.show({type:"error",text:"Either Internet is not working or some internal server issue"})})}resetDateFilter(){this.selectedStartDate=new Date,this.selectedEndDate=new Date,this.toggleFlag?(this.searchRefundedBillFormGroup.patchValue({fromDate:this.selectedStartDate,toDate:this.selectedEndDate,entityBillID:null}),this.searchRefundedBillFormGroup.controls.entityBillID.setErrors({required:!0}),this.searchRefundedBillFormGroup.updateValueAndValidity(),this.refundedBillList$.next([])):this.getRefundedBillList(!1).then(i=>{this.refundedBillList$.next(i)}).catch(i=>{this.refundedBillList$.next([]),this.toastrService.show({type:"error",text:i})})}closeNav(){null!==document.getElementById("mySidenav")&&(document.getElementById("mySidenav").style.width="0")}closeBillRefundForm(i){i&&this.refundedBillList$.next([]),this.closeNav()}printBillRefundRecipt(i){var t=this;return new Promise((n,a)=>{this.loader.showSpinner("Printing report..."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W",entityBillID:i}},"billservice/printBillRefundRecipt").pipe((0,h.R)(this.destroySubscription$)).subscribe(function(){var c=(0,w.Z)(function*(o){"200"===o.statusCode?n(Object.assign({printDate:o.date},o.responseList[0])):(t.loader.hideSpinner(),a(o.errorMessage))});return function(o){return c.apply(this,arguments)}}(),c=>{this.loader.hideSpinner(),a("Either Internet is not working or facing internal server issue")})})}generateBarCode(i){var t=this;return new Promise((n,a)=>{this.loader.showSpinner("Printing report..."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W",entityBusinessName:i}},"adminservice/getBarCode").pipe((0,h.R)(this.destroySubscription$)).subscribe(function(){var c=(0,w.Z)(function*(o){t.loader.hideSpinner(),"200"===o.statusCode?n(Object.assign({printDate:o.date},o.responseList[0])):a(o.errorMessage)});return function(o){return c.apply(this,arguments)}}(),c=>{this.loader.hideSpinner(),a("Either Internet is not working or facing internal server issue")})})}refundBill(i){i.isBillRefunded=!0,this.selectedBillDetails=i;const t=this.screenWidth>900?this.screenWidth/4:this.screenWidth;document.getElementById("mySidenav").style.width=t+"px"}printRefundedBillReport(i){this.printBillRefundRecipt(i.entityBusinessID).then(n=>{this.generateBarCode(i.patitentID).then(l=>{const c="data:image/jpg;base64,"+l.entityBusinessName,o=this.commonService.parseDate(l.printDate,"dd-MM-yyyy"),p=this.authService.employeeName,g=n.billServiceDetailEntities,f=this.numberToWordService.transform(n.refundAmount),A=this.commonService.convertFirstLetterInUpperCase(f);let x=[],B=[],_=[],q=[];const U=n.oldBillDate,G=n.effectiveDateFrom;let I=this.commonService.findValuesOfYearMonthAndDays(n.dob,i.effectiveDateFrom);const X=0==I.years?I.months+" M , "+I.days+" D":I.years+" Y";g.forEach((T,z)=>{x.push(z+1+"\n"),_.push(T.entityrate+"\n"),B.push(T.entityFinalAmount+"\n"),q.push(T.entityBusinessName+"\n")});let E="";null!=n.companyLogo&&""!=n.companyLogo&&null!=n.companyLogo&&(E="data:image/jpg;base64,"+n.companyLogo),this.winRef.nativeWindow.pdfMake.createPdf({info:{title:n.patitentName+"\tRefunded Bill Receipt",author:n.companyName,subject:"",keywords:""},pageMargins:[10,15,10,15],content:[{style:"tableExample",widths:[400],table:{body:[[{stack:[{image:E,width:480,height:60,margin:[15,10,0,0],alignment:"center",border:[!1,!1,!1,!1]}]}],[{}],[[{image:c,width:60,height:16,margin:[0,0,20,0],alignment:"right",border:[!1,!1,!1,!1]},{text:"REFUND RECEIPT",margin:[0,-10,0,0]},{text:"*"+i.patitentID+"*",border:[!1,!1,!1,!1],fontSize:"8",alignment:"right",bold:!1,margin:[0,-2,50,0]}]],[{style:"tableExample",table:{widths:[300,245],body:[["Patient Details","Bill Details"],[{style:"tableExample",table:{widths:[73,135],border:[!1,!1,!1,!1],body:[[{text:"UHID\t\t\t\t   :",border:[!1,!1,!1,!1],fontSize:"10",alignment:"left",bold:!1,margin:[0,0,0,0]},{text:i.patitentID,border:[!1,!1,!1,!1],fontSize:"10",alignment:"left",bold:!0,margin:[0,0,0,0]}],[{text:"Patient Name\t:",border:[!1,!1,!1,!1],fontSize:"10",alignment:"left",bold:!1,margin:[0,0,0,0]},{text:n.patitentName,border:[!1,!1,!1,!1],fontSize:"10",alignment:"left",bold:!0,margin:[0,0,0,0]}],[{text:"Age/Gender\t  :",border:[!1,!1,!1,!1],fontSize:"10",alignment:"left",bold:!1,margin:[0,0,0,0]},{text:X+" / "+n.patitentGender,border:[!1,!1,!1,!1],fontSize:"10",alignment:"left",bold:!0,margin:[0,0,0,0]}],[{text:"Referred By\t   :",border:[!1,!1,!1,!1],fontSize:"10",alignment:"left",bold:!1,margin:[0,0,0,0]},{text:n.referralName,border:[!1,!1,!1,!1],fontSize:"10",alignment:"left",bold:!0,margin:[0,0,0,0]}],[{text:"Address\t\t\t :",border:[!1,!1,!1,!1],fontSize:"10",alignment:"left",bold:!1,margin:[0,0,0,0]},{text:n.refundRemarks,border:[!1,!1,!1,!1],fontSize:"10",alignment:"left",bold:!0,margin:[0,0,0,0]}]]}},{style:"tableExample",table:{widths:[115,115],body:[[{text:"Receipt No.\t\t\t\t   :",border:[!1,!1,!1,!1],fontSize:"10",alignment:"left",bold:!1,margin:[0,0,0,0]},{text:n.entityBusinessShortCode,border:[!1,!1,!1,!1],fontSize:"10",alignment:"left",bold:!0,margin:[0,0,0,0]}],[{text:"Date\t\t\t\t\t\t       :",border:[!1,!1,!1,!1],fontSize:"10",alignment:"left",bold:!1,margin:[0,0,0,0]},{text:G,border:[!1,!1,!1,!1],fontSize:"10",alignment:"left",bold:!0,margin:[0,0,0,0]}],[{text:"Old Receipt Ref.No\t  :",border:[!1,!1,!1,!1],fontSize:"10",alignment:"left",bold:!1,margin:[0,0,0,0]},{text:n.entityParentBusinessName,border:[!1,!1,!1,!1],fontSize:"10",alignment:"left",bold:!0,margin:[0,0,0,0]}],[{text:"Old Receipt Date\t\t  :",border:[!1,!1,!1,!1],fontSize:"10",alignment:"left",bold:!1,margin:[0,0,0,0]},{text:U,border:[!1,!1,!1,!1],fontSize:"10",alignment:"left",bold:!0,margin:[0,0,0,0]}]]}}]]}}],[{style:"tableExample",table:{widths:[30,355,65,85],border:[!1,!1,!1,!1],body:[["SlNo.","Particulars","Rate(Rs.)","Amount(Rs.)"],[{stack:[{text:x,border:[!1,!1,!1,!1],fontSize:"10.5",alignment:"center",bold:!1,margin:[0,0,0,0]}]},{stack:[{text:q,border:[!1,!1,!1,!1],fontSize:"10.5",alignment:"left",bold:!1,margin:[0,0,0,0]}]},{stack:[{text:_,border:[!1,!1,!1,!1],fontSize:"10.5",alignment:"right",bold:!0,margin:[0,0,0,0]}]},{stack:[{text:B,border:[!1,!1,!1,!1],fontSize:"10.5",alignment:"right",bold:!0,margin:[0,0,0,0]}]}],[{text:"",border:[!1,!0,!1,!1],alignment:"center",bold:!1,margin:[0,0,0,0]},{text:"Total",border:[!0,!0,!1,!0],fontSize:"10.5",bold:!0,margin:[0,0,0,0]},{text:n.totalBillAmount,fontSize:"10.5",border:[!0,!0,!0,!0],alignment:"right",margin:[0,0,0,0]},{text:n.totalBillAmount,fontSize:"10.5",border:[!0,!0,!0,!0],alignment:"right",margin:[0,0,0,0]}],[{text:"",border:[!1,!1,!1,!1],alignment:"center",bold:!1,margin:[0,0,0,0]},{text:"",border:[!1,!1,!1,!1],fontSize:"10.5",alignment:"center",bold:!1,margin:[0,0,0,0]},{text:"Refund",border:[!0,!1,!0,!0],fontSize:"10.5",alignment:"right",bold:!1,margin:[0,0,0,0]},{text:n.refundAmount,fontSize:"10.5",border:[!0,!1,!0,!0],bold:!0,alignment:"right",margin:[0,0,0,0]}],[{text:"",border:[!1,!1,!1,!1],fontSize:"10.5",alignment:"center",bold:!0,margin:[0,0,0,0]},{text:"",border:[!1,!1,!1,!1],fontSize:"10.5",alignment:"left",bold:!1,margin:[0,0,0,0]},{text:"",border:[!1,!1,!1,!1],fontSize:"10.5",alignment:"center",bold:!0,margin:[0,0,0,0]},{text:"",border:[!1,!1,!1,!1],fontSize:"10.5",alignment:"left",bold:!1,margin:[0,0,0,0]}]]}}],[{text:"Refunded On Tests\t:\t"+i.refundTestsName,bold:!0,fontSize:"11",alignment:"left",lineHeight:1.5,margin:[0,5,0,0]}],[{text:"Amount in Word:\t"+A,bold:!0,fontSize:"11",alignment:"left",lineHeight:"1.5",margin:[0,5,0,0]}],[[{text:"Prepared By:\t"+n.createdByUser+"\t\t\t\t\t\t\tChecked By:\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tCashier By:",bold:!1,fontSize:"9.5",alignment:"left",lineHeight:"1.5",margin:[0,5,0,0]}]],[[{text:"Printed By:\t"+p+"\t\t\t\t\t\t\t\t\t\t\t\tPrinted Date:"+o,bold:!0,fontSize:"9.5",alignment:"left"}]],[{text:"Powered By iCareInfosystems",bold:!1,fontSize:"9.5",alignment:"center",color:"red"}]]}}],styles:{header:{fontSize:20,bold:!0,margin:[0,0,0,0],alignment:"center",decoration:"underline",color:"black"},commitment:{fontSize:12,bold:!1,margin:[0,0,0,12],alignment:"center"},subheader:{fontSize:12,bold:!0,margin:[40,0,0,4],alignment:"center"},tableExample:{margin:[0,5,0,15],alignment:"center",bold:!0},tableHeader:{bold:!0,fontSize:13,color:"black",alignment:"center"},patientdetails:{bold:!1,fontsize:8,color:"black",alignment:"left"},imageStyle:{alignment:"left",margin:[0,-50,0,0]}}}).open()}).catch(l=>{this.toastrService.show({type:"error",text:l})})}).catch(n=>{this.toastrService.show({type:"error",text:n})})}}return(r=d).\u0275fac=function(i){return new(i||r)(e.Y36(u.qu),e.Y36(W.u),e.Y36(N.$),e.Y36(k.k),e.Y36(L.D),e.Y36(R.c),e.Y36(O.v),e.Y36(ee.t),e.Y36(K.f))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-bill-refund"]],decls:3,vars:2,consts:[["class","container-fluid",4,"ngIf"],[1,"container-fluid"],[1,"row"],[1,"col-lg-4","col-md-4","col-12"],["childLink","Billing","subchildLink","Bill Refund"],[1,"col-lg-5","col-md-5","col-12"],[1,"bill-refund-seach-form",3,"formGroup"],[1,"col-lg-4","col-md-4","col-sm-6","bill-search-parameter"],["appearance","outline",2,"width","100%"],["matInput","","placeholder","Start Date","formControlName","fromDate","id","start-date-block","readonly","","required","",3,"matDatepicker","max","click"],["matSuffix","",3,"for"],["aria-label","calendar-icon","matDatepickerToggleIcon","",1,"lms-calendar-icon"],["startDatePicker",""],["matInput","","placeholder","End Date","formControlName","toDate","id","end-date-block","readonly","","required","",3,"matDatepicker","max","min","click"],["endDatePicker",""],[1,"col-lg-4","col-md-4","col-sm-6","bill-search-parameter",3,"hidden"],["matInput","","placeholder","Enter Bill ID*","formControlName","entityBillID","id","bill-id-block"],[4,"ngIf"],[1,"col-lg-3","col-md-3","col-12","bill-search-parameter"],["mat-raised-button","","color","warn",1,"warn-action-btn",3,"click"],["mat-raised-button","","color","primary",1,"primary-action-btn",3,"hidden","disabled","click"],["id","mySidenav",1,"bill-refund-sidenav"],[1,"update-pending-dues-panel"],[3,"billDetail","closePanelEvent"],[1,"mat-elevation-z12","lms-master-card"],[1,"lms-matcardtitlegroup"],["mat-icon-button","",3,"disableRipple","click",4,"ngIf"],[1,"remaining-space"],[1,"toggle-center-data"],[1,"toggle-label",3,"ngClass"],["color","primary",1,"toggle-material-input",3,"change"],["mat-icon-button","",3,"disableRipple","click"],["aria-label","excel",1,"lms-excel-icon"],["aria-label","csv",1,"lms-csv-icon"],["childLinkLabel","Billing","subchildLinkLabel","Bill Refund"]],template:function(i,t){1&i&&(e._UZ(0,"app-header"),e.YNc(1,we,52,19,"div",0),e.YNc(2,Ce,2,0,"div",0)),2&i&&(e.xp6(1),e.Q6J("ngIf",t.canViewRecord),e.xp6(1),e.Q6J("ngIf",!t.canViewRecord))},dependencies:[y.mk,y.O5,Q.G,u._Y,u.Fj,u.JJ,u.JL,u.Q7,u.sg,u.u,C.lW,C.RK,v.a8,v.C1,S.Mq,S.hl,S.nW,S.Q0,M.Nt,b.KE,b.hX,b.TO,b.R9,oe.Rr,Y.L,te.A,ye],styles:[".search-patient-container[_ngcontent-%COMP%]{display:flow-root;margin-top:-10px;margin-left:10px;margin-right:30px}.bill-search-parameter[_ngcontent-%COMP%]{margin-top:11px}.warn-action-btn[_ngcontent-%COMP%]{float:right;margin-top:5px}.primary-action-btn[_ngcontent-%COMP%]{float:right;margin-right:10px;margin-top:5px}.bill-refund-sidenav[_ngcontent-%COMP%]{position:fixed;top:64px;right:0;height:100%;width:0;z-index:3;box-shadow:1px 0 12px #212529;background-color:#fff;overflow-x:hidden;transition:.55s}.update-pending-dues-panel[_ngcontent-%COMP%]{padding-bottom:100px}.toggle-center-data[_ngcontent-%COMP%]{margin-top:7px}@media (max-width: 766px){.toggle-center-data[_ngcontent-%COMP%]{margin-top:2px}}.toggle-center-data[_ngcontent-%COMP%]   .toggle-label[_ngcontent-%COMP%]{font-size:14px;padding:0 10px}@media (max-width: 766px){.toggle-center-data[_ngcontent-%COMP%]   .toggle-label[_ngcontent-%COMP%]{font-size:12px}}.toggle-center-data[_ngcontent-%COMP%]   .active[_ngcontent-%COMP%]{opacity:1}.toggle-center-data[_ngcontent-%COMP%]   .inactive[_ngcontent-%COMP%]{opacity:.4}.toggle-material-input[_ngcontent-%COMP%]{margin-top:0}@media (max-width: 766px){.toggle-material-input[_ngcontent-%COMP%]{margin-top:4px}}.bill-refund-seach-form[_ngcontent-%COMP%]{display:flex;flex-direction:row}@media (max-width: 766px){.bill-refund-seach-form[_ngcontent-%COMP%]{flex-direction:column}}.refund-bill-form[_ngcontent-%COMP%]:disabled{opacity:.4}"]}),d})();var J=m(9347),ne=m(1775);let Pe=(()=>{var r;class d{constructor(i,t,n,a,l,c,o){this.dialogRef=i,this._fb=n,this.toastrService=a,this.loader=l,this.authService=c,this.masterService=o,this.referralList$=new P.X([]),this.referraltypeList$=new P.X([]),this.destroySubscription$=new Z.t(1),this.selectedBill={},this.referralDoctorName="",this._referralTypeList=[{entityBusinessID:1,entityBusinessName:"Doctor"},{entityBusinessID:2,entityBusinessName:"Patholab"},{entityBusinessID:3,entityBusinessName:"Others"}],this.selectedBill=t}ngOnInit(){this.referraltypeList$.next(this._referralTypeList),this.getReferralList(this.selectedBill.entityReferralType).then(i=>{this.referralList$.next(i)}).catch(i=>{this.referralList$.next([]),this.toastrService.show({type:"error",text:i})}),this.updateReferralForm=this._fb.group({referralType:new u.NI(this.selectedBill.entityReferralType,[u.kI.required]),referredFrom:new u.NI(this.selectedBill.entityReferralFrom,[u.kI.required])})}ngOnDestroy(){this.selectedBill={},this.referralDoctorName="",this.destroySubscription$.next(null),this.destroySubscription$.complete()}onChangeOfDropdown(i){switch(i.type){case"Referral Type":this.updateReferralForm.controls.referredFrom.setValue(null),this.getReferralList(i.value).then(t=>{this.referralList$.next(t)}).catch(t=>{this.referralList$.next([]),this.toastrService.show({type:"error",text:t})});break;case"Referral":this.updateReferralForm.controls.referredFrom.setValue(i.value),this.referralDoctorName=i.viewValue}}getReferralList(i){return new Promise((t,n)=>{this.loader.showSpinner("Loading..."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,entityBusinessID:null,mode:"W",detailFlag:!0,dropDown:!0,referredFrom:i}},"referralservice/getAllReferralReferenceEntity").pipe((0,h.R)(this.destroySubscription$)).subscribe(l=>{this.loader.hideSpinner(),"200"===l.statusCode||"300"===l.statusCode?(l.responseList=null==l.responseList?[]:l.responseList,t(l.responseList)):n(l.errorMessage)},l=>{this.loader.hideSpinner(),n("Either Internet is not working or facing internal server issue")})})}close(){this.dialogRef.close()}updateReferralDoctor(i){this.loader.showSpinner("Updating Referral Doctor..."),this.masterService.requestApiForGeneralMaster({billEntity:{entityBusinessID:this.selectedBill.entityBusinessID,entityReferralType:i.referralType,entityReferralFrom:i.referredFrom,companyID:this.authService.companyID,createdBy:this.authService.employeeID,auditAction:"U",mode:"W"}},"billservice/updateReferral").pipe((0,h.R)(this.destroySubscription$)).subscribe(n=>{this.loader.hideSpinner(),"200"===n.statusCode?(this.toastrService.show({type:"success",text:"Referral doctor modified for "+this.selectedBill.entityPatientName}),this.selectedBill.refferalFromName=""===this.referralDoctorName?this.selectedBill.refferalFromName:this.referralDoctorName,this.selectedBill.entityReferralFrom=i.referredFrom,this.selectedBill.entityReferralType=i.referralType,this.selectedBill.effectiveDateFrom=n.date,this.dialogRef.close(this.selectedBill)):this.toastrService.show({type:"error",text:n.errorMessage})},n=>{this.loader.hideSpinner(),this.toastrService.show({type:"error",text:"Either Internet is not working or facing internal server issue"})})}}return(r=d).\u0275fac=function(i){return new(i||r)(e.Y36(J.so),e.Y36(J.WI),e.Y36(u.qu),e.Y36(k.k),e.Y36(L.D),e.Y36(N.$),e.Y36(R.c))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-update-bill"]],decls:16,vars:15,consts:[["mat-dialog-title","",1,"update-bill-mat-dialog-title"],["mat-icon-button","",3,"disableRipple","click","keydown.enter"],["aria-label","cancel",1,"lms-cancel-icon"],[3,"formGroup"],[1,"container"],[1,"row",2,"margin-top","15px"],[1,"col-12"],[3,"dropdownFor","isRequired","records","formControlsName","customClass","idForSelect","dropdownChangeEvent"],["align","end"],["mat-raised-button","","color","primary",2,"margin-right","15px",3,"disabled","click"]],template:function(i,t){1&i&&(e.TgZ(0,"div",0)(1,"h2"),e._uU(2,"Update Referral Name"),e.qZA(),e.TgZ(3,"button",1),e.NdJ("click",function(){return t.close()})("keydown.enter",function(a){return a.preventDefault()}),e._UZ(4,"div",2),e.qZA()(),e.TgZ(5,"mat-dialog-content")(6,"form",3)(7,"div",4)(8,"div",5)(9,"div",6)(10,"app-lms-select",7),e.NdJ("dropdownChangeEvent",function(a){return t.onChangeOfDropdown(a)}),e.qZA()(),e.TgZ(11,"div",6)(12,"app-lms-select",7),e.NdJ("dropdownChangeEvent",function(a){return t.onChangeOfDropdown(a)}),e.qZA()()()()()(),e.TgZ(13,"mat-dialog-actions",8)(14,"button",9),e.NdJ("click",function(){return t.updateReferralDoctor(t.updateReferralForm.value)}),e._uU(15," Update "),e.qZA()()),2&i&&(e.xp6(3),e.Q6J("disableRipple",!0),e.xp6(3),e.Q6J("formGroup",t.updateReferralForm),e.xp6(4),e.Q6J("dropdownFor","Referral Type")("isRequired",!0)("records",t.referraltypeList$)("formControlsName",t.updateReferralForm.get("referralType"))("customClass","update-bill-from-select")("idForSelect","update-bill-form-1"),e.xp6(2),e.Q6J("dropdownFor","Referral")("isRequired",!0)("records",t.referralList$)("formControlsName",t.updateReferralForm.get("referredFrom"))("customClass","update-bill-from-select")("idForSelect","update-bill-form-2"),e.xp6(2),e.Q6J("disabled",t.updateReferralForm.invalid))},dependencies:[u._Y,u.JL,u.sg,ne.P,C.lW,C.RK,J.uh,J.xY,J.H8],styles:[".update-bill-mat-dialog-title[_ngcontent-%COMP%]{background:#e1e1e1;margin:0!important;height:56px;padding-top:11px;padding-left:10px;display:flex;justify-content:space-between}"]}),d})();var Be=m(3519),F=m.n(Be),ue=m(4834),ae=m(2651),ce=m(1476),D=m(9538),_e=m(6082),Fe=m(1786),de=m(3680),me=m(8525);function Te(r,d){if(1&r&&(e.TgZ(0,"mat-option",80),e._uU(1),e.qZA()),2&r){const s=d.$implicit;e.Q6J("value",s.entityBusinessID),e.xp6(1),e.hij(" ",s.entityBusinessName," ")}}function Ie(r,d){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Payment type is required field. "),e.qZA())}function Ze(r,d){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Please input valid amount. "),e.qZA())}function Ne(r,d){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Reason for discount is required field. "),e.qZA())}function ke(r,d){1&r&&e._UZ(0,"div",81)}function Le(r,d){1&r&&(e.TgZ(0,"th",82),e._uU(1," Service Name "),e.qZA())}function Re(r,d){if(1&r&&(e.TgZ(0,"td",83),e._uU(1),e.qZA()),2&r){const s=d.$implicit;e.xp6(1),e.hij(" ",s.entityBusinessName," ")}}function qe(r,d){1&r&&(e.TgZ(0,"td",84),e._uU(1," Total "),e.qZA())}function Ee(r,d){1&r&&(e.TgZ(0,"th",82),e._uU(1," Department "),e.qZA())}function Me(r,d){if(1&r&&(e.TgZ(0,"td",83),e._uU(1),e.qZA()),2&r){const s=d.$implicit;e.xp6(1),e.hij(" ",s.entitySuperParentBusinessName," ")}}function Oe(r,d){1&r&&e._UZ(0,"td",84)}function Je(r,d){1&r&&(e.TgZ(0,"th",82),e._uU(1," Rate "),e.qZA())}function Ue(r,d){if(1&r&&(e.TgZ(0,"td",83),e._uU(1),e.qZA()),2&r){const s=d.$implicit;e.xp6(1),e.hij(" ",s.entityrate," ")}}function Ge(r,d){if(1&r&&(e.TgZ(0,"td",84),e._uU(1),e.qZA()),2&r){const s=e.oxw();e.xp6(1),e.hij(" ",s.totalBasePrice," ")}}function ze(r,d){1&r&&(e.TgZ(0,"th",82),e._uU(1," Give In Percent "),e.qZA())}const $=function(){return{standalone:!0}};function Xe(r,d){if(1&r){const s=e.EpF();e.TgZ(0,"td",83)(1,"mat-checkbox",85),e.NdJ("change",function(t){const a=e.CHM(s).$implicit,l=e.oxw();return e.KtG(l.onChangeOfPercentageCheckbox(t.checked,a))})("ngModelChange",function(t){const a=e.CHM(s).$implicit;return e.KtG(a.isPercentage=t)}),e.qZA()()}if(2&r){const s=d.$implicit,i=d.index;e.xp6(1),e.MGl("name","rowispercent",i,""),e.Q6J("disabled",1===s.isSampleCollected||1==s.entityIsTestPackage)("ngModel",s.isPercentage)("ngModelOptions",e.DdM(4,$))}}function Ve(r,d){1&r&&e._UZ(0,"td",84)}function He(r,d){1&r&&(e.TgZ(0,"th",82),e._uU(1," Discount "),e.qZA())}function je(r,d){if(1&r){const s=e.EpF();e.TgZ(0,"td",83)(1,"mat-form-field",86)(2,"input",87),e.NdJ("keyup",function(t){const a=e.CHM(s).$implicit,l=e.oxw();return e.KtG(l.applyDiscountOnSelectedTestService(a,t.target.value))})("ngModelChange",function(t){const a=e.CHM(s).$implicit;return e.KtG(a.entityDiscount=t)}),e.qZA()()()}if(2&r){const s=d.$implicit,i=d.index;e.xp6(2),e.MGl("name","discount",i,""),e.Q6J("disabled",1===s.isSampleCollected||1===s.entityIsTestPackage)("ngModelOptions",e.DdM(4,$))("ngModel",s.entityDiscount)}}function We(r,d){if(1&r&&(e.TgZ(0,"td",84),e._uU(1),e.qZA()),2&r){const s=e.oxw();e.xp6(1),e.hij(" ",s.totalDiscount," ")}}function Ke(r,d){1&r&&(e.TgZ(0,"th",82),e._uU(1," Net Amount "),e.qZA())}function Qe(r,d){if(1&r&&(e.TgZ(0,"td",83),e._uU(1),e.qZA()),2&r){const s=d.$implicit;e.xp6(1),e.hij(" ",s.entityFinalAmount," ")}}function Ye(r,d){if(1&r&&(e.TgZ(0,"td",84),e._uU(1),e.qZA()),2&r){const s=e.oxw();e.xp6(1),e.hij(" ",s.totalNetAmount," ")}}function $e(r,d){1&r&&(e.TgZ(0,"th",82),e._uU(1," Check for External "),e.qZA())}function et(r,d){if(1&r){const s=e.EpF();e.TgZ(0,"td",88)(1,"mat-checkbox",89),e.NdJ("ngModelChange",function(t){const a=e.CHM(s).$implicit;return e.KtG(a.isExternal=t)})("change",function(t){const a=e.CHM(s).$implicit,l=e.oxw();return e.KtG(l.onChangeOfExternalCheckbox(t.checked,a))}),e.qZA()()}if(2&r){const s=d.$implicit,i=d.index;e.xp6(1),e.MGl("name","rowispercent",i,""),e.Q6J("disabled",1===s.isSampleCollected)("ngModel",s.isExternal)("ngModelOptions",e.DdM(4,$))}}function tt(r,d){1&r&&e._UZ(0,"td",84)}function it(r,d){1&r&&(e.TgZ(0,"th",82),e._uU(1," Check For Self Discount "),e.qZA())}function nt(r,d){if(1&r){const s=e.EpF();e.TgZ(0,"td",83)(1,"mat-checkbox",89),e.NdJ("ngModelChange",function(t){const a=e.CHM(s).$implicit;return e.KtG(a.entityIsSelfDiscount=t)})("change",function(t){const a=e.CHM(s).$implicit,l=e.oxw();return e.KtG(l.onChangeOfSelfDiscountCheckbox(t.checked,a))}),e.qZA()()}if(2&r){const s=d.$implicit,i=d.index;e.xp6(1),e.MGl("name","rowispercent",i,""),e.Q6J("disabled",1===s.isSampleCollected||1===s.entityIsTestPackage)("ngModel",s.entityIsSelfDiscount)("ngModelOptions",e.DdM(4,$))}}function at(r,d){1&r&&e._UZ(0,"td",84)}function lt(r,d){1&r&&(e.TgZ(0,"th",82),e._uU(1," Action "),e.qZA())}function rt(r,d){if(1&r){const s=e.EpF();e.TgZ(0,"td",83)(1,"button",90),e.NdJ("click",function(){const t=e.CHM(s),n=t.$implicit,a=t.index,l=e.oxw();return e.KtG(l.removeTestService(n,a))}),e._UZ(2,"div",91),e.qZA()()}2&r&&(e.xp6(1),e.Q6J("disableRipple",!0))}function st(r,d){1&r&&e._UZ(0,"td",84)}function ot(r,d){1&r&&e._UZ(0,"tr",92)}const ut=function(r){return{"background-color":r}};function ct(r,d){1&r&&e._UZ(0,"tr",93),2&r&&e.Q6J("ngStyle",e.VKq(1,ut,d.$implicit.bgColor))}function dt(r,d){if(1&r&&e._UZ(0,"tr",94),2&r){const s=e.oxw();e.Udp("display",s.dataSource.data.length>0?"table-row":"none")}}function mt(r,d){if(1&r&&(e.TgZ(0,"tr",95)(1,"td",96),e._uU(2),e.qZA()()),2&r){e.oxw();const s=e.MAs(126);e.xp6(2),e.hij(' No data matching the filter "',s.value,'" ')}}function pt(r,d){1&r&&(e.TgZ(0,"div",97),e._uU(1," No Test Added "),e.qZA())}const ft=function(){return[10,25,100]};let ht=(()=>{var r;class d{constructor(i,t,n,a,l,c,o,p,g,f){this.loader=i,this.masterService=t,this.authService=n,this._fb=a,this.toastrService=l,this.commonService=c,this.dialog=o,this.winRef=p,this.env=g,this.ngZone=f,this.selectedMasterData={},this.masterList=[],this.newPatientDetail={},this.submitButtonLabel="Submit",this.createPatientEvent=new e.vpe,this.billCreationEvent=new e.vpe,this.backgroundColorsList=["#EBB9F8","#CCB9F9","#BDC9FD","#B8F2D9","#F2FCC0","#FAE3AF","#FCB49C","#EBB9F8","#CCB9F9","#BDC9FD","#B8F2D9","#F2FCC0","#FAE3AF","#FCB49C","#EBB9F8","#CCB9F9","#BDC9FD","#B8F2D9","#F2FCC0","#FAE3AF","#FCB49C","#EBB9F8","#CCB9F9","#BDC9FD","#B8F2D9","#F2FCC0","#FAE3AF","#FCB49C"],this.displayedColumns=["testName","departmentName","rate","isPercent","entityDiscount","entityFinalAmount","isExternal","entityIsSelfDiscount","actions"],this.dataSource=new D.by([]),this.testEntitiesList=[],this.testServiceList$=new P.X([]),this.testPackagesList$=new P.X([]),this.patientList$=new P.X([]),this.referraltypeList$=new P.X([]),this.paymentTypeList$=new P.X([]),this.referralList$=new P.X([]),this.destroySubscription$=new Z.t(1),this.fetchDataOnCloseDialog$=new P.X([]),this.selectedPatientDetail=null,this.selectedReferralDoctorName=null,this.selectedReferralDoctorType=null,this.showLoader=!1,this.totalBasePrice=0,this.totalNetAmount=0,this.totalDiscount=0,this._referralTypeList=[{entityBusinessID:1,entityBusinessName:"Doctor"},{entityBusinessID:2,entityBusinessName:"Patholab"},{entityBusinessID:3,entityBusinessName:"Others"}],this._paymentTypeList=[{entityBusinessID:"Cash",entityBusinessName:"Cash"}]}ngOnInit(){this.referraltypeList$.next(this._referralTypeList),this.paymentTypeList$.next(this._paymentTypeList),setTimeout(()=>{this.getTestServiceList(null).then(i=>{this.testServiceList$.next(i),this.getPatientList().then(t=>{t=t.map(n=>({...n,entityBusinessName:`${n?.entityBusinessShortCode} - ${n?.entityBusinessName} (${n?.entityMobileNumber})`})),this.patientList$.next(t),this.getReferralList(this.selectedReferralType.value).then(n=>{this.referralList$.next(n)}).catch(n=>{this.referralList$.next([]),this.toastrService.show({type:"error",text:n})})}).catch(t=>{this.patientList$.next([]),this.toastrService.show({type:"error",text:t})})}).catch(i=>{this.testServiceList$.next([]),this.toastrService.show({type:"error",text:i})})},1e3),this.billFormGroup=this._fb.group({testControl:new u.NI(null),switchTestPackage:new u.NI(!1),patientName:new u.NI(null,[u.kI.required]),referralType:new u.NI(1,[u.kI.required]),referredFrom:new u.NI(null,[u.kI.required]),entityOverallDiscount:new u.NI(0),isPercentage:new u.NI(0),discount:new u.NI(null),flatDiscount:new u.NI({value:null,disabled:!1}),percentageDiscount:new u.NI({value:null,disabled:!1}),entityTotalDiscount:new u.NI(0),entityTotalDiscountPercentage:new u.NI(0),entityDiscountReason:new u.NI(null),paymentType:new u.NI(null,[u.kI.required]),entityTotalReceiveAmount:new u.NI(0,[u.kI.required]),entityTotalDuesAmount:new u.NI(0),isEmergency:new u.NI(0)}),null!==this.selectedMasterData&&(this.billFormGroup.patchValue(this.selectedMasterData),1==this.selectedMasterData.isPercentage?(this.billFormGroup.controls.flatDiscount.reset(),this.billFormGroup.controls.flatDiscount.disable(),this.billFormGroup.controls.percentageDiscount.enable(),this.billFormGroup.controls.percentageDiscount.setValue(this.selectedMasterData.discount)):(this.billFormGroup.controls.percentageDiscount.reset(),this.billFormGroup.controls.percentageDiscount.disable(),this.billFormGroup.controls.flatDiscount.enable(),this.billFormGroup.controls.flatDiscount.setValue(this.selectedMasterData.discount)),this.testEntitiesList=this.selectedMasterData.testResponseEntities||[])}ngOnChanges(){if(this.selectedPatientDetail=this.newPatientDetail.values,"addPatient"===this.newPatientDetail.section){let i=this.patientList$.getValue();i.unshift(this.newPatientDetail.values),this.billFormGroup.controls.patientName.setValue(this.selectedPatientDetail.entityBusinessID),this.patientList$.next(i)}"searchPatient"===this.newPatientDetail.section&&void 0!==this.billFormGroup&&this.billFormGroup.controls.patientName.setValue(this.selectedPatientDetail.entityBusinessID)}get isPercentage(){return this.billFormGroup.controls.isPercentage}get entityIsDefaultPrice(){return this.billFormGroup.controls.entityIsDefaultPrice}get switchTestPackageFlag(){return this.billFormGroup.controls.switchTestPackage}get selectedReferralType(){return this.billFormGroup.controls.referralType}get overallDiscount(){return this.billFormGroup.controls.entityOverallDiscount}get patientID(){return this.billFormGroup.controls.patientName}get referralDoctorID(){return this.billFormGroup.controls.referredFrom}ngAfterViewInit(){this.dataSource=new D.by([]),this.dataSource.paginator=this.paginator}ngOnDestroy(){this.fetchDataOnCloseDialog$&&this.fetchDataOnCloseDialog$.unsubscribe(),this.newPatientDetail={},this.billFormGroup.reset(),this.testEntitiesList=[],this.destroySubscription$.next(null),this.destroySubscription$.complete()}getTestServiceList(i){return new Promise((t,n)=>{null===i?this.loader.showSpinner("Loading..."):this.loader.hideSpinner(),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,entityBusinessID:i,mode:"W",detailFlag:!1,dropDown:null===i}},"testservice/getAllTest/").pipe((0,h.R)(this.destroySubscription$)).subscribe(l=>{"200"===l.statusCode||"300"===l.statusCode?(l.responseList=null===i?null==l.responseList?[]:l.responseList.map(c=>({entityBusinessID:c.entityBusinessID,entityBusinessName:c.entityBusinessName+" ("+c.entityShortCode+")"})):null==l.responseList?[]:l.responseList,t(l.responseList)):(this.loader.hideSpinner(),n(l.errorMessage))},l=>{this.loader.hideSpinner(),n("Either Internet is not working or facing internal server issue")})})}getTestServiceListFromPackageID(i){return new Promise((t,n)=>{null===i?this.loader.showSpinner("Loading..."):this.loader.hideSpinner(),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,entityBusinessID:i,mode:"W",detailFlag:!1,dropDown:null===i}},"testpackageservice/getAllTestFromTestPackage").pipe((0,h.R)(this.destroySubscription$)).subscribe(l=>{this.loader.hideSpinner(),"200"===l.statusCode||"300"===l.statusCode?(l.responseList=null==l.responseList?[]:l.responseList,t(l.responseList)):n(l.errorMessage)},l=>{this.loader.hideSpinner(),n("Either Internet is not working or facing internal server issue")})})}getTestPackageList(){return new Promise((i,t)=>{this.loader.showSpinner("Loading..."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,entityBusinessID:null,mode:"W",detailFlag:!1,dropDown:!0}},"testpackageservice/getAllEntity").pipe((0,h.R)(this.destroySubscription$)).subscribe(a=>{this.loader.hideSpinner(),"200"===a.statusCode||"300"===a.statusCode?(a.responseList=null==a.responseList?[]:a.responseList,i(a.responseList)):t(a.errorMessage)},a=>{this.loader.hideSpinner(),t("Either Internet is not working or facing internal server issue")})})}openAddReferralModel(){this.dialog.open(_e.s,{disableClose:!0,data:{header:"Referral Form",buttonLabel:"Submit",records:{selectedItem:null,uniqueItemList:this.referralList$.getValue().map(t=>({entityBusinessID:t.entityBusinessID,entityBusinessName:t.entityBusinessName,entityBusinessShortCode:t.entityBusinessShortCode}))}},animation:{to:"right"},position:{top:"50vh",left:"50vw"},panelClass:"lms-dialog-box-center"}).afterClosed().subscribe(t=>{if(null!==t){let n=this.referralList$.getValue();n.unshift(t[0].modifiedObject),this.referralList$.next(n),this.billFormGroup.controls.referredFrom.setValue(t[0].modifiedObject.entityBusinessID),this.toastrService.show({type:"success",text:t[0].modifiedObject.entityBusinessName+" Created!"})}})}getReferralMappingForSelectedTest(i,t){return new Promise((n,a)=>{this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,entityID:i,referredFrom:t,mode:"W",detailFlag:!1,dropDown:!1}},"referralmappingservice/getAllReferralMapping/").pipe((0,h.R)(this.destroySubscription$)).subscribe(c=>{"200"===c.statusCode||"300"===c.statusCode?(c.responseList=null==c.responseList?[]:c.responseList,n(c.responseList)):a(c.errorMessage)},c=>{a("Either Internet is not working or facing internal server issue")})})}switchToTestPackage(i){this.dataSource.data.length>0&&F().fire({title:`Selected test will be lost if you changed ${i?"test to test package":"test package to test"} , do you want to change?`,showCancelButton:!0,confirmButtonText:"Change Anyway",cancelButtonText:"Don't Change",icon:"warning"}).then(n=>{n.isConfirmed?(this.testEntitiesList=[],this.setAmountForTestService()):this.switchTestPackageFlag.setValue(!i)});const t=this.testPackagesList$.getValue().length;i&&0==t&&this.getTestPackageList().then(n=>{this.testPackagesList$.next(n)}).catch(n=>{this.testPackagesList$.next([]),this.toastrService.show({type:"error",text:n})})}applyFilter(i){this.dataSource.filter=i.target.value.trim().toLowerCase(),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}getPatientList(){let i=new Date;const t=new Date((new Date).setDate(i.getDate()-this.authService.periodOfDays)),n=this.commonService.parseDate(t,"yyyy-MM-dd"),a=this.commonService.parseDate(i,"yyyy-MM-dd");return new Promise((l,c)=>{this.loader.showSpinner("Loading..."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{fromDate:n,toDate:a,companyID:this.authService.companyID,createdBy:this.authService.employeeID,entityBusinessID:null,mode:"W",detailFlag:!1,entityType:1,dropDown:!0}},"patientservice/getAllPatient").pipe((0,h.R)(this.destroySubscription$)).subscribe(p=>{"200"===p.statusCode||"300"===p.statusCode?(p.responseList=null==p.responseList?[]:p.responseList,l(p.responseList)):(this.loader.hideSpinner(),c(p.errorMessage))},p=>{this.loader.hideSpinner(),c("Either Internet is not working or facing internal server issue")})})}getReferralList(i){return new Promise((t,n)=>{this.loader.showSpinner("Loading..."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,entityBusinessID:null,mode:"W",detailFlag:!1,dropDown:!1,referredFrom:i}},"referralservice/getAllReferralReferenceEntity").pipe((0,h.R)(this.destroySubscription$)).subscribe(l=>{this.loader.hideSpinner(),"200"===l.statusCode||"300"===l.statusCode?(l.responseList=null==l.responseList?[]:l.responseList,t(l.responseList)):n(l.errorMessage)},l=>{this.loader.hideSpinner(),n("Either Internet is not working or facing internal server issue")})})}openSidePanel(i){this.createPatientEvent.emit(i)}flatDiscountOnTestPackage(i){let t=this.testEntitiesList.reduce(function(n,a){return n+Number(a.entityrate)},0);i>t||i<0?(this.toastrService.show({type:"error",text:"Flat Discount amount should be less than total Base Charge"}),this.billFormGroup.controls.flatDiscount.setValue(null),this.testEntitiesList=this.testEntitiesList.map(n=>({...n,isPercentage:0,entityDiscount:0,entityFinalAmount:n.entityrate})),this.setAmountForTestService()):(this.testEntitiesList=this.testEntitiesList.map(n=>({...n,isPercentage:1,entityDiscount:(100-100*(t-i)/t).toFixed(2),entityFinalAmount:(n.entityrate-n.entityrate*(100-100*(t-i)/t)/100).toFixed(2)})),this.setAmountForTestService())}changePercentageToggleEvent(i){i?(this.billFormGroup.controls.flatDiscount.reset(),this.billFormGroup.controls.flatDiscount.disable(),this.billFormGroup.controls.percentageDiscount.enable(),this.testEntitiesList=this.testEntitiesList.map(t=>({...t,entityFinalAmount:t.entityrate,isPercentage:1,entityDiscount:0})),this.isPercentage.setValue(1)):(this.billFormGroup.controls.percentageDiscount.reset(),this.billFormGroup.controls.percentageDiscount.disable(),this.billFormGroup.controls.flatDiscount.enable(),this.testEntitiesList=this.testEntitiesList.map(t=>({...t,entityFinalAmount:t.entityrate,isPercentage:0,entityDiscount:0})),this.isPercentage.setValue(0)),this.setAmountForTestService()}percentageDiscountOnTestPackage(i){(i=""===i?0:i)>100||i<0?(this.toastrService.show({type:"error",text:"Percentage value should be in between of 1 to 100"}),this.billFormGroup.controls.percentageDiscount.setValue(null),this.testEntitiesList=this.testEntitiesList.map(t=>({...t,isPercentage:1,entityDiscount:0,entityFinalAmount:t.entityrate}))):this.testEntitiesList=this.testEntitiesList.map(t=>({...t,isPercentage:1,entityDiscount:i,entityFinalAmount:(t.tempEntityFinalAmount-i*t.tempEntityFinalAmount/100).toFixed(2)})),this.setAmountForTestService()}applyDiscountOnSelectedTestService(i,t){1===i.isPercentage?t>100||t<0?(this.toastrService.show({type:"error",text:"Percentage value should be in between of 1 to 100"}),i.entityDiscount=0,i.entityFinalAmount=0):i.entityFinalAmount=i.entityrate-t*i.entityrate/100:i.entityrate<t||t<0?(this.toastrService.show({type:"error",text:"Discount amount should be less than Test Base Charge"}),i.entityDiscount=0,i.entityFinalAmount=i.entityrate):(i.entityDiscount=t,i.entityFinalAmount=i.entityrate-t),this.setAmountForTestService()}setEmergencyFlag(i){let t=0;t=i?1:0,this.billFormGroup.controls.isEmergency.setValue(t)}setReferralForEachTest(i){this.testEntitiesList=this.testEntitiesList.map(i?t=>({...t,entityIsSelfDiscount:1}):t=>({...t,entityIsSelfDiscount:0})),this.dataSource=new D.by(this.testEntitiesList),this.dataSource.paginator=this.paginator}onChangeOfTestOrPackage(i,t){if(t)this.showLoader=!0,this.getTestServiceListFromPackageID(i.value).then(n=>{this.showLoader=!1,this.setTestListFromTestPackage(i.value,n)}).catch(n=>{this.showLoader=!1,this.toastrService.show({type:"error",text:n})});else if(this.testEntitiesList.find(a=>a.entityBusinessID===i.value))this.toastrService.show({type:"error",text:i.viewValue+" already in list"});else{this.showLoader=!0;let a=this.billFormGroup.controls.referredFrom.value;null!==a?this.getTestServiceList(i.value).then(l=>{this.getReferralMappingForSelectedTest(i.value,a).then(c=>{this.setReferralDiscountForSelectedTestServices(i.value,l[0],c[0].referralMappingTestComponents)}).catch(c=>{this.showLoader=!1,this.toastrService.show({type:"error",text:c})})}).catch(l=>{this.showLoader=!1,this.toastrService.show({type:"error",text:l})}):this.getTestServiceList(i.value).then(l=>{this.setTestEntitiesList(l[0])}).catch(l=>{this.showLoader=!1,this.toastrService.show({type:"error",text:l})})}this.billFormGroup.controls.testControl.setValue(null)}setReferralDiscountForSelectedTestServices(i,t,n){const a=this.testEntitiesList.length;if(null!=n){if(n[0].entityTestID==i){let l=0,c=0,o=1;1==n[0].entityIsNewRatePercentage?(n[0].entityNewRate=Math.round(n[0].entityNewRate*n[0].entityBaseCharge/100),l=n[0].entityBaseCharge-n[0].entityNewRate,c=n[0].entityNewRate,o=0):(null!=n[0].entityNewRate?(l=n[0].entityBaseCharge-n[0].entityNewRate,c=n[0].entityNewRate):(l=0,c=t.testBaseCharge),o=0),this.testEntitiesList.push({createdBy:a,entityID:null,entityBusinessID:t.entityBusinessID,entityBusinessName:t.entityBusinessName,entitySuperParentBusinessName:t.entitySuperParentBusinessName,entityrate:t.testBaseCharge,entityDiscount:l,entityFinalAmount:c,tempEntityFinalAmount:c,entityParentBusinessID:t.entityParentBusinessID,entitySuperParentBusinessID:t.entitySuperParentBusinessID,isPercentage:0,isSampleCollected:0,entityIsTestPackage:0,isExternal:t.isExternal,entityIsSelfDiscount:o,reportStatus:0,isPrinted:0,printedTime:null,bgColor:a%2==0?"#ffffff":"#ddebf7",testPackageID:null})}}else this.testEntitiesList.push({createdBy:a,entityID:null,entityBusinessID:t.entityBusinessID,entityBusinessName:t.entityBusinessName,entitySuperParentBusinessName:t.entitySuperParentBusinessName,entityrate:t.testBaseCharge,entityDiscount:0,entityFinalAmount:t.testBaseCharge,tempEntityFinalAmount:t.testBaseCharge,entityParentBusinessID:t.entityParentBusinessID,entitySuperParentBusinessID:t.entitySuperParentBusinessID,isPercentage:0,isSampleCollected:0,entityIsTestPackage:0,isExternal:t.isExternal,entityIsSelfDiscount:1,reportStatus:0,isPrinted:0,printedTime:null,bgColor:a%2==0?"#ffffff":"#ddebf7",testPackageID:null});this.showLoader=!1,this.setAmountForTestService()}setTestEntitiesList(i){const t=this.testEntitiesList.length;this.testEntitiesList.push({createdBy:t,entityID:null,entityBusinessID:i.entityBusinessID,entityBusinessName:i.entityBusinessName,entitySuperParentBusinessName:i.entitySuperParentBusinessName,entityrate:i.testBaseCharge,entityDiscount:0,entityFinalAmount:i.testBaseCharge,tempEntityFinalAmount:i.testBaseCharge,entityParentBusinessID:i.entityParentBusinessID,entitySuperParentBusinessID:i.entitySuperParentBusinessID,isPercentage:0,isSampleCollected:0,entityIsTestPackage:0,isExternal:i.isExternal,entityIsSelfDiscount:1,reportStatus:0,isPrinted:0,printedTime:null,bgColor:t%2==0?"#ffffff":"#ddebf7",testPackageID:null}),this.showLoader=!1,this.setAmountForTestService()}setTestListFromTestPackage(i,t){const n=this.testEntitiesList.length;let a=t.map((l,c)=>({createdBy:n+c,entityID:null,entityBusinessID:l.entityBusinessID,entityBusinessName:l.entityBusinessName,entitySuperParentBusinessName:l.entitySuperParentBusinessName,entityrate:l.unitNewPrice,entityDiscount:0,entityFinalAmount:l.unitNewPrice,tempEntityFinalAmount:l.unitNewPrice,entityParentBusinessID:l.entityParentBusinessID,entitySuperParentBusinessID:l.entitySuperParentBusinessID,isPercentage:0,isSampleCollected:0,entityIsTestPackage:l.isPartOfTestPackage,isExternal:l.isExternal,entityIsSelfDiscount:1,reportStatus:0,isPrinted:0,printedTime:null,bgColor:"#EBB9F8",testPackageID:i}));this.testEntitiesList=a,this.setAmountForTestService()}onChangeOfDropdown(i){switch(i.type){case"Patient":if(0===this.testEntitiesList.length){let n=this.patientList$.getValue();this.selectedPatientDetail=n.find(a=>a.entityBusinessID===i.value)}else F().fire({title:"Do you want to remove added test, which was for enquiry purpose?",showCancelButton:!0,confirmButtonText:"Remove test",cancelButtonText:"Close",icon:"warning"}).then(n=>{if(n.isConfirmed){let a=this.patientList$.getValue();this.selectedPatientDetail=a.find(l=>l.entityBusinessID===i.value),this.testEntitiesList=[],this.setAmountForTestService()}else this.billFormGroup.controls.patientName.setValue(null)});break;case"Referral Type":this.billFormGroup.controls.referredFrom.setValue(null),this.getReferralList(i.value).then(n=>{this.referralList$.next(n)}).catch(n=>{this.referralList$.next([]),this.toastrService.show({type:"error",text:n})});break;case"Referral":this.billFormGroup.controls.referredFrom.setValue(i.value);let t=this.billFormGroup.controls.referralType.value;this.selectedReferralDoctorName=i.viewValue,this.selectedReferralDoctorType=this._referralTypeList.find(n=>n.entityBusinessID===t).entityBusinessName}}clearSelectedPatientDetail(){this.selectedPatientDetail=null,this.billFormGroup.controls.patientName.setValue(null)}clearReferralDoctorDetail(){F().fire({title:"Do you want to clear referral details?",showDenyButton:!0,showCancelButton:!0,confirmButtonText:"Clear only referral",denyButtonText:"Clear referral with test added in bill",cancelButtonText:"Close",icon:"question",width:600}).then(i=>{i.isConfirmed?(this.billFormGroup.controls.referredFrom.setValue(null),this.billFormGroup.controls.referralType.setValue(null),this.selectedReferralDoctorName=null,F().fire({title:"Referral detail cleared",icon:"success",timer:1500})):i.isDenied&&(this.billFormGroup.controls.referredFrom.setValue(null),this.billFormGroup.controls.referralType.setValue(null),this.selectedReferralDoctorName=null,this.testEntitiesList=[],this.setAmountForTestService(),F().fire({title:"Referral detail cleared with test added in bill",icon:"success",timer:1500}))})}setOverallDiscount(i){this.testEntitiesList=this.testEntitiesList.map(n=>({...n,entityDiscount:0,entityFinalAmount:n.entityrate})),this.setAmountForTestService();let t=0;i?(t=1,this.billFormGroup.controls.flatDiscount.enable(),this.billFormGroup.controls.flatDiscount.setValue(0)):(t=0,this.billFormGroup.controls.flatDiscount.disable(),this.billFormGroup.controls.flatDiscount.setValue(null)),this.billFormGroup.controls.entityOverallDiscount.setValue(t)}keytab(i,t,n){if(13===i.keyCode){var a=i.srcElement.id.split("-").reduce((l,c)=>(Number(c)&&(c=Number(c)+1),l+"-"+c));document.getElementById(a).focus()}else this._uniqueColumnValidator(i.target.value,t,n)}_uniqueColumnValidator(i,t,n){if(n){const a=null===this.selectedMasterData?{entityBusinessID:null}:this.selectedMasterData;null!=this.masterList.find(c=>c[t].toString().trim().toLowerCase()===i.trim().toLowerCase()&&c.entityBusinessID!=a.entityBusinessID)&&this.billFormGroup.controls[t].setErrors({mustBeUnique:!0})}}removeTestService(i,t){null===i.testPackageID?F().fire({title:"Do you want to remove "+i.entityBusinessName+" from list?",showCancelButton:!0,confirmButtonText:"Remove test",cancelButtonText:"Close",icon:"question"}).then(n=>{n.isConfirmed&&(this.testEntitiesList.splice(t,1),this.setAmountForTestService())}):F().fire({title:"Do you want to remove selected test, This test is part of package it will delete complete package?",showCancelButton:!0,confirmButtonText:"Remove test package",cancelButtonText:"Close",icon:"question"}).then(n=>{n.isConfirmed&&(this.testEntitiesList=this.testEntitiesList.filter(a=>a.testPackageID!==i.testPackageID),this.setAmountForTestService())})}onChangeOfPercentageCheckbox(i,t){return t.isPercentage=i?1:0,this.applyDiscountOnSelectedTestService(t,t.entityDiscount),t}onChangeOfExternalCheckbox(i,t){t.isExternal=i?1:0}onChangeOfSelfDiscountCheckbox(i,t){t.entityIsSelfDiscount=i?1:0}setAmountForTestService(){this.totalBasePrice=this.testEntitiesList.reduce(function(a,l){return a+Number(l.entityrate)},0);let i=this.testEntitiesList.reduce(function(a,l){return a+Number(l.entityFinalAmount)},0);this.totalNetAmount=Math.round(i),this.totalDiscount=parseInt((this.totalBasePrice-this.totalNetAmount).toFixed(0));let t=(100*this.totalDiscount/this.totalBasePrice).toFixed(2);this.billFormGroup.controls.entityTotalDiscountPercentage.setValue(t),this.billFormGroup.controls.entityTotalDiscount.setValue(this.totalDiscount),this.changeReceiveAmount(this.billFormGroup.controls.entityTotalReceiveAmount.value),this.totalDiscount>0&&(this.billFormGroup.controls.entityDiscountReason.setValidators(u.kI.required),this.billFormGroup.controls.entityDiscountReason.setErrors({required:!0}),this.billFormGroup.updateValueAndValidity()),this.dataSource=new D.by(this.testEntitiesList),this.dataSource.paginator=this.paginator}changeReceiveAmount(i){this.totalNetAmount<Number(i)||Number(i)<0?(this.toastrService.show({type:"error",text:"Received amount can not be greater than total amount"}),this.billFormGroup.controls.entityTotalReceiveAmount.setValue(0),this.billFormGroup.controls.entityTotalDuesAmount.setValue(this.totalNetAmount)):this.billFormGroup.controls.entityTotalDuesAmount.setValue((this.totalNetAmount-i).toFixed(0))}resetBillFormValue(){this.billFormGroup.reset(),this.testEntitiesList=[],this.setAmountForTestService(),this.selectedPatientDetail=null,this.selectedReferralDoctorName=null,this.billFormGroup.controls.entityOverallDiscount.setValue(0),this.newPatientDetail.values=null}onFormSubmit(){if(this.billFormGroup.valid&&this.dataSource.data.length>0){let i=this.billFormGroup.value;this.billFormGroup.controls.entityTotalReceiveAmount.setValue(i.entityTotalReceiveAmount),F().fire({title:"Your recieved amount is \u20b9 "+i.entityTotalReceiveAmount,showCancelButton:!0,confirmButtonText:"Add Bill",cancelButtonText:"Close",icon:"success",width:600}).then(t=>{if(t.isConfirmed){i.entityBusinessName="New Bill";let n={billEntity:{active:1,entityPatientID:i.patientName,entityReferralType:i.referralType,entityReferralFrom:i.referredFrom,entityTotalBillAmount:this.totalBasePrice,entityTotalDiscountAmount:this.totalDiscount,entityIsWholeDiscount:i.entityOverallDiscount,entityTotalDiscountPercentage:i.entityTotalDiscountPercentage,entityTotalPayableAmount:this.totalNetAmount,entityTotalReceiveAmount:i.entityTotalReceiveAmount,entityTotalDuesAmount:i.entityTotalDuesAmount,paymentStatus:0==i.entityTotalDuesAmount?1:0,billServiceDetailEntities:this.testEntitiesList.map(a=>({createdBy:a.createdBy,entityID:null,entityBusinessID:a.entityBusinessID,entityBusinessName:a.entityBusinessName,entitySuperParentBusinessName:a.entitySuperParentBusinessName,entityrate:a.entityrate,entityDiscount:a.entityDiscount,entityFinalAmount:a.entityFinalAmount,entityParentBusinessID:a.entityParentBusinessID,entitySuperParentBusinessID:a.entitySuperParentBusinessID,isPercentage:a.isPercentage,isSampleCollected:a.isSampleCollected,entityIsTestPackage:a.entityIsTestPackage,isExternal:a.isExternal,entityIsSelfDiscount:a.entityIsSelfDiscount,reportStatus:a.reportStatus,isPrinted:a.isPrinted,printedTime:a.printedTime})),isPercentage:i.isPercentage,entityWholeDiscountAmount:i.entityTotalDiscount,isEmergency:i.isEmergency,discountRemarks:i.entityDiscountReason,paymentType:i.paymentType,cardCharge:0,companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W",auditAction:"C"}};"Cash"===i.paymentType?this.masterService.requestActionRestAPI(i,n,"billservice/createEntity","Adding ").then(a=>{this.billCreationEvent.emit(a),this.resetBillFormValue()}).catch(a=>{this.toastrService.show({type:"error",text:a})}):this.masterService.requestActionRestAPI(i,n,"billservice/createOrder","Adding ").then(a=>{this.payAmount(i.entityTotalReceiveAmount,a.orderID,n)}).catch(a=>{this.toastrService.show({type:"error",text:a})})}})}else{this.billFormGroup.markAllAsTouched(),this.billFormGroup.updateValueAndValidity();const i=document.getElementById("noTestAvailable");if(null!==i){i.classList.add("shake");const t=setTimeout(()=>{i.classList.remove("shake"),clearTimeout(t)},2e3)}}}payAmount(i,t,n){var a=this;new this.winRef.nativeWindow.Razorpay({key:this.env.razorpayKey,amount:100*i,currency:"INR",name:this.env.merchantCompanyName,description:this.env.merchantCompanyDescription,image:this.env.companyImageURL,order_id:t,handler:o=>{a.verifySignatureAPI(o.razorpay_order_id,o.razorpay_payment_id,o.razorpay_signature,i,n)},prefill:{name:"Book Appointment",email:this.env.merchantEmailID,contact:this.selectedPatientDetail.entityMobileNumber},notes:{address:this.env.merchantCompanyAddress},theme:{color:this.env.merchantBrandColor}}).open()}verifySignatureAPI(i,t,n,a,l){this.loader.showSpinner("Verifying..."),this.masterService.requestApiForGeneralMaster({razorpay_payment_id:t,razorpay_order_id:i,razorpay_signature:n},"billservice/verifyOrder").pipe((0,h.R)(this.destroySubscription$)).subscribe(o=>{this.showConfirmationBlock(o.success,a,i,l),this.loader.hideSpinner()},o=>{this.loader.hideSpinner()})}showConfirmationBlock(i,t,n,a){this.ngZone.run(i?()=>{this.masterService.requestActionRestAPI({},a,"billservice/createEntity","Adding ").then(l=>{F().fire({title:"Transaction Completed!",showCancelButton:!0,confirmButtonText:"Okay",cancelButtonText:"Close",icon:"success",width:600}).then(c=>{c.isConfirmed&&(this.resetBillFormValue(),this.billCreationEvent.emit(l))})}).catch(l=>{this.toastrService.show({type:"error",text:l})})}:()=>{F().fire({title:"Transaction Failed!",showDenyButton:!0,showCancelButton:!0,confirmButtonText:"Try again!",denyButtonText:"Clear bill form",cancelButtonText:"Close",icon:"error",width:600,footer:"<div><b>Note : </b> If amount is deducted from your bank account and\n          then show your transaction was cancelled then your money will reflect in your account within 7\n          working days </div>"}).then(l=>{l.isConfirmed?this.payAmount(t,n,a):l.isDenied&&(this.billCreationEvent.emit(null),this.resetBillFormValue())})})}}return(r=d).\u0275fac=function(i){return new(i||r)(e.Y36(L.D),e.Y36(R.c),e.Y36(N.$),e.Y36(u.qu),e.Y36(k.k),e.Y36(O.v),e.Y36(ue.Y),e.Y36(K.f),e.Y36(Fe.D),e.Y36(e.R0b))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-bill-form"]],viewQuery:function(i,t){if(1&i&&e.Gf(ce.NW,5),2&i){let n;e.iGM(n=e.CRH())&&(t.paginator=n.first)}},inputs:{selectedMasterData:"selectedMasterData",masterList:"masterList",newPatientDetail:"newPatientDetail",submitButtonLabel:"submitButtonLabel"},outputs:{createPatientEvent:"createPatientEvent",billCreationEvent:"billCreationEvent"},features:[e.TTD],decls:178,vars:79,consts:[[1,"container-fluid","bill-form-container"],["autocomplete","off","novalidate","",3,"formGroup"],[1,"row","bill-form-main-block"],[1,"col-12","col-md-3","col-lg-3"],[1,"col-12","col-md-12","col-lg-12","gap-between-field"],[1,"row",3,"hidden"],[1,"col-7"],[3,"dropdownFor","isRequired","records","formControlsName","customClass","idForSelect","dropdownChangeEvent"],[1,"col-5","patient-search-action-button-block"],["mat-icon-button","",3,"disableRipple","keydown.enter","click"],["aria-label","add-item",1,"lms-add-item-icon"],["mat-icon-button","",1,"lms-search-icon-btn",3,"disableRipple","keydown.enter","click"],["aria-label","person-search",1,"lms-person-search-icon"],[1,"col-10",2,"padding-bottom","15px","display","flex","flex-direction","column"],[2,"text-align","initial","color","#0f75eb","font-size","16px","font-weight","bold"],[2,"text-align","initial","color","#0f75eb","font-size","14px"],[1,"col-2","patient-search-action-button-block",2,"left","10%"],["mat-icon-button","",3,"disableRipple","click"],["aria-label","clear-icon",1,"lms-clear-icon"],[1,"col-12","col-md-12","col-lg-12","gap-between-field",3,"hidden"],[1,"col-12",2,"padding-bottom","15px","display","flex","flex-direction","column"],[1,"col-10"],[1,"col-2","referral-search-action-button-block"],["formControlName","entityOverallDiscount","id","bill-form-6","color","primary",1,"bill-form-checkbox",3,"labelPosition","disabled","change"],[1,"row"],[1,"col-5"],["appearance","outline",1,"bill-form-flat-input"],["matInput","","placeholder","Flat","minLength","1","maxLength","10","id","bill-form-7","formControlName","flatDiscount",3,"keyup"],[1,"col-2"],["id","bill-form-8","color","primary","formControlName","isPercentage",1,"bill-form-slide-toggle",3,"change"],["appearance","outline",1,"bill-form-percentage-input"],["matInput","","placeholder","Percentage","minLength","1","maxLength","3","id","bill-form-9","formControlName","percentageDiscount",3,"keyup"],[1,"col-6"],["appearance","outline",1,"bill-form-total-discount-input"],["id","bill-form-10","matInput","","placeholder","Total Discount","formControlName","entityTotalDiscount","readonly",""],["matInput","","placeholder","Total Discount (%)","id","bill-form-11","formControlName","entityTotalDiscountPercentage","readonly",""],["appearance","outline",1,"bill-form-test-select"],["formControlName","paymentType","id","bill-form-12","required","",3,"selectionChange"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["matInput","","type","number","min","0","placeholder","Received Amount","id","bill-form-13","pattern","^[\\d]+$","formControlName","entityTotalReceiveAmount","required","",3,"keyup"],["matInput","","placeholder","Dues Left","formControlName","entityTotalDuesAmount","id","bill-form-14","readonly",""],["id","bill-form-15","color","primary",1,"bill-form-checkbox",3,"labelPosition","disabled","change"],["formControlName","isEmergency","id","bill-form-16","color","warn",1,"bill-form-checkbox",3,"labelPosition","disabled","change"],["matInput","","placeholder","Reason for discount*","formControlName","entityDiscountReason","minLength","1","maxLength","100","id","bill-form-17",3,"keyup"],[1,"col-12","col-md-9","col-lg-9","test-package-service-list"],[1,"row",3,"ngClass"],[1,"col-12","col-md-5","col-lg-5",3,"hidden"],[3,"dropdownFor","isRequired","records","formControlsName","customClass","idForSelect","disabled","dropdownChangeEvent"],[1,"col-12","col-md-4","col-lg-4","toggle-action-block"],["id","bill-form-2","color","primary","formControlName","switchTestPackage","labelPosition","after",1,"switch-test-package-toggle",3,"change"],["aria-label","loader","class","lms-ios-loader",4,"ngIf"],["appearance","outline",1,"filter-mat-input"],["matInput","","placeholder","Search here...",3,"disabled","keyup"],["input",""],[1,"col-12"],[1,"test-table-container"],["mat-table","",3,"dataSource"],["matColumnDef","testName"],["mat-header-cell","","class","table-header-style",4,"matHeaderCellDef"],["mat-cell","","class","table-row-style",4,"matCellDef"],["mat-footer-cell","","class","table-footer-style",4,"matFooterCellDef"],["matColumnDef","departmentName"],["matColumnDef","rate"],["matColumnDef","isPercent"],["matColumnDef","entityDiscount"],["matColumnDef","entityFinalAmount"],["matColumnDef","isExternal"],["class","table-row-style",4,"matCellDef"],["matColumnDef","entityIsSelfDiscount"],["matColumnDef","actions","stickyEnd",""],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",3,"ngStyle",4,"matRowDef","matRowDefColumns"],["mat-footer-row","",3,"display",4,"matFooterRowDef","matFooterRowDefSticky"],["class","mat-row",4,"matNoDataRow"],["id","noTestAvailable","class","no-test-added",4,"ngIf"],[3,"pageSizeOptions"],[1,"row",2,"float","right","margin-top","15px","padding-bottom","20%"],["type","submit",1,"submit-primary-btn",3,"keydown.enter","click"],["type","submit",1,"reset-warn-btn",3,"keydown.enter","click"],[3,"value"],["aria-label","loader",1,"lms-ios-loader"],["mat-header-cell","",1,"table-header-style"],["mat-cell","",1,"table-row-style"],["mat-footer-cell","",1,"table-footer-style"],[3,"name","disabled","ngModel","ngModelOptions","change","ngModelChange"],["appearance","outline",1,"table-form-input"],["matInput","","type","number",3,"name","disabled","ngModelOptions","ngModel","keyup","ngModelChange"],[1,"table-row-style"],[3,"name","disabled","ngModel","ngModelOptions","ngModelChange","change"],["mat-icon-button","",2,"padding-bottom","10px",3,"disableRipple","click"],["aria-label","delete",1,"lms-delete-icon"],["mat-header-row",""],["mat-row","",3,"ngStyle"],["mat-footer-row",""],[1,"mat-row"],["colspan","4",1,"mat-cell"],["id","noTestAvailable",1,"no-test-added"]],template:function(i,t){1&i&&(e.TgZ(0,"div",0)(1,"form",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"app-lms-select",7),e.NdJ("dropdownChangeEvent",function(a){return t.onChangeOfDropdown(a)}),e.qZA()(),e.TgZ(8,"div",8)(9,"button",9),e.NdJ("keydown.enter",function(a){return a.preventDefault()})("click",function(){return t.openSidePanel("addPatient")}),e._UZ(10,"div",10),e.qZA(),e.TgZ(11,"button",11),e.NdJ("keydown.enter",function(a){return a.preventDefault()})("click",function(){return t.openSidePanel("searchPatient")}),e._UZ(12,"div",12),e.qZA()()(),e.TgZ(13,"div",5)(14,"div",13)(15,"div",14),e._uU(16," Patient Name : "),e.qZA(),e.TgZ(17,"div",15),e._uU(18),e.qZA()(),e.TgZ(19,"div",16)(20,"button",17),e.NdJ("click",function(){return t.clearSelectedPatientDetail()}),e._UZ(21,"div",18),e.qZA()()()(),e.TgZ(22,"div",19)(23,"app-lms-select",7),e.NdJ("dropdownChangeEvent",function(a){return t.onChangeOfDropdown(a)}),e.qZA()(),e.TgZ(24,"div",4)(25,"div",5)(26,"div",20)(27,"div",14),e._uU(28," Referral Type : "),e.qZA(),e.TgZ(29,"div",15),e._uU(30),e.qZA()()()(),e.TgZ(31,"div",4)(32,"div",5)(33,"div",21)(34,"app-lms-select",7),e.NdJ("dropdownChangeEvent",function(a){return t.onChangeOfDropdown(a)}),e.qZA()(),e.TgZ(35,"div",22)(36,"button",17),e.NdJ("click",function(){return t.openAddReferralModel()}),e._UZ(37,"div",10),e.qZA()()(),e.TgZ(38,"div",5)(39,"div",21)(40,"div",14),e._uU(41," Referral Name : "),e.qZA(),e.TgZ(42,"div",15),e._uU(43),e.qZA()(),e.TgZ(44,"div",22)(45,"button",17),e.NdJ("click",function(){return t.clearReferralDoctorDetail()}),e._UZ(46,"div",18),e.qZA()()()(),e.TgZ(47,"div",4)(48,"mat-checkbox",23),e.NdJ("change",function(a){return t.setOverallDiscount(a.checked)}),e._uU(49," Overall Discount "),e.qZA()(),e.TgZ(50,"div",19)(51,"div",24)(52,"div",25)(53,"mat-form-field",26)(54,"mat-label"),e._uU(55,"Flat"),e.qZA(),e.TgZ(56,"input",27),e.NdJ("keyup",function(a){return t.flatDiscountOnTestPackage(a.target.value)}),e.qZA()()(),e.TgZ(57,"div",28)(58,"mat-slide-toggle",29),e.NdJ("change",function(a){return t.changePercentageToggleEvent(a.checked)}),e.qZA()(),e.TgZ(59,"div",25)(60,"mat-form-field",30)(61,"mat-label"),e._uU(62,"Percentage"),e.qZA(),e.TgZ(63,"input",31),e.NdJ("keyup",function(a){return t.percentageDiscountOnTestPackage(a.target.value)}),e.qZA()()()()(),e.TgZ(64,"div",19)(65,"div",24)(66,"div",32)(67,"mat-form-field",33)(68,"mat-label"),e._uU(69,"Total Discount"),e.qZA(),e._UZ(70,"input",34),e.qZA()(),e.TgZ(71,"div",32)(72,"mat-form-field",33)(73,"mat-label"),e._uU(74,"Percentage Discount"),e.qZA(),e._UZ(75,"input",35),e.qZA()()()(),e.TgZ(76,"div",4)(77,"mat-form-field",36)(78,"mat-label"),e._uU(79,"Payment Type"),e.qZA(),e.TgZ(80,"mat-select",37),e.NdJ("selectionChange",function(a){return t.onChangeOfDropdown({type:"Payment Type",value:a.value})}),e.YNc(81,Te,2,2,"mat-option",38),e.ALo(82,"async"),e.qZA(),e.YNc(83,Ie,2,0,"mat-error",39),e.qZA()(),e.TgZ(84,"div",4)(85,"div",24)(86,"div",32)(87,"mat-form-field",33)(88,"mat-label"),e._uU(89,"Received Amount"),e.qZA(),e.TgZ(90,"input",40),e.NdJ("keyup",function(a){return t.changeReceiveAmount(a.target.value)}),e.qZA(),e.YNc(91,Ze,2,0,"mat-error",39),e.qZA()(),e.TgZ(92,"div",32)(93,"mat-form-field",33)(94,"mat-label"),e._uU(95,"Dues Left"),e.qZA(),e._UZ(96,"input",41),e.qZA()()()(),e.TgZ(97,"div",4)(98,"div",24)(99,"div",32)(100,"mat-checkbox",42),e.NdJ("change",function(a){return t.setReferralForEachTest(a.checked)}),e._uU(101," is Referral "),e.qZA()(),e.TgZ(102,"div",32)(103,"mat-checkbox",43),e.NdJ("change",function(a){return t.setEmergencyFlag(a.checked)}),e._uU(104," is Emergency "),e.qZA()()()(),e.TgZ(105,"div",19)(106,"mat-form-field",36)(107,"mat-label"),e._uU(108,"Reason for discount*"),e.qZA(),e.TgZ(109,"input",44),e.NdJ("keyup",function(a){return t.keytab(a,"entityDiscountReason",!1)}),e.qZA(),e.YNc(110,Ne,2,0,"mat-error",39),e.qZA()()(),e.TgZ(111,"div",45)(112,"div",46)(113,"div",47)(114,"app-lms-select",48),e.NdJ("dropdownChangeEvent",function(a){return t.onChangeOfTestOrPackage(a,t.switchTestPackageFlag.value)}),e.qZA()(),e.TgZ(115,"div",47)(116,"app-lms-select",48),e.NdJ("dropdownChangeEvent",function(a){return t.onChangeOfTestOrPackage(a,t.switchTestPackageFlag.value)}),e.qZA()(),e.TgZ(117,"div",49)(118,"mat-slide-toggle",50),e.NdJ("change",function(a){return t.switchToTestPackage(a.checked)}),e._uU(119," Switch to Test Package "),e.qZA(),e.YNc(120,ke,1,0,"div",51),e.qZA(),e.TgZ(121,"div",3)(122,"mat-form-field",52)(123,"mat-label"),e._uU(124,"Filter test service"),e.qZA(),e.TgZ(125,"input",53,54),e.NdJ("keyup",function(a){return t.applyFilter(a)}),e.qZA()()()(),e.TgZ(127,"div",24)(128,"div",55)(129,"div",56)(130,"table",57),e.ynx(131,58),e.YNc(132,Le,2,0,"th",59),e.YNc(133,Re,2,1,"td",60),e.YNc(134,qe,2,0,"td",61),e.BQk(),e.ynx(135,62),e.YNc(136,Ee,2,0,"th",59),e.YNc(137,Me,2,1,"td",60),e.YNc(138,Oe,1,0,"td",61),e.BQk(),e.ynx(139,63),e.YNc(140,Je,2,0,"th",59),e.YNc(141,Ue,2,1,"td",60),e.YNc(142,Ge,2,1,"td",61),e.BQk(),e.ynx(143,64),e.YNc(144,ze,2,0,"th",59),e.YNc(145,Xe,2,5,"td",60),e.YNc(146,Ve,1,0,"td",61),e.BQk(),e.ynx(147,65),e.YNc(148,He,2,0,"th",59),e.YNc(149,je,3,5,"td",60),e.YNc(150,We,2,1,"td",61),e.BQk(),e.ynx(151,66),e.YNc(152,Ke,2,0,"th",59),e.YNc(153,Qe,2,1,"td",60),e.YNc(154,Ye,2,1,"td",61),e.BQk(),e.ynx(155,67),e.YNc(156,$e,2,0,"th",59),e.YNc(157,et,2,5,"td",68),e.YNc(158,tt,1,0,"td",61),e.BQk(),e.ynx(159,69),e.YNc(160,it,2,0,"th",59),e.YNc(161,nt,2,5,"td",60),e.YNc(162,at,1,0,"td",61),e.BQk(),e.ynx(163,70),e.YNc(164,lt,2,0,"th",59),e.YNc(165,rt,3,1,"td",60),e.YNc(166,st,1,0,"td",61),e.BQk(),e.YNc(167,ot,1,0,"tr",71),e.YNc(168,ct,1,3,"tr",72),e.YNc(169,dt,1,2,"tr",73),e.YNc(170,mt,3,1,"tr",74),e.qZA(),e.YNc(171,pt,2,0,"div",75),e._UZ(172,"mat-paginator",76),e.qZA()()()()(),e.TgZ(173,"div",77)(174,"button",78),e.NdJ("keydown.enter",function(a){return a.preventDefault()})("click",function(){return t.onFormSubmit()}),e._uU(175),e.qZA(),e.TgZ(176,"button",79),e.NdJ("keydown.enter",function(a){return a.preventDefault()})("click",function(){return t.resetBillFormValue()}),e._uU(177," Reset Bill "),e.qZA()()()()),2&i&&(e.xp6(1),e.Q6J("formGroup",t.billFormGroup),e.xp6(4),e.Q6J("hidden",null!==t.selectedPatientDetail),e.xp6(2),e.Q6J("dropdownFor","Patient")("isRequired",!0)("records",t.patientList$)("formControlsName",t.billFormGroup.get("patientName"))("customClass","patient-name-search")("idForSelect","bill-form-3"),e.xp6(2),e.Q6J("disableRipple",!0),e.xp6(2),e.Q6J("disableRipple",!0),e.xp6(2),e.Q6J("hidden",null===t.selectedPatientDetail),e.xp6(5),e.hij(" ",null==t.selectedPatientDetail?null:t.selectedPatientDetail.entityBusinessName," "),e.xp6(2),e.Q6J("disableRipple",!0),e.xp6(2),e.Q6J("hidden",null!==t.selectedReferralDoctorName),e.xp6(1),e.Q6J("dropdownFor","Referral Type")("isRequired",!0)("records",t.referraltypeList$)("formControlsName",t.billFormGroup.get("referralType"))("customClass","referral-type-select")("idForSelect","bill-form-4"),e.xp6(2),e.Q6J("hidden",null===t.selectedReferralDoctorName),e.xp6(5),e.hij(" ",t.selectedReferralDoctorType," "),e.xp6(2),e.Q6J("hidden",null!==t.selectedReferralDoctorName),e.xp6(2),e.Q6J("dropdownFor","Referral")("isRequired",!0)("records",t.referralList$)("formControlsName",t.billFormGroup.get("referredFrom"))("customClass","referral-from-select")("idForSelect","bill-form-5"),e.xp6(2),e.Q6J("disableRipple",!0),e.xp6(2),e.Q6J("hidden",null===t.selectedReferralDoctorName),e.xp6(5),e.hij(" ",t.selectedReferralDoctorName," "),e.xp6(2),e.Q6J("disableRipple",!0),e.xp6(3),e.Q6J("labelPosition","after")("disabled",0===t.totalBasePrice),e.xp6(2),e.Q6J("hidden",0===t.overallDiscount.value),e.xp6(14),e.Q6J("hidden",0===t.totalDiscount),e.xp6(17),e.Q6J("ngForOf",e.lcZ(82,76,t.paymentTypeList$)),e.xp6(2),e.Q6J("ngIf",null==t.billFormGroup.controls.paymentType||null==t.billFormGroup.controls.paymentType.errors?null:t.billFormGroup.controls.paymentType.errors.required),e.xp6(8),e.Q6J("ngIf",null==t.billFormGroup.controls.entityTotalReceiveAmount||null==t.billFormGroup.controls.entityTotalReceiveAmount.errors?null:t.billFormGroup.controls.entityTotalReceiveAmount.errors.pattern),e.xp6(9),e.Q6J("labelPosition","after")("disabled",0===t.totalBasePrice),e.xp6(3),e.Q6J("labelPosition","after")("disabled",0===t.totalBasePrice),e.xp6(2),e.Q6J("hidden",0===t.totalDiscount),e.xp6(5),e.Q6J("ngIf",null==t.billFormGroup.controls.entityDiscountReason||null==t.billFormGroup.controls.entityDiscountReason.errors?null:t.billFormGroup.controls.entityDiscountReason.errors.required),e.xp6(2),e.Q6J("ngClass",null===t.patientID.value?null:null===t.referralDoctorID.value?"disable-div-block":"false"),e.xp6(1),e.Q6J("hidden",t.switchTestPackageFlag.value),e.xp6(1),e.Q6J("dropdownFor","Test")("isRequired",!1)("records",t.testServiceList$)("formControlsName",t.billFormGroup.get("testControl"))("customClass","bill-form-test-select")("idForSelect","bill-form-1")("disabled",t.showLoader),e.xp6(1),e.Q6J("hidden",!t.switchTestPackageFlag.value),e.xp6(1),e.Q6J("dropdownFor","Test Package")("isRequired",!1)("records",t.testPackagesList$)("formControlsName",t.billFormGroup.get("testControl"))("customClass","bill-form-test-select")("idForSelect","bill-form-1")("disabled",t.showLoader),e.xp6(4),e.Q6J("ngIf",t.showLoader),e.xp6(5),e.Q6J("disabled",0===t.totalBasePrice),e.xp6(5),e.Q6J("dataSource",t.dataSource),e.xp6(37),e.Q6J("matHeaderRowDef",t.displayedColumns)("matHeaderRowDefSticky",!0),e.xp6(1),e.Q6J("matRowDefColumns",t.displayedColumns),e.xp6(1),e.Q6J("matFooterRowDef",t.displayedColumns)("matFooterRowDefSticky",!0),e.xp6(2),e.Q6J("ngIf",0===t.dataSource.data.length),e.xp6(1),e.Udp("display",t.dataSource.data.length>0?"block":"none"),e.Q6J("pageSizeOptions",e.DdM(78,ft)),e.xp6(3),e.hij(" ",t.submitButtonLabel," "))},dependencies:[y.mk,y.sg,y.O5,y.PC,u._Y,u.Fj,u.wV,u.JJ,u.JL,u.Q7,u.c5,u.qQ,u.On,u.sg,u.u,ne.P,de.ey,C.RK,ie.oG,M.Nt,b.KE,b.hX,b.TO,ce.NW,me.gD,oe.Rr,D.BZ,D.fO,D.as,D.w1,D.Dz,D.nj,D.mD,D.Ke,D.ge,D.ev,D.yh,D.XQ,D.Gk,D.Q2,D.Ee,y.Ov],styles:[".bill-form-container[_ngcontent-%COMP%]{margin-top:10px}@media (max-width: 766px){.bill-form-container[_ngcontent-%COMP%]{margin-top:40px}}.lms-search-icon-btn[_ngcontent-%COMP%]{right:20%}.bill-form-primary-container[_ngcontent-%COMP%]{position:sticky!important;top:-5px!important;z-index:999!important}.switch-test-package-toggle[_ngcontent-%COMP%]{display:flex;flex-direction:row;margin-top:10px}@media (max-width: 766px){.switch-test-package-toggle[_ngcontent-%COMP%]{margin-left:8px;margin-top:-10px}}.patient-search-action-button-block[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-around;left:18%;margin-top:1%}@media (max-width: 766px){.patient-search-action-button-block[_ngcontent-%COMP%]{left:14%}}.referral-search-action-button-block[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;left:10%;margin-top:1%}@media (max-width: 766px){.referral-search-action-button-block[_ngcontent-%COMP%]{left:5%}}.bill-form-checkbox[_ngcontent-%COMP%]{display:flex;flex-direction:row;margin-bottom:6px}@media (max-width: 766px){.bill-form-checkbox[_ngcontent-%COMP%]{margin-top:0}}.bill-form-main-block[_ngcontent-%COMP%]{display:flex;flex-direction:row}@media (max-width: 766px){.bill-form-main-block[_ngcontent-%COMP%]{margin-left:-8%;flex-direction:column}}.test-package-secondary-form[_ngcontent-%COMP%]{margin-left:-1%}@media (max-width: 766px){.test-package-secondary-form[_ngcontent-%COMP%]{margin-left:-4%}}.percentage-panel-title[_ngcontent-%COMP%]{font-weight:700;display:flex;flex-direction:row;margin-top:16px;font-size:15px}@media (max-width: 766px){.percentage-panel-title[_ngcontent-%COMP%]{margin-top:0;margin-bottom:10px}}.test-package-percentage-panel[_ngcontent-%COMP%]{display:flex;flex-direction:row;margin-left:-7%}@media (max-width: 766px){.test-package-percentage-panel[_ngcontent-%COMP%]{margin-left:0}}.bill-form-flat-input[_ngcontent-%COMP%]{width:9vw}@media (max-width: 766px){.bill-form-flat-input[_ngcontent-%COMP%]{width:36vw}}.bill-form-slide-toggle[_ngcontent-%COMP%]{display:flex;flex-direction:row;margin-top:14px}@media (max-width: 766px){.bill-form-slide-toggle[_ngcontent-%COMP%]{margin-left:-8px}}.bill-form-percentage-input[_ngcontent-%COMP%]{width:10vw}@media (max-width: 766px){.bill-form-percentage-input[_ngcontent-%COMP%]{width:36vw;margin-left:0}}.test-package-service-block[_ngcontent-%COMP%]{background:#e6e6e6;cursor:pointer}.test-package-service-block[_ngcontent-%COMP%]   .test-package-service-column[_ngcontent-%COMP%]{display:flex;flex-direction:column;color:#1f1f1b;font-size:14px;margin-bottom:4%}.label-values-column[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-top:-35px}.label-and-name-block[_ngcontent-%COMP%]{float:left;margin-left:10px;margin-top:7px;margin-bottom:5px}.delete-test-service[_ngcontent-%COMP%]{float:right}.label-block[_ngcontent-%COMP%]{display:inline;font-size:14px;font-weight:bolder}.name-block[_ngcontent-%COMP%]{display:inline;font-size:13px}.percentage-checkbox[_ngcontent-%COMP%]{position:relative;top:3px;left:10px}.discount-amount-input[_ngcontent-%COMP%]{width:45%;border:2px solid #d7d7d7;border-radius:10px;padding-left:7px}.disable-div-block[_ngcontent-%COMP%]{pointer-events:none;opacity:.4}.not-clickable[_ngcontent-%COMP%]{pointer-events:none}.test-table-container[_ngcontent-%COMP%]{width:96%;margin-left:auto;max-height:600px;overflow:auto;box-shadow:0 0 5px #dee2e6}@media (max-width: 766px){.test-table-container[_ngcontent-%COMP%]{width:98%;max-height:500px;box-shadow:0 0 10px 2px #888}}table[_ngcontent-%COMP%]{width:100%}.filter-mat-input[_ngcontent-%COMP%]{font-size:14px;width:100%;display:flex;flex-direction:column;margin-left:auto}@media (max-width: 766px){.filter-mat-input[_ngcontent-%COMP%]{width:98%;margin-top:10px}}.table-header-style[_ngcontent-%COMP%]{text-align:center;font-size:15px;font-weight:500;word-break:break-word;min-width:100px;background:#187efe;color:#fff}.table-row-style[_ngcontent-%COMP%], .table-footer-style[_ngcontent-%COMP%]{text-align:center;font-size:13px;font-weight:500}.toggle-action-block[_ngcontent-%COMP%]{display:flex;flex-direction:row-reverse;justify-content:space-between}@media (max-width: 766px){.toggle-action-block[_ngcontent-%COMP%]{flex-direction:row}}input[type=number][_ngcontent-%COMP%]::-webkit-inner-spin-button, input[type=number][_ngcontent-%COMP%]::-webkit-outer-spin-button{-webkit-appearance:none;appearance:none;margin:0}.submit-primary-btn[_ngcontent-%COMP%]{float:right;display:block;text-align:center;border:2px solid #187efe;outline:none;color:#fff;border-radius:24px;transition:.25s;cursor:pointer;width:130px;font-size:16px;background:#187efe;margin-right:20px;height:40px}.reset-warn-btn[_ngcontent-%COMP%]{float:right;display:block;text-align:center;border:2px solid #f44336;outline:none;color:#fff;border-radius:24px;transition:.25s;cursor:pointer;width:130px;font-size:16px;background:#f44336;margin-right:20px;height:40px}.submit-primary-btn[_ngcontent-%COMP%]:disabled, .reset-warn-btn[_ngcontent-%COMP%]:disabled{opacity:.4;pointer-events:none}.no-test-added[_ngcontent-%COMP%]{height:100px;display:flex;justify-content:center;align-items:center;color:#000;overflow:hidden}.shake[_ngcontent-%COMP%]{color:red;animation:_ngcontent-%COMP%_shaken .8s infinite}@keyframes _ngcontent-%COMP%_shaken{0%{transform:translate(0)}25%{transform:translate(25px)}50%{transform:translate(-25px)}to{transform:translate(0)}}.gap-between-field[_ngcontent-%COMP%]{margin-bottom:16px}"]}),d})();function gt(r,d){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Patient Name is required field. "),e.qZA())}function bt(r,d){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Please match the requested format. "),e.qZA())}function yt(r,d){if(1&r&&(e.TgZ(0,"mat-option",28),e._uU(1),e.qZA()),2&r){const s=d.$implicit;e.Q6J("value",s.entityBusinessShortCode),e.xp6(1),e.hij(" ",s.entityBusinessName," ")}}function vt(r,d){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Gender is required field. "),e.qZA())}function Dt(r,d){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Please enter valid Mobile number. "),e.qZA())}function At(r,d){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Mobile Number is required field. "),e.qZA())}function wt(r,d){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Mobile Number is already taken. "),e.qZA())}function Ct(r,d){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Please enter valid Email-ID. "),e.qZA())}let xt=(()=>{var r;class d{constructor(i,t,n,a,l,c){this.fb=i,this.loader=t,this.masterService=n,this.authService=a,this.toastrService=l,this.commonService=c,this.destroySubscription$=new Z.t(1),this.createPatientEvent=new e.vpe,this.salutationList$=new P.X([]),this.genderList$=new P.X([]),this.currentDate=new Date}ngOnInit(){this.createPatientForm=this.fb.group({entitySalutationID:new u.NI(null,[u.kI.required]),entityBusinessName:new u.NI(null,[u.kI.required]),entityDOB:new u.NI(null,[u.kI.required]),entityAgeInYear:new u.NI(null,[u.kI.required]),entityAgeInMonth:new u.NI(null,[u.kI.required]),entityAgeInDays:new u.NI(null,[u.kI.required]),entityGender:new u.NI(null,[u.kI.required]),entityMobileNumber:new u.NI(null,[u.kI.required]),entityEmailID:new u.NI(null,[u.kI.email]),entityAddress:new u.NI(null)}),this.getSalutaionList().then(i=>{this.salutationList$.next(i),this.getGenderList().then(t=>{this.genderList$.next(t)}).catch(()=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}).catch(()=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})}),this.createPatientForm.controls.entityDOB.setValue(this.currentDate),this.setValuesOfYearMonthAndDays(this.currentDate,this.currentDate)}getSalutaionList(){return new Promise((i,t)=>{this.loader.showSpinner("Loading..."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,entityBusinessID:null,mode:"W",detailFlag:!1,dropDown:!0}},"salutationservice/getAllSalutation/").pipe((0,h.R)(this.destroySubscription$)).subscribe(a=>{this.loader.hideSpinner(),"200"===a.statusCode||"300"===a.statusCode?(a.responseList=null==a.responseList?[]:a.responseList.map(l=>({entityBusinessID:l.entityBusinessName,entityBusinessName:l.entityBusinessName})),i(a.responseList)):t(a.errorMessage)},a=>{this.loader.hideSpinner(),t("Either Internet is not working or facing internal server issue")})})}getGenderList(){return new Promise((i,t)=>{this.loader.showSpinner("Loading..."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,entityType:"G",mode:"W",detailFlag:!1,dropDown:!0}},"enumservice/getAllReferenceEntity/").pipe((0,h.R)(this.destroySubscription$)).subscribe(a=>{this.loader.hideSpinner(),"200"===a.statusCode||"300"===a.statusCode?(a.responseList=null==a.responseList?[]:a.responseList,i(a.responseList)):t(a.errorMessage)},a=>{this.loader.hideSpinner(),t("Either Internet is not working or facing internal server issue")})})}closeAddPatientBlock(){this.createPatientEvent.emit(null)}ngOnDestroy(){this.destroySubscription$.next(null),this.destroySubscription$.complete()}keytab(i,t,n){if(13===i.keyCode){var a=i.srcElement.id.split("-").reduce((l,c)=>(Number(c)&&(c=Number(c)+1),l+"-"+c));document.getElementById(a).focus()}else this._uniqueColumnValidator(i.target.value,t,n)}_uniqueColumnValidator(i,t,n){if(n)10===i.length&&this.checkMobileNumberIsExists(i).then(a=>{a&&null!==i&&this.createPatientForm.controls[t].setErrors({mustBeUnique:!0})}).catch(a=>{this.toastrService.show({type:"error",text:a})});else switch(t){case"entityAgeInYear":Number(i)<0&&(this.toastrService.show({type:"error",text:"Kindly enter natural number in between 0-9"}),this.createPatientForm.controls[t].setValue(0)),Number(i)>120&&(this.toastrService.show({type:"error",text:"Kindly enter valid year"}),this.createPatientForm.controls[t].setValue(0)),this.onChangeOfYearMonthDaysInput();break;case"entityAgeInMonth":Number(i)<0&&(this.toastrService.show({type:"error",text:"Kindly enter natural number in between 0-9"}),this.createPatientForm.controls[t].setValue(0)),Number(i)>11&&(this.toastrService.show({type:"error",text:"Kindly enter valid month"}),this.createPatientForm.controls[t].setValue(0)),this.onChangeOfYearMonthDaysInput();break;case"entityAgeInDays":Number(i)<0&&(this.toastrService.show({type:"error",text:"Kindly enter natural number in between 0-9"}),this.createPatientForm.controls[t].setValue(0)),Number(i)>31&&(this.toastrService.show({type:"error",text:"Kindly enter valid days"}),this.createPatientForm.controls[t].setValue(0)),this.onChangeOfYearMonthDaysInput()}}onChangeOfDOBInput(i){this.setValuesOfYearMonthAndDays(this.currentDate,i)}setValuesOfYearMonthAndDays(i,t){const n=this.commonService.findValuesOfYearMonthAndDays(i,t);this.createPatientForm.controls.entityAgeInYear.setValue(n.years),this.createPatientForm.controls.entityAgeInMonth.setValue(n.months),this.createPatientForm.controls.entityAgeInDays.setValue(n.days)}onChangeOfYearMonthDaysInput(){let i=Number(this.createPatientForm.controls.entityAgeInYear.value),t=Number(this.createPatientForm.controls.entityAgeInMonth.value),n=Number(this.createPatientForm.controls.entityAgeInDays.value),a=new Date(this.currentDate).getFullYear()-i,l=new Date(this.currentDate).getMonth()-t,c=new Date(this.currentDate).getDate()-n;const o=new Date(a,l,c);this.createPatientForm.controls.entityDOB.setValue(o)}checkMobileNumberIsExists(i){return new Promise((t,n)=>{this.loader.showSpinner("Loading..."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,entityBusinessName:i,mode:"W",detailFlag:!1,dropDown:!0}},"adminservice/validateMobileNo").pipe((0,h.R)(this.destroySubscription$)).subscribe(l=>{this.loader.hideSpinner(),"200"===l.statusCode?t(l.responseList[0]):"300"===l.statusCode?t(!1):n(l.errorMessage)},l=>{this.loader.hideSpinner(),n("Either Internet is not working or facing internal server issue")})})}onChangeOfDropdown(i){}createNewPatient(i){const t={patientEntity:{entitySalutationID:i.entitySalutationID,entityBusinessName:i.entityBusinessName,entityCategoryID:"",entityClubMemberID:"",entityAllergy:"",entityGender:i.entityGender,entityBloodGroupID:"",entityWeight:"",entityHeight:"",entityCountryID:"",entityStateID:"",entityCityID:"",entityAddress:i.entityAddress,entityMobileNumber:i.entityMobileNumber,entityResidentialNumber:"",entityPatientType:"",entityCorporateID:"",entityEmployeeNumber:"",entityEmployeeDesignation:"",entityEmployeeDepartment:"",entityInsuranceID:"",entityInsuranceCode:"",entityPolicyNumber:"",entityEmailID:i.entityEmailID,entityPassword:null,entityPhoto:"",entityDOB:this.commonService.parseDate(i.entityDOB),entityAgeInMonth:i.entityAgeInMonth,entityAgeInYear:i.entityAgeInYear,entityAgeInDays:i.entityAgeInDays,companyID:this.authService.companyID,createdBy:this.authService.employeeID,auditAction:"C",mode:"W",activeFlag:1}};this.masterService.requestActionRestAPI(i,t,"patientservice/createPatient","Adding ").then(n=>{this.toastrService.show({type:"success",text:n.entityBusinessName+" Created!"}),this.createPatientForm.reset(),this.createPatientEvent.emit(n)}).catch(n=>{this.toastrService.show({type:"error",text:n})})}}return(r=d).\u0275fac=function(i){return new(i||r)(e.Y36(u.qu),e.Y36(L.D),e.Y36(R.c),e.Y36(N.$),e.Y36(k.k),e.Y36(O.v))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-create-patient"]],outputs:{createPatientEvent:"createPatientEvent"},decls:76,vars:27,consts:[["autocomplete","off",3,"formGroup"],[1,"container-fluid"],[1,"row"],[1,"col-6"],[2,"font-size","1rem","padding-top","8px"],["mat-icon-button","",2,"float","right","padding-top","8px",3,"disableRipple","click"],["aria-label","clear-icon",1,"lms-clear-icon"],[1,"col-12"],[3,"dropdownFor","isRequired","records","formControlsName","customClass","idForSelect","keyup","dropdownChangeEvent"],["appearance","outline",1,"create-patient-form-field"],["matInput","","placeholder","Patient Name*","formControlName","entityBusinessName","minLength","1","maxLength","100","required","","id","create-patient-2","oninput","this.value = this.value.toUpperCase()",3,"pattern","keyup"],[4,"ngIf"],[1,"col-4"],["matInput","","placeholder","Age (in year)","formControlName","entityAgeInYear","minLength","1","maxLength","3","id","create-patient-3",3,"pattern","keyup"],["matInput","","placeholder","Age (in month)","formControlName","entityAgeInMonth","minLength","1","maxLength","2","id","create-patient-4",3,"pattern","keyup"],["matInput","","placeholder","Age (in day)","formControlName","entityAgeInDays","minLength","1","maxLength","2","id","create-patient-5",3,"pattern","keyup"],["matInput","","placeholder","Date of Birth (MM/DD/YYYY)","formControlName","entityDOB","id","create-patient-6","readonly","",3,"matDatepicker","max","click","dateChange"],["matSuffix","",3,"for"],["aria-label","calendar-icon","matDatepickerToggleIcon","",1,"lms-calendar-icon"],["dobpicker",""],["formControlName","entityGender","required","","id","create-patient-7"],[3,"value",4,"ngFor","ngForOf"],["matInput","","placeholder","Mobile Number*","id","create-patient-8","formControlName","entityMobileNumber","minLength","10","maxLength","10","required","",3,"pattern","keyup"],["matInput","","placeholder","Email ID","formControlName","entityEmailID","minLength","1","maxLength","100","id","create-patient-9",3,"keyup"],["matInput","","placeholder","Address","formControlName","entityAddress","minLength","1","maxLength","200","id","create-patient-10","rows","1",3,"keyup"],[1,"col-12",2,"display","flex","flex-direction","row","justify-content","space-around","padding-bottom","20%"],["mat-raised-button","","color","primary",1,"primary-action-btn",2,"width","35%",3,"disabled","click"],["mat-raised-button","","color","warn",1,"warn-action-btn",2,"width","35%",3,"click"],[3,"value"]],template:function(i,t){if(1&i){const n=e.EpF();e.TgZ(0,"form",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),e._uU(5,"Add New Patient"),e.qZA()(),e.TgZ(6,"div",3)(7,"button",5),e.NdJ("click",function(){return t.closeAddPatientBlock()}),e._UZ(8,"div",6),e.qZA()()(),e.TgZ(9,"div",2)(10,"div",7)(11,"app-lms-select",8),e.NdJ("keyup",function(l){return t.keytab(l,"entitySalutationID",!1)})("dropdownChangeEvent",function(l){return t.onChangeOfDropdown(l)}),e.qZA()(),e.TgZ(12,"div",7)(13,"mat-form-field",9)(14,"mat-label"),e._uU(15,"Patient Name"),e.qZA(),e.TgZ(16,"input",10),e.NdJ("keyup",function(l){return t.keytab(l,"entityBusinessName",!1)}),e.qZA(),e.YNc(17,gt,2,0,"mat-error",11),e.YNc(18,bt,2,0,"mat-error",11),e.qZA()(),e.TgZ(19,"div",12)(20,"mat-form-field",9)(21,"mat-label"),e._uU(22,"Age (in year)"),e.qZA(),e.TgZ(23,"input",13),e.NdJ("keyup",function(l){return t.keytab(l,"entityAgeInYear",!1)}),e.qZA()()(),e.TgZ(24,"div",12)(25,"mat-form-field",9)(26,"mat-label"),e._uU(27,"Age (in month)"),e.qZA(),e.TgZ(28,"input",14),e.NdJ("keyup",function(l){return t.keytab(l,"entityAgeInMonth",!1)}),e.qZA()()(),e.TgZ(29,"div",12)(30,"mat-form-field",9)(31,"mat-label"),e._uU(32,"Age (in day)"),e.qZA(),e.TgZ(33,"input",15),e.NdJ("keyup",function(l){return t.keytab(l,"entityAgeInDays",!1)}),e.qZA()()(),e.TgZ(34,"div",7)(35,"mat-form-field",9)(36,"mat-label"),e._uU(37,"Date of Birth (MM/DD/YYYY)"),e.qZA(),e.TgZ(38,"input",16),e.NdJ("click",function(){e.CHM(n);const l=e.MAs(42);return e.KtG(l.open())})("dateChange",function(l){return t.onChangeOfDOBInput(l.target.value)}),e.qZA(),e.TgZ(39,"mat-datepicker-toggle",17),e._UZ(40,"div",18),e.qZA(),e._UZ(41,"mat-datepicker",null,19),e.qZA()(),e.TgZ(43,"div",7)(44,"mat-form-field",9)(45,"mat-label"),e._uU(46,"Choose Gender"),e.qZA(),e.TgZ(47,"mat-select",20),e.YNc(48,yt,2,2,"mat-option",21),e.ALo(49,"async"),e.qZA(),e.YNc(50,vt,2,0,"mat-error",11),e.qZA()(),e.TgZ(51,"div",7)(52,"mat-form-field",9)(53,"mat-label"),e._uU(54,"Mobile Number"),e.qZA(),e.TgZ(55,"input",22),e.NdJ("keyup",function(l){return t.keytab(l,"entityMobileNumber",!0)}),e.qZA(),e.YNc(56,Dt,2,0,"mat-error",11),e.YNc(57,At,2,0,"mat-error",11),e.YNc(58,wt,2,0,"mat-error",11),e.qZA()(),e.TgZ(59,"div",7)(60,"mat-form-field",9)(61,"mat-label"),e._uU(62,"Email ID"),e.qZA(),e.TgZ(63,"input",23),e.NdJ("keyup",function(l){return t.keytab(l,"entityEmailID",!1)}),e.qZA(),e.YNc(64,Ct,2,0,"mat-error",11),e.qZA()(),e.TgZ(65,"div",7)(66,"mat-form-field",9)(67,"mat-label"),e._uU(68,"Address"),e.qZA(),e.TgZ(69,"textarea",24),e.NdJ("keyup",function(l){return t.keytab(l,"entityAddress",!1)}),e.qZA()()()(),e.TgZ(70,"div",2)(71,"div",25)(72,"button",26),e.NdJ("click",function(){return t.createNewPatient(t.createPatientForm.value)}),e._uU(73," Create "),e.qZA(),e.TgZ(74,"button",27),e.NdJ("click",function(){return t.closeAddPatientBlock()}),e._uU(75," Close "),e.qZA()()()()()}if(2&i){const n=e.MAs(42);e.Q6J("formGroup",t.createPatientForm),e.xp6(7),e.Q6J("disableRipple",!0),e.xp6(4),e.Q6J("dropdownFor","Salutation")("isRequired",!0)("records",t.salutationList$)("formControlsName",t.createPatientForm.controls.entitySalutationID)("customClass","create-patient-form-field")("idForSelect","create-patient-1"),e.xp6(5),e.Q6J("pattern","[^]*"),e.xp6(1),e.Q6J("ngIf",null==t.createPatientForm.controls.entityBusinessName||null==t.createPatientForm.controls.entityBusinessName.errors?null:t.createPatientForm.controls.entityBusinessName.errors.required),e.xp6(1),e.Q6J("ngIf",null==t.createPatientForm.controls.entityBusinessName||null==t.createPatientForm.controls.entityBusinessName.errors?null:t.createPatientForm.controls.entityBusinessName.errors.pattern),e.xp6(5),e.Q6J("pattern","[0-9/]*"),e.xp6(5),e.Q6J("pattern","[0-9/]*"),e.xp6(5),e.Q6J("pattern","[0-9/]*"),e.xp6(5),e.Q6J("matDatepicker",n)("max",t.currentDate),e.xp6(1),e.Q6J("for",n),e.xp6(9),e.Q6J("ngForOf",e.lcZ(49,25,t.genderList$)),e.xp6(2),e.Q6J("ngIf",null==t.createPatientForm.controls.entityGender||null==t.createPatientForm.controls.entityGender.errors?null:t.createPatientForm.controls.entityGender.errors.required),e.xp6(5),e.Q6J("pattern","[6-9]{1}[0-9]{9}"),e.xp6(1),e.Q6J("ngIf",null==t.createPatientForm.controls.entityMobileNumber||null==t.createPatientForm.controls.entityMobileNumber.errors?null:t.createPatientForm.controls.entityMobileNumber.errors.pattern),e.xp6(1),e.Q6J("ngIf",null==t.createPatientForm.controls.entityMobileNumber||null==t.createPatientForm.controls.entityMobileNumber.errors?null:t.createPatientForm.controls.entityMobileNumber.errors.required),e.xp6(1),e.Q6J("ngIf",null==t.createPatientForm.controls.entityMobileNumber||null==t.createPatientForm.controls.entityMobileNumber.errors?null:t.createPatientForm.controls.entityMobileNumber.errors.mustBeUnique),e.xp6(6),e.Q6J("ngIf",null==t.createPatientForm.controls.entityEmailID||null==t.createPatientForm.controls.entityEmailID.errors?null:t.createPatientForm.controls.entityEmailID.errors.email),e.xp6(8),e.Q6J("disabled",t.createPatientForm.invalid)}},dependencies:[y.sg,y.O5,u._Y,u.Fj,u.JJ,u.JL,u.Q7,u.c5,u.sg,u.u,ne.P,de.ey,C.lW,C.RK,S.Mq,S.hl,S.nW,S.Q0,M.Nt,b.KE,b.hX,b.TO,b.R9,me.gD,y.Ov]}),d})();function St(r,d){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Please match the requested format. "),e.qZA())}function Pt(r,d){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Please enter valid mobile number. "),e.qZA())}function Bt(r,d){if(1&r){const s=e.EpF();e.TgZ(0,"div",21)(1,"mat-card",22),e.NdJ("click",function(){const n=e.CHM(s).$implicit,a=e.oxw();return e.KtG(a.choosePatient(n))}),e.TgZ(2,"mat-card-header")(3,"div",23),e._uU(4),e.ALo(5,"uppercase"),e.qZA(),e.TgZ(6,"mat-card-title"),e._uU(7),e.qZA(),e.TgZ(8,"mat-card-subtitle"),e._uU(9),e.qZA()()()()}if(2&r){const s=d.$implicit,i=e.oxw();e.Q6J("hidden",0===(null==i.searchedPatientList?null:i.searchedPatientList.length)),e.xp6(4),e.hij(" ",e.lcZ(5,4,(null==s?null:s.entityBusinessShortCode)||"")," "),e.xp6(3),e.Oqu((null==s?null:s.entityBusinessName)||""),e.xp6(2),e.hij("Mobile Number : ",(null==s?null:s.entityMobileNumber)||"","")}}function _t(r,d){1&r&&(e.TgZ(0,"div",24),e._UZ(1,"img",25),e.qZA())}let Ft=(()=>{var r;class d{constructor(i,t,n,a,l,c){this.fb=i,this.loader=t,this.masterService=n,this.authService=a,this.toastrService=l,this.commonService=c,this.searchedPatientList=null,this.destroySubscription$=new Z.t(1),this.searchPatientEvent=new e.vpe}ngOnInit(){this.searchPatientForm=this.fb.group({entityBusinessName:new u.NI(null),entityMobileNumber:new u.NI(null),entityRegistrationNo:new u.NI(null)})}ngOnDestroy(){this.destroySubscription$.next(null),this.destroySubscription$.complete()}getPatientDetail(i){return new Promise((t,n)=>{this.loader.showSpinner("Loading..."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,entityBusinessName:null===i.entityBusinessName||""===i.entityBusinessName?void 0:i.entityBusinessName,mobileNo:null===i.entityMobileNumber||""===i.entityMobileNumber?void 0:i.entityMobileNumber,entityRegistrationNo:null===i.entityRegistrationNo||""===i.entityRegistrationNo?void 0:i.entityRegistrationNo,mode:"W",detailFlag:!1,entityType:1,dropDown:!1}},"patientservice/getAllPatient").pipe((0,h.R)(this.destroySubscription$)).subscribe(l=>{this.loader.hideSpinner(),"200"===l.statusCode||"300"===l.statusCode?(l.responseList=null==l.responseList?[]:l.responseList,t(l.responseList)):n(l.errorMessage)},l=>{this.loader.hideSpinner(),n("Either Internet is not working or facing internal server issue")})})}closeSearchPatientBlock(){this.searchPatientEvent.emit(null)}searchPatientByParameter(i){i=Object.keys(i).reduce((t,n)=>(t[n]=null===i[n]||""===i[n].trim()?null:i[n],t),{}),this.commonService.checkEveryPropertiesNullOrUndefined(i)?(this.toastrService.show({type:"error",text:"You have not entered in any of the textbox to search!"}),this.searchPatientForm.patchValue(i)):this.getPatientDetail(i).then(t=>{this.searchedPatientList=t}).catch(t=>{this.toastrService.show({type:"error",text:t})})}choosePatient(i){this.searchPatientForm.reset(),this.searchPatientEvent.emit(i),this.searchedPatientList=null}}return(r=d).\u0275fac=function(i){return new(i||r)(e.Y36(u.qu),e.Y36(L.D),e.Y36(R.c),e.Y36(N.$),e.Y36(k.k),e.Y36(O.v))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-search-patient"]],outputs:{searchPatientEvent:"searchPatientEvent"},decls:43,vars:8,consts:[["autocomplete","off",3,"formGroup"],[1,"container-fluid"],[1,"row"],[1,"col-6"],[2,"font-size","1rem","padding-top","8px"],["mat-icon-button","",2,"float","right","padding-top","8px",3,"disableRipple","click"],["aria-label","clear-icon",1,"lms-clear-icon"],[1,"col-12"],["appearance","outline",1,"search-patient-form-field"],["matInput","","placeholder","Patient Name","formControlName","entityBusinessName","minLength","1","maxLength","100","id","search-patient-1",3,"pattern"],[4,"ngIf"],[1,"divider"],["matInput","","placeholder","Contact Number*","id","search-patient-2","formControlName","entityMobileNumber","minLength","10","maxLength","10",3,"pattern"],["matInput","","placeholder","Registration No.","id","search-patient-3","formControlName","entityRegistrationNo"],[1,"col-12",2,"display","flex","flex-direction","row","justify-content","space-around"],["mat-raised-button","","color","primary",1,"primary-action-btn",2,"width","35%",3,"click"],["mat-raised-button","","color","warn",1,"warn-action-btn",2,"width","35%",3,"click"],[1,"container"],[1,"row",2,"margin-top","20px","margin-bottom","100px"],["class","col-12",3,"hidden",4,"ngFor","ngForOf"],["style","background-color: white",4,"ngIf"],[1,"col-12",3,"hidden"],[1,"patient-card","mat-elevation-z8",3,"click"],["mat-card-avatar","",1,"patient-card-avatar"],[2,"background-color","white"],["src","assets/images/noitemfound.png",1,"no-patient-found"]],template:function(i,t){1&i&&(e.TgZ(0,"form",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),e._uU(5,"Search Patient"),e.qZA()(),e.TgZ(6,"div",3)(7,"button",5),e.NdJ("click",function(){return t.closeSearchPatientBlock()}),e._UZ(8,"div",6),e.qZA()()(),e.TgZ(9,"div",2)(10,"div",7)(11,"mat-form-field",8)(12,"mat-label"),e._uU(13,"Patient Name"),e.qZA(),e._UZ(14,"input",9),e.YNc(15,St,2,0,"mat-error",10),e.qZA()(),e.TgZ(16,"div",7)(17,"div",11),e._uU(18,"OR"),e.qZA()(),e.TgZ(19,"div",7)(20,"mat-form-field",8)(21,"mat-label"),e._uU(22,"Mobile Number"),e.qZA(),e._UZ(23,"input",12),e.YNc(24,Pt,2,0,"mat-error",10),e.qZA()(),e.TgZ(25,"div",7)(26,"div",11),e._uU(27,"OR"),e.qZA()(),e.TgZ(28,"div",7)(29,"mat-form-field",8)(30,"mat-label"),e._uU(31,"Registration No."),e.qZA(),e._UZ(32,"input",13),e.qZA()()(),e.TgZ(33,"div",2)(34,"div",14)(35,"button",15),e.NdJ("click",function(){return t.searchPatientByParameter(t.searchPatientForm.value)}),e._uU(36," Search "),e.qZA(),e.TgZ(37,"button",16),e.NdJ("click",function(){return t.searchPatientForm.reset(),t.searchedPatientList=[]}),e._uU(38," Reset "),e.qZA()()()()(),e.TgZ(39,"div",17)(40,"div",18),e.YNc(41,Bt,10,6,"div",19),e.YNc(42,_t,2,0,"div",20),e.qZA()()),2&i&&(e.Q6J("formGroup",t.searchPatientForm),e.xp6(7),e.Q6J("disableRipple",!0),e.xp6(7),e.Q6J("pattern","[^]*"),e.xp6(1),e.Q6J("ngIf",null==t.searchPatientForm.controls.entityBusinessName||null==t.searchPatientForm.controls.entityBusinessName.errors?null:t.searchPatientForm.controls.entityBusinessName.errors.pattern),e.xp6(8),e.Q6J("pattern","[6-9]{1}[0-9]{9}"),e.xp6(1),e.Q6J("ngIf",null==t.searchPatientForm.controls.entityMobileNumber||null==t.searchPatientForm.controls.entityMobileNumber.errors?null:t.searchPatientForm.controls.entityMobileNumber.errors.pattern),e.xp6(17),e.Q6J("ngForOf",t.searchedPatientList),e.xp6(1),e.Q6J("ngIf",0===(null==t.searchedPatientList?null:t.searchedPatientList.length)))},dependencies:[y.sg,y.O5,u._Y,u.Fj,u.JJ,u.JL,u.c5,u.sg,u.u,C.lW,C.RK,v.a8,v.kc,v.dk,v.$j,v.n5,M.Nt,b.KE,b.hX,b.TO,y.gd],styles:['.search-patient-form-field[_ngcontent-%COMP%]{width:100%!important}.divider[_ngcontent-%COMP%]{display:flex;align-items:center;text-align:center}.divider[_ngcontent-%COMP%]:before, .divider[_ngcontent-%COMP%]:after{content:"";flex:1;border-bottom:4px solid #000}.divider[_ngcontent-%COMP%]:not(:empty):before{margin-right:.25em}.divider[_ngcontent-%COMP%]:not(:empty):after{margin-left:.25em}.no-patient-found[_ngcontent-%COMP%]{display:block;margin-left:auto;margin-right:auto;width:50%}.patient-card[_ngcontent-%COMP%]{max-height:100px;height:auto;margin-bottom:10px;cursor:pointer}.patient-card-avatar[_ngcontent-%COMP%]{background-size:cover;background-color:#f5f5f5;text-align:center;line-height:42px}']}),d})();function Tt(r,d){if(1&r){const s=e.EpF();e.TgZ(0,"div")(1,"app-create-patient",30),e.NdJ("createPatientEvent",function(t){e.CHM(s),e.oxw();const n=e.MAs(39),a=e.oxw();return e.KtG(a.onClickEventInCreatePatientForm(t,n))}),e.qZA()()}}function It(r,d){if(1&r){const s=e.EpF();e.TgZ(0,"div")(1,"app-search-patient",31),e.NdJ("searchPatientEvent",function(t){e.CHM(s),e.oxw();const n=e.MAs(39),a=e.oxw();return e.KtG(a.onClickEventInSearchPatientForm(t,n))}),e.qZA()()}}function Zt(r,d){if(1&r){const s=e.EpF();e.TgZ(0,"div",32)(1,"app-bill-form",33),e.NdJ("createPatientEvent",function(t){e.CHM(s),e.oxw();const n=e.MAs(39),a=e.oxw();return n.toggle(),e.KtG(a.openFormInsideSidenav(t))})("billCreationEvent",function(t){e.CHM(s);const n=e.oxw(2);return e.KtG(n.closeBillForm(t))}),e.qZA()()}if(2&r){const s=e.oxw(2);e.xp6(1),e.Q6J("newPatientDetail",s.searchedPatientDetails)}}function Nt(r,d){if(1&r){const s=e.EpF();e.TgZ(0,"div",1)(1,"div",2)(2,"div",3),e._UZ(3,"app-breadcrumb",4),e.qZA(),e.TgZ(4,"div",5)(5,"mat-form-field",6)(6,"mat-label"),e._uU(7,"Start Date"),e.qZA(),e.TgZ(8,"input",7),e.NdJ("ngModelChange",function(t){e.CHM(s);const n=e.oxw();return e.KtG(n.selectedStartDate=t)})("click",function(){e.CHM(s);const t=e.MAs(12);return e.KtG(t.open())}),e.qZA(),e.TgZ(9,"mat-datepicker-toggle",8),e._UZ(10,"div",9),e.qZA(),e._UZ(11,"mat-datepicker",null,10),e.qZA()(),e.TgZ(13,"div",5)(14,"mat-form-field",6)(15,"mat-label"),e._uU(16,"End Date"),e.qZA(),e.TgZ(17,"input",11),e.NdJ("ngModelChange",function(t){e.CHM(s);const n=e.oxw();return e.KtG(n.selectedEndDate=t)})("click",function(){e.CHM(s);const t=e.MAs(21);return e.KtG(t.open())}),e.qZA(),e.TgZ(18,"mat-datepicker-toggle",12),e._UZ(19,"div",9),e.qZA(),e._UZ(20,"mat-datepicker",null,13),e.qZA()(),e.TgZ(22,"div",14)(23,"button",15),e.NdJ("click",function(){e.CHM(s);const t=e.oxw();return e.KtG(t.resetDateFilter())}),e._uU(24," Reset "),e.qZA(),e.TgZ(25,"button",16),e.NdJ("click",function(){e.CHM(s);const t=e.oxw();return e.KtG(t.searchBillForSelectedDate())}),e._uU(26," Search "),e.qZA()()(),e.TgZ(27,"div",2)(28,"mat-card",17)(29,"mat-card-title-group",18)(30,"button",19),e.NdJ("click",function(){e.CHM(s);const t=e.oxw();return e.KtG(t.exportData("xlsx"))}),e._UZ(31,"div",20),e.qZA(),e.TgZ(32,"button",19),e.NdJ("click",function(){e.CHM(s);const t=e.oxw();return e.KtG(t.exportData("csv"))}),e._UZ(33,"div",21),e.qZA(),e._UZ(34,"span",22),e.qZA(),e._UZ(35,"mat-card-content"),e.qZA()(),e.TgZ(36,"div",23)(37,"mat-sidenav-container",24)(38,"mat-sidenav",25,26),e.YNc(40,Tt,2,0,"div",27),e.YNc(41,It,2,0,"div",27),e.qZA(),e.TgZ(42,"mat-sidenav-content")(43,"a",28),e.NdJ("click",function(){e.CHM(s);const t=e.oxw();return e.KtG(t.closeNav())}),e._uU(44,"\xd7"),e.qZA(),e.YNc(45,Zt,2,1,"div",29),e.qZA()()()()}if(2&r){const s=e.MAs(12),i=e.MAs(21),t=e.oxw();e.xp6(8),e.Q6J("matDatepicker",s)("ngModel",t.selectedStartDate)("max",t.currentDate),e.xp6(1),e.Q6J("for",s),e.xp6(8),e.Q6J("matDatepicker",i)("ngModel",t.selectedEndDate)("max",t.currentDate)("min",t.selectedStartDate),e.xp6(1),e.Q6J("for",i),e.xp6(12),e.Q6J("disableRipple",!0),e.xp6(2),e.Q6J("disableRipple",!0),e.xp6(8),e.Q6J("ngIf","addPatient"===t.sidebarFormPanel),e.xp6(1),e.Q6J("ngIf","searchPatient"===t.sidebarFormPanel),e.xp6(4),e.Q6J("ngIf",t.showBillForm)}}function kt(r,d){1&r&&(e.TgZ(0,"div",1),e._UZ(1,"app-access-denied",34),e.qZA())}let Lt=(()=>{var r;class d{constructor(i,t,n,a,l,c,o,p,g,f){this.loader=i,this.toastrService=t,this.masterService=n,this.exportService=a,this.authService=l,this.dialog=c,this.dialogRef=o,this.commonService=p,this.numberToWordService=g,this.winRef=f,this.billList$=new P.X([]),this.inlineEditFlag=!1,this.showLogCheckedFlag=!1,this.gridOptions=new H.s8,this.changeDetection=new j.x,this.destroySubscription$=new Z.t(1),this.currentDate=new Date,this.selectedStartDate=new Date,this.selectedEndDate=new Date,this.showBillForm=!1,this.sidebarFormPanel="",this.searchedPatientDetails={section:"",values:null},this.clientX=0,this.clientY=0,this.updateDialogTopPosition="0px",this.updateDialogLeftPosition="0px",this.canViewRecord=!0}ngOnInit(){this.initializeBillList()}initializeBillList(){this.getPageAccessDetail().then(i=>{this.pageAccessDetail=i,this.gridOptions.showAddButton=1==this.pageAccessDetail?.data?.entityIsInsert,this.canViewRecord=1==this.pageAccessDetail?.data?.entityIsBillView,this.canViewRecord?this.setBillList(!1):this.loader.hideSpinner()}).catch(i=>{this.toastrService.show({type:"error",text:i})}),this.gridOptions={searchPlaceholder:"Search Bill",pageSize:this.authService.pageSize,dateFormat:"yyyy-MM-dd",keyCodeForNextCell:13,showInlineEdit:this.inlineEditFlag,titleForMobileView:"entityPatientName",pageSizeArray:[5,10,20],showDeleteButton:!1,showAddButton:!1,showEditButton:!1,showActivateDeactivateButton:!1,showSearchInput:!0,activateDeactivateCondition:{conditionalProperty:"activeFlag",valueForActivation:"1",valueForDeactivation:"0"},columns:[{name:"entityBusinessShortCode",label:"Bill Receipt No.",enable:!0,searchable:!0,sortable:!0,type:"text",editable:!1,footerValue:0,isRequired:!1},{name:"entityPatientID",label:"Patient ID",enable:!0,searchable:!1,sortable:!0,type:"text",editable:!1,isRequired:!1},{name:"entityPatientName",label:"Patient Name",enable:!0,searchable:!0,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"entityPatientAge",label:"Age",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"entityPatientGender",label:"Gender",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"effectiveDateFrom",label:"Date",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"entityTotalBillAmount",label:"Bill Amount",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1,footerValue:0},{name:"entityTotalDiscountAmount",label:"Discount",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1,footerValue:0},{name:"entityTotalPayableAmount",label:"Payable Amount",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1,footerValue:0},{name:"entityTotalDuesAmount",label:"Dues Amount",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1,footerValue:0},{name:"entityTotalReceiveAmount",label:"Received Amount",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1,footerValue:0},{name:"refferalFromName",label:"Referral Doctor",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"paymentType",label:"Payment Type",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"refundStatus",label:"Refund Status",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"paymentStatus",label:"Payment Status",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"activeFlag",label:"",enable:!1,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"entityID",label:"",enable:!1,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"entityBusinessID",label:"",enable:!1,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1}]}}setBillList(i){this.getBillList(i).then(t=>{this.setFooterValue(t),this.billList$.next(t)}).catch(t=>{this.billList$.next([]),this.toastrService.show({type:"error",text:t})})}setFooterValue(i){this.gridOptions.columns.find(o=>"entityBusinessShortCode"==o.name).footerValue=i.length||0;const t=i.reduce((o,p)=>o+p.entityTotalBillAmount,0),n=i.reduce((o,p)=>o+p.entityTotalDiscountAmount,0),a=i.reduce((o,p)=>o+p.entityTotalPayableAmount,0),l=i.reduce((o,p)=>o+p.entityTotalDuesAmount,0),c=i.reduce((o,p)=>o+p.entityTotalReceiveAmount,0);this.gridOptions.columns.find(o=>"entityTotalBillAmount"==o.name).footerValue=t||0,this.gridOptions.columns.find(o=>"entityTotalDiscountAmount"==o.name).footerValue=n||0,this.gridOptions.columns.find(o=>"entityTotalPayableAmount"==o.name).footerValue=a||0,this.gridOptions.columns.find(o=>"entityTotalDuesAmount"==o.name).footerValue=l||0,this.gridOptions.columns.find(o=>"entityTotalReceiveAmount"==o.name).footerValue=c||0}ngOnDestroy(){this.destroySubscription$.next(null),this.destroySubscription$.complete()}resetDateFilter(){this.selectedStartDate=new Date,this.selectedEndDate=new Date,this.setBillList(this.showLogCheckedFlag)}searchBillForSelectedDate(){const i=new Date(this.selectedStartDate),t=new Date(this.selectedEndDate),n=Math.abs(t-i),a=Math.floor(n/864e5),l=this.authService.dateRangeLimit;a>l?this.toastrService.show({type:"error",text:`Date range should be in between of ${l} days.`}):this.setBillList(this.showLogCheckedFlag)}assignPermissionForBillList(i){var t=this;return(0,w.Z)(function*(){const n=t.pageAccessDetail?.currentDate||new Date;let a=t.pageAccessDetail?.data?.entityDays||1,l=1==t.pageAccessDetail?.data?.entityIsDelete,c=1==t.pageAccessDetail?.data?.entityIsUpdate,o=new Date(n).setDate(new Date(n).getDate()-a),p=new Date(o).toISOString().substring(0,10),g=(new Date).toISOString().slice(0,10);return i=yield i.map(f=>{let A=t.commonService.parseDate(f?.effectiveDateFrom),x=null===f.entityBusinessName?["",g,""]:f.entityBusinessName.split(","),B=x[0],_=t.commonService.findValuesOfYearMonthAndDays(x[1],n),q=x[2];return{...f,entityPatientName:B,entityPatientAge:0==_.years?_.months+" M , "+_.days+" D":_.years+" Y",entityPatientGender:q,paymentStatus:1==f.paymentStatus?"Cleared":"Not cleared",refundStatus:1==f.refundStatus?"Refunded":"Not refunded",createdAtInMilliseconds:Date.parse(A),showEditButton:!!(c&&Date.parse(A.substring(0,10))>=Date.parse(p)),showActiveFlagButton:!!(l&&Date.parse(A.substring(0,10))>=Date.parse(p))}}).sort((f,A)=>f.createdAtInMilliseconds>A.createdAtInMilliseconds?-1:0)})()}getBillList(i){var t=this;return new Promise((n,a)=>{this.loader.showSpinner("Bill list on the way!");const l={genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W",detailFlag:i,dropDown:!1,fromDate:this.commonService.parseDate(this.selectedStartDate,"yyyy-MM-dd"),toDate:this.commonService.parseDate(this.selectedEndDate,"yyyy-MM-dd")}};this.masterService.requestApiForGeneralMaster(l,"billservice/getAllBillReferenceEntity").pipe((0,h.R)(this.destroySubscription$)).subscribe(function(){var c=(0,w.Z)(function*(o){t.loader.hideSpinner(),"200"===o.statusCode||"300"===o.statusCode?(o.responseList=i?0==o.responseList[0].length?[]:o.responseList[0]:0==o.responseList[0].length?[]:yield t.assignPermissionForBillList(o.responseList[0]),n(o.responseList)):a(o.errorMessage)});return function(o){return c.apply(this,arguments)}}(),c=>{this.loader.hideSpinner(),a("Either Internet is not working or facing internal server issue")})})}getPageAccessDetail(){return new Promise((i,t)=>{this.loader.showSpinner("Loading..."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,roleID:this.authService.employeeID,entityBusinessID:1,mode:"W"}},"pageaccessservice/getAllEntity").pipe((0,h.R)(this.destroySubscription$)).subscribe(a=>{"200"===a.statusCode||"300"===a.statusCode?(a.responseList=null==a?.responseList?null:a?.responseList[0]?.pageList.find(l=>1===l.pageID)||null,i({data:a.responseList,currentDate:a?.date})):(this.loader.hideSpinner(),t(a.errorMessage))},a=>{this.loader.hideSpinner(),t("Either Internet is not working or facing internal server issue")})})}printBillReport(i){var t=this;return new Promise((n,a)=>{this.loader.showSpinner("Printing report..."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W",entityBillID:i}},"billservice/printBillRecipt").pipe((0,h.R)(this.destroySubscription$)).subscribe(function(){var c=(0,w.Z)(function*(o){"200"===o.statusCode?n(Object.assign({printDate:o.date},o.responseList[0])):(t.loader.hideSpinner(),a(o.errorMessage))});return function(o){return c.apply(this,arguments)}}(),c=>{this.loader.hideSpinner(),a("Either Internet is not working or facing internal server issue")})})}generateBarCode(i){var t=this;return new Promise((n,a)=>{this.loader.showSpinner("Printing report..."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W",entityBusinessName:i}},"adminservice/getBarCode").pipe((0,h.R)(this.destroySubscription$)).subscribe(function(){var c=(0,w.Z)(function*(o){t.loader.hideSpinner(),"200"===o.statusCode?n(Object.assign({printDate:o.date},o.responseList[0])):a(o.errorMessage)});return function(o){return c.apply(this,arguments)}}(),c=>{this.loader.hideSpinner(),a("Either Internet is not working or facing internal server issue")})})}exportData(i){const t=[{property:"entityBusinessShortCode",label:"Bill Receipt No."},{property:"entityPatientID",label:"Patient ID"},{property:"entityPatientName",label:"Patient Name"},{property:"entityPatientAge",label:"Age"},{property:"entityPatientGender",label:"Gender"},{property:"effectiveDateFrom",label:"Date"},{property:"entityTotalBillAmount",label:"Bill Amount"},{property:"entityTotalDiscountAmount",label:"Discount"},{property:"entityTotalPayableAmount",label:"Payable Amount"},{property:"entityTotalDuesAmount",label:"Dues Amount"},{property:"entityTotalReceiveAmount",label:"Received Amount"},{property:"refferalFromName",label:"Referral Doctor"},{property:"paymentType",label:"Payment Type"},{property:"refundStatus",label:"Refund Status"},{property:"paymentStatus",label:"Payment Status"}];this.showLogCheckedFlag&&t.push({property:"auditAction",label:"Audit Action"}),this.exportService.generateFile(this.billList$.getValue(),"Bill List."+i,t)}showLog(i){this.billList$.next([]),this.showLogCheckedFlag=i,i?this.getBillList(!0).then(t=>{this.billList$.next(t),this.gridOptions.showAddButton=!1,this.gridOptions.showEditButton=!1,this.gridOptions.showActivateDeactivateButton=!1,this.gridOptions.columns.push({name:"auditAction",label:"Audit Action",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1})}).catch(t=>{this.billList$.next([]),this.toastrService.show({type:"error",text:t})}):this.initializeBillList()}initiateAddBill(i){document.getElementById("mySidenav").style.width="100%",this.showBillForm=!0}closeNav(){document.getElementById("mySidenav").style.width="0",this.showBillForm=!1}closeBillForm(i){var t=this;return(0,w.Z)(function*(){if(null!==i){let n=t.billList$.getValue();n.push(i),n=n.map(a=>({...a,paymentStatus:"Cleared"===a.paymentStatus?1:"Not cleared"===a.paymentStatus?0:a.paymentStatus})),n=yield t.assignPermissionForBillList(n),t.billList$.next(n),t.setFooterValue(n)}t.closeNav()})()}openFormInsideSidenav(i){this.sidebarFormPanel=i}onClickEventInSearchPatientForm(i,t){null!==i&&(this.searchedPatientDetails=i,i.entityBusinessName=`${i?.entityBusinessShortCode} - ${i?.entityBusinessName} (${i?.entityMobileNumber})`,this.searchedPatientDetails={section:"searchPatient",values:i}),t.toggle()}onClickEventInCreatePatientForm(i,t){null!==i&&(i.entityBusinessName=`${i?.entityBusinessShortCode} - ${i?.entityBusinessName} (${i?.entityMobileNumber})`,this.searchedPatientDetails={section:"addPatient",values:i}),t.toggle()}initiateEditBill(i){var t=this;const n=new J.vA;n.disableClose=!0,n.autoFocus=!0,n.width="400px",n.data=i,this.dialogRef.open(Pe,n).afterClosed().subscribe(function(){var l=(0,w.Z)(function*(c){if(void 0!==c){let o=t.billList$.getValue();const p=o.findIndex(g=>g.entityBusinessID===c.entityBusinessID);o[p]=c,o=yield t.assignPermissionForBillList(o),t.billList$.next(o),t.setFooterValue(o)}});return function(c){return l.apply(this,arguments)}}())}deleteBill(i){var t=this;F().fire({title:"Enter valid reason!",input:"text",inputAttributes:{autocapitalize:"off"},inputPlaceholder:"Reason*",inputValidator:n=>n?"":"Reason is mandatory field!",showCancelButton:!0,confirmButtonText:"Cancel Bill",showLoaderOnConfirm:!0,backdrop:!1,preConfirm:n=>this.masterService.requestApiForGeneralMaster({billEntity:{auditAction:"D",companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W",entityBusinessID:i.entityBusinessID,remarks:n}},"billservice/deactivateEntity").pipe((0,h.R)(this.destroySubscription$)).subscribe(l=>{if("200"===l.statusCode)return l;F().showValidationMessage(`Request failed: ${l.errorMessage}`)},l=>{F().showValidationMessage("Request failed: Either Internet is not working or facing internal server issue")})}).then(function(){var n=(0,w.Z)(function*(a){if(a.isConfirmed){let l=t.billList$.getValue();l=l.filter(c=>c.entityBusinessID!==i.entityBusinessID),l=yield t.assignPermissionForBillList(l),t.billList$.next(l),t.setFooterValue(l)}});return function(a){return n.apply(this,arguments)}}())}printReport(i){const t=i.entityBusinessID,n=i.entityPatientID,a=this.pageAccessDetail?.currentDate||new Date;this.printBillReport(t).then(l=>{this.generateBarCode(n).then(c=>{const o="data:image/jpg;base64,"+c.entityBusinessName,p=this.commonService.parseDate(c.printDate,"dd-MM-yyyy"),g=this.authService.employeeName,f=l.billServiceDetailEntities,A=this.numberToWordService.transform(l.entityTotalReceiveAmount),x=this.commonService.convertFirstLetterInUpperCase(A),B=f.reduce(function(T,z){return T+Number(z.entityFinalAmount)},0).toFixed(2);let _=[],q=[],U=[],G=[],I=this.commonService.findValuesOfYearMonthAndDays(l.dob,a);const X=0==I.years?I.months+" M , "+I.days+" D":I.years+" Y";f.forEach((T,z)=>{_.push(z+1+"\n"),U.push(T.entityrate+"\n"),q.push(T.entityFinalAmount+"\n"),G.push(T.entityBusinessName+"\n")});let E="";null!=l.companyLogo&&""!=l.companyLogo&&null!=l.companyLogo&&(E="data:image/jpg;base64,"+l.companyLogo),this.winRef.nativeWindow.pdfMake.createPdf({info:{title:l.patitentName+"\tBill Receipt",author:l.companyName,subject:"",keywords:""},pageMargins:[10,10,10,10],content:[{widths:[500],table:{body:[[[{image:E,width:480,height:70,margin:[2,2,2,2],alignment:"center",border:[!1,!1,!1,!1]}]],[[{text:"RECEIPT",alignment:"center",fontSize:"12",bold:!0,margin:[0,0,0,0],border:[!1,!1,!1,!1]}]],[{table:{widths:[340,205],body:[["Patient Details","Receipt Details"],[{style:"tableExample",table:{widths:[80,190],border:[!1,!1,!1,!1],body:[[{text:"UHID/Name\t   :",border:[!1,!1,!1,!1],fontSize:"10",alignment:"left",bold:!1,margin:[0,0,0,0]},{text:i.entityPatientID+"/"+l.patitentName,border:[!1,!1,!1,!1],fontSize:"10",alignment:"left",bold:!0,margin:[0,0,0,0]}],[{text:"Age/Sex \t\t\t:",border:[!1,!1,!1,!1],fontSize:"10",alignment:"left",bold:!1,margin:[0,0,0,0]},{text:X+" / "+l.gender,border:[!1,!1,!1,!1],fontSize:"10",alignment:"left",bold:!0,margin:[0,0,0,0]}],[{text:"Referred By\t   :",border:[!1,!1,!1,!1],fontSize:"10",alignment:"left",bold:!1,margin:[0,0,0,0]},{text:l.refferalFromName,border:[!1,!1,!1,!1],fontSize:"10",alignment:"left",bold:!0,margin:[0,0,0,0]}],[{text:"Address :",border:[!0,!0,!0,!0],fontSize:"10",alignment:"left",bold:!1,margin:[0,0,0,0]},{text:l.remarks,border:[!0,!0,!0,!0],fontSize:"10",alignment:"left",bold:!0,margin:[0,0,0,0]}]]},layout:"noBorders"},{style:"tableExample",table:{widths:[90,135],body:[[{text:"Receipt No.\t  :",border:[!1,!1,!1,!1],fontSize:"10",alignment:"left",bold:!1,margin:[0,0,0,0]},{text:l.entityBillDisplayID,border:[!1,!1,!1,!1],fontSize:"10",alignment:"left",bold:!0,margin:[0,0,0,0]}],[{text:"Receipt Date\t:",border:[!1,!1,!1,!1],fontSize:"10",alignment:"left",bold:!1,margin:[0,0,0,0]},{text:l.effectiveDateFrom,border:[!1,!1,!1,!1],fontSize:"10",alignment:"left",bold:!0,margin:[0,0,0,0]}],[{image:o,width:70,height:20,margin:[-40,0,0,0],alignment:"right",border:[!1,!1,!1,!1]},{text:"",border:[!1,!1,!1,!1],fontSize:"10",alignment:"left",bold:!0,margin:[0,0,0,0]}],[{text:"*"+i.entityPatientID+"*",border:[!1,!1,!1,!1],fontSize:"10",alignment:"right",bold:!0,margin:[20,0,0,0]},{text:"",border:[!1,!1,!1,!1],fontSize:"10",alignment:"left",bold:!0,margin:[0,0,0,0]}]]},layout:"noBorders"}]]}}],[{style:"tableExample",table:{widths:[392,60,75],border:[!1,!1,!1,!1],body:[["Particulars","Rate (Rs.)","Amount (Rs.)"],[{stack:[{text:G,border:[!1,!1,!1,!1],fontSize:"10.5",alignment:"left",bold:!1,margin:[0,0,0,5]}]},{stack:[{text:U,border:[!1,!1,!1,!1],fontSize:"10.5",alignment:"right",bold:!0,margin:[0,0,0,5]}]},{stack:[{text:q,border:[!1,!1,!1,!1],fontSize:"10.5",alignment:"right",bold:!0,margin:[0,0,0,5]}]}],[{text:"Discount",border:[!0,!0,!1,!0],fontSize:"10.5",alignment:"left",bold:!0,margin:[0,0,0,0]},{text:"",border:[!1,!1,!1,!0],fontSize:"10.5",alignment:"right",bold:!0,margin:[0,0,0,0]},{text:+l.entityTotalDiscountAmount,fontSize:"10.5",border:[!0,!1,!0,!0],bold:!0,alignment:"right",margin:[0,0,0,0]}],[{text:"Total",border:[!0,!0,!1,!1],fontSize:"10.5",bold:!0,margin:[0,0,0,0],alignment:"left"},{text:+l.entityTotalBillAmount,fontSize:"10.5",border:[!1,!0,!0,!0],alignment:"right",margin:[0,0,0,0]},{text:B,fontSize:"10.5",border:[!0,!0,!0,!0],alignment:"right",margin:[0,0,0,0]}],[{text:"Dues",border:[!0,!0,!1,!0],fontSize:"10.5",alignment:"left",bold:!0,margin:[0,0,0,0]},{text:"",border:[!1,!1,!1,!0],fontSize:"10.5",alignment:"center",bold:!1,margin:[0,0,0,0]},{text:+l.entityTotalDuesAmount,fontSize:"10.5",border:[!0,!1,!0,!0],bold:!0,alignment:"right",margin:[0,0,0,0]}],[{text:"Paid Amount",border:[!0,!0,!1,!0],fontSize:"10.5",alignment:"left",bold:!0,margin:[0,0,0,0]},{text:"By "+i.paymentType,border:[!1,!1,!1,!0],fontSize:"10.5",alignment:"left",bold:!0,margin:[0,0,0,0]},{text:+l.entityTotalReceiveAmount,fontSize:"10.5",bold:!0,border:[!0,!1,!0,!0],alignment:"right",margin:[0,0,0,0]}]]}}],[[{text:"Amount in Word:\t"+x,bold:!0,fontSize:"11",alignment:"left",lineHeight:"1",margin:[0,0,0,0]}]],[[{text:"Prepared By:\t"+l.createdByUser+"\t\t\t\tPrinted By:\t"+g+"\t\t\t\tPrinted Date:"+p+"\t\t\t\tChecked By:\t\t\t\tCashier By:",bold:!0,fontSize:"9",alignment:"left",lineHeight:"1",margin:[0,0,0,0]}]],[[{image:"data:image/jpeg;base64,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",width:300,height:10,margin:[1,1,1,1],alignment:"left",border:[!1,!1,!1,!1]},{text:"Powered By iCare Infosystems",bold:!0,fontSize:"9",alignment:"right",color:"red"}]]]}}],styles:{header:{fontSize:20,bold:!0,margin:[0,0,0,0],alignment:"center",decoration:"underline",color:"black"},commitment:{fontSize:12,bold:!1,margin:[0,0,0,12],alignment:"center"},subheader:{fontSize:12,bold:!0,margin:[40,0,0,4],alignment:"center"},tableExample:{margin:[0,0,0,0],alignment:"center",bold:!0},tableHeader:{bold:!0,fontSize:13,color:"black",alignment:"center"},patientdetails:{bold:!1,fontsize:8,color:"black",alignment:"left"},imageStyle:{alignment:"left",margin:[0,-50,0,0]}}}).open()}).catch(c=>{this.toastrService.show({type:"error",text:c})})}).catch(l=>{this.toastrService.show({type:"error",text:l})})}}return(r=d).\u0275fac=function(i){return new(i||r)(e.Y36(L.D),e.Y36(k.k),e.Y36(R.c),e.Y36(W.u),e.Y36(N.$),e.Y36(ue.Y),e.Y36(J.uw),e.Y36(O.v),e.Y36(ee.t),e.Y36(K.f))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-bill"]],decls:3,vars:2,consts:[["class","container-fluid",4,"ngIf"],[1,"container-fluid"],[1,"row"],[1,"col-lg-5","col-md-5","col-sm-12"],["childLink","Billing","subchildLink","Bill"],[1,"col-lg-2","col-md-2","col-sm-12","bill-search-parameter"],["appearance","outline",2,"width","100%"],["matInput","","placeholder","Start Date","id","start-date-block",3,"matDatepicker","ngModel","max","ngModelChange","click"],["matSuffix","","readonly","",3,"for"],["aria-label","calendar-icon","matDatepickerToggleIcon","",1,"lms-calendar-icon"],["startDatePicker",""],["matInput","","placeholder","End Date","id","end-date-block","readonly","",3,"matDatepicker","ngModel","max","min","ngModelChange","click"],["matSuffix","",3,"for"],["endDatePicker",""],[1,"col-lg-3","col-md-3","col-sm-12","bill-search-parameter"],["mat-raised-button","","color","warn",1,"warn-action-btn",3,"click"],["mat-raised-button","","color","primary",1,"primary-action-btn",3,"click"],[1,"mat-elevation-z12","lms-master-card"],[1,"lms-matcardtitlegroup"],["mat-icon-button","",3,"disableRipple","click"],["aria-label","excel",1,"lms-excel-icon"],["aria-label","csv",1,"lms-csv-icon"],[1,"remaining-space"],["id","mySidenav",1,"sidenav"],[1,"example-container"],["mode","over","position","end","disableClose","true",1,"lms-mat-sidenav"],["sidenav",""],[4,"ngIf"],[1,"closebtn",3,"click"],["style","margin-top: 42px",4,"ngIf"],[3,"createPatientEvent"],[3,"searchPatientEvent"],[2,"margin-top","42px"],[3,"newPatientDetail","createPatientEvent","billCreationEvent"],["childLinkLabel","Billing","subchildLinkLabel","Bill"]],template:function(i,t){1&i&&(e._UZ(0,"app-header"),e.YNc(1,Nt,46,14,"div",0),e.YNc(2,kt,2,0,"div",0)),2&i&&(e.xp6(1),e.Q6J("ngIf",t.canViewRecord),e.xp6(1),e.Q6J("ngIf",!t.canViewRecord))},dependencies:[y.O5,Q.G,u.Fj,u.JJ,u.On,C.lW,C.RK,v.a8,v.dn,v.C1,S.Mq,S.hl,S.nW,S.Q0,M.Nt,b.KE,b.hX,b.R9,ae.JX,ae.TM,ae.Rh,Y.L,te.A,ht,xt,Ft],styles:[".search-patient-container[_ngcontent-%COMP%]{display:flow-root;margin-top:-10px;margin-left:10px;margin-right:30px}.bill-search-parameter[_ngcontent-%COMP%]{margin-top:11px}.warn-action-btn[_ngcontent-%COMP%]{float:right;margin-top:5px}.primary-action-btn[_ngcontent-%COMP%]{float:right;margin-right:10px;margin-top:5px}.sidenav[_ngcontent-%COMP%]{height:100%;width:0;position:fixed;z-index:1;top:64px;left:0;background-color:#e3e3e3;overflow-x:hidden;transition:1s;padding-top:60px;text-align:center}@media (max-width: 766px){.sidenav[_ngcontent-%COMP%]{position:absolute}}.sidenav[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{padding:8px 8px 8px 32px;text-decoration:none;font-size:25px;color:#818181;display:block;transition:.3s}.sidenav[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#cfc8c8}.sidenav[_ngcontent-%COMP%]   .closebtn[_ngcontent-%COMP%]{position:absolute;top:0;right:25px;font-size:36px;cursor:pointer;margin-left:50px}@media screen and (max-height: 450px){.sidenav[_ngcontent-%COMP%]{padding-top:15px}.sidenav[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{font-size:18px}}.example-container[_ngcontent-%COMP%]{position:absolute;inset:0}.lms-mat-sidenav[_ngcontent-%COMP%]{width:25%}@media (max-width: 900px){.lms-mat-sidenav[_ngcontent-%COMP%]{width:100%}}.lms-bill-table[_ngcontent-%COMP%]{overflow:auto;height:500px}"]}),d})();function Rt(r,d){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Remarks for discount is required! "),e.qZA())}function qt(r,d){if(1&r){const s=e.EpF();e.TgZ(0,"button",23),e.NdJ("click",function(){e.CHM(s);const t=e.oxw();return e.KtG(t.updatePendingDues(t.clearDuesFormGroup.value))}),e._uU(1),e.qZA()}if(2&r){const s=e.oxw();e.Q6J("disabled",s.clearDuesFormGroup.invalid),e.xp6(1),e.hij(" ","Clear Dues"," ")}}let pe=(()=>{var r;class d{constructor(i,t,n,a,l){this.loader=i,this.fb=t,this.toastrService=n,this.authService=a,this.masterService=l,this.billDetail={},this.closePanelEvent=new e.vpe,this.destroySubscription$=new Z.t(1)}ngOnInit(){this.clearDuesFormGroup=this.fb.group({totalDiscountAmount:new u.NI(null),leftDuesAmount:new u.NI(null),isSelfDiscount:new u.NI(1),discountRemarks:new u.NI(null)})}ngOnChanges(){this.billDetail.isDuesCleared?(this.billDetail.entityTotalDuesAmount=this.billDetail.totalDuesAmount,this.clearDuesFormGroup&&(this.clearDuesFormGroup.controls.totalDiscountAmount.setValue(this.billDetail.totalDiscountAmount),this.clearDuesFormGroup.controls.leftDuesAmount.setValue(this.billDetail.entityTotalDuesAmount-this.billDetail.totalDiscountAmount),this.clearDuesFormGroup.controls.isSelfDiscount.setValue(this.billDetail.isSelfDiscount),this.clearDuesFormGroup.controls.discountRemarks.setValue(this.billDetail.discountRemarks))):this.clearDuesFormGroup&&this.clearDuesFormGroup.controls.leftDuesAmount.setValue(this.billDetail.entityTotalDuesAmount)}ngOnDestroy(){this.destroySubscription$.next(null),this.destroySubscription$.complete()}get discount(){return this.clearDuesFormGroup.controls.totalDiscountAmount}closeClearDuesBlock(){this.closePanelEvent.emit(!1)}checkForSelfDiscount(i){this.clearDuesFormGroup.controls.isSelfDiscount.setValue(i?1:0)}onChangeOfDiscountValue(i){(i=parseInt(i))>0?(i>Number(this.billDetail.entityTotalDuesAmount)?(this.toastrService.show({type:"error",text:"Discount amount should not greater than dues amount!"}),this.clearDuesFormGroup.controls.leftDuesAmount.setValue(this.billDetail.entityTotalDuesAmount),setTimeout(()=>{this.clearDuesFormGroup.controls.totalDiscountAmount.setValue(null),this.clearDuesFormGroup.controls.discountRemarks.clearValidators(),this.clearDuesFormGroup.controls.discountRemarks.updateValueAndValidity()},100)):this.clearDuesFormGroup.controls.leftDuesAmount.setValue(this.billDetail.entityTotalDuesAmount-i),this.clearDuesFormGroup.controls.discountRemarks.setValidators([u.kI.required])):(this.clearDuesFormGroup.controls.discountRemarks.clearValidators(),this.clearDuesFormGroup.controls.leftDuesAmount.setValue(this.billDetail.entityTotalDuesAmount),this.clearDuesFormGroup.controls.totalDiscountAmount.setValue(null),this.toastrService.show({type:"error",text:"Please enter non negative numbers!"})),this.clearDuesFormGroup.controls.discountRemarks.updateValueAndValidity()}updatePendingDues(i){let t={},n="";this.billDetail.isDuesCleared?(this.loader.showSpinner("Modifying dues for "+this.billDetail.entityPatientName),n="billservice/updateDiscountDuesEntity",t={billDuesEntity:{createdBy:this.authService.employeeID,companyID:this.authService.companyID,entityBusinessID:this.billDetail.entityBusinessID,entityBusinessShortCode:this.billDetail.entityBusinessShortCode,entityParentBusinessID:this.billDetail.entityParentBusinessID,totalDuesAmount:this.billDetail.entityTotalDuesAmount,totalDiscountAmount:i.totalDiscountAmount,isSelfDiscount:i.isSelfDiscount,totalPayableAmount:this.billDetail.entityTotalDuesAmount,auditAction:"U",discountRemarks:i.discountRemarks,mode:"W"}}):(this.loader.showSpinner("Clearing dues for "+this.billDetail.entityPatientName),n="billservice/updateDuesEntity",t={billDuesEntity:{createdBy:this.authService.employeeID,companyID:this.authService.companyID,entityParentBusinessID:this.billDetail.entityBusinessID,totalDuesAmount:this.billDetail.entityTotalDuesAmount,totalDiscountAmount:i.totalDiscountAmount,isSelfDiscount:i.isSelfDiscount,totalPayableAmount:this.billDetail.entityTotalPayableAmount,auditAction:"C",discountRemarks:i.discountRemarks,mode:"W"}}),this.masterService.requestApiForGeneralMaster(t,n).pipe((0,h.R)(this.destroySubscription$)).subscribe(a=>{this.loader.hideSpinner(),"200"==a.statusCode?(this.billDetail.isDuesCleared?(this.toastrService.show({type:"success",text:"Dues modified of Bill ID "+this.billDetail.entityParentBusinessID+" for "+this.billDetail.entityPatientName}),this.closePanelEvent.emit(a.responseList[0])):(this.toastrService.show({type:"success",text:"Dues cleared of Bill ID "+this.billDetail.entityBusinessID+" for "+this.billDetail.entityPatientName}),this.closePanelEvent.emit(!0)),this.clearDuesFormGroup.reset()):this.toastrService.show({type:"error",text:"There is some issue in clearing dues"})},a=>{this.loader.hideSpinner(),this.toastrService.show({type:"error",text:"Either Internet is not working or some internal server issue"})})}}return(r=d).\u0275fac=function(i){return new(i||r)(e.Y36(L.D),e.Y36(u.qu),e.Y36(k.k),e.Y36(N.$),e.Y36(R.c))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-clear-dues"]],inputs:{billDetail:"billDetail"},outputs:{closePanelEvent:"closePanelEvent"},features:[e.TTD],decls:115,vars:21,consts:[["autocomplete","off",3,"formGroup"],[1,"container-fluid"],[1,"row"],[1,"col-6"],[2,"font-size","1rem","padding-top","8px"],["mat-icon-button","",2,"float","right","padding-top","8px",3,"disableRipple","click"],["aria-label","clear-icon",1,"lms-clear-icon"],[1,"col-12"],[1,"row","detail-block"],[1,"col-lg-4","col-md-4","col-6"],[1,"col-lg-8","col-md-8","col-6"],[1,"col-12",3,"hidden"],[1,"row","input-block"],[1,"col-lg-4","col-md-4","col-6",2,"margin-top","14px"],["appearance","outline",1,"clear-dues-mat-form-field"],["matInput","","type","number","placeholder","Discount","id","clear-dues-input-1","formControlName","totalDiscountAmount",3,"keyup"],["matInput","","placeholder","Left Dues Amount","id","clear-dues-input-2","formControlName","leftDuesAmount","readonly",""],["formControlName","isSelfDiscount","id","clear-dues-input-3","color","primary",1,"is-self-discount-checkbox",3,"labelPosition","change"],["matInput","","placeholder","Remarks*","id","clear-dues-input-4","formControlName","discountRemarks"],[4,"ngIf"],[1,"row",2,"margin-top","12px"],[1,"col-12",2,"display","flex","flex-direction","row","justify-content","space-around"],["mat-raised-button","","type","button","color","primary","style","width: 35%","class","primary-action-btn",3,"disabled","click",4,"ngIf"],["mat-raised-button","","type","button","color","primary",1,"primary-action-btn",2,"width","35%",3,"disabled","click"]],template:function(i,t){1&i&&(e.TgZ(0,"form",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),e._uU(5),e.qZA()(),e.TgZ(6,"div",3)(7,"button",5),e.NdJ("click",function(){return t.closeClearDuesBlock()}),e._UZ(8,"div",6),e.qZA()()(),e.TgZ(9,"div",2)(10,"div",7)(11,"div",8)(12,"div",9)(13,"b"),e._uU(14,"Bill No.: "),e.qZA()(),e.TgZ(15,"div",10),e._uU(16),e.qZA()()(),e.TgZ(17,"div",7)(18,"div",8)(19,"div",9)(20,"b"),e._uU(21,"Patient Name: "),e.qZA()(),e.TgZ(22,"div",10),e._uU(23),e.qZA()()(),e.TgZ(24,"div",7)(25,"div",8)(26,"div",9)(27,"b"),e._uU(28,"Patient Age: "),e.qZA()(),e.TgZ(29,"div",10),e._uU(30),e.qZA()()(),e.TgZ(31,"div",7)(32,"div",8)(33,"div",9)(34,"b"),e._uU(35,"Gender: "),e.qZA()(),e.TgZ(36,"div",10),e._uU(37),e.qZA()()(),e.TgZ(38,"div",11)(39,"div",8)(40,"div",9)(41,"b"),e._uU(42,"Refferal Doctor: "),e.qZA()(),e.TgZ(43,"div",10),e._uU(44),e.qZA()()(),e.TgZ(45,"div",7)(46,"div",8)(47,"div",9)(48,"b"),e._uU(49,"Billing Date: "),e.qZA()(),e.TgZ(50,"div",10),e._uU(51),e.qZA()()(),e.TgZ(52,"div",11)(53,"div",8)(54,"div",9)(55,"b"),e._uU(56,"Total Bill Amount: "),e.qZA()(),e.TgZ(57,"div",10),e._uU(58),e.qZA()()(),e.TgZ(59,"div",11)(60,"div",8)(61,"div",9)(62,"b"),e._uU(63,"Payable Amount: "),e.qZA()(),e.TgZ(64,"div",10),e._uU(65),e.qZA()()(),e.TgZ(66,"div",11)(67,"div",8)(68,"div",9)(69,"b"),e._uU(70,"Received Amount: "),e.qZA()(),e.TgZ(71,"div",10),e._uU(72),e.qZA()()(),e.TgZ(73,"div",7)(74,"div",8)(75,"div",9)(76,"b"),e._uU(77,"Dues Amount: "),e.qZA()(),e.TgZ(78,"div",10),e._uU(79),e.qZA()()(),e.TgZ(80,"div",7)(81,"div",12)(82,"div",13)(83,"b"),e._uU(84,"Discount: "),e.qZA()(),e.TgZ(85,"div",10)(86,"mat-form-field",14)(87,"input",15),e.NdJ("keyup",function(a){return t.onChangeOfDiscountValue(a.target.value)}),e.qZA()()()()(),e.TgZ(88,"div",7)(89,"div",12)(90,"div",13)(91,"b"),e._uU(92,"Left Dues Amount: "),e.qZA()(),e.TgZ(93,"div",10)(94,"mat-form-field",14),e._UZ(95,"input",16),e.qZA()()()(),e.TgZ(96,"div",7)(97,"div",2)(98,"div",9)(99,"b"),e._uU(100,"is Self Discount: "),e.qZA()(),e.TgZ(101,"div",10)(102,"mat-checkbox",17),e.NdJ("change",function(a){return t.checkForSelfDiscount(a.checked)}),e.qZA()()()(),e.TgZ(103,"div",11)(104,"div",12)(105,"div",13)(106,"b"),e._uU(107,"Remarks: "),e.qZA()(),e.TgZ(108,"div",10)(109,"mat-form-field",14),e._UZ(110,"input",18),e.YNc(111,Rt,2,0,"mat-error",19),e.qZA()()()()(),e.TgZ(112,"div",20)(113,"div",21),e.YNc(114,qt,2,2,"button",22),e.qZA()()()()),2&i&&(e.Q6J("formGroup",t.clearDuesFormGroup),e.xp6(5),e.hij(" ",null!=t.billDetail&&t.billDetail.isDuesCleared?"Modify Dues":"Pay Dues"," "),e.xp6(2),e.Q6J("disableRipple",!0),e.xp6(9),e.hij(" ",null==t.billDetail?null:t.billDetail.entityBusinessShortCode," "),e.xp6(7),e.hij(" ",null==t.billDetail?null:t.billDetail.entityPatientName," "),e.xp6(7),e.hij(" ",null==t.billDetail?null:t.billDetail.entityPatientAge," "),e.xp6(7),e.hij(" ",null==t.billDetail?null:t.billDetail.entityPatientGender," "),e.xp6(1),e.Q6J("hidden",null==t.billDetail?null:t.billDetail.isDuesCleared),e.xp6(6),e.hij(" ",null==t.billDetail?null:t.billDetail.refferalFromName," "),e.xp6(7),e.hij(" ",null==t.billDetail?null:t.billDetail.effectiveDateFrom," "),e.xp6(1),e.Q6J("hidden",null==t.billDetail?null:t.billDetail.isDuesCleared),e.xp6(6),e.hij(" ",null==t.billDetail?null:t.billDetail.entityTotalBillAmount," "),e.xp6(1),e.Q6J("hidden",null==t.billDetail?null:t.billDetail.isDuesCleared),e.xp6(6),e.hij(" ",null==t.billDetail?null:t.billDetail.entityTotalPayableAmount," "),e.xp6(1),e.Q6J("hidden",null==t.billDetail?null:t.billDetail.isDuesCleared),e.xp6(6),e.hij(" ",null==t.billDetail?null:t.billDetail.entityTotalReceiveAmount," "),e.xp6(7),e.hij(" ",null==t.billDetail?null:t.billDetail.entityTotalDuesAmount," "),e.xp6(23),e.Q6J("labelPosition","after"),e.xp6(1),e.Q6J("hidden",0==t.discount.value||null==t.discount.value),e.xp6(8),e.Q6J("ngIf",null==t.clearDuesFormGroup.controls.discountRemarks||null==t.clearDuesFormGroup.controls.discountRemarks.errors?null:t.clearDuesFormGroup.controls.discountRemarks.errors.required),e.xp6(3),e.Q6J("ngIf",!(null!=t.billDetail&&t.billDetail.isDuesCleared)))},dependencies:[y.O5,u._Y,u.Fj,u.wV,u.JJ,u.JL,u.sg,u.u,C.lW,C.RK,ie.oG,M.Nt,b.KE,b.TO],styles:[".detail-block[_ngcontent-%COMP%]{padding:10px 0}.clear-dues-mat-form-field[_ngcontent-%COMP%]{width:100%}.input-block[_ngcontent-%COMP%]{padding-top:20px}"]}),d})(),Et=(()=>{var r;class d{constructor(i,t,n,a,l,c,o,p){this.exportService=i,this.authService=t,this.toastrService=n,this.loader=a,this.masterService=l,this.commonService=c,this.numberToWordService=o,this.winRef=p,this.clearedDuesList$=new P.X([]),this.inlineEditFlag=!1,this.showLogCheckedFlag=!1,this.gridOptions=new H.s8,this.changeDetection=new j.x,this.destroySubscription$=new Z.t(1),this.currentDate=new Date,this.selectedStartDate=new Date,this.selectedEndDate=new Date,this.selectedBillDetails={},this.screenWidth=screen.width}ngOnInit(){this.getClearedDuesList(!1).then(i=>{this.clearedDuesList$.next(i)}).catch(i=>{this.clearedDuesList$.next([]),this.toastrService.show({type:"error",text:i})}),this.gridOptions={searchPlaceholder:"Search Patient",pageSize:this.authService.pageSize,dateFormat:"yyyy-MM-dd",keyCodeForNextCell:13,showInlineEdit:this.inlineEditFlag,titleForMobileView:"entityPatientName",pageSizeArray:[5,10,20],showDeleteButton:!1,showAddButton:!1,showEditButton:!1,showActivateDeactivateButton:!1,showSearchInput:!0,activateDeactivateCondition:{conditionalProperty:"activeFlag",valueForActivation:"1",valueForDeactivation:"0"},columns:[{name:"entityPatientName",label:"Patient Name",enable:!0,searchable:!0,sortable:!0,type:"text",editable:!1,isRequired:!1},{name:"entityPatientAge",label:"Patient Age",enable:!0,searchable:!1,sortable:!0,type:"text",editable:!1,isRequired:!1},{name:"entityPatientGender",label:"Gender",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"entityBusinessName",label:"Old Bill No.",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"effectiveDateTo",label:"Old Bill Date",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"entityBusinessShortCode",label:"New Bill ID",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"effectiveDateFrom",label:"New Bill Date",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"totalDuesAmount",label:"Dues Amount",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"totalDiscountAmount",label:"Discount on dues",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"entityFinalAmount",label:"Final Amount",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1}]}}exportData(i){this.exportService.generateFile(this.clearedDuesList$.getValue(),"Cleared Dues List."+i,[{property:"entityPatientName",label:"Patient Name"},{property:"entityPatientAge",label:"Patient Age"},{property:"entityPatientGender",label:"Gender"},{property:"entityBusinessName",label:"Old Bill No."},{property:"effectiveDateTo",label:"Old Bill Date"},{property:"entityBusinessShortCode",label:"New Bill ID"},{property:"effectiveDateFrom",label:"New Bill Date"},{property:"totalDuesAmount",label:"Dues Amount"},{property:"totalDiscountAmount",label:"Discount on dues"},{property:"entityFinalAmount",label:"Final Amount"}])}getClearedDuesList(i){var t=this;return new Promise((n,a)=>{this.loader.showSpinner("Cleared Dues list on the way!");const l={genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W",detailFlag:i,dropDown:!1,fromDate:this.commonService.parseDate(this.selectedStartDate,"yyyy-MM-dd"),toDate:this.commonService.parseDate(this.selectedEndDate,"yyyy-MM-dd")}};this.masterService.requestApiForGeneralMaster(l,"billservice/getDuesReferenceEntity").pipe((0,h.R)(this.destroySubscription$)).subscribe(function(){var c=(0,w.Z)(function*(o){t.loader.hideSpinner(),"200"===o.statusCode||"300"===o.statusCode?(o.responseList=null==o.responseList?[]:yield t.assignPermissionForBillList(o.responseList[0]),n(o.responseList)):a(o.errorMessage)});return function(o){return c.apply(this,arguments)}}(),c=>{this.loader.hideSpinner(),a("Either Internet is not working or some internal server issue")})})}assignPermissionForBillList(i){var t=this;return(0,w.Z)(function*(){const n=(new Date).toISOString().slice(0,10);return i=yield i.map(a=>{let l=null===a.patitentName?["",n,""]:a.patitentName.split(","),c=l[0],o=t.commonService.findValuesOfYearMonthAndDays(l[1],a.effectiveDateFrom),p=l[2];return{...a,entityPatientName:c,entityPatientAge:0==o.years?o.months+" M , "+o.days+" D":o.years+" Y",entityPatientGender:p,totalDiscountAmount:null==a.totalDiscountAmount?0:a.totalDiscountAmount,entityFinalAmount:a.totalDuesAmount-(null==a.totalDiscountAmount?0:a.totalDiscountAmount)}}).sort((a,l)=>Date.parse(a.effectiveDateFrom)>Date.parse(l.effectiveDateFrom)?-1:0)})()}ngOnDestroy(){this.destroySubscription$.next(null),this.destroySubscription$.complete()}searchClearedDuesForSelectedDate(){this.getClearedDuesList(!1).then(i=>{this.clearedDuesList$.next(i)}).catch(i=>{this.clearedDuesList$.next([]),this.toastrService.show({type:"error",text:i})})}resetDateFilter(){this.selectedStartDate=new Date,this.selectedEndDate=new Date,this.getClearedDuesList(!1).then(i=>{this.clearedDuesList$.next(i)}).catch(i=>{this.clearedDuesList$.next([]),this.toastrService.show({type:"error",text:i})})}closeNav(){null!==document.getElementById("mySidenav")&&(document.getElementById("mySidenav").style.width="0")}closeDuesClearForm(i){if(Object.keys(i).length>0){console.log(i);let t=this.clearedDuesList$.getValue(),n=t.findIndex(a=>a.entityBusinessID===i.entityBusinessID);t[n]=i,this.clearedDuesList$.next(t)}this.closeNav()}updateDues(i){i.isDuesCleared=!0,this.selectedBillDetails=i;const t=this.screenWidth>900?this.screenWidth/4:this.screenWidth;document.getElementById("mySidenav").style.width=t+"px"}printDuesRecipt(i){var t=this;return new Promise((n,a)=>{this.loader.showSpinner("Printing report..."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W",entityBillID:i}},"billservice/printDuesRecipt").pipe((0,h.R)(this.destroySubscription$)).subscribe(function(){var c=(0,w.Z)(function*(o){"200"===o.statusCode?n(Object.assign({printDate:o.date},o.responseList[0])):(t.loader.hideSpinner(),a(o.errorMessage))});return function(o){return c.apply(this,arguments)}}(),c=>{this.loader.hideSpinner(),a("Either Internet is not working or facing internal server issue")})})}generateBarCode(i){var t=this;return new Promise((n,a)=>{this.loader.showSpinner("Printing report..."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W",entityBusinessName:i}},"adminservice/getBarCode").pipe((0,h.R)(this.destroySubscription$)).subscribe(function(){var c=(0,w.Z)(function*(o){t.loader.hideSpinner(),"200"===o.statusCode?n(Object.assign({printDate:o.date},o.responseList[0])):a(o.errorMessage)});return function(o){return c.apply(this,arguments)}}(),c=>{this.loader.hideSpinner(),a("Either Internet is not working or facing internal server issue")})})}printDuesReport(i){this.printDuesRecipt(i.entityBusinessID).then(n=>{this.generateBarCode(n.patientID).then(l=>{const c="data:image/jpg;base64,"+l.entityBusinessName,o=this.commonService.parseDate(l.printDate,"dd-MM-yyyy"),p=this.authService.employeeName,g=n.billServiceDetailEntities,f=n.duesOnLastBill-n.discountOnDues,A=n.totalPayableAmount-n.totalDiscountAmount,x=this.numberToWordService.transform(f),B=this.commonService.convertFirstLetterInUpperCase(x);let _=[],q=[],U=[],G=[];const I=n.oldBillDate,X=n.effectiveDateFrom;let E=this.commonService.findValuesOfYearMonthAndDays(n.dob,i.effectiveDateFrom);const V=0==E.years?E.months+" M , "+E.days+" D":E.years+" Y";g.forEach((le,Vt)=>{_.push(Vt+1+"\n"),U.push(le.entityrate+"\n"),q.push(le.entityFinalAmount+"\n"),G.push(le.entityBusinessName+"\n")});let T="";null!=n.companyLogo&&""!=n.companyLogo&&null!=n.companyLogo&&(T="data:image/jpg;base64,"+n.companyLogo),this.winRef.nativeWindow.pdfMake.createPdf({info:{title:n.patitentName+"\tDues Cleared Receipt",author:n.companyName,subject:"",keywords:""},pageMargins:[10,15,10,15],content:[{style:"tableExample",widths:[494],table:{body:[[{stack:[{image:T,width:480,height:60,margin:[15,10,0,0],alignment:"center",border:[!1,!1,!1,!1]}]}],[{}],[[{image:c,width:60,height:16,margin:[0,0,20,0],alignment:"right",border:[!1,!1,!1,!1]},{text:"RECEIPT",margin:[0,-10,0,0]},{text:"*"+n.patientID+"*",border:[!1,!1,!1,!1],fontSize:"8",alignment:"right",bold:!1,margin:[0,-2,50,0]}]],[{table:{widths:[300,245],body:[["Patient Details","Receipt Details"],[{style:"tableExample",table:{widths:[73,175],border:[!1,!1,!1,!1],body:[[{text:"UHID\t\t\t\t   :",border:[!1,!1,!1,!1],fontSize:"10",alignment:"left",bold:!1,margin:[0,0,0,0]},{text:+n.patientID,border:[!1,!1,!1,!1],fontSize:"10",alignment:"left",bold:!0,margin:[0,0,0,0]}],[{text:"Patient Name\t:",border:[!1,!1,!1,!1],fontSize:"10",alignment:"left",bold:!1,margin:[0,0,0,0]},{text:n.patitentName,border:[!1,!1,!1,!1],fontSize:"10",alignment:"left",bold:!0,margin:[0,0,0,0]}],[{text:"Age/Sex \t\t\t:",border:[!1,!1,!1,!1],fontSize:"10",alignment:"left",bold:!1,margin:[0,0,0,0]},{text:V+" / "+n.patitentGender,border:[!1,!1,!1,!1],fontSize:"10",alignment:"left",bold:!0,margin:[0,0,0,0]}],[{text:"Referred By\t   :",border:[!1,!1,!1,!1],fontSize:"10",alignment:"left",bold:!1,margin:[0,0,0,0]},{text:n.referralName,border:[!1,!1,!1,!1],fontSize:"10",alignment:"left",bold:!0,margin:[0,0,0,0]}],[{text:"Address\t\t\t :",border:[!1,!1,!1,!1],fontSize:"10",alignment:"left",bold:!1,margin:[0,0,0,0]},{text:n.discountRemarks,border:[!1,!1,!1,!1],fontSize:"10",alignment:"left",bold:!0,margin:[0,0,0,0]}]]},layout:"noBorders"},{style:"tableExample",table:{widths:[115,115],body:[[{text:"Receipt No.\t\t\t\t   :",border:[!1,!1,!1,!1],fontSize:"10",alignment:"left",bold:!1,margin:[0,0,0,0]},{text:n.entityBusinessShortCode,border:[!1,!1,!1,!1],fontSize:"10",alignment:"left",bold:!0,margin:[0,0,0,0]}],[{text:"Date\t\t\t\t\t\t\t   :",border:[!1,!1,!1,!1],fontSize:"10",alignment:"left",bold:!1,margin:[0,0,0,0]},{text:X,border:[!1,!1,!1,!1],fontSize:"10",alignment:"left",bold:!0,margin:[0,0,0,0]}],[{text:"Receipt Ref.No\t\t    :",border:[!1,!1,!1,!1],fontSize:"10",alignment:"left",bold:!1,margin:[0,0,0,0]},{text:n.entityParentBusinessName,border:[!1,!1,!1,!1],fontSize:"10",alignment:"left",bold:!0,margin:[0,0,0,0]}],[{text:"Old Receipt Date\t\t :",border:[!1,!1,!1,!1],fontSize:"10",alignment:"left",bold:!1,margin:[0,0,0,0]},{text:I,border:[!1,!1,!1,!1],fontSize:"10",alignment:"left",bold:!0,margin:[0,0,0,0]}]]},layout:"noBorders"}]]}}],[{style:"tableExample",table:{widths:[30,305,95,85],border:[!1,!1,!1,!1],body:[["S.No.","Particulars","Rate(Rs.)","Amount(Rs.)"],[{stack:[{text:_,border:[!1,!1,!1,!1],fontSize:"10.5",alignment:"center",bold:!1,margin:[0,0,0,5]}]},{stack:[{text:G,border:[!1,!1,!1,!1],fontSize:"10.5",alignment:"left",bold:!1,margin:[0,0,0,5]}]},{stack:[{text:U,border:[!1,!1,!1,!1],fontSize:"10.5",alignment:"right",bold:!0,margin:[0,0,0,5]}]},{stack:[{text:q,border:[!1,!1,!1,!1],fontSize:"10.5",alignment:"right",bold:!0,margin:[0,0,0,5]}]}],[{text:"",border:[!1,!0,!1,!1],alignment:"center",bold:!1,margin:[0,0,0,0]},{text:"Total",border:[!0,!0,!1,!0],alignment:"left",fontSize:"10.5",bold:!0,margin:[0,0,0,0]},{text:n.totalBillAmount,fontSize:"10.5",border:[!0,!0,!0,!0],alignment:"right",margin:[0,0,0,0]},{text:n.totalPayableAmount,fontSize:"10.5",border:[!0,!0,!0,!0],alignment:"right",margin:[0,0,0,0]}],[{text:"",border:[!1,!1,!1,!1],alignment:"center",bold:!1,margin:[0,0,0,0]},{text:"Amount Paid In Last Bill-Rs."+n.amountPaidInLastBill,border:[!0,!1,!1,!0],fontSize:"10.5",alignment:"left",bold:!0,margin:[0,0,0,0]},{text:"Discount",border:[!0,!1,!0,!0],fontSize:"10.5",alignment:"right",bold:!1,margin:[0,0,0,0]},{text:n.discountOnOldBill,fontSize:"10.5",border:[!0,!1,!0,!0],bold:!0,alignment:"right",margin:[0,0,0,0]}],[{text:"",border:[!1,!1,!1,!1],alignment:"center",bold:!1,margin:[0,0,0,0]},{text:"",border:[!0,!1,!1,!0],fontSize:"10.5",alignment:"left",bold:!0,margin:[0,0,0,0]},{text:"Last Dues Amount",border:[!1,!0,!0,!0],fontSize:"10.5",alignment:"right",bold:!1,margin:[0,0,0,0]},{text:n.totalDuesAmount,fontSize:"10.5",border:[!0,!1,!0,!0],bold:!0,alignment:"right",margin:[0,0,0,0]}],[{text:"",border:[!1,!1,!1,!1],alignment:"center",bold:!1,margin:[0,0,0,0]},{text:"",border:[!0,!1,!1,!0],fontSize:"10.5",alignment:"left",bold:!0,margin:[0,0,0,0]},{text:"Discount On Dues",border:[!1,!0,!0,!0],fontSize:"10.5",alignment:"right",bold:!1,margin:[0,0,0,0]},{text:n.discountOnDues,fontSize:"10.5",border:[!0,!1,!0,!0],bold:!0,alignment:"right",margin:[0,0,0,0]}],[{text:"",border:[!1,!1,!1,!1],alignment:"center",bold:!1,margin:[0,0,0,0]},{text:"",border:[!0,!1,!1,!0],fontSize:"10.5",alignment:"left",bold:!0,margin:[0,5,0,0]},{text:"Recieved Amount",border:[!1,!0,!0,!0],fontSize:"10.5",alignment:"right",bold:!1,margin:[0,0,0,0]},{text:f,fontSize:"10.5",bold:!0,border:[!0,!1,!0,!0],alignment:"right",margin:[0,0,0,0]}],[{text:"",border:[!1,!1,!1,!1],fontSize:"10.5",alignment:"center",bold:!0,margin:[0,0,0,0]},{text:"Total Bill-Rs."+n.totalPayableAmount+"\tTotal Discount-Rs."+n.totalDiscountAmount+"\tTotal Received-Rs."+A,border:[!0,!0,!1,!0],fontSize:"10",alignment:"left",bold:!0,margin:[0,0,0,0]},{text:"Balance",border:[!1,!1,!0,!0],fontSize:"10",alignment:"right",bold:!1,margin:[0,0,0,0]},{text:"0",fontSize:"10",border:[!0,!1,!0,!0],alignment:"right",bold:!0,margin:[0,0,0,0]}]]}}],[{text:"Amount in Word:\t"+B,bold:!0,fontSize:"11",alignment:"left",lineHeight:"1.5",margin:[0,5,0,0]}],[[{text:"Prepared By:\t"+n.createdByUser+"\t\t\t\t\t\t\tChecked By:\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tCashier By:",bold:!0,fontSize:"9",alignment:"left",lineHeight:"1.5",margin:[0,5,0,0]}]],[[{text:"Printed By:\t"+p+"\t\t\t\t\t\t\t\t\t\t\t\tPrinted Date:"+o,bold:!0,fontSize:"9",alignment:"left"}]],[[{text:"Powered By iCare Infosystems",bold:!1,fontSize:"9",alignment:"center",color:"red"}]]]}}],styles:{header:{fontSize:20,bold:!0,margin:[0,0,0,0],alignment:"center",decoration:"underline",color:"black"},commitment:{fontSize:12,bold:!1,margin:[0,0,0,12],alignment:"center"},subheader:{fontSize:12,bold:!0,margin:[40,0,0,4],alignment:"center"},tableExample:{margin:[0,5,0,15],alignment:"center",bold:!0},tableHeader:{bold:!0,fontSize:13,color:"black",alignment:"center"},patientdetails:{bold:!1,fontsize:8,color:"black",alignment:"left"},imageStyle:{alignment:"left",margin:[0,-50,0,0]}}}).open()}).catch(l=>{this.toastrService.show({type:"error",text:l})})}).catch(n=>{this.toastrService.show({type:"error",text:n})})}}return(r=d).\u0275fac=function(i){return new(i||r)(e.Y36(W.u),e.Y36(N.$),e.Y36(k.k),e.Y36(L.D),e.Y36(R.c),e.Y36(O.v),e.Y36(ee.t),e.Y36(K.f))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-cleared-dues"]],decls:39,vars:12,consts:[[1,"container-fluid"],[1,"row"],[1,"col-lg-5","col-md-5","col-sm-12"],["childLink","Billing","subchildLink","Cleared Dues"],[1,"col-lg-2","col-md-2","col-sm-12","bill-search-parameter"],["appearance","outline",2,"width","100%"],["matInput","","placeholder","Start Date","id","start-date-block","readonly","",3,"matDatepicker","ngModel","max","ngModelChange","click"],["matSuffix","",3,"for"],["aria-label","calendar-icon","matDatepickerToggleIcon","",1,"lms-calendar-icon"],["startDatePicker",""],["matInput","","placeholder","End Date","id","end-date-block","readonly","",3,"matDatepicker","ngModel","max","min","ngModelChange","click"],["endDatePicker",""],[1,"col-lg-3","col-md-3","col-sm-12","bill-search-parameter"],["mat-raised-button","","color","warn",1,"warn-action-btn",3,"click"],["mat-raised-button","","color","primary",1,"primary-action-btn",3,"click"],["id","mySidenav",1,"sidenav"],[1,"update-pending-dues-panel"],[3,"billDetail","closePanelEvent"],[1,"mat-elevation-z12","lms-master-card"],[1,"lms-matcardtitlegroup"],["mat-icon-button","",3,"disableRipple","click"],["aria-label","excel",1,"lms-excel-icon"],["aria-label","csv",1,"lms-csv-icon"],[1,"remaining-space"]],template:function(i,t){if(1&i){const n=e.EpF();e._UZ(0,"app-header"),e.TgZ(1,"div",0)(2,"div",1)(3,"div",2),e._UZ(4,"app-breadcrumb",3),e.qZA(),e.TgZ(5,"div",4)(6,"mat-form-field",5)(7,"mat-label"),e._uU(8,"Start Date"),e.qZA(),e.TgZ(9,"input",6),e.NdJ("ngModelChange",function(l){return t.selectedStartDate=l})("click",function(){e.CHM(n);const l=e.MAs(13);return e.KtG(l.open())}),e.qZA(),e.TgZ(10,"mat-datepicker-toggle",7),e._UZ(11,"div",8),e.qZA(),e._UZ(12,"mat-datepicker",null,9),e.qZA()(),e.TgZ(14,"div",4)(15,"mat-form-field",5)(16,"mat-label"),e._uU(17,"End Date"),e.qZA(),e.TgZ(18,"input",10),e.NdJ("ngModelChange",function(l){return t.selectedEndDate=l})("click",function(){e.CHM(n);const l=e.MAs(22);return e.KtG(l.open())}),e.qZA(),e.TgZ(19,"mat-datepicker-toggle",7),e._UZ(20,"div",8),e.qZA(),e._UZ(21,"mat-datepicker",null,11),e.qZA()(),e.TgZ(23,"div",12)(24,"button",13),e.NdJ("click",function(){return t.resetDateFilter()}),e._uU(25," Reset "),e.qZA(),e.TgZ(26,"button",14),e.NdJ("click",function(){return t.searchClearedDuesForSelectedDate()}),e._uU(27," Search "),e.qZA()()(),e.TgZ(28,"div",1)(29,"div",15)(30,"div",16)(31,"app-clear-dues",17),e.NdJ("closePanelEvent",function(l){return t.closeDuesClearForm(l)}),e.qZA()()(),e.TgZ(32,"mat-card",18)(33,"mat-card-title-group",19)(34,"button",20),e.NdJ("click",function(){return t.exportData("xlsx")}),e._UZ(35,"div",21),e.qZA(),e.TgZ(36,"button",20),e.NdJ("click",function(){return t.exportData("csv")}),e._UZ(37,"div",22),e.qZA(),e._UZ(38,"span",23),e.qZA()()()()}if(2&i){const n=e.MAs(13),a=e.MAs(22);e.xp6(9),e.Q6J("matDatepicker",n)("ngModel",t.selectedStartDate)("max",t.currentDate),e.xp6(1),e.Q6J("for",n),e.xp6(8),e.Q6J("matDatepicker",a)("ngModel",t.selectedEndDate)("max",t.currentDate)("min",t.selectedStartDate),e.xp6(1),e.Q6J("for",a),e.xp6(12),e.Q6J("billDetail",t.selectedBillDetails),e.xp6(3),e.Q6J("disableRipple",!0),e.xp6(2),e.Q6J("disableRipple",!0)}},dependencies:[Q.G,u.Fj,u.JJ,u.On,C.lW,C.RK,v.a8,v.C1,S.Mq,S.hl,S.nW,S.Q0,M.Nt,b.KE,b.hX,b.R9,Y.L,pe],styles:[".search-patient-container[_ngcontent-%COMP%]{display:flow-root;margin-top:-10px;margin-left:10px;margin-right:30px}.bill-search-parameter[_ngcontent-%COMP%]{margin-top:11px}.warn-action-btn[_ngcontent-%COMP%]{float:right;margin-top:5px}.primary-action-btn[_ngcontent-%COMP%]{float:right;margin-right:10px;margin-top:5px}.sidenav[_ngcontent-%COMP%]{position:fixed;top:64px;right:0;height:100%;width:0;z-index:1;box-shadow:1px 0 12px #212529;background-color:#fff;overflow-x:hidden;transition:.55s}.update-pending-dues-panel[_ngcontent-%COMP%]{padding-bottom:100px}"]}),d})();function Mt(r,d){if(1&r){const s=e.EpF();e.TgZ(0,"div",1)(1,"div",2),e._UZ(2,"app-breadcrumb",3),e.qZA(),e.TgZ(3,"div",2)(4,"div",4)(5,"div",5)(6,"app-clear-dues",6),e.NdJ("closePanelEvent",function(t){e.CHM(s);const n=e.oxw();return e.KtG(n.closeDuesClearForm(t))}),e.qZA()()(),e.TgZ(7,"mat-card",7)(8,"mat-card-title-group",8)(9,"button",9),e.NdJ("click",function(){e.CHM(s);const t=e.oxw();return e.KtG(t.exportData("xlsx"))}),e._UZ(10,"div",10),e.qZA(),e.TgZ(11,"button",9),e.NdJ("click",function(){e.CHM(s);const t=e.oxw();return e.KtG(t.exportData("csv"))}),e._UZ(12,"div",11),e.qZA(),e._UZ(13,"span",12),e.qZA()()()()}if(2&r){const s=e.oxw();e.xp6(6),e.Q6J("billDetail",s.selectedBillDetails),e.xp6(3),e.Q6J("disableRipple",!0),e.xp6(2),e.Q6J("disableRipple",!0)}}function Ot(r,d){1&r&&(e.TgZ(0,"div",1),e._UZ(1,"app-access-denied",13),e.qZA())}const Jt=[{path:"bill",component:Lt},{path:"billpendingdue",component:(()=>{var r;class d{constructor(i,t,n,a,l,c){this.loader=i,this.authService=t,this.masterService=n,this.exportService=a,this.toastrService=l,this.commonService=c,this.screenWidth=screen.width,this.pendingDuesList$=new P.X([]),this.inlineEditFlag=!1,this.showLogCheckedFlag=!1,this.gridOptions=new H.s8,this.destroySubscription$=new Z.t(1),this.changeDetection=new j.x,this.selectedBillDetails={},this.canViewRecord=!0}ngOnInit(){this.getPageAccessDetail().then(i=>{this.pageAccessDetail=i,this.canViewRecord=1==this.pageAccessDetail?.data?.entityIsBillView,this.canViewRecord?this.getPendingDuesList(!1).then(t=>{this.pendingDuesList$.next(t)}).catch(t=>{this.pendingDuesList$.next([]),this.toastrService.show({type:"error",text:t})}):this.loader.hideSpinner()}).catch(i=>{this.toastrService.show({type:"error",text:i})}),this.gridOptions={searchPlaceholder:"Search Patient",pageSize:this.authService.pageSize,dateFormat:"yyyy-MM-dd",keyCodeForNextCell:13,showInlineEdit:this.inlineEditFlag,titleForMobileView:"entityBusinessShortCode",pageSizeArray:[5,10,20],showDeleteButton:!1,showAddButton:!1,showEditButton:!1,showActivateDeactivateButton:!1,showSearchInput:!0,activateDeactivateCondition:{conditionalProperty:"activeFlag",valueForActivation:"1",valueForDeactivation:"0"},columns:[{name:"entityBusinessShortCode",label:"Bill No.",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"entityPatientName",label:"Patient Name",enable:!0,searchable:!0,sortable:!0,type:"text",editable:!1,isRequired:!1},{name:"entityPatientAge",label:"Patient Age",enable:!0,searchable:!1,sortable:!0,type:"text",editable:!1,isRequired:!1},{name:"entityPatientGender",label:"Gender",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"refferalFromName",label:"Refferal Doctor",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"effectiveDateFrom",label:"Billing Date",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"entityTotalBillAmount",label:"Total Bill Amount",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"entityTotalPayableAmount",label:"Payable Amount",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"entityTotalReceiveAmount",label:"Received Amount",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"entityTotalDuesAmount",label:"Dues Amount",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1}]}}ngOnDestroy(){this.destroySubscription$.next(null),this.destroySubscription$.complete()}getPageAccessDetail(){return new Promise((i,t)=>{this.loader.showSpinner("Loading..."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,roleID:this.authService.employeeID,entityBusinessID:2,mode:"W"}},"pageaccessservice/getAllEntity").pipe((0,h.R)(this.destroySubscription$)).subscribe(a=>{"200"===a.statusCode||"300"===a.statusCode?(a.responseList=null==a?.responseList?null:a?.responseList[0]?.pageList.find(l=>2===l.pageID)||null,i({data:a.responseList,currentDate:a?.date})):(this.loader.hideSpinner(),t(a.errorMessage))},a=>{this.loader.hideSpinner(),t("Either Internet is not working or facing internal server issue")})})}getPendingDuesList(i){var t=this;return new Promise((n,a)=>{this.loader.showSpinner("Pending dues list on the way."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,mode:"W",detailFlag:i,dropDown:!1,isDues:!0}},"billservice/getAllBillReferenceEntity").pipe((0,h.R)(this.destroySubscription$)).subscribe(function(){var c=(0,w.Z)(function*(o){t.loader.hideSpinner(),"200"===o.statusCode||"300"===o.statusCode?(o.responseList=null==o.responseList?[]:yield t.assignPermissionForBillList(o.responseList[0]),n(o.responseList)):a(o.errorMessage)});return function(o){return c.apply(this,arguments)}}(),c=>{this.loader.hideSpinner(),a("Either Internet is not working or some internal server issue")})})}assignPermissionForBillList(i){var t=this;return(0,w.Z)(function*(){const n=(new Date).toISOString().slice(0,10);let a=t.pageAccessDetail?.currentDate||new Date,l=t.pageAccessDetail?.data?.entityDays||1,c=1==t.pageAccessDetail?.data?.entityIsUpdate,o=new Date(a).setDate(new Date(a).getDate()-l),p=new Date(o).toISOString().substring(0,10);return i=yield i.map(g=>{let f=null===g.entityBusinessName?["",n,""]:g.entityBusinessName.split(","),A=f[0],x=t.commonService.findValuesOfYearMonthAndDays(f[1],g.effectiveDateFrom),B=f[2];return{...g,entityPatientName:A,entityPatientAge:0==x.years?x.months+" M , "+x.days+" D":x.years+" Y",entityPatientGender:B,showEditButton:!!(c&&Date.parse(g.effectiveDateFrom.substring(0,10))>=Date.parse(p))}}).sort((g,f)=>Date.parse(g.effectiveDateFrom)>Date.parse(f.effectiveDateFrom)?-1:0)})()}exportData(i){this.exportService.generateFile(this.pendingDuesList$.getValue(),"Pending Dues List."+i,[{property:"entityBusinessShortCode",label:"Bill No."},{property:"entityPatientName",label:"Patient Name"},{property:"entityPatientAge",label:"Patient Age"},{property:"entityPatientGender",label:"Gender"},{property:"refferalFromName",label:"Refferal Doctor"},{property:"effectiveDateFrom",label:"Billing Date"},{property:"entityTotalBillAmount",label:"Total Bill Amount"},{property:"entityTotalPayableAmount",label:"Payable Amount"},{property:"entityTotalReceiveAmount",label:"Received Amount"},{property:"entityTotalDuesAmount",label:"Dues Amount"}])}closeNav(){null!==document.getElementById("mySidenav")&&(document.getElementById("mySidenav").style.width="0")}closeDuesClearForm(i){if(i){let t=this.pendingDuesList$.getValue();t=t.filter(n=>n.entityBusinessID!=this.selectedBillDetails.entityBusinessID),this.pendingDuesList$.next(t)}this.closeNav()}clearDues(i){i.isDuesCleared=!1,this.selectedBillDetails=i;const t=this.screenWidth>900?this.screenWidth/4:this.screenWidth;document.getElementById("mySidenav").style.width=t+"px"}}return(r=d).\u0275fac=function(i){return new(i||r)(e.Y36(L.D),e.Y36(N.$),e.Y36(R.c),e.Y36(W.u),e.Y36(k.k),e.Y36(O.v))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-pending-dues"]],decls:3,vars:2,consts:[["class","container-fluid",4,"ngIf"],[1,"container-fluid"],[1,"row"],["childLink","Billing","subchildLink","Pending Dues"],["id","mySidenav",1,"sidenav"],[1,"update-pending-dues-panel"],[3,"billDetail","closePanelEvent"],[1,"mat-elevation-z12","lms-master-card"],[1,"lms-matcardtitlegroup"],["mat-icon-button","",3,"disableRipple","click"],["aria-label","excel",1,"lms-excel-icon"],["aria-label","csv",1,"lms-csv-icon"],[1,"remaining-space"],["childLinkLabel","Billing","subchildLinkLabel","Pending Dues"]],template:function(i,t){1&i&&(e._UZ(0,"app-header"),e.YNc(1,Mt,14,3,"div",0),e.YNc(2,Ot,2,0,"div",0)),2&i&&(e.xp6(1),e.Q6J("ngIf",t.canViewRecord),e.xp6(1),e.Q6J("ngIf",!t.canViewRecord))},dependencies:[y.O5,Q.G,C.RK,v.a8,v.C1,Y.L,te.A,pe],styles:[".sidenav[_ngcontent-%COMP%]{position:fixed;top:64px;right:0;height:100%;width:0;z-index:1;box-shadow:1px 0 12px #212529;background-color:#fff;overflow-x:hidden;transition:.55s}.update-pending-dues-panel[_ngcontent-%COMP%]{padding-bottom:100px}"]}),d})()},{path:"billcleareddue",component:Et},{path:"billrefund",component:xe},{path:"",pathMatch:"full",redirectTo:"bill"}];let Ut=(()=>{var r;class d{}return(r=d).\u0275fac=function(i){return new(i||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[se.Bz.forChild(Jt),se.Bz]}),d})();var Gt=m(6611),zt=m(9820);let Xt=(()=>{var r;class d{}return(r=d).\u0275fac=function(i){return new(i||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[y.ez,Ut,zt.m,Gt.q,u.u5,u.UX]}),d})()}}]);