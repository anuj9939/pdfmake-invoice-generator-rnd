"use strict";(self.webpackChunklms_web_app=self.webpackChunklms_web_app||[]).push([[949],{949:(An,j,h)=>{h.r(j),h.d(j,{GeneralMasterModule:()=>In});var D=h(6814),W=h(1896),J=h(4423),p=h(5619),o=h(6223),e=h(5879),b=h(9250),f=h(8394),v=h(3493),C=h(8586),S=h(2242),k=h(1775),d=h(5195),x=h(2032),y=h(5683),I=h(3424),le=h(9562);function ue(r,l){if(1&r&&(e.TgZ(0,"div",20),e._uU(1),e.qZA()),2&r){const c=l.$implicit;e.xp6(1),e.hij(" ",c.subDepartmentName," ")}}function ce(r,l){if(1&r&&(e.TgZ(0,"div",20),e._uU(1),e.qZA()),2&r){const c=l.$implicit;e.xp6(1),e.hij(" ",c.subDepartmentName," ")}}const z=function(r){return[r]};let pe=(()=>{var r;class l{constructor(t,i,n,a){this.loader=t,this.toastrService=i,this.masterService=n,this.authService=a,this.employeeList$=new p.X([]),this.departmentList$=new p.X([]),this.availableTestGroupList$=new p.X([]),this.assignedTestGroupList$=new p.X([]),this.filterAvailableTestGroupString=null,this.filterAssignedTestGroupString=null}ngOnInit(){this.entityEmployeeID=new o.NI(null),this.entityDepartmentID=new o.NI(null),this.getEmployeeList().then(t=>{this.employeeList$.next(t),this.getDepartmentList().then(i=>{this.departmentList$.next(i)}).catch(()=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}).catch(()=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}drop(t){t.previousContainer===t.container?(0,J.bA)(t.container.data,t.previousIndex,t.currentIndex):(0,J.EA)(t.previousContainer.data,t.container.data,t.previousIndex,t.currentIndex)}getEmployeeList(){return new Promise((t,i)=>{this.loader.showSpinner("Loading..."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W",detailFlag:!1,dropDown:!0}},"employeeservice/getAllEmployee/").subscribe(a=>{this.loader.hideSpinner(),"200"===a.statusCode||"300"===a.statusCode?(a.responseList=null==a.responseList?[]:a.responseList,t(a.responseList)):i(a.errorMessage)},a=>{this.loader.hideSpinner(),i("Either Internet is not working or facing internal server issue")})})}getDepartmentList(){return new Promise((t,i)=>{this.loader.showSpinner("Loading..."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W",detailFlag:!1,dropDown:!0}},"departmentservice/getAllDepartment").subscribe(a=>{this.loader.hideSpinner(),"200"===a.statusCode||"300"===a.statusCode?(a.responseList=null==a.responseList?[]:a.responseList,t(a.responseList)):i(a.errorMessage)},a=>{this.loader.hideSpinner(),i("Either Internet is not working or facing internal server issue")})})}getAvailableTestGroupList(t,i){return new Promise((n,a)=>{this.loader.showSpinner("Available Test Group on the way..."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,searchValue:t,departmentID:i,mode:"W"}},"adminservice/getAvailableTestGroup").subscribe(u=>{this.loader.hideSpinner(),"200"===u.statusCode||"300"===u.statusCode?(u.responseList=null==u.responseList[0].userTestGroupEntityList?[]:u.responseList[0].userTestGroupEntityList,n(u.responseList)):a(u.errorMessage)},u=>{this.loader.hideSpinner(),a("Either Internet is not working or facing internal server issue")})})}getAssignedTestGroupList(t,i){return new Promise((n,a)=>{this.loader.showSpinner("Assigned Test Group on the way..."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,searchValue:t,departmentID:i,mode:"W"}},"adminservice/getAssignedTestGroup").subscribe(u=>{this.loader.hideSpinner(),"200"===u.statusCode||"300"===u.statusCode?(u.responseList=null==u.responseList[0].userTestGroupEntityList?[]:u.responseList[0].userTestGroupEntityList,n(u.responseList)):a(u.errorMessage)},u=>{this.loader.hideSpinner(),a("Either Internet is not working or facing internal server issue")})})}onChangeOfDropdown(t){this.fetchTestGroupDetails(this.entityEmployeeID.value,this.entityDepartmentID.value)}fetchTestGroupDetails(t,i){null!==t&&null!==i&&this.getAvailableTestGroupList(t,i).then(n=>{this.availableTestGroupList$.next(n),this.getAssignedTestGroupList(t,i).then(a=>{this.assignedTestGroupList$.next(a)}).catch(()=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}).catch(()=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}assignUserTestGroup(){const t=this.assignedTestGroupList$.getValue();this.loader.showSpinner("Assigning Test Group to Selected Employee");let i=[];t.map(a=>{i.push(a.subDepartmentID)}),this.masterService.requestApiForGeneralMaster({userTestGroupMappingEntity:{entityUserID:this.entityEmployeeID.value,departmentID:this.entityDepartmentID.value,auditAction:"U",subDepartmentList:i,companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W"}},"adminservice/assignUserTestGroup").subscribe(a=>{this.loader.hideSpinner(),"200"===a.statusCode?(this.toastrService.show({type:"success",text:"Assigned Test Group to Selected Employee!"}),this.fetchTestGroupDetails(this.entityEmployeeID.value,this.entityDepartmentID.value)):this.toastrService.show({type:"error",text:a.errorMessage})},a=>{this.loader.hideSpinner(),this.toastrService.show({type:"error",text:"Either Internet is not working or facing internal server issue"})})}resetAllParameter(){this.entityEmployeeID.setValue(null),this.entityDepartmentID.setValue(null),this.assignedTestGroupList$.next([]),this.availableTestGroupList$.next([]),this.filterAvailableTestGroupString=null,this.filterAssignedTestGroupString=null}}return(r=l).\u0275fac=function(t){return new(t||r)(e.Y36(b.D),e.Y36(f.k),e.Y36(v.c),e.Y36(C.$))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-user-test-group-mapping"]],decls:52,vars:42,consts:[[1,"container-fluid"],[1,"row"],["childLink","Administration","subchildLink","User Test Group Mapping"],[1,"mat-elevation-z12","lms-mapping-master-card"],[1,"row","user-test-group-sticky-header"],[1,"col-6","col-lg-3","col-md-3"],["customClass","mapping-dropdown",3,"dropdownFor","isRequired","records","formControlsName","idForSelect","dropdownChangeEvent"],[1,"col-6","col-lg-2","col-md-2"],[1,"btn","btn-primary","btn-dimension",3,"disabled","click"],[1,"btn","btn-danger","btn-dimension",3,"disabled","click"],[1,"col-6"],[1,"col-12"],[1,"row","mapping-search-filter"],["appearance","outline",1,"mapping-dropdown"],["matInput","","type","text","placeholder","Search Test Group","autocomplete","off",3,"value","disabled","keyup"],[1,"col-12","lms-dragdrop-container"],["cdkDropList","",1,"example-list",3,"cdkDropListData","cdkDropListConnectedTo","cdkDropListDropped"],["availableTestGroup","cdkDropList"],["class","example-box","cdkDrag","",4,"ngFor","ngForOf"],["assignedTestGroup","cdkDropList"],["cdkDrag","",1,"example-box"]],template:function(t,i){if(1&t&&(e._UZ(0,"app-header"),e.TgZ(1,"div",0)(2,"div",1),e._UZ(3,"app-breadcrumb",2),e.qZA(),e._UZ(4,"br"),e.TgZ(5,"mat-card",3)(6,"div",4)(7,"div",5)(8,"app-lms-select",6),e.NdJ("dropdownChangeEvent",function(a){return i.onChangeOfDropdown(a)}),e.qZA()(),e.TgZ(9,"div",5)(10,"app-lms-select",6),e.NdJ("dropdownChangeEvent",function(a){return i.onChangeOfDropdown(a)}),e.qZA()(),e.TgZ(11,"div",7)(12,"button",8),e.NdJ("click",function(){return i.assignUserTestGroup()}),e._uU(13," Submit "),e.qZA()(),e.TgZ(14,"div",7)(15,"button",9),e.NdJ("click",function(){return i.resetAllParameter()}),e._uU(16," Reset All "),e.qZA()()(),e.TgZ(17,"div",1)(18,"div",10)(19,"div",1)(20,"div",11)(21,"div",12)(22,"div"),e._uU(23,"Available Test Group"),e.qZA(),e.TgZ(24,"mat-form-field",13)(25,"mat-label"),e._uU(26,"Search Available Test Group"),e.qZA(),e.TgZ(27,"input",14),e.NdJ("keyup",function(a){return i.filterAvailableTestGroupString=a.target.value}),e.qZA()()()(),e.TgZ(28,"div",15)(29,"div",16,17),e.NdJ("cdkDropListDropped",function(a){return i.drop(a)}),e.ALo(31,"cdkFilterList"),e.YNc(32,ue,2,1,"div",18),e.ALo(33,"cdkFilterList"),e.ALo(34,"async"),e.qZA()()()(),e.TgZ(35,"div",10)(36,"div",1)(37,"div",11)(38,"div",12)(39,"div"),e._uU(40,"Assigned Test Group"),e.qZA(),e.TgZ(41,"mat-form-field",13)(42,"mat-label"),e._uU(43,"Search Assigned Test Group"),e.qZA(),e.TgZ(44,"input",14),e.NdJ("keyup",function(a){return i.filterAssignedTestGroupString=a.target.value}),e.qZA()()()(),e.TgZ(45,"div",15)(46,"div",16,19),e.NdJ("cdkDropListDropped",function(a){return i.drop(a)}),e.ALo(48,"cdkFilterList"),e.YNc(49,ce,2,1,"div",18),e.ALo(50,"cdkFilterList"),e.ALo(51,"async"),e.qZA()()()()()()()),2&t){const n=e.MAs(30),a=e.MAs(47);e.xp6(8),e.Q6J("dropdownFor","Employee")("isRequired",!0)("records",i.employeeList$)("formControlsName",i.entityEmployeeID)("idForSelect","role-tab-1"),e.xp6(2),e.Q6J("dropdownFor","Department")("isRequired",!0)("records",i.departmentList$)("formControlsName",i.entityDepartmentID)("idForSelect","role-tab-1"),e.xp6(2),e.Q6J("disabled",0===i.assignedTestGroupList$.getValue().length),e.xp6(3),e.Q6J("disabled",i.entityEmployeeID.invalid),e.xp6(12),e.Q6J("value",i.filterAvailableTestGroupString)("disabled",0===i.availableTestGroupList$.getValue().length),e.xp6(2),e.Q6J("cdkDropListData",e.xi3(31,22,i.availableTestGroupList$.getValue(),i.filterAvailableTestGroupString))("cdkDropListConnectedTo",e.VKq(38,z,a)),e.xp6(3),e.Q6J("ngForOf",e.xi3(33,25,e.lcZ(34,28,i.availableTestGroupList$),i.filterAvailableTestGroupString)),e.xp6(12),e.Q6J("value",i.filterAssignedTestGroupString)("disabled",0===i.assignedTestGroupList$.getValue().length),e.xp6(2),e.Q6J("cdkDropListData",e.xi3(48,30,i.assignedTestGroupList$.getValue(),i.filterAssignedTestGroupString))("cdkDropListConnectedTo",e.VKq(40,z,n)),e.xp6(3),e.Q6J("ngForOf",e.xi3(50,33,e.lcZ(51,36,i.assignedTestGroupList$),i.filterAssignedTestGroupString))}},dependencies:[D.sg,S.G,k.P,J.Wj,J.Zt,d.a8,x.Nt,y.KE,y.hX,I.L,D.Ov,le.q],styles:[".lms-mapping-master-card[_ngcontent-%COMP%]{width:96vw;display:inline-block;left:1%;top:10px;height:auto;max-height:80vh;overflow:hidden}@media (max-width: 766px){.lms-mapping-master-card[_ngcontent-%COMP%]{width:90vw}}.lms-dragdrop-container[_ngcontent-%COMP%]{overflow-y:auto;height:auto;max-height:62vh}@media (max-width: 766px){.lms-dragdrop-container[_ngcontent-%COMP%]{max-height:42vh}}.example-list[_ngcontent-%COMP%]{border:solid 1px #ccc;min-height:60px;background:white;border-radius:4px;overflow:hidden;display:block}.example-box[_ngcontent-%COMP%]{padding:20px 10px;border-bottom:solid 1px #ccc;color:#000000de;display:flex;flex-direction:row;align-items:center;justify-content:space-between;box-sizing:border-box;cursor:move;background:white;font-size:14px}.cdk-drag-preview[_ngcontent-%COMP%]{box-sizing:border-box;border-radius:4px;box-shadow:0 5px 5px -3px #0003,0 8px 10px 1px #00000024,0 3px 14px 2px #0000001f}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:0}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}.example-box[_ngcontent-%COMP%]:last-child{border:none}.example-list.cdk-drop-list-dragging[_ngcontent-%COMP%]   .example-box[_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform .25s cubic-bezier(0,0,.2,1)}.btn-dimension[_ngcontent-%COMP%]{width:100%;margin:3px}.mapping-search-filter[_ngcontent-%COMP%]{flex-direction:row;justify-content:space-around;align-items:center}@media (max-width: 766px){.mapping-search-filter[_ngcontent-%COMP%]{flex-direction:column}}"]}),l})();var F=h(8),A=h(8645),N=h(7270),_=h(2296),w=h(2599);let de=(()=>{var r;class l{constructor(t,i,n,a,s){this.loader=t,this.authService=i,this.masterService=n,this.exportService=a,this.toastrService=s,this.bloodGroupList$=new p.X([]),this.inlineEditFlag=!0,this.showLogCheckedFlag=!1,this.gridOptions=new F.s8,this.changeDetection=new A.x,this.disableToggleFlag=!1}ngOnInit(){this.getBloodGroupList(!1).then(t=>{this.bloodGroupList$.next(t)}).catch(t=>{this.bloodGroupList$.next([]),this.toastrService.show({type:"error",text:t})}),this.gridOptions={searchPlaceholder:"Search Blood Group",pageSize:this.authService.pageSize,dateFormat:"yyyy-MM-dd",keyCodeForNextCell:13,showInlineEdit:this.inlineEditFlag,titleForMobileView:"entityBusinessName",pageSizeArray:[5,10,20],showDeleteButton:!1,showAddButton:!0,showEditButton:!0,showActivateDeactivateButton:!0,showSearchInput:!0,activateDeactivateCondition:{conditionalProperty:"activeFlag",valueForActivation:"1",valueForDeactivation:"0"},columns:[{name:"entityBusinessName",label:"Blood Group",enable:!0,searchable:!0,sortable:!0,type:"text",editable:!0,isRequired:!0,shouldBeUnique:!0,min:1,max:100,pattern:"[^]*",columnPlaceholder:"Blood Group",requiredLabel:"Please enter Blood Groupuntry",patternLabel:"Please match the requested format."},{name:"entityBusinessShortCode",label:"Abbreviation",enable:!0,searchable:!0,sortable:!0,type:"text",editable:!0,isRequired:!0,shouldBeUnique:!0,min:1,max:10,pattern:"[^]*",columnPlaceholder:"Abbreviation",requiredLabel:"Please enter abbreviation",patternLabel:"Please match the requested format."},{name:"createdByUser",label:"Last Updated By",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"effectiveDateFrom",label:"Last Modified on",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"activeFlag",label:"",enable:!1,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"entityID",label:"",enable:!1,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"entityBusinessID",label:"",enable:!1,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1}]}}getBloodGroupList(t){return new Promise((i,n)=>{this.loader.showSpinner("Blood Group on the way."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W",detailFlag:t,dropDown:!1}},"bloodgroupservice/getAllBloodGroup/").subscribe(s=>{this.loader.hideSpinner(),"200"===s.statusCode||"300"===s.statusCode?(s.responseList=null==s.responseList?[]:s.responseList,i(s.responseList)):n(s.errorMessage)},s=>{this.loader.hideSpinner(),n("Either Internet is not working or some internal server issue")})})}exportData(t){const i=[{property:"entityBusinessName",label:"Blood Group"},{property:"entityBusinessShortCode",label:"Abbreviation"},{property:"createdByUser",label:"Last Updated By"},{property:"effectiveDateFrom",label:"Last Modified on"}];this.showLogCheckedFlag&&i.push({property:"auditAction",label:"Audit Action"}),this.exportService.generateFile(this.bloodGroupList$.getValue(),"Blood Group List."+t,i)}showLog(t){this.bloodGroupList$.next([]),t?this.getBloodGroupList(!0).then(i=>{this.showLogCheckedFlag=!0,this.bloodGroupList$.next(i),this.gridOptions.showAddButton=!1,this.gridOptions.showEditButton=!1,this.gridOptions.showActivateDeactivateButton=!1,this.gridOptions.columns.push({name:"auditAction",label:"Audit Action",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1})}).catch(i=>{this.bloodGroupList$.next([]),this.toastrService.show({type:"error",text:i})}):(this.showLogCheckedFlag=!1,this.ngOnInit())}actionButtonClickEvent(t,i){switch(i){case"add":case"update":this.disableToggleFlag=!0,this.gridOptions.showActivateDeactivateButton=!1;break;case"cancel":this.disableToggleFlag=!1,this.gridOptions.showActivateDeactivateButton=!0}}addNewBloodGroup(t){this.masterService.requestActionRestAPI(t,{genericManipulationRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,entityBusinessName:t.entityBusinessName,entityBusinessShortCode:t.entityBusinessShortCode,auditAction:"C",mode:"W"}},"bloodgroupservice/createBGEntity/","Adding ").then(n=>{this.changeDetection.next({originalObject:t,modifiedObject:n}),this.toastrService.show({type:"success",text:t.entityBusinessName+" Added!"}),this.disableToggleFlag=!1,this.gridOptions.showActivateDeactivateButton=!0}).catch(n=>{this.toastrService.show({type:"error",text:n})})}updateBloodGroup(t){this.masterService.requestActionRestAPI(t,{genericManipulationRequestEntity:{entityID:t.entityID,entityBusinessID:t.entityBusinessID,entityBusinessName:t.entityBusinessName,entityBusinessShortCode:t.entityBusinessShortCode,auditAction:"U",companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W"}},"bloodgroupservice/updateBGEntity/","Updating ").then(n=>{this.changeDetection.next({originalObject:t,modifiedObject:n}),this.toastrService.show({type:"success",text:t.entityBusinessName+" Updated!"}),this.disableToggleFlag=!1,this.gridOptions.showActivateDeactivateButton=!0}).catch(n=>{this.changeDetection.next({originalObject:t,modifiedObject:void 0}),this.disableToggleFlag=!0,this.gridOptions.showActivateDeactivateButton=!1,this.toastrService.show({type:"error",text:n})})}activateBloodGroup(t){this.masterService.requestActionRestAPI(t,{genericManipulationRequestEntity:{entityID:t.entityID,entityBusinessID:t.entityBusinessID,entityBusinessName:t.entityBusinessName,entityBusinessShortCode:t.entityBusinessShortCode,auditAction:"A",companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W"}},"bloodgroupservice/activateBGEntity","Activating ").then(n=>{this.changeDetection.next({originalObject:t,modifiedObject:n}),this.toastrService.show({type:"success",text:t.entityBusinessName+" Activated!"})}).catch(n=>{this.changeDetection.next({originalObject:t,modifiedObject:void 0}),this.toastrService.show({type:"error",text:n})})}deactivateBloodGroup(t){this.masterService.requestActionRestAPI(t,{genericManipulationRequestEntity:{entityID:t.entityID,entityBusinessID:t.entityBusinessID,entityBusinessName:t.entityBusinessName,entityBusinessShortCode:t.entityBusinessShortCode,auditAction:"D",companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W"}},"bloodgroupservice/deactivateBGEntity","Deactivating ").then(n=>{this.changeDetection.next({originalObject:t,modifiedObject:n}),this.toastrService.show({type:"success",text:t.entityBusinessName+" Deactivated!"})}).catch(n=>{this.changeDetection.next({originalObject:t,modifiedObject:void 0}),this.toastrService.show({type:"error",text:n})})}}return(r=l).\u0275fac=function(t){return new(t||r)(e.Y36(b.D),e.Y36(C.$),e.Y36(v.c),e.Y36(N.u),e.Y36(f.k))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-blood-group"]],decls:14,vars:4,consts:[[1,"container-fluid"],[1,"row"],["childLink","General Master","subchildLink","Blood Group"],[1,"mat-elevation-z12","lms-master-card"],[1,"lms-matcardtitlegroup"],["mat-icon-button","",3,"disableRipple","click"],["aria-label","excel",1,"lms-excel-icon"],["aria-label","csv",1,"lms-csv-icon"],[1,"remaining-space"],["color","primary",1,"lms-matslidetoggle",3,"checked","disabled","change"]],template:function(t,i){1&t&&(e._UZ(0,"app-header"),e.TgZ(1,"div",0)(2,"div",1),e._UZ(3,"app-breadcrumb",2),e.qZA(),e.TgZ(4,"div",1)(5,"mat-card",3)(6,"mat-card-title-group",4)(7,"button",5),e.NdJ("click",function(){return i.exportData("xlsx")}),e._UZ(8,"div",6),e.qZA(),e.TgZ(9,"button",5),e.NdJ("click",function(){return i.exportData("csv")}),e._UZ(10,"div",7),e.qZA(),e._UZ(11,"span",8),e.TgZ(12,"mat-slide-toggle",9),e.NdJ("change",function(a){return i.showLog(a.checked)}),e._uU(13," Show Logs "),e.qZA()()()()()),2&t&&(e.xp6(7),e.Q6J("disableRipple",!0),e.xp6(2),e.Q6J("disableRipple",!0),e.xp6(3),e.Q6J("checked",i.showLogCheckedFlag)("disabled",i.disableToggleFlag))},dependencies:[S.G,_.RK,d.a8,d.C1,w.Rr,I.L]}),l})(),me=(()=>{var r;class l{constructor(t,i,n,a,s){this.loader=t,this.authService=i,this.masterService=n,this.exportService=a,this.toastrService=s,this.categoryList$=new p.X([]),this.inlineEditFlag=!0,this.showLogCheckedFlag=!1,this.gridOptions=new F.s8,this.changeDetection=new A.x,this.disableToggleFlag=!1}ngOnInit(){this.getCategoryList(!1).then(t=>{this.categoryList$.next(t)}).catch(t=>{this.categoryList$.next([]),this.toastrService.show({type:"error",text:t})}),this.gridOptions={searchPlaceholder:"Search Category",pageSize:this.authService.pageSize,dateFormat:"yyyy-MM-dd",keyCodeForNextCell:13,showInlineEdit:this.inlineEditFlag,titleForMobileView:"entityBusinessName",pageSizeArray:[5,10,20],showDeleteButton:!1,showAddButton:!0,showEditButton:!0,showActivateDeactivateButton:!0,showSearchInput:!0,activateDeactivateCondition:{conditionalProperty:"activeFlag",valueForActivation:"1",valueForDeactivation:"0"},columns:[{name:"entityBusinessName",label:"Category",enable:!0,searchable:!0,sortable:!0,type:"text",editable:!0,isRequired:!0,shouldBeUnique:!0,min:1,max:100,pattern:"[^]*",columnPlaceholder:"Category Name",requiredLabel:"Please enter category",patternLabel:"Please match the requested format."},{name:"entityBusinessShortCode",label:"Abbreviation",enable:!0,searchable:!0,sortable:!0,type:"text",editable:!0,isRequired:!0,shouldBeUnique:!0,min:3,max:10,pattern:"[^]{3,10} *",columnPlaceholder:"Abbreviation",requiredLabel:"Please enter abbreviation",patternLabel:"Length must greater than 2"},{name:"createdByUser",label:"Last Updated By",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"effectiveDateFrom",label:"Last Modified on",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"activeFlag",label:"",enable:!1,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"entityID",label:"",enable:!1,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"entityBusinessID",label:"",enable:!1,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1}]}}getCategoryList(t){return new Promise((i,n)=>{this.loader.showSpinner("Category list on the way."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W",detailFlag:t,dropDown:!1}},"categoryservice/getAllCategory/").subscribe(s=>{this.loader.hideSpinner(),"200"===s.statusCode||"300"===s.statusCode?(s.responseList=null==s.responseList?[]:s.responseList,i(s.responseList)):n(s.errorMessage)},s=>{this.loader.hideSpinner(),n("Either Internet is not working or some internal server issue")})})}exportData(t){const i=[{property:"entityBusinessName",label:"Category"},{property:"entityBusinessShortCode",label:"Abbreviation"},{property:"createdByUser",label:"Last Updated By"},{property:"effectiveDateFrom",label:"Last Modified on"}];this.showLogCheckedFlag&&i.push({property:"auditAction",label:"Audit Action"}),this.exportService.generateFile(this.categoryList$.getValue(),"Category List."+t,i)}showLog(t){this.categoryList$.next([]),t?this.getCategoryList(!0).then(i=>{this.showLogCheckedFlag=!0,this.categoryList$.next(i),this.gridOptions.showAddButton=!1,this.gridOptions.showEditButton=!1,this.gridOptions.showActivateDeactivateButton=!1,this.gridOptions.columns.push({name:"auditAction",label:"Audit Action",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1})}).catch(i=>{this.categoryList$.next([]),this.toastrService.show({type:"error",text:i})}):(this.showLogCheckedFlag=!1,this.ngOnInit())}addNewCategory(t){this.masterService.requestActionRestAPI(t,{genericManipulationRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,entityBusinessName:t.entityBusinessName,entityBusinessShortCode:t.entityBusinessShortCode,auditAction:"C",mode:"W"}},"categoryservice/createEntity/","Adding ").then(n=>{this.changeDetection.next({originalObject:t,modifiedObject:n}),this.toastrService.show({type:"success",text:t.entityBusinessName+" Added!"}),this.disableToggleFlag=!1,this.gridOptions.showActivateDeactivateButton=!0}).catch(n=>{this.changeDetection.next({originalObject:t,modifiedObject:void 0}),this.disableToggleFlag=!0,this.gridOptions.showActivateDeactivateButton=!1,this.toastrService.show({type:"error",text:n})})}updateCategory(t){this.masterService.requestActionRestAPI(t,{genericManipulationRequestEntity:{entityID:t.entityID,entityBusinessID:t.entityBusinessID,entityBusinessName:t.entityBusinessName,entityBusinessShortCode:t.entityBusinessShortCode,auditAction:"U",companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W"}},"categoryservice/updateEntity/","Updating ").then(n=>{this.changeDetection.next({originalObject:t,modifiedObject:n}),this.toastrService.show({type:"success",text:t.entityBusinessName+" Updated!"}),this.disableToggleFlag=!1,this.gridOptions.showActivateDeactivateButton=!0}).catch(n=>{this.changeDetection.next({originalObject:t,modifiedObject:void 0}),this.disableToggleFlag=!0,this.gridOptions.showActivateDeactivateButton=!1,this.toastrService.show({type:"error",text:n})})}actionButtonClickEvent(t,i){switch(i){case"add":case"update":this.disableToggleFlag=!0,this.gridOptions.showActivateDeactivateButton=!1;break;case"cancel":this.disableToggleFlag=!1,this.gridOptions.showActivateDeactivateButton=!0}}activateCategory(t){this.masterService.requestActionRestAPI(t,{genericManipulationRequestEntity:{entityID:t.entityID,entityBusinessID:t.entityBusinessID,entityBusinessName:t.entityBusinessName,entityBusinessShortCode:t.entityBusinessShortCode,auditAction:"A",companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W"}},"categoryservice/activateEntity/","Activating ").then(n=>{this.changeDetection.next({originalObject:t,modifiedObject:n}),this.toastrService.show({type:"success",text:t.entityBusinessName+" Activated!"})}).catch(n=>{this.changeDetection.next({originalObject:t,modifiedObject:void 0}),this.toastrService.show({type:"error",text:n})})}deactivateCategory(t){this.masterService.requestActionRestAPI(t,{genericManipulationRequestEntity:{entityID:t.entityID,entityBusinessID:t.entityBusinessID,entityBusinessName:t.entityBusinessName,entityBusinessShortCode:t.entityBusinessShortCode,auditAction:"D",companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W"}},"categoryservice/deactivateEntity/","Deactivating ").then(n=>{this.changeDetection.next({originalObject:t,modifiedObject:n}),this.toastrService.show({type:"success",text:t.entityBusinessName+" Deactivated!"})}).catch(n=>{this.changeDetection.next({originalObject:t,modifiedObject:void 0}),this.toastrService.show({type:"error",text:n})})}}return(r=l).\u0275fac=function(t){return new(t||r)(e.Y36(b.D),e.Y36(C.$),e.Y36(v.c),e.Y36(N.u),e.Y36(f.k))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-category"]],decls:14,vars:4,consts:[[1,"container-fluid"],[1,"row"],["childLink","General Master","subchildLink","Category"],[1,"mat-elevation-z12","lms-master-card"],[1,"lms-matcardtitlegroup"],["mat-icon-button","",3,"disableRipple","click"],["aria-label","excel",1,"lms-excel-icon"],["aria-label","csv",1,"lms-csv-icon"],[1,"remaining-space"],["color","primary",1,"lms-matslidetoggle",3,"checked","disabled","change"]],template:function(t,i){1&t&&(e._UZ(0,"app-header"),e.TgZ(1,"div",0)(2,"div",1),e._UZ(3,"app-breadcrumb",2),e.qZA(),e.TgZ(4,"div",1)(5,"mat-card",3)(6,"mat-card-title-group",4)(7,"button",5),e.NdJ("click",function(){return i.exportData("xlsx")}),e._UZ(8,"div",6),e.qZA(),e.TgZ(9,"button",5),e.NdJ("click",function(){return i.exportData("csv")}),e._UZ(10,"div",7),e.qZA(),e._UZ(11,"span",8),e.TgZ(12,"mat-slide-toggle",9),e.NdJ("change",function(a){return i.showLog(a.checked)}),e._uU(13," Show Logs "),e.qZA()()()()()),2&t&&(e.xp6(7),e.Q6J("disableRipple",!0),e.xp6(2),e.Q6J("disableRipple",!0),e.xp6(3),e.Q6J("checked",i.showLogCheckedFlag)("disabled",i.disableToggleFlag))},dependencies:[S.G,_.RK,d.a8,d.C1,w.Rr,I.L]}),l})(),he=(()=>{var r;class l{constructor(t,i,n,a,s){this.loader=t,this.toastrService=i,this.masterService=n,this.exportService=a,this.authService=s,this.citiesList$=new p.X([]),this.inlineEditFlag=!0,this.showLogCheckedFlag=!1,this.gridOptions=new F.s8,this.changeDetection=new A.x,this.disableToggleFlag=!1}ngOnInit(){this.getcitiesList(!1).then(t=>{this.citiesList$.next(t)}).catch(t=>{this.citiesList$.next([]),this.toastrService.show({type:"error",text:t})}),this.gridOptions={searchPlaceholder:"Search City",pageSize:this.authService.pageSize,dateFormat:"yyyy-MM-dd",keyCodeForNextCell:13,showInlineEdit:this.inlineEditFlag,titleForMobileView:"entityBusinessName",pageSizeArray:[5,10,20],showDeleteButton:!1,showAddButton:!0,showEditButton:!0,showActivateDeactivateButton:!0,showSearchInput:!0,activateDeactivateCondition:{conditionalProperty:"activeFlag",valueForActivation:"1",valueForDeactivation:"0"},columns:[{name:"entitySuperParentBusinessID",label:"Country Name",enable:!0,searchable:!1,sortable:!1,type:"select",selectionList:{data:[],key:"entityBusinessID",value:"entityBusinessName"},dropdownSelectedValue:"entitySuperParentBusinessName",editable:!0,isRequired:!0,columnPlaceholder:"Choose Country",requiredLabel:"Please choose country"},{name:"entityParentBusinessID",label:"State Name",enable:!0,searchable:!1,sortable:!1,type:"select",selectionList:{data:[],key:"entityBusinessID",value:"entityBusinessName"},dropdownSelectedValue:"entityParentBusinessName",editable:!0,isRequired:!0,columnPlaceholder:"Choose State",requiredLabel:"Please choose state"},{name:"entityBusinessName",label:"City Name",enable:!0,searchable:!0,sortable:!0,type:"text",editable:!0,isRequired:!0,shouldBeUnique:!0,min:1,max:100,pattern:"[A-Za-z ]*",columnPlaceholder:"City Name",requiredLabel:"Please enter city",patternLabel:"Please match the requested format."},{name:"entityBusinessShortCode",label:"Abbreviation",enable:!0,searchable:!0,sortable:!0,type:"text",editable:!0,isRequired:!0,shouldBeUnique:!0,min:1,max:100,pattern:"[A-Za-z ]*",columnPlaceholder:"Abbreviation",requiredLabel:"Please enter abbreviation",patternLabel:"Please match the requested format."},{name:"createdByUser",label:"Last Updated By",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"effectiveDateFrom",label:"Created On",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"activeFlag",label:"",enable:!1,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"entityID",label:"",enable:!1,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"entityBusinessID",label:"",enable:!1,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"entitySuperParentBusinessName",label:"",enable:!1,searchable:!0,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"entityParentBusinessName",label:"",enable:!1,searchable:!0,sortable:!1,type:"text",editable:!1,isRequired:!1}]}}ngOnDestroy(){this.countryListSubscription&&this.countryListSubscription.unsubscribe(),this.stateListSubscription&&this.stateListSubscription.unsubscribe(),this.cityListSubscription&&this.cityListSubscription.unsubscribe()}getCountryList(t=!1){return new Promise((i,n)=>{this.loader.showSpinner("Loading..."),this.countryListSubscription=this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,entityBusinessID:null,mode:"W",detailFlag:t,dropDown:!0}},"countryservice/getAllCountry").subscribe(s=>{this.loader.hideSpinner(),"200"===s.statusCode||"300"===s.statusCode?(s.responseList=null==s.responseList?[]:s.responseList,i(s.responseList)):n(s.errorMessage)},s=>{this.loader.hideSpinner(),n("Either Internet is not working or facing internal server issue")})})}getStatesList(t,i=!1){return new Promise((n,a)=>{this.loader.showSpinner("Loading..."),this.stateListSubscription=this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,entityBusinessID:t,mode:"W",detailFlag:i,dropDown:!0}},"stateservice/getAllState/").subscribe(u=>{this.loader.hideSpinner(),"200"===u.statusCode||"300"===u.statusCode?(u.responseList=null==u.responseList?[]:u.responseList,n(u.responseList)):a(u.errorMessage)},u=>{this.loader.hideSpinner(),a("Either Internet is not working or facing internal server issue")})})}getcitiesList(t){return new Promise((i,n)=>{this.loader.showSpinner("City list on the way!"),this.cityListSubscription=this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W",detailFlag:t,dropDown:!1}},"cityservice/getAllCity/").subscribe(s=>{this.loader.hideSpinner(),"200"===s.statusCode||"300"===s.statusCode?(s.responseList=null==s.responseList?[]:s.responseList,i(s.responseList)):n(s.errorMessage)},s=>{this.loader.hideSpinner(),n("Either Internet is not working or facing internal server issue")})})}exportData(t){const i=[{property:"entitySuperParentBusinessName",label:"Country Name"},{property:"entityParentBusinessName",label:"State Name"},{property:"entityBusinessName",label:"City Name"},{property:"entityBusinessShortCode",label:"Abbreviation"},{property:"createdByUser",label:"Last Updated By"},{property:"effectiveDateFrom",label:"Last Modified on"}];this.showLogCheckedFlag&&i.push({property:"auditAction",label:"Audit Action"}),this.exportService.generateFile(this.citiesList$.getValue(),"City List."+t,i)}showLog(t){this.citiesList$.next([]),t?this.getcitiesList(!0).then(i=>{this.showLogCheckedFlag=!0,this.citiesList$.next(i),this.gridOptions.showAddButton=!1,this.gridOptions.showEditButton=!1,this.gridOptions.showActivateDeactivateButton=!1,this.gridOptions.columns.push({name:"auditAction",label:"Audit Action",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1})}).catch(i=>{this.citiesList$.next([]),this.toastrService.show({type:"error",text:i})}):(this.showLogCheckedFlag=!1,this.ngOnInit())}onChangeOfDropdown(t){"entitySuperParentBusinessID"===t.column&&this.getStatesList(t.selectedRow[t.column],"Update"===t.selectedRow.actionType).then(n=>{this.gridOptions.columns.find(a=>"entityParentBusinessID"===a.name).selectionList.data=n,this.changeDetection.next("Fetched State")}).catch(n=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}initiateAddCity(t){this.actionButtonClickEvent(null,"add"),null===t?alert("Custom code goes here"):this.getCountryList(!1).then(i=>{this.gridOptions.columns.find(n=>"entitySuperParentBusinessID"===n.name).selectionList.data=i,this.changeDetection.next("Fetched Country")}).catch(i=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}initiateUpdateCity(t){this.actionButtonClickEvent(null,"update"),this.inlineEditFlag?this.getCountryList(!0).then(i=>{this.gridOptions.columns.find(n=>"entitySuperParentBusinessID"===n.name).selectionList.data=i,this.changeDetection.next("Fetched Country"),this.getStatesList(t.entitySuperParentBusinessID,!0).then(n=>{this.gridOptions.columns.find(a=>"entityParentBusinessID"===a.name).selectionList.data=n,this.changeDetection.next("Fetched State")}).catch(n=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}).catch(i=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})}):alert("Custom code goes here")}actionButtonClickEvent(t,i){switch(i){case"add":case"update":this.disableToggleFlag=!0,this.gridOptions.showActivateDeactivateButton=!1;break;case"cancel":this.disableToggleFlag=!1,this.gridOptions.showActivateDeactivateButton=!0}}addNewCity(t){this.masterService.requestActionRestAPI(t,{genericChildManipulationRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,entityBusinessName:t.entityBusinessName,entityBusinessShortCode:t.entityBusinessShortCode,entityParentBusinessID:t.entityParentBusinessID,entitySuperParentBusinessID:t.entitySuperParentBusinessID,auditAction:"C",mode:"W"}},"cityservice/createSuperChildEntity/","Adding ").then(n=>{this.changeDetection.next({originalObject:t,modifiedObject:n}),this.toastrService.show({type:"success",text:t.entityBusinessName+" Added!"}),this.disableToggleFlag=!1,this.gridOptions.showActivateDeactivateButton=!0}).catch(n=>{this.changeDetection.next({originalObject:t,modifiedObject:void 0}),this.disableToggleFlag=!0,this.gridOptions.showActivateDeactivateButton=!1,this.toastrService.show({type:"error",text:n})})}updateCity(t){this.masterService.requestActionRestAPI(t,{genericChildManipulationRequestEntity:{entityID:t.entityID,entityBusinessID:t.entityBusinessID,entityBusinessName:t.entityBusinessName,entityBusinessShortCode:t.entityBusinessShortCode,entityParentBusinessID:t.entityParentBusinessID,entitySuperParentBusinessID:t.entitySuperParentBusinessID,auditAction:"U",companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W"}},"cityservice/updateSuperChildEntity/","Updating ").then(n=>{this.changeDetection.next({originalObject:t,modifiedObject:n}),this.toastrService.show({type:"success",text:t.entityBusinessName+" Updated!"}),this.disableToggleFlag=!1,this.gridOptions.showActivateDeactivateButton=!0}).catch(n=>{this.changeDetection.next({originalObject:t,modifiedObject:void 0}),this.disableToggleFlag=!0,this.gridOptions.showActivateDeactivateButton=!1,this.toastrService.show({type:"error",text:n})})}activateCity(t){this.masterService.requestActionRestAPI(t,{genericChildManipulationRequestEntity:{entityID:t.entityID,entityBusinessID:t.entityBusinessID,entityBusinessName:t.entityBusinessName,entityBusinessShortCode:t.entityBusinessShortCode,entityParentBusinessID:t.entityParentBusinessID,entitySuperParentBusinessID:t.entitySuperParentBusinessID,auditAction:"A",companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W"}},"cityservice/activateSuperChildEntity","Activating ").then(n=>{this.changeDetection.next({originalObject:t,modifiedObject:n}),this.toastrService.show({type:"success",text:t.entityBusinessName+" Activated!"})}).catch(n=>{this.changeDetection.next({originalObject:t,modifiedObject:void 0}),this.toastrService.show({type:"error",text:n})})}deactivateCity(t){this.masterService.requestActionRestAPI(t,{genericChildManipulationRequestEntity:{entityID:t.entityID,entityBusinessID:t.entityBusinessID,entityBusinessName:t.entityBusinessName,entityBusinessShortCode:t.entityBusinessShortCode,entityParentBusinessID:t.entityParentBusinessID,entitySuperParentBusinessID:t.entitySuperParentBusinessID,auditAction:"D",companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W"}},"cityservice/deactivateSuperChildEntity","Deactivating ").then(n=>{this.changeDetection.next({originalObject:t,modifiedObject:n}),this.toastrService.show({type:"success",text:t.entityBusinessName+" Deactivated!"})}).catch(n=>{this.changeDetection.next({originalObject:t,modifiedObject:void 0}),this.toastrService.show({type:"error",text:n})})}}return(r=l).\u0275fac=function(t){return new(t||r)(e.Y36(b.D),e.Y36(f.k),e.Y36(v.c),e.Y36(N.u),e.Y36(C.$))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-cities"]],decls:14,vars:4,consts:[[1,"container-fluid"],[1,"row"],["childLink","General Master","subchildLink","City"],[1,"mat-elevation-z12","lms-master-card"],[1,"lms-matcardtitlegroup"],["mat-icon-button","",3,"disableRipple","click"],["aria-label","excel",1,"lms-excel-icon"],["aria-label","csv",1,"lms-csv-icon"],[1,"remaining-space"],["color","primary",1,"lms-matslidetoggle",3,"checked","disabled","change"]],template:function(t,i){1&t&&(e._UZ(0,"app-header"),e.TgZ(1,"div",0)(2,"div",1),e._UZ(3,"app-breadcrumb",2),e.qZA(),e.TgZ(4,"div",1)(5,"mat-card",3)(6,"mat-card-title-group",4)(7,"button",5),e.NdJ("click",function(){return i.exportData("xlsx")}),e._UZ(8,"div",6),e.qZA(),e.TgZ(9,"button",5),e.NdJ("click",function(){return i.exportData("csv")}),e._UZ(10,"div",7),e.qZA(),e._UZ(11,"span",8),e.TgZ(12,"mat-slide-toggle",9),e.NdJ("change",function(a){return i.showLog(a.checked)}),e._uU(13," Show Logs "),e.qZA()()()()()),2&t&&(e.xp6(7),e.Q6J("disableRipple",!0),e.xp6(2),e.Q6J("disableRipple",!0),e.xp6(3),e.Q6J("checked",i.showLogCheckedFlag)("disabled",i.disableToggleFlag))},dependencies:[S.G,_.RK,d.a8,d.C1,w.Rr,I.L]}),l})(),ye=(()=>{var r;class l{constructor(t,i,n,a,s){this.loader=t,this.authService=i,this.masterService=n,this.exportService=a,this.toastrService=s,this.clubMasterList$=new p.X([]),this.inlineEditFlag=!0,this.showLogCheckedFlag=!1,this.gridOptions=new F.s8,this.changeDetection=new A.x,this.disableToggleFlag=!1}ngOnInit(){this.getClubMasterList(!1).then(t=>{this.clubMasterList$.next(t)}).catch(t=>{this.clubMasterList$.next([]),this.toastrService.show({type:"error",text:t})}),this.gridOptions={searchPlaceholder:"Search Club",pageSize:this.authService.pageSize,dateFormat:"yyyy-MM-dd",keyCodeForNextCell:13,showInlineEdit:this.inlineEditFlag,titleForMobileView:"entityBusinessName",pageSizeArray:[5,10,20],showDeleteButton:!1,showAddButton:!0,showEditButton:!0,showActivateDeactivateButton:!0,showSearchInput:!0,activateDeactivateCondition:{conditionalProperty:"activeFlag",valueForActivation:"1",valueForDeactivation:"0"},columns:[{name:"entityBusinessName",label:"Club Member",enable:!0,searchable:!0,sortable:!0,type:"text",editable:!0,isRequired:!0,shouldBeUnique:!0,min:1,max:100,pattern:"[^]*",columnPlaceholder:"Club Member",requiredLabel:"Please enter club member",patternLabel:"Please match the requested format."},{name:"entityBusinessShortCode",label:"Abbreviation",enable:!0,searchable:!0,sortable:!0,type:"text",editable:!0,isRequired:!0,shouldBeUnique:!0,min:1,max:10,pattern:"[^]*",columnPlaceholder:"Abbreviation",requiredLabel:"Please enter abbreviation",patternLabel:"Please match the requested format."},{name:"createdByUser",label:"Last Updated By",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"effectiveDateFrom",label:"Last Modified on",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"activeFlag",label:"",enable:!1,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"entityID",label:"",enable:!1,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"entityBusinessID",label:"",enable:!1,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1}]}}getClubMasterList(t){return new Promise((i,n)=>{this.loader.showSpinner("Club list on the way."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W",detailFlag:t,dropDown:!1}},"clubmemberservice/getAllClubMember/").subscribe(s=>{this.loader.hideSpinner(),"200"===s.statusCode||"300"===s.statusCode?(s.responseList=null==s.responseList?[]:s.responseList,i(s.responseList)):n(s.errorMessage)},s=>{this.loader.hideSpinner(),n("Either Internet is not working or some internal server issue")})})}exportData(t){const i=[{property:"entityBusinessName",label:"Club Member"},{property:"entityBusinessShortCode",label:"Abbreviation"},{property:"createdByUser",label:"Last Updated By"},{property:"effectiveDateFrom",label:"Last Modified on"}];this.showLogCheckedFlag&&i.push({property:"auditAction",label:"Audit Action"}),this.exportService.generateFile(this.clubMasterList$.getValue(),"Club Master List."+t,i)}showLog(t){this.clubMasterList$.next([]),t?this.getClubMasterList(!0).then(i=>{this.showLogCheckedFlag=!0,this.clubMasterList$.next(i),this.gridOptions.showAddButton=!1,this.gridOptions.showEditButton=!1,this.gridOptions.showActivateDeactivateButton=!1,this.gridOptions.columns.push({name:"auditAction",label:"Audit Action",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1})}).catch(i=>{this.clubMasterList$.next([]),this.toastrService.show({type:"error",text:i})}):(this.showLogCheckedFlag=!1,this.ngOnInit())}addNewClubMember(t){this.masterService.requestActionRestAPI(t,{genericManipulationRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,entityBusinessName:t.entityBusinessName,entityBusinessShortCode:t.entityBusinessShortCode,auditAction:"C",mode:"W"}},"clubmemberservice/createEntity/","Adding ").then(n=>{this.changeDetection.next({originalObject:t,modifiedObject:n}),this.toastrService.show({type:"success",text:t.entityBusinessName+" Added!"}),this.disableToggleFlag=!1,this.gridOptions.showActivateDeactivateButton=!0}).catch(n=>{this.changeDetection.next({originalObject:t,modifiedObject:void 0}),this.disableToggleFlag=!0,this.gridOptions.showActivateDeactivateButton=!1,this.toastrService.show({type:"error",text:n})})}updateClubMember(t){this.masterService.requestActionRestAPI(t,{genericManipulationRequestEntity:{entityID:t.entityID,entityBusinessID:t.entityBusinessID,entityBusinessName:t.entityBusinessName,entityBusinessShortCode:t.entityBusinessShortCode,auditAction:"U",companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W"}},"clubmemberservice/updateEntity/","Updating ").then(n=>{this.changeDetection.next({originalObject:t,modifiedObject:n}),this.toastrService.show({type:"success",text:t.entityBusinessName+" Updated!"}),this.disableToggleFlag=!1,this.gridOptions.showActivateDeactivateButton=!0}).catch(n=>{this.changeDetection.next({originalObject:t,modifiedObject:void 0}),this.disableToggleFlag=!0,this.gridOptions.showActivateDeactivateButton=!1,this.toastrService.show({type:"error",text:n})})}actionButtonClickEvent(t,i){switch(i){case"add":case"update":this.disableToggleFlag=!0,this.gridOptions.showActivateDeactivateButton=!1;break;case"cancel":this.disableToggleFlag=!1,this.gridOptions.showActivateDeactivateButton=!0}}activateClubMember(t){this.masterService.requestActionRestAPI(t,{genericManipulationRequestEntity:{entityID:t.entityID,entityBusinessID:t.entityBusinessID,entityBusinessName:t.entityBusinessName,entityBusinessShortCode:t.entityBusinessShortCode,auditAction:"A",companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W"}},"clubmemberservice/activateEntity/","Activating ").then(n=>{this.changeDetection.next({originalObject:t,modifiedObject:n}),this.toastrService.show({type:"success",text:t.entityBusinessName+" Activated!"})}).catch(n=>{this.changeDetection.next({originalObject:t,modifiedObject:void 0}),this.toastrService.show({type:"error",text:n})})}deactivateClubMember(t){this.masterService.requestActionRestAPI(t,{genericManipulationRequestEntity:{entityID:t.entityID,entityBusinessID:t.entityBusinessID,entityBusinessName:t.entityBusinessName,entityBusinessShortCode:t.entityBusinessShortCode,auditAction:"D",companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W"}},"clubmemberservice/deactivateEntity/","Deactivating ").then(n=>{this.changeDetection.next({originalObject:t,modifiedObject:n}),this.toastrService.show({type:"success",text:t.entityBusinessName+" Deactivated!"})}).catch(n=>{this.changeDetection.next({originalObject:t,modifiedObject:void 0}),this.toastrService.show({type:"error",text:n})})}}return(r=l).\u0275fac=function(t){return new(t||r)(e.Y36(b.D),e.Y36(C.$),e.Y36(v.c),e.Y36(N.u),e.Y36(f.k))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-club-master"]],decls:14,vars:4,consts:[[1,"container-fluid"],[1,"row"],["childLink","General Master","subchildLink","Club Master"],[1,"mat-elevation-z12","lms-master-card"],[1,"lms-matcardtitlegroup"],["mat-icon-button","",3,"disableRipple","click"],["aria-label","excel",1,"lms-excel-icon"],["aria-label","csv",1,"lms-csv-icon"],[1,"remaining-space"],["color","primary",1,"lms-matslidetoggle",3,"checked","disabled","change"]],template:function(t,i){1&t&&(e._UZ(0,"app-header"),e.TgZ(1,"div",0)(2,"div",1),e._UZ(3,"app-breadcrumb",2),e.qZA(),e.TgZ(4,"div",1)(5,"mat-card",3)(6,"mat-card-title-group",4)(7,"button",5),e.NdJ("click",function(){return i.exportData("xlsx")}),e._UZ(8,"div",6),e.qZA(),e.TgZ(9,"button",5),e.NdJ("click",function(){return i.exportData("csv")}),e._UZ(10,"div",7),e.qZA(),e._UZ(11,"span",8),e.TgZ(12,"mat-slide-toggle",9),e.NdJ("change",function(a){return i.showLog(a.checked)}),e._uU(13," Show Logs "),e.qZA()()()()()),2&t&&(e.xp6(7),e.Q6J("disableRipple",!0),e.xp6(2),e.Q6J("disableRipple",!0),e.xp6(3),e.Q6J("checked",i.showLogCheckedFlag)("disabled",i.disableToggleFlag))},dependencies:[S.G,_.RK,d.a8,d.C1,w.Rr,I.L]}),l})();var B=h(6082),Y=h(6593),M=h(5986);function ge(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Company Name is required field. "),e.qZA())}function be(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Please match the requested format. "),e.qZA())}function fe(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Company Name is already taken. "),e.qZA())}function ve(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Please match the requested format. "),e.qZA())}function Ce(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Abbreviation is already taken. "),e.qZA())}function De(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Address is required field. "),e.qZA())}function _e(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Please enter valid pin code. "),e.qZA())}function Se(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Pin Code is required field. "),e.qZA())}function Ie(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Please enter valid Company Phone. "),e.qZA())}function we(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Company Phone is required field. "),e.qZA())}function Fe(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Please enter valid email. "),e.qZA())}function Ae(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Email is required field. "),e.qZA())}function Ne(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Please enter valid Fax. "),e.qZA())}function Le(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Please enter valid website. "),e.qZA())}function Be(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Contact Person is required field. "),e.qZA())}function Te(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Please enter valid contact number. "),e.qZA())}function ke(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Contact Number is required field. "),e.qZA())}function xe(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Please enter valid email. "),e.qZA())}function Pe(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Email is required field. "),e.qZA())}function qe(r,l){if(1&r){const c=e.EpF();e.ynx(0),e.TgZ(1,"label",24),e._UZ(2,"div",25),e._uU(3," Upload Company Logo "),e.qZA(),e.TgZ(4,"input",26),e.NdJ("change",function(i){e.CHM(c);const n=e.oxw();return e.KtG(n.uploadCompanyLogo(i))}),e.qZA(),e.BQk()}}function Me(r,l){if(1&r){const c=e.EpF();e.ynx(0),e._UZ(1,"img",27),e.TgZ(2,"button",28),e.NdJ("click",function(){e.CHM(c);const i=e.oxw();return i.base64String="",e.KtG(i.safeURL="")}),e._UZ(3,"div",29),e.qZA(),e.BQk()}if(2&r){const c=e.oxw();e.xp6(1),e.Q6J("src",c.safeURL,e.LSH),e.xp6(1),e.Q6J("disableRipple",!0)}}let X=(()=>{var r;class l{constructor(t,i,n,a,s,u){this.loader=t,this.masterService=i,this.authService=n,this.fb=a,this.toastrService=s,this._sanitizer=u,this.selectedMasterData={},this.masterList=[],this.submitButtonLabel="Submit",this.countryList$=new p.X([]),this.stateList$=new p.X([]),this.cityList$=new p.X([]),this.companyList$=new p.X([]),this.base64String="",this.fetchDataOnCloseDialog$=new p.X([])}ngOnInit(){const t=this.masterList.filter(i=>0===i.entityIsChild);if(this.companyList$.next(t),this.companyForm=this.fb.group({entityIsChild:new o.NI(!1),entityParentBusinessID:new o.NI(null),entityBusinessName:new o.NI(null,[o.kI.required]),entityBusinessShortCode:new o.NI(null),entityCountry:new o.NI(null,[o.kI.required]),entityState:new o.NI(null,[o.kI.required]),entityCity:new o.NI(null,[o.kI.required]),entityAddress:new o.NI(null,[o.kI.required]),entityPinCode:new o.NI(null,[o.kI.required]),entityPhone:new o.NI(null,[o.kI.required]),entityEmail:new o.NI(null,[o.kI.required,o.kI.email]),entityFax:new o.NI(null),entityWebsite:new o.NI(null),entityGSTN:new o.NI(null),entityLatitude:new o.NI(null),entityLongitude:new o.NI(null),entityContactPersonName:new o.NI(null,[o.kI.required]),entityContactNumber:new o.NI(null,[o.kI.required]),entityContactPersonEmail:new o.NI(null,[o.kI.required,o.kI.email])}),this.updateFormControl(),null!==this.selectedMasterData){this.getCountryList().then(n=>{this.countryList$.next(n),this.getStatesList(this.selectedMasterData.entityCountry).then(a=>{this.stateList$.next(a),this.getCitiesList(this.selectedMasterData.entityState).then(s=>{this.cityList$.next(s)}).catch(s=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}).catch(a=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}).catch(n=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})});const i=Object.entries(this.companyForm.value).reduce((n,[a,s])=>(n[a]=this.selectedMasterData[a],n),{});this.companyForm.patchValue(i),this.companyForm.controls.entityIsChild.setValue(1==this.selectedMasterData.entityIsChild),null!==this.selectedMasterData.logo&&(this.base64String=this.selectedMasterData.logo,this.safeURL=this._sanitizer.bypassSecurityTrustResourceUrl("data:image/jpg;base64,"+this.base64String))}else this.getCountryList().then(i=>{this.countryList$.next(i)}).catch(i=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}get entityIsChild(){return this.companyForm.get("entityIsChild")}get entityParentBusinessID(){return this.companyForm.get("entityParentBusinessID")}updateFormControl(){this.entityIsChild.valueChanges.subscribe(t=>{t?(this.base64String="",this.companyForm.controls.entityParentBusinessID.setValidators(o.kI.required)):(this.companyForm.controls.entityParentBusinessID.setValue(null),this.companyForm.controls.entityParentBusinessID.clearValidators()),this.companyForm.updateValueAndValidity()})}getCountryList(){return new Promise((t,i)=>{this.loader.showSpinner("Loading..."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,entityBusinessID:null,mode:"W",detailFlag:null!==this.selectedMasterData,dropDown:!0}},"countryservice/getAllCountry").subscribe(a=>{this.loader.hideSpinner(),"200"===a.statusCode||"300"===a.statusCode?(a.responseList=null==a.responseList?[]:a.responseList,t(a.responseList)):i(a.errorMessage)},a=>{this.loader.hideSpinner(),i("Either Internet is not working or facing internal server issue")})})}getStatesList(t){return new Promise((i,n)=>{this.loader.showSpinner("Loading..."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,entityBusinessID:t,mode:"W",detailFlag:null!==this.selectedMasterData,dropDown:!0}},"stateservice/getAllState/").subscribe(s=>{this.loader.hideSpinner(),"200"===s.statusCode||"300"===s.statusCode?(s.responseList=null==s.responseList?[]:s.responseList,i(s.responseList)):n(s.errorMessage)},s=>{this.loader.hideSpinner(),n("Either Internet is not working or facing internal server issue")})})}getCitiesList(t){return new Promise((i,n)=>{this.loader.showSpinner("Loading..."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,entityBusinessID:t,mode:"W",detailFlag:null!==this.selectedMasterData,dropDown:!0}},"cityservice/getAllCity/").subscribe(s=>{this.loader.hideSpinner(),"200"===s.statusCode||"300"===s.statusCode?(s.responseList=null==s.responseList?[]:s.responseList,i(s.responseList)):n(s.errorMessage)},s=>{this.loader.hideSpinner(),n("Either Internet is not working or facing internal server issue")})})}keytab(t,i,n){if(13===t.keyCode){var a=t.srcElement.id.split("-").reduce((s,u)=>(Number(u)&&(u=Number(u)+1),s+"-"+u));document.getElementById(a).focus()}else this._uniqueColumnValidator(t.target.value,i,n)}_uniqueColumnValidator(t,i,n){if(n){const a=null===this.selectedMasterData?{entityBusinessID:null}:this.selectedMasterData;null!=this.masterList.find(u=>u[i].toString().trim().toLowerCase()===t.trim().toLowerCase()&&u.entityBusinessID!=a.entityBusinessID)&&this.companyForm.controls[i].setErrors({mustBeUnique:!0})}}onChangeOfDropdown(t){switch(t.type){case"Country":this.getStatesList(t.value).then(i=>{this.stateList$.next(i)}).catch(i=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})});break;case"State":this.getCitiesList(t.value).then(i=>{this.cityList$.next(i)}).catch(i=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}}uploadCompanyLogo(t){let i=t.target.files||t.srcElement.files;var n=i[0];if(parseFloat(this.calculateFileSize(n.size,2))>100)this.toastrService.show({type:"error",text:"File size should not greater than 100 kb"}),this.base64String="";else if(i&&n){var a=new FileReader;a.onload=this.loadCompanyLogo.bind(this),a.readAsBinaryString(n)}}calculateFileSize(t,i){if(0==t)return"0 Bytes";var a=i||2,u=Math.floor(Math.log(t)/Math.log(1024));return parseFloat((t/Math.pow(1024,u)).toFixed(a))+" "+["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][u]}loadCompanyLogo(t){this.base64String=btoa(t.target.result),this.safeURL=this._sanitizer.bypassSecurityTrustResourceUrl("data:image/jpg;base64,"+this.base64String)}updateCompanyForm(){null===this.selectedMasterData?this.addNewCompany(this.companyForm.value):this.updateCompany(this.selectedMasterData,this.companyForm.value)}addNewCompany(t){const i={companyEntity:{entityIsChild:Number(t.entityIsChild),entityParentBusinessID:t.entityParentBusinessID,entityBusinessName:t.entityBusinessName,entityBusinessShortCode:t.entityBusinessShortCode,entityCountry:t.entityCountry,entityState:t.entityState,entityCity:t.entityCity,entityAddress:t.entityAddress,entityPinCode:t.entityPinCode,entityPhone:t.entityPhone,entityEmail:t.entityEmail,entityFax:t.entityFax,entityWebsite:t.entityWebsite,entityGSTN:t.entityGSTN,entityLatitude:t.entityLatitude,entityLongitude:t.entityLongitude,entityContactPersonName:t.entityContactPersonName,entityContactNumber:t.entityContactNumber,entityContactPersonEmail:t.entityContactPersonEmail,logo:this.base64String,activeFlag:1,companyID:this.authService.companyID,createdBy:this.authService.employeeID,auditAction:"C",mode:"W"}};this.masterService.requestActionRestAPI(t,i,"companyservice/createEntity","Adding ").then(n=>{this.fetchDataOnCloseDialog$.next([{modifiedObject:n}])}).catch(n=>{this.toastrService.show({type:"error",text:n})})}updateCompany(t,i){const n={companyEntity:{entityID:t.entityID,entityBusinessID:t.entityBusinessID,entityIsChild:Number(i.entityIsChild),entityParentBusinessID:i.entityParentBusinessID,entityBusinessName:i.entityBusinessName,entityBusinessShortCode:i.entityBusinessShortCode,entityCountry:i.entityCountry,entityState:i.entityState,entityCity:i.entityCity,entityAddress:i.entityAddress,entityPinCode:i.entityPinCode,entityPhone:i.entityPhone,entityEmail:i.entityEmail,entityFax:i.entityFax,entityWebsite:i.entityWebsite,entityGSTN:i.entityGSTN,entityLatitude:i.entityLatitude,entityLongitude:i.entityLongitude,entityContactPersonName:i.entityContactPersonName,entityContactNumber:i.entityContactNumber,entityContactPersonEmail:i.entityContactPersonEmail,logo:this.base64String,activeFlag:1,companyID:this.authService.companyID,createdBy:this.authService.employeeID,auditAction:"U",mode:"W"}};this.masterService.requestActionRestAPI(i,n,"companyservice/updateEntity","Updating ").then(a=>{this.fetchDataOnCloseDialog$.next([{modifiedObject:a}])}).catch(a=>{this.toastrService.show({type:"error",text:a})})}ngOnDestroy(){this.fetchDataOnCloseDialog$&&this.fetchDataOnCloseDialog$.unsubscribe()}}return(r=l).\u0275fac=function(t){return new(t||r)(e.Y36(b.D),e.Y36(v.c),e.Y36(C.$),e.Y36(o.qu),e.Y36(f.k),e.Y36(Y.H7))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-company-form"]],inputs:{selectedMasterData:"selectedMasterData",masterList:"masterList",submitButtonLabel:"submitButtonLabel"},decls:108,vars:56,consts:[["autocomplete","off",3,"formGroup"],[1,"container-fluid","company-master-container"],[1,"row"],[1,"col-12","col-md-4","col-lg-3"],["formControlName","entityIsChild","id","company-field-1","color","primary",1,"company-form-checkbox",3,"labelPosition"],[3,"dropdownFor","isRequired","records","formControlsName","idForSelect","dropdownChangeEvent"],["appearance","outline",1,"lms-mat-form-field"],["matInput","","placeholder","Company Name*","formControlName","entityBusinessName","minLength","1","maxLength","100","required","","id","company-field-3",3,"pattern","keyup"],[4,"ngIf"],["matInput","","placeholder","Abbreviation","formControlName","entityBusinessShortCode","minLength","1","maxLength","10","id","company-field-4",3,"pattern","keyup"],["matInput","","placeholder","Address*","formControlName","entityAddress","minLength","1","maxLength","200","id","company-field-8","rows","1","required","",3,"keyup"],["matInput","","placeholder","Pin Code*","id","company-field-9","formControlName","entityPinCode","minLength","1","maxLength","6","required","",3,"pattern","keyup"],["matInput","","placeholder","Company Phone*","id","company-field-10","formControlName","entityPhone","minLength","10","maxLength","10","required","",3,"pattern","keyup"],["matInput","","placeholder","Company Email*","formControlName","entityEmail","minLength","1","maxLength","100","required","","id","company-field-11",3,"keyup"],["matInput","","placeholder","Fax","formControlName","entityFax","minLength","1","maxLength","20","id","company-field-12",3,"pattern","keyup"],["matInput","","placeholder","Website","formControlName","entityWebsite","minLength","1","maxLength","100","id","company-field-13",3,"pattern","keyup"],["matInput","","placeholder","GSTIN Number","id","company-field-14","formControlName","entityGSTN","minLength","1","maxLength","15",2,"text-transform","uppercase",3,"keyup"],["matInput","","placeholder","Latitude","id","company-field-15","formControlName","entityLatitude","minLength","1","maxLength","12",3,"keyup"],["matInput","","placeholder","Longitude","id","company-field-17","formControlName","entityLongitude","minLength","1","maxLength","12",3,"keyup"],["matInput","","placeholder","Contact Person Name*","id","company-field-18","formControlName","entityContactPersonName","minLength","1","maxLength","100","required","",3,"keyup"],["matInput","","placeholder","Contact Person Mobile*","id","company-field-19","formControlName","entityContactNumber","minLength","10","maxLength","10","required","",3,"pattern","keyup"],["matInput","","placeholder","Contact Person Email*","formControlName","entityContactPersonEmail","minLength","1","maxLength","100","required","","id","company-field-20",3,"keyup"],[1,"col-12","col-md-12","col-lg-12"],[1,"btn","btn-primary","lms-submit-button",3,"disabled","click","keydown.enter"],["for","company-field-21",1,"custom-file-upload"],["aria-label","upload",1,"lms-upload-icon"],["id","company-field-21","type","file","accept","image/*",3,"change"],["alt","Company Logo",1,"file-upload-image",3,"src"],["mat-icon-button","",1,"clear-image-icon",3,"disableRipple","click"],["aria-label","clear-image",1,"lms-clear-image-icon"]],template:function(t,i){1&t&&(e.TgZ(0,"form",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"mat-checkbox",4),e._uU(5," Is Child ? "),e.qZA()(),e.TgZ(6,"div",3)(7,"app-lms-select",5),e.NdJ("dropdownChangeEvent",function(a){return i.onChangeOfDropdown(a)}),e.qZA()(),e.TgZ(8,"div",3)(9,"mat-form-field",6)(10,"mat-label"),e._uU(11,"Company Name"),e.qZA(),e.TgZ(12,"input",7),e.NdJ("keyup",function(a){return i.keytab(a,"entityBusinessName",!0)}),e.qZA(),e.YNc(13,ge,2,0,"mat-error",8),e.YNc(14,be,2,0,"mat-error",8),e.YNc(15,fe,2,0,"mat-error",8),e.qZA()(),e.TgZ(16,"div",3)(17,"mat-form-field",6)(18,"mat-label"),e._uU(19,"Abbreviation"),e.qZA(),e.TgZ(20,"input",9),e.NdJ("keyup",function(a){return i.keytab(a,"entityBusinessShortCode",!0)}),e.qZA(),e.YNc(21,ve,2,0,"mat-error",8),e.YNc(22,Ce,2,0,"mat-error",8),e.qZA()(),e.TgZ(23,"div",3)(24,"app-lms-select",5),e.NdJ("dropdownChangeEvent",function(a){return i.onChangeOfDropdown(a)}),e.qZA()(),e.TgZ(25,"div",3)(26,"app-lms-select",5),e.NdJ("dropdownChangeEvent",function(a){return i.onChangeOfDropdown(a)}),e.qZA()(),e.TgZ(27,"div",3)(28,"app-lms-select",5),e.NdJ("dropdownChangeEvent",function(a){return i.onChangeOfDropdown(a)}),e.qZA()(),e.TgZ(29,"div",3)(30,"mat-form-field",6)(31,"mat-label"),e._uU(32,"Address"),e.qZA(),e.TgZ(33,"textarea",10),e.NdJ("keyup",function(a){return i.keytab(a,"entityAddress",!1)}),e.qZA(),e.YNc(34,De,2,0,"mat-error",8),e.qZA()(),e.TgZ(35,"div",3)(36,"mat-form-field",6)(37,"mat-label"),e._uU(38,"Pin Code"),e.qZA(),e.TgZ(39,"input",11),e.NdJ("keyup",function(a){return i.keytab(a,"entityPinCode",!1)}),e.qZA(),e.YNc(40,_e,2,0,"mat-error",8),e.YNc(41,Se,2,0,"mat-error",8),e.qZA()(),e.TgZ(42,"div",3)(43,"mat-form-field",6)(44,"mat-label"),e._uU(45,"Company Phone"),e.qZA(),e.TgZ(46,"input",12),e.NdJ("keyup",function(a){return i.keytab(a,"entityPhone",!1)}),e.qZA(),e.YNc(47,Ie,2,0,"mat-error",8),e.YNc(48,we,2,0,"mat-error",8),e.qZA()(),e.TgZ(49,"div",3)(50,"mat-form-field",6)(51,"mat-label"),e._uU(52,"Company Email"),e.qZA(),e.TgZ(53,"input",13),e.NdJ("keyup",function(a){return i.keytab(a,"entityEmail",!1)}),e.qZA(),e.YNc(54,Fe,2,0,"mat-error",8),e.YNc(55,Ae,2,0,"mat-error",8),e.qZA()(),e.TgZ(56,"div",3)(57,"mat-form-field",6)(58,"mat-label"),e._uU(59,"Fax"),e.qZA(),e.TgZ(60,"input",14),e.NdJ("keyup",function(a){return i.keytab(a,"entityFax",!1)}),e.qZA(),e.YNc(61,Ne,2,0,"mat-error",8),e.qZA()(),e.TgZ(62,"div",3)(63,"mat-form-field",6)(64,"mat-label"),e._uU(65,"Website"),e.qZA(),e.TgZ(66,"input",15),e.NdJ("keyup",function(a){return i.keytab(a,"entityWebsite",!1)}),e.qZA(),e.YNc(67,Le,2,0,"mat-error",8),e.qZA()(),e.TgZ(68,"div",3)(69,"mat-form-field",6)(70,"mat-label"),e._uU(71,"GSTIN Number"),e.qZA(),e.TgZ(72,"input",16),e.NdJ("keyup",function(a){return i.keytab(a,"entityGSTN",!1)}),e.qZA()()(),e.TgZ(73,"div",3)(74,"mat-form-field",6)(75,"mat-label"),e._uU(76,"Latitude"),e.qZA(),e.TgZ(77,"input",17),e.NdJ("keyup",function(a){return i.keytab(a,"entityLatitude",!1)}),e.qZA()()(),e.TgZ(78,"div",3)(79,"mat-form-field",6)(80,"mat-label"),e._uU(81,"Longitude"),e.qZA(),e.TgZ(82,"input",18),e.NdJ("keyup",function(a){return i.keytab(a,"entityLongitude",!1)}),e.qZA()()(),e.TgZ(83,"div",3)(84,"mat-form-field",6)(85,"mat-label"),e._uU(86,"Contact Person Name"),e.qZA(),e.TgZ(87,"input",19),e.NdJ("keyup",function(a){return i.keytab(a,"entityContactPersonName",!1)}),e.qZA(),e.YNc(88,Be,2,0,"mat-error",8),e.qZA()(),e.TgZ(89,"div",3)(90,"mat-form-field",6)(91,"mat-label"),e._uU(92,"Contact Person Mobile"),e.qZA(),e.TgZ(93,"input",20),e.NdJ("keyup",function(a){return i.keytab(a,"entityContactNumber",!1)}),e.qZA(),e.YNc(94,Te,2,0,"mat-error",8),e.YNc(95,ke,2,0,"mat-error",8),e.qZA()(),e.TgZ(96,"div",3)(97,"mat-form-field",6)(98,"mat-label"),e._uU(99,"Contact Person Email"),e.qZA(),e.TgZ(100,"input",21),e.NdJ("keyup",function(a){return i.keytab(a,"entityContactPersonEmail",!1)}),e.qZA(),e.YNc(101,xe,2,0,"mat-error",8),e.YNc(102,Pe,2,0,"mat-error",8),e.qZA()(),e.TgZ(103,"div",22),e.YNc(104,qe,5,0,"ng-container",8),e.YNc(105,Me,4,2,"ng-container",8),e.qZA()()(),e.TgZ(106,"button",23),e.NdJ("click",function(){return i.updateCompanyForm()})("keydown.enter",function(a){return a.preventDefault()}),e._uU(107),e.qZA()()),2&t&&(e.Q6J("formGroup",i.companyForm),e.xp6(4),e.Q6J("labelPosition","after"),e.xp6(2),e.Udp("display",i.entityIsChild.value?"block":"none"),e.xp6(1),e.Q6J("dropdownFor","Company")("isRequired",i.entityIsChild.value)("records",i.companyList$)("formControlsName",i.companyForm.controls.entityParentBusinessID)("idForSelect","company-field-2"),e.xp6(5),e.Q6J("pattern","[^]*"),e.xp6(1),e.Q6J("ngIf",null==i.companyForm.controls.entityBusinessName||null==i.companyForm.controls.entityBusinessName.errors?null:i.companyForm.controls.entityBusinessName.errors.required),e.xp6(1),e.Q6J("ngIf",null==i.companyForm.controls.entityBusinessName||null==i.companyForm.controls.entityBusinessName.errors?null:i.companyForm.controls.entityBusinessName.errors.pattern),e.xp6(1),e.Q6J("ngIf",null==i.companyForm.controls.entityBusinessName||null==i.companyForm.controls.entityBusinessName.errors?null:i.companyForm.controls.entityBusinessName.errors.mustBeUnique),e.xp6(5),e.Q6J("pattern","[^]*"),e.xp6(1),e.Q6J("ngIf",null==i.companyForm.controls.entityBusinessShortCode||null==i.companyForm.controls.entityBusinessShortCode.errors?null:i.companyForm.controls.entityBusinessShortCode.errors.pattern),e.xp6(1),e.Q6J("ngIf",null==i.companyForm.controls.entityBusinessShortCode||null==i.companyForm.controls.entityBusinessShortCode.errors?null:i.companyForm.controls.entityBusinessShortCode.errors.mustBeUnique),e.xp6(2),e.Q6J("dropdownFor","Country")("isRequired",!0)("records",i.countryList$)("formControlsName",i.companyForm.controls.entityCountry)("idForSelect","company-field-5"),e.xp6(2),e.Q6J("dropdownFor","State")("isRequired",!0)("records",i.stateList$)("formControlsName",i.companyForm.controls.entityState)("idForSelect","company-field-6"),e.xp6(2),e.Q6J("dropdownFor","City")("isRequired",!0)("records",i.cityList$)("formControlsName",i.companyForm.controls.entityCity)("idForSelect","company-field-7"),e.xp6(6),e.Q6J("ngIf",null==i.companyForm.controls.entityAddress||null==i.companyForm.controls.entityAddress.errors?null:i.companyForm.controls.entityAddress.errors.required),e.xp6(5),e.Q6J("pattern","[0-9]{6}"),e.xp6(1),e.Q6J("ngIf",null==i.companyForm.controls.entityPinCode||null==i.companyForm.controls.entityPinCode.errors?null:i.companyForm.controls.entityPinCode.errors.pattern),e.xp6(1),e.Q6J("ngIf",null==i.companyForm.controls.entityPinCode||null==i.companyForm.controls.entityPinCode.errors?null:i.companyForm.controls.entityPinCode.errors.required),e.xp6(5),e.Q6J("pattern","[6-9]{1}[0-9]{9}"),e.xp6(1),e.Q6J("ngIf",null==i.companyForm.controls.entityPhone||null==i.companyForm.controls.entityPhone.errors?null:i.companyForm.controls.entityPhone.errors.pattern),e.xp6(1),e.Q6J("ngIf",null==i.companyForm.controls.entityPhone||null==i.companyForm.controls.entityPhone.errors?null:i.companyForm.controls.entityPhone.errors.required),e.xp6(6),e.Q6J("ngIf",null==i.companyForm.controls.entityEmail||null==i.companyForm.controls.entityEmail.errors?null:i.companyForm.controls.entityEmail.errors.email),e.xp6(1),e.Q6J("ngIf",null==i.companyForm.controls.entityEmail||null==i.companyForm.controls.entityEmail.errors?null:i.companyForm.controls.entityEmail.errors.required),e.xp6(5),e.Q6J("pattern","[^]*"),e.xp6(1),e.Q6J("ngIf",null==i.companyForm.controls.entityFax||null==i.companyForm.controls.entityFax.errors?null:i.companyForm.controls.entityFax.errors.pattern),e.xp6(5),e.Q6J("pattern","((https?|ftp|smtp)://)?(www.)?[a-z0-9]+.[a-z]+(/[a-zA-Z0-9#]+/?)*$"),e.xp6(1),e.Q6J("ngIf",null==i.companyForm.controls.entityWebsite||null==i.companyForm.controls.entityWebsite.errors?null:i.companyForm.controls.entityWebsite.errors.pattern),e.xp6(21),e.Q6J("ngIf",null==i.companyForm.controls.entityContactPersonName||null==i.companyForm.controls.entityContactPersonName.errors?null:i.companyForm.controls.entityContactPersonName.errors.required),e.xp6(5),e.Q6J("pattern","[6-9]{1}[0-9]{9}"),e.xp6(1),e.Q6J("ngIf",null==i.companyForm.controls.entityContactNumber||null==i.companyForm.controls.entityContactNumber.errors?null:i.companyForm.controls.entityContactNumber.errors.pattern),e.xp6(1),e.Q6J("ngIf",null==i.companyForm.controls.entityContactNumber||null==i.companyForm.controls.entityContactNumber.errors?null:i.companyForm.controls.entityContactNumber.errors.required),e.xp6(6),e.Q6J("ngIf",null==i.companyForm.controls.entityContactPersonEmail||null==i.companyForm.controls.entityContactPersonEmail.errors?null:i.companyForm.controls.entityContactPersonEmail.errors.email),e.xp6(1),e.Q6J("ngIf",null==i.companyForm.controls.entityContactPersonEmail||null==i.companyForm.controls.entityContactPersonEmail.errors?null:i.companyForm.controls.entityContactPersonEmail.errors.required),e.xp6(1),e.Udp("display",i.entityIsChild.value?"none":"block"),e.xp6(1),e.Q6J("ngIf",0===i.base64String.length),e.xp6(1),e.Q6J("ngIf",i.base64String.length>0),e.xp6(1),e.Q6J("disabled",i.companyForm.invalid),e.xp6(1),e.hij(" ",i.submitButtonLabel," "))},dependencies:[D.O5,o._Y,o.Fj,o.JJ,o.JL,o.Q7,o.c5,o.sg,o.u,k.P,_.RK,M.oG,x.Nt,y.KE,y.hX,y.TO],styles:[".company-master-container[_ngcontent-%COMP%]{display:flex;margin-top:12px}.company-form-checkbox[_ngcontent-%COMP%]{display:flex;flex-direction:row;margin-top:10px}@media (max-width: 766px){.company-form-checkbox[_ngcontent-%COMP%]{margin-top:5px;margin-bottom:5px}}input[type=file][_ngcontent-%COMP%]{display:none}.custom-file-upload[_ngcontent-%COMP%]{border:1px solid #ccc;display:inline-block;padding:6px 12px;cursor:pointer;height:200px;width:15vw;text-align:center;border-radius:5px}@media (max-width: 766px){.custom-file-upload[_ngcontent-%COMP%]{width:73vw}}.file-upload-image[_ngcontent-%COMP%]{border:1px solid #ccc;height:200px;width:15vw;border-radius:5px;object-fit:contain}@media (max-width: 766px){.file-upload-image[_ngcontent-%COMP%]{width:73vw}}.file-upload-image[_ngcontent-%COMP%]:hover{filter:blur(3px)}.clear-image-icon[_ngcontent-%COMP%]{position:relative;right:8vw;top:10px}@media (max-width: 766px){.clear-image-icon[_ngcontent-%COMP%]{right:-32vw;top:-15vh}}"]}),l})();var q=h(4834);let Ze=(()=>{var r;class l{constructor(t,i,n,a,s,u){this.loader=t,this.toastrService=i,this.masterService=n,this.exportService=a,this.authService=s,this.dialog=u,this.companyList$=new p.X([]),this.inlineEditFlag=!1,this.showLogCheckedFlag=!1,this.gridOptions=new F.s8,this.changeDetection=new A.x}ngOnInit(){this.getCompanyList(!1).then(t=>{this.companyList$.next(t)}).catch(t=>{this.companyList$.next([]),this.toastrService.show({type:"error",text:t})}),this.gridOptions={searchPlaceholder:"Search Company",pageSize:this.authService.pageSize,dateFormat:"yyyy-MM-dd",keyCodeForNextCell:13,showInlineEdit:this.inlineEditFlag,titleForMobileView:"entityBusinessName",pageSizeArray:[5,10,20],showDeleteButton:!1,showAddButton:!0,showEditButton:!0,showActivateDeactivateButton:!0,showSearchInput:!0,activateDeactivateCondition:{conditionalProperty:"activeFlag",valueForActivation:"1",valueForDeactivation:"0"},columns:[{name:"entityBusinessName",label:"Company Name",enable:!0,searchable:!0,sortable:!0,type:"text"},{name:"entityAddress",label:"Address",enable:!0,searchable:!0,sortable:!0,type:"text",editable:!1},{name:"entityContactPersonName",label:"Contact Person",enable:!0,searchable:!0,sortable:!0,type:"text",editable:!1},{name:"entityContactNumber",label:"Contact No",enable:!0,searchable:!0,sortable:!0,type:"text",editable:!1},{name:"entityGSTN",label:"GSTIN Number",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1},{name:"entityPhone",label:"Company Phone",enable:!0,searchable:!0,sortable:!0,type:"text",editable:!1},{name:"createdByUser",label:"Last Updated By",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"effectiveDateFrom",label:"Last Modified on",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"activeFlag",label:"",enable:!1,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"entityID",label:"",enable:!1,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"entityBusinessID",label:"",enable:!1,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1}]}}getCompanyList(t){return new Promise((i,n)=>{this.loader.showSpinner("Company list on the way!"),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W",detailFlag:t,dropDown:!1}},"companyservice/getAllEntity").subscribe(s=>{this.loader.hideSpinner(),"200"===s.statusCode||"300"===s.statusCode?(s.responseList=null==s.responseList?[]:s.responseList,i(s.responseList)):n(s.errorMessage)},s=>{this.loader.hideSpinner(),n("Either Internet is not working or facing internal server issue")})})}exportData(t){const i=[{property:"entityBusinessName",label:"Company Name"},{property:"entityAddress",label:"Address"},{property:"entityContactPersonName",label:"Contact Person"},{property:"entityContactNumber",label:"Contact No"},{property:"entityGSTN",label:"GSTIN Number"},{property:"entityPhone",label:"Company Phone"},{property:"createdByUser",label:"Last Updated By"},{property:"effectiveDateFrom",label:"Last Modified on"}];this.showLogCheckedFlag&&i.push({property:"auditAction",label:"Audit Action"}),this.exportService.generateFile(this.companyList$.getValue(),"Company List."+t,i)}showLog(t){this.companyList$.next([]),t?this.getCompanyList(!0).then(i=>{this.showLogCheckedFlag=!0,this.companyList$.next(i),this.gridOptions.showAddButton=!1,this.gridOptions.showEditButton=!1,this.gridOptions.showActivateDeactivateButton=!1,this.gridOptions.columns.push({name:"auditAction",label:"Audit Action",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1})}).catch(i=>{this.companyList$.next([]),this.toastrService.show({type:"error",text:i})}):(this.showLogCheckedFlag=!1,this.ngOnInit())}initiateAddCompany(t){this.dialog.open(B.s,{disableClose:!0,data:{header:"Company Form",buttonLabel:"Submit",records:{selectedItem:t,uniqueItemList:this.companyList$.getValue().map(n=>({entityBusinessID:n.entityBusinessID,entityBusinessName:n.entityBusinessName,entityBusinessShortCode:n.entityBusinessShortCode,entityIsChild:n.entityIsChild}))},component:X},animation:{to:"right"},position:{top:"50vh",left:"50vw"},panelClass:"lms-dialog-box-center"}).afterClosed().subscribe(n=>{if(null!==n){let a=this.companyList$.getValue();a.unshift(n[0].modifiedObject),this.companyList$.next(a),this.toastrService.show({type:"success",text:n[0].modifiedObject.entityBusinessName+" Created!"})}})}initiateUpdateCompany(t){this.dialog.open(B.s,{disableClose:!0,data:{header:"Company Form",buttonLabel:"Update",records:{selectedItem:t,uniqueItemList:this.companyList$.getValue().map(n=>({entityBusinessID:n.entityBusinessID,entityBusinessName:n.entityBusinessName,entityBusinessShortCode:n.entityBusinessShortCode,entityIsChild:n.entityIsChild}))},component:X},animation:{to:"right"},position:{top:"50vh",left:"50vw"},panelClass:"lms-dialog-box-center"}).afterClosed().subscribe(n=>{if(null!==n){let a=this.companyList$.getValue(),s=a.findIndex(u=>u.entityBusinessID==n[0].modifiedObject.entityBusinessID);a[s]=n[0].modifiedObject,this.companyList$.next(a),this.toastrService.show({type:"success",text:n[0].modifiedObject.entityBusinessName+" Updated!"})}})}activateCompany(t){this.masterService.requestActionRestAPI(t,{companyEntity:{entityID:t.entityID,entityBusinessID:t.entityBusinessID,entityEmailID:t.entityEmailID,entityBusinessName:t.entityBusinessName,entityBusinessShortCode:t.entityBusinessShortCode,activeFlag:1,entityIsChild:t.entityIsChild,entityCountry:t.entityCountry,entityState:t.entityState,entityCity:t.entityCity,entityAddress:t.entityAddress,entityPinCode:t.entityPinCode,entityPhone:t.entityPhone,entityEmail:t.entityEmail,entityFax:t.entityFax,entityWebsite:t.entityWebsite,entityGSTN:t.entityGSTN,entityLatitude:t.entityLatitude,entityLongitude:t.entityLongitude,entityContactPersonName:t.entityContactPersonName,entityContactNumber:t.entityContactNumber,entityContactPersonEmail:t.entityContactPersonEmail,logo:t.logo,entityParentBusinessID:t.entityParentBusinessID,auditAction:"A",companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W"}},"companyservice/activateEntity","Activating ").then(n=>{this.changeDetection.next({originalObject:t,modifiedObject:n}),this.toastrService.show({type:"success",text:t.entityBusinessName+" Activated!"})}).catch(n=>{this.toastrService.show({type:"error",text:n})})}deactivateCompany(t){this.masterService.requestActionRestAPI(t,{companyEntity:{entityID:t.entityID,entityBusinessID:t.entityBusinessID,entityEmailID:t.entityEmailID,entityBusinessName:t.entityBusinessName,entityBusinessShortCode:t.entityBusinessShortCode,activeFlag:0,entityIsChild:t.entityIsChild,entityCountry:t.entityCountry,entityState:t.entityState,entityCity:t.entityCity,entityAddress:t.entityAddress,entityPinCode:t.entityPinCode,entityPhone:t.entityPhone,entityEmail:t.entityEmail,entityFax:t.entityFax,entityWebsite:t.entityWebsite,entityGSTN:t.entityGSTN,entityLatitude:t.entityLatitude,entityLongitude:t.entityLongitude,entityContactPersonName:t.entityContactPersonName,entityContactNumber:t.entityContactNumber,entityContactPersonEmail:t.entityContactPersonEmail,logo:t.logo,entityParentBusinessID:t.entityParentBusinessID,auditAction:"D",companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W"}},"companyservice/deactivateEntity","Deactivating ").then(n=>{this.changeDetection.next({originalObject:t,modifiedObject:n}),this.toastrService.show({type:"success",text:t.entityBusinessName+" Deactivated!"})}).catch(n=>{this.toastrService.show({type:"error",text:n})})}}return(r=l).\u0275fac=function(t){return new(t||r)(e.Y36(b.D),e.Y36(f.k),e.Y36(v.c),e.Y36(N.u),e.Y36(C.$),e.Y36(q.Y))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-company"]],decls:14,vars:3,consts:[[1,"container-fluid"],[1,"row"],["childLink","General Master","subchildLink","Company"],[1,"mat-elevation-z12","lms-master-card"],[1,"lms-matcardtitlegroup"],["mat-icon-button","",3,"disableRipple","click"],["aria-label","excel",1,"lms-excel-icon"],["aria-label","csv",1,"lms-csv-icon"],[1,"remaining-space"],["color","primary",1,"lms-matslidetoggle",3,"checked","change"]],template:function(t,i){1&t&&(e._UZ(0,"app-header"),e.TgZ(1,"div",0)(2,"div",1),e._UZ(3,"app-breadcrumb",2),e.qZA(),e.TgZ(4,"div",1)(5,"mat-card",3)(6,"mat-card-title-group",4)(7,"button",5),e.NdJ("click",function(){return i.exportData("xlsx")}),e._UZ(8,"div",6),e.qZA(),e.TgZ(9,"button",5),e.NdJ("click",function(){return i.exportData("csv")}),e._UZ(10,"div",7),e.qZA(),e._UZ(11,"span",8),e.TgZ(12,"mat-slide-toggle",9),e.NdJ("change",function(a){return i.showLog(a.checked)}),e._uU(13," Show Logs "),e.qZA()()()()()),2&t&&(e.xp6(7),e.Q6J("disableRipple",!0),e.xp6(2),e.Q6J("disableRipple",!0),e.xp6(3),e.Q6J("checked",i.showLogCheckedFlag))},dependencies:[S.G,_.RK,d.a8,d.C1,w.Rr,I.L]}),l})();function Ee(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Corporate Name is required field. "),e.qZA())}function Oe(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Please match the requested format. "),e.qZA())}function Re(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Corporate Name is already taken. "),e.qZA())}function Ue(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Please match the requested format. "),e.qZA())}function Je(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Abbreviation is already taken. "),e.qZA())}function $e(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Please enter valid website. "),e.qZA())}function Qe(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Contact Person is required field. "),e.qZA())}function Ge(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Please enter valid contact number. "),e.qZA())}function Ye(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Contact Number is required field. "),e.qZA())}function je(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Please enter valid email. "),e.qZA())}function We(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Email is required field. "),e.qZA())}let V=(()=>{var r;class l{constructor(t,i,n,a,s){this.loader=t,this.masterService=i,this.authService=n,this.fb=a,this.toastrService=s,this.selectedMasterData={},this.masterList=[],this.submitButtonLabel="Submit",this.countryList$=new p.X([]),this.stateList$=new p.X([]),this.cityList$=new p.X([]),this.designationList$=new p.X([]),this.fetchDataOnCloseDialog$=new p.X([])}ngOnInit(){if(this.corporateForm=this.fb.group({entityBusinessName:new o.NI(null,[o.kI.required]),entityBusinessShortCode:new o.NI(null),entityCountryID:new o.NI(null,[o.kI.required]),entityStateID:new o.NI(null,[o.kI.required]),entityCityID:new o.NI(null,[o.kI.required]),entityAddress:new o.NI(null),entityWebsite:new o.NI(null),entityGSTIN:new o.NI(null),entityContactPersonName:new o.NI(null,[o.kI.required]),entityContactNumber:new o.NI(null,[o.kI.required]),entityEmail:new o.NI(null,[o.kI.required,o.kI.email]),entityDesignation:new o.NI(null),entityEmpCode:new o.NI(null)}),null!==this.selectedMasterData){this.getCountryList().then(i=>{this.countryList$.next(i),this.getStatesList(this.selectedMasterData.entityCountryID).then(n=>{this.stateList$.next(n),this.getCitiesList(this.selectedMasterData.entityStateID).then(a=>{this.cityList$.next(a),this.getDesignationList().then(s=>{this.designationList$.next(s)}).catch(s=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}).catch(a=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}).catch(n=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}).catch(i=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})});const t=Object.entries(this.corporateForm.value).reduce((i,[n,a])=>(i[n]=this.selectedMasterData[n],i),{});this.corporateForm.patchValue(t)}else this.getCountryList().then(t=>{this.countryList$.next(t),this.getDesignationList().then(i=>{this.designationList$.next(i)}).catch(i=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}).catch(t=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}getCountryList(){return new Promise((t,i)=>{this.loader.showSpinner("Loading..."),this.countryListSubscription=this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,entityBusinessID:null,mode:"W",detailFlag:null!==this.selectedMasterData,dropDown:!0}},"countryservice/getAllCountry").subscribe(a=>{this.loader.hideSpinner(),"200"===a.statusCode||"300"===a.statusCode?(a.responseList=null==a.responseList?[]:a.responseList,t(a.responseList)):i(a.errorMessage)},a=>{this.loader.hideSpinner(),i("Either Internet is not working or facing internal server issue")})})}getStatesList(t){return new Promise((i,n)=>{this.loader.showSpinner("Loading..."),this.stateListSubscription=this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,entityBusinessID:t,mode:"W",detailFlag:null!==this.selectedMasterData,dropDown:!0}},"stateservice/getAllState/").subscribe(s=>{this.loader.hideSpinner(),"200"===s.statusCode||"300"===s.statusCode?(s.responseList=null==s.responseList?[]:s.responseList,i(s.responseList)):n(s.errorMessage)},s=>{this.loader.hideSpinner(),n("Either Internet is not working or facing internal server issue")})})}getCitiesList(t){return new Promise((i,n)=>{this.loader.showSpinner("Loading..."),this.cityListSubscription=this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,entityBusinessID:t,mode:"W",detailFlag:null!==this.selectedMasterData,dropDown:!0}},"cityservice/getAllCity/").subscribe(s=>{this.loader.hideSpinner(),"200"===s.statusCode||"300"===s.statusCode?(s.responseList=null==s.responseList?[]:s.responseList,i(s.responseList)):n(s.errorMessage)},s=>{this.loader.hideSpinner(),n("Either Internet is not working or facing internal server issue")})})}getDesignationList(){return new Promise((t,i)=>{this.loader.showSpinner("Loading..."),this.designationListSubscription=this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,entityBusinessID:null,mode:"W",detailFlag:null!==this.selectedMasterData,dropDown:!0}},"designationservice/getAllDesignation/").subscribe(a=>{this.loader.hideSpinner(),"200"===a.statusCode||"300"===a.statusCode?(a.responseList=null==a.responseList?[]:a.responseList,t(a.responseList)):i(a.errorMessage)},a=>{this.loader.hideSpinner(),i("Either Internet is not working or facing internal server issue")})})}keytab(t,i,n){if(13===t.keyCode){var a=t.srcElement.id.split("-").reduce((s,u)=>(Number(u)&&(u=Number(u)+1),s+"-"+u));document.getElementById(a).focus()}else this._uniqueColumnValidator(t.target.value,i,n)}_uniqueColumnValidator(t,i,n){if(n){const a=null===this.selectedMasterData?{entityBusinessID:null}:this.selectedMasterData;null!=this.masterList.find(u=>u[i].toString().trim().toLowerCase()===t.trim().toLowerCase()&&u.entityBusinessID!=a.entityBusinessID)&&this.corporateForm.controls[i].setErrors({mustBeUnique:!0})}}onChangeOfDropdown(t){switch(t.type){case"Country":this.getStatesList(t.value).then(i=>{this.stateList$.next(i)}).catch(i=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})});break;case"State":this.getCitiesList(t.value).then(i=>{this.cityList$.next(i)}).catch(i=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}}updateCorporateForm(){null===this.selectedMasterData?this.addNewCorporate(this.corporateForm.value):this.updateCorporate(this.selectedMasterData,this.corporateForm.value)}addNewCorporate(t){this.masterService.requestActionRestAPI(t,{corporateRequestEntity:{entityBusinessName:t.entityBusinessName,entityBusinessShortCode:t.entityBusinessShortCode,entityCountryID:t.entityCountryID,entityStateID:t.entityStateID,entityCityID:t.entityCityID,entityAddress:t.entityAddress,entityWebsite:t.entityWebsite,entityGSTIN:t.entityGSTIN,entityContactPersonName:t.entityContactPersonName,entityContactNumber:t.entityContactNumber,entityEmail:t.entityEmail,entityDesignation:t.entityDesignation,entityEmpCode:t.entityEmpCode,companyID:this.authService.companyID,createdBy:this.authService.employeeID,auditAction:"C",mode:"W"}},"corporateservice/createCorporate/","Adding ").then(n=>{this.fetchDataOnCloseDialog$.next([{modifiedObject:n}])}).catch(n=>{this.toastrService.show({type:"error",text:n})})}updateCorporate(t,i){this.masterService.requestActionRestAPI(i,{corporateRequestEntity:{entityID:t.entityID,entityBusinessID:t.entityBusinessID,entityBusinessName:i.entityBusinessName,entityBusinessShortCode:i.entityBusinessShortCode,entityCountryID:i.entityCountryID,entityStateID:i.entityStateID,entityCityID:i.entityCityID,entityAddress:i.entityAddress,entityWebsite:i.entityWebsite,entityGSTIN:i.entityGSTIN,entityContactPersonName:i.entityContactPersonName,entityContactNumber:i.entityContactNumber,entityEmail:i.entityEmail,entityDesignation:i.entityDesignation,entityEmpCode:i.entityEmpCode,companyID:this.authService.companyID,createdBy:this.authService.employeeID,auditAction:"U",mode:"W"}},"corporateservice/updateCorporate/","Updating ").then(a=>{this.fetchDataOnCloseDialog$.next([{modifiedObject:a}])}).catch(a=>{this.toastrService.show({type:"error",text:a})})}ngOnDestroy(){(this.fetchDataOnCloseDialog$||this.countryListSubscription||this.designationListSubscription)&&(this.fetchDataOnCloseDialog$.unsubscribe(),this.countryListSubscription.unsubscribe(),this.designationListSubscription.unsubscribe()),this.stateListSubscription&&this.stateListSubscription.unsubscribe(),this.cityListSubscription&&this.cityListSubscription.unsubscribe()}}return(r=l).\u0275fac=function(t){return new(t||r)(e.Y36(b.D),e.Y36(v.c),e.Y36(C.$),e.Y36(o.qu),e.Y36(f.k))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-corporate-form"]],inputs:{selectedMasterData:"selectedMasterData",masterList:"masterList",submitButtonLabel:"submitButtonLabel"},decls:69,vars:38,consts:[["autocomplete","off",3,"formGroup"],[1,"container-fluid","corporate-master-container"],[1,"row"],[1,"col-12","col-md-4","col-lg-3"],["appearance","outline",1,"lms-mat-form-field"],["matInput","","placeholder","Corporate Name*","formControlName","entityBusinessName","minLength","1","maxLength","100","required","","id","lms-field-1",3,"pattern","keyup"],[4,"ngIf"],["matInput","","placeholder","Abbreviation","formControlName","entityBusinessShortCode","minLength","1","maxLength","10","id","lms-field-2",3,"pattern","keyup"],[3,"dropdownFor","isRequired","records","formControlsName","idForSelect","dropdownChangeEvent"],["matInput","","placeholder","Address","formControlName","entityAddress","minLength","1","maxLength","200","id","lms-field-6","rows","1",3,"keyup"],["matInput","","placeholder","Website","formControlName","entityWebsite","minLength","1","maxLength","100","id","lms-field-7",3,"pattern","keyup"],["matInput","","placeholder","GSTIN Number","id","lms-field-8","formControlName","entityGSTIN","minLength","1","maxLength","15",2,"text-transform","uppercase",3,"keyup"],["matInput","","placeholder","Contact Person*","id","lms-field-9","formControlName","entityContactPersonName","minLength","1","maxLength","100","required","",3,"keyup"],["matInput","","placeholder","Contact Number*","id","lms-field-10","formControlName","entityContactNumber","minLength","10","maxLength","10","required","",3,"pattern","keyup"],["matInput","","placeholder","Email*","formControlName","entityEmail","minLength","1","maxLength","100","required","","id","lms-field-11",3,"keyup"],["matInput","","placeholder","Employee Code","formControlName","entityEmpCode","minLength","1","maxLength","20","id","lms-field-13",3,"keyup"],[1,"btn","btn-primary","lms-submit-button",3,"disabled","click","keydown.enter"]],template:function(t,i){1&t&&(e.TgZ(0,"form",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"mat-form-field",4)(5,"mat-label"),e._uU(6,"Corporate Name"),e.qZA(),e.TgZ(7,"input",5),e.NdJ("keyup",function(a){return i.keytab(a,"entityBusinessName",!0)}),e.qZA(),e.YNc(8,Ee,2,0,"mat-error",6),e.YNc(9,Oe,2,0,"mat-error",6),e.YNc(10,Re,2,0,"mat-error",6),e.qZA()(),e.TgZ(11,"div",3)(12,"mat-form-field",4)(13,"mat-label"),e._uU(14,"Abbreviation"),e.qZA(),e.TgZ(15,"input",7),e.NdJ("keyup",function(a){return i.keytab(a,"entityBusinessShortCode",!0)}),e.qZA(),e.YNc(16,Ue,2,0,"mat-error",6),e.YNc(17,Je,2,0,"mat-error",6),e.qZA()(),e.TgZ(18,"div",3)(19,"app-lms-select",8),e.NdJ("dropdownChangeEvent",function(a){return i.onChangeOfDropdown(a)}),e.qZA()(),e.TgZ(20,"div",3)(21,"app-lms-select",8),e.NdJ("dropdownChangeEvent",function(a){return i.onChangeOfDropdown(a)}),e.qZA()(),e.TgZ(22,"div",3)(23,"app-lms-select",8),e.NdJ("dropdownChangeEvent",function(a){return i.onChangeOfDropdown(a)}),e.qZA()(),e.TgZ(24,"div",3)(25,"mat-form-field",4)(26,"mat-label"),e._uU(27,"Address"),e.qZA(),e.TgZ(28,"textarea",9),e.NdJ("keyup",function(a){return i.keytab(a,"entityAddress",!1)}),e.qZA()()(),e.TgZ(29,"div",3)(30,"mat-form-field",4)(31,"mat-label"),e._uU(32,"Website"),e.qZA(),e.TgZ(33,"input",10),e.NdJ("keyup",function(a){return i.keytab(a,"entityWebsite",!1)}),e.qZA(),e.YNc(34,$e,2,0,"mat-error",6),e.qZA()(),e.TgZ(35,"div",3)(36,"mat-form-field",4)(37,"mat-label"),e._uU(38,"GSTIN Number"),e.qZA(),e.TgZ(39,"input",11),e.NdJ("keyup",function(a){return i.keytab(a,"entityGSTIN",!1)}),e.qZA()()(),e.TgZ(40,"div",3)(41,"mat-form-field",4)(42,"mat-label"),e._uU(43,"Contact Person"),e.qZA(),e.TgZ(44,"input",12),e.NdJ("keyup",function(a){return i.keytab(a,"entityContactPersonName",!1)}),e.qZA(),e.YNc(45,Qe,2,0,"mat-error",6),e.qZA()(),e.TgZ(46,"div",3)(47,"mat-form-field",4)(48,"mat-label"),e._uU(49,"Contact Number"),e.qZA(),e.TgZ(50,"input",13),e.NdJ("keyup",function(a){return i.keytab(a,"entityContactNumber",!1)}),e.qZA(),e.YNc(51,Ge,2,0,"mat-error",6),e.YNc(52,Ye,2,0,"mat-error",6),e.qZA()(),e.TgZ(53,"div",3)(54,"mat-form-field",4)(55,"mat-label"),e._uU(56,"Email"),e.qZA(),e.TgZ(57,"input",14),e.NdJ("keyup",function(a){return i.keytab(a,"entityEmail",!1)}),e.qZA(),e.YNc(58,je,2,0,"mat-error",6),e.YNc(59,We,2,0,"mat-error",6),e.qZA()(),e.TgZ(60,"div",3)(61,"app-lms-select",8),e.NdJ("dropdownChangeEvent",function(a){return i.onChangeOfDropdown(a)}),e.qZA()(),e.TgZ(62,"div",3)(63,"mat-form-field",4)(64,"mat-label"),e._uU(65,"Employee Code"),e.qZA(),e.TgZ(66,"input",15),e.NdJ("keyup",function(a){return i.keytab(a,"entityEmpCode",!1)}),e.qZA()()()()(),e.TgZ(67,"button",16),e.NdJ("click",function(){return i.updateCorporateForm()})("keydown.enter",function(a){return a.preventDefault()}),e._uU(68),e.qZA()()),2&t&&(e.Q6J("formGroup",i.corporateForm),e.xp6(7),e.Q6J("pattern","[^]*"),e.xp6(1),e.Q6J("ngIf",null==i.corporateForm.controls.entityBusinessName||null==i.corporateForm.controls.entityBusinessName.errors?null:i.corporateForm.controls.entityBusinessName.errors.required),e.xp6(1),e.Q6J("ngIf",null==i.corporateForm.controls.entityBusinessName||null==i.corporateForm.controls.entityBusinessName.errors?null:i.corporateForm.controls.entityBusinessName.errors.pattern),e.xp6(1),e.Q6J("ngIf",null==i.corporateForm.controls.entityBusinessName||null==i.corporateForm.controls.entityBusinessName.errors?null:i.corporateForm.controls.entityBusinessName.errors.mustBeUnique),e.xp6(5),e.Q6J("pattern","[^]*"),e.xp6(1),e.Q6J("ngIf",null==i.corporateForm.controls.entityBusinessShortCode||null==i.corporateForm.controls.entityBusinessShortCode.errors?null:i.corporateForm.controls.entityBusinessShortCode.errors.pattern),e.xp6(1),e.Q6J("ngIf",null==i.corporateForm.controls.entityBusinessShortCode||null==i.corporateForm.controls.entityBusinessShortCode.errors?null:i.corporateForm.controls.entityBusinessShortCode.errors.mustBeUnique),e.xp6(2),e.Q6J("dropdownFor","Country")("isRequired",!0)("records",i.countryList$)("formControlsName",i.corporateForm.controls.entityCountryID)("idForSelect","lms-field-3"),e.xp6(2),e.Q6J("dropdownFor","State")("isRequired",!0)("records",i.stateList$)("formControlsName",i.corporateForm.controls.entityStateID)("idForSelect","lms-field-4"),e.xp6(2),e.Q6J("dropdownFor","City")("isRequired",!0)("records",i.cityList$)("formControlsName",i.corporateForm.controls.entityCityID)("idForSelect","lms-field-5"),e.xp6(10),e.Q6J("pattern","((https?|ftp|smtp)://)?(www.)?[a-z0-9]+.[a-z]+(/[a-zA-Z0-9#]+/?)*$"),e.xp6(1),e.Q6J("ngIf",null==i.corporateForm.controls.entityWebsite||null==i.corporateForm.controls.entityWebsite.errors?null:i.corporateForm.controls.entityWebsite.errors.pattern),e.xp6(11),e.Q6J("ngIf",null==i.corporateForm.controls.entityContactPersonName||null==i.corporateForm.controls.entityContactPersonName.errors?null:i.corporateForm.controls.entityContactPersonName.errors.required),e.xp6(5),e.Q6J("pattern","[6-9]{1}[0-9]{9}"),e.xp6(1),e.Q6J("ngIf",null==i.corporateForm.controls.entityContactNumber||null==i.corporateForm.controls.entityContactNumber.errors?null:i.corporateForm.controls.entityContactNumber.errors.pattern),e.xp6(1),e.Q6J("ngIf",null==i.corporateForm.controls.entityContactNumber||null==i.corporateForm.controls.entityContactNumber.errors?null:i.corporateForm.controls.entityContactNumber.errors.required),e.xp6(6),e.Q6J("ngIf",null==i.corporateForm.controls.entityEmail||null==i.corporateForm.controls.entityEmail.errors?null:i.corporateForm.controls.entityEmail.errors.email),e.xp6(1),e.Q6J("ngIf",null==i.corporateForm.controls.entityEmail||null==i.corporateForm.controls.entityEmail.errors?null:i.corporateForm.controls.entityEmail.errors.required),e.xp6(2),e.Q6J("dropdownFor","Designation")("isRequired",!1)("records",i.designationList$)("formControlsName",i.corporateForm.controls.entityDesignation)("idForSelect","lms-field-12"),e.xp6(6),e.Q6J("disabled",i.corporateForm.invalid),e.xp6(1),e.hij(" ",i.submitButtonLabel," "))},dependencies:[D.O5,o._Y,o.Fj,o.JJ,o.JL,o.Q7,o.c5,o.sg,o.u,k.P,x.Nt,y.KE,y.hX,y.TO],styles:[".corporate-master-container[_ngcontent-%COMP%]{display:flex;margin-top:12px}"]}),l})(),ze=(()=>{var r;class l{constructor(t,i,n,a,s,u){this.loader=t,this.toastrService=i,this.masterService=n,this.exportService=a,this.authService=s,this.dialog=u,this.corporateList$=new p.X([]),this.inlineEditFlag=!1,this.showLogCheckedFlag=!1,this.gridOptions=new F.s8,this.changeDetection=new A.x}ngOnInit(){this.getCorporateList(!1).then(t=>{this.corporateList$.next(t)}).catch(t=>{this.corporateList$.next([]),this.toastrService.show({type:"error",text:t})}),this.gridOptions={searchPlaceholder:"Search Corporate",pageSize:this.authService.pageSize,dateFormat:"yyyy-MM-dd",keyCodeForNextCell:13,showInlineEdit:this.inlineEditFlag,titleForMobileView:"entityBusinessName",pageSizeArray:[5,10,20],showDeleteButton:!1,showAddButton:!0,showEditButton:!0,showActivateDeactivateButton:!0,showSearchInput:!0,activateDeactivateCondition:{conditionalProperty:"activeFlag",valueForActivation:"1",valueForDeactivation:"0"},columns:[{name:"entityBusinessName",label:"Corporate",enable:!0,searchable:!0,sortable:!0,type:"text"},{name:"entityBusinessShortCode",label:"Abbreviation",enable:!0,searchable:!0,sortable:!0,type:"text",editable:!1},{name:"entityContactPersonName",label:"Contact Person",enable:!0,searchable:!0,sortable:!0,type:"text",editable:!1},{name:"entityContactNumber",label:"Contact No",enable:!0,searchable:!0,sortable:!0,type:"text",editable:!1},{name:"entityEmail",label:"Email",enable:!0,searchable:!0,sortable:!0,type:"text",editable:!1},{name:"createdByUser",label:"Last Updated By",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"effectiveDateFrom",label:"Last Modified on",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"activeFlag",label:"",enable:!1,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"entityID",label:"",enable:!1,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"entityBusinessID",label:"",enable:!1,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1}]}}getCorporateList(t){return new Promise((i,n)=>{this.loader.showSpinner("Corporate list on the way!"),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W",detailFlag:t,dropDown:!1}},"corporateservice/getAllCorporate/").subscribe(s=>{this.loader.hideSpinner(),"200"===s.statusCode||"300"===s.statusCode?(s.responseList=null==s.responseList?[]:s.responseList,i(s.responseList)):n(s.errorMessage)},s=>{this.loader.hideSpinner(),n("Either Internet is not working or facing internal server issue")})})}exportData(t){const i=[{property:"entityBusinessName",label:"Corporate"},{property:"entityBusinessShortCode",label:"Abbreviation"},{property:"entityContactPersonName",label:"Contact Person"},{property:"entityContactNumber",label:"Contact No"},{property:"entityEmail",label:"Email"},{property:"createdByUser",label:"Last Updated By"},{property:"effectiveDateFrom",label:"Last Modified on"}];this.showLogCheckedFlag&&i.push({property:"auditAction",label:"Audit Action"}),this.exportService.generateFile(this.corporateList$.getValue(),"Corporate List."+t,i)}showLog(t){this.corporateList$.next([]),t?this.getCorporateList(!0).then(i=>{this.showLogCheckedFlag=!0,this.corporateList$.next(i),this.gridOptions.showAddButton=!1,this.gridOptions.showEditButton=!1,this.gridOptions.showActivateDeactivateButton=!1,this.gridOptions.columns.push({name:"auditAction",label:"Audit Action",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1})}).catch(i=>{this.corporateList$.next([]),this.toastrService.show({type:"error",text:i})}):(this.showLogCheckedFlag=!1,this.ngOnInit())}initiateAddCorporate(t){this.dialog.open(B.s,{disableClose:!0,data:{header:"Corporate Form",buttonLabel:"Submit",records:{selectedItem:t,uniqueItemList:this.corporateList$.getValue().map(n=>({entityBusinessID:n.entityBusinessID,entityBusinessName:n.entityBusinessName,entityBusinessShortCode:n.entityBusinessShortCode}))},component:V},animation:{to:"right"},position:{top:"50vh",left:"50vw"},panelClass:"lms-dialog-box-center"}).afterClosed().subscribe(n=>{if(null!==n){let a=this.corporateList$.getValue();a.unshift(n[0].modifiedObject),this.corporateList$.next(a),this.toastrService.show({type:"success",text:n[0].modifiedObject.entityBusinessName+" Created!"})}})}initiateUpdateCorporate(t){this.dialog.open(B.s,{disableClose:!0,data:{header:"Corporate Form",buttonLabel:"Update",records:{selectedItem:t,uniqueItemList:this.corporateList$.getValue().map(n=>({entityBusinessID:n.entityBusinessID,entityBusinessName:n.entityBusinessName,entityBusinessShortCode:n.entityBusinessShortCode}))},component:V},animation:{to:"right"},position:{top:"50vh",left:"50vw"},panelClass:"lms-dialog-box-center"}).afterClosed().subscribe(n=>{if(null!==n){let a=this.corporateList$.getValue(),s=a.findIndex(u=>u.entityBusinessID==n[0].modifiedObject.entityBusinessID);a[s]=n[0].modifiedObject,this.corporateList$.next(a),this.toastrService.show({type:"success",text:n[0].modifiedObject.entityBusinessName+" Updated!"})}})}activateCorporate(t){this.masterService.requestActionRestAPI(t,{corporateRequestEntity:{entityID:t.entityID,entityBusinessID:t.entityBusinessID,entityBusinessName:t.entityBusinessName,entityBusinessShortCode:t.entityBusinessShortCode,entityCountryID:t.entityCountryID,entityStateID:t.entityStateID,entityCityID:t.entityCityID,entityAddress:t.entityAddress,entityWebsite:t.entityWebsite,entityGSTIN:t.entityGSTIN,entityContactPersonName:t.entityContactPersonName,entityContactNumber:t.entityContactNumber,entityEmail:t.entityEmail,entityDesignation:t.entityDesignation,entityEmpCode:t.entityEmpCode,auditAction:"A",companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W"}},"corporateservice/activateCorporate/","Activating ").then(n=>{this.changeDetection.next({originalObject:t,modifiedObject:n}),this.toastrService.show({type:"success",text:t.entityBusinessName+" Activated!"})}).catch(n=>{this.toastrService.show({type:"error",text:n})})}deactivateCorporate(t){this.masterService.requestActionRestAPI(t,{corporateRequestEntity:{entityID:t.entityID,entityBusinessID:t.entityBusinessID,entityBusinessName:t.entityBusinessName,entityBusinessShortCode:t.entityBusinessShortCode,entityCountryID:t.entityCountryID,entityStateID:t.entityStateID,entityCityID:t.entityCityID,entityAddress:t.entityAddress,entityWebsite:t.entityWebsite,entityGSTIN:t.entityGSTIN,entityContactPersonName:t.entityContactPersonName,entityContactNumber:t.entityContactNumber,entityEmail:t.entityEmail,entityDesignation:t.entityDesignation,entityEmpCode:t.entityEmpCode,auditAction:"D",companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W"}},"corporateservice/deactivateCorporate/","Deactivating ").then(n=>{this.changeDetection.next({originalObject:t,modifiedObject:n}),this.toastrService.show({type:"success",text:t.entityBusinessName+" Deactivated!"})}).catch(n=>{this.toastrService.show({type:"error",text:n})})}}return(r=l).\u0275fac=function(t){return new(t||r)(e.Y36(b.D),e.Y36(f.k),e.Y36(v.c),e.Y36(N.u),e.Y36(C.$),e.Y36(q.Y))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-corporate-master"]],decls:14,vars:3,consts:[[1,"container-fluid"],[1,"row"],["childLink","General Master","subchildLink","Corporate Master"],[1,"mat-elevation-z12","lms-master-card"],[1,"lms-matcardtitlegroup"],["mat-icon-button","",3,"disableRipple","click"],["aria-label","excel",1,"lms-excel-icon"],["aria-label","csv",1,"lms-csv-icon"],[1,"remaining-space"],["color","primary",1,"lms-matslidetoggle",3,"checked","change"]],template:function(t,i){1&t&&(e._UZ(0,"app-header"),e.TgZ(1,"div",0)(2,"div",1),e._UZ(3,"app-breadcrumb",2),e.qZA(),e.TgZ(4,"div",1)(5,"mat-card",3)(6,"mat-card-title-group",4)(7,"button",5),e.NdJ("click",function(){return i.exportData("xlsx")}),e._UZ(8,"div",6),e.qZA(),e.TgZ(9,"button",5),e.NdJ("click",function(){return i.exportData("csv")}),e._UZ(10,"div",7),e.qZA(),e._UZ(11,"span",8),e.TgZ(12,"mat-slide-toggle",9),e.NdJ("change",function(a){return i.showLog(a.checked)}),e._uU(13," Show Logs "),e.qZA()()()()()),2&t&&(e.xp6(7),e.Q6J("disableRipple",!0),e.xp6(2),e.Q6J("disableRipple",!0),e.xp6(3),e.Q6J("checked",i.showLogCheckedFlag))},dependencies:[S.G,_.RK,d.a8,d.C1,w.Rr,I.L]}),l})(),Xe=(()=>{var r;class l{constructor(t,i,n,a,s){this.loader=t,this.authService=i,this.masterService=n,this.exportService=a,this.toastrService=s,this.countryList$=new p.X([]),this.inlineEditFlag=!0,this.showLogCheckedFlag=!1,this.gridOptions=new F.s8,this.changeDetection=new A.x,this.disableToggleFlag=!1}ngOnInit(){this.getCountryList(!1).then(t=>{this.countryList$.next(t)}).catch(t=>{this.countryList$.next([]),this.toastrService.show({type:"error",text:t})}),this.gridOptions={searchPlaceholder:"Search Country",pageSize:this.authService.pageSize,dateFormat:"yyyy-MM-dd",keyCodeForNextCell:13,showInlineEdit:this.inlineEditFlag,titleForMobileView:"entityBusinessName",pageSizeArray:[5,10,20],showDeleteButton:!1,showAddButton:!0,showEditButton:!0,showActivateDeactivateButton:!0,showSearchInput:!0,activateDeactivateCondition:{conditionalProperty:"activeFlag",valueForActivation:"1",valueForDeactivation:"0"},columns:[{name:"entityBusinessName",label:"Country Name",enable:!0,searchable:!0,sortable:!0,type:"text",editable:!0,isRequired:!0,shouldBeUnique:!0,min:1,max:100,pattern:"[A-Za-z ]*",columnPlaceholder:"Country Name",requiredLabel:"Please enter country",patternLabel:"Please match the requested format."},{name:"entityBusinessShortCode",label:"Abbreviation",enable:!0,searchable:!0,sortable:!0,type:"text",editable:!0,isRequired:!0,shouldBeUnique:!0,min:1,max:10,pattern:"[A-Za-z ]*",columnPlaceholder:"Abbreviation",requiredLabel:"Please enter abbreviation",patternLabel:"Please match the requested format."},{name:"createdByUser",label:"Last Updated By",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"effectiveDateFrom",label:"Last Modified on",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"activeFlag",label:"",enable:!1,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"entityID",label:"",enable:!1,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"entityBusinessID",label:"",enable:!1,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1}]}}ngOnDestroy(){this.countryListSubscription&&this.countryListSubscription.unsubscribe()}getCountryList(t){return new Promise((i,n)=>{this.loader.showSpinner("Country list on the way."),this.countryListSubscription=this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W",detailFlag:t,dropDown:!1}},"countryservice/getAllCountry").subscribe(s=>{this.loader.hideSpinner(),"200"===s.statusCode||"300"===s.statusCode?(s.responseList=null==s.responseList?[]:s.responseList,i(s.responseList)):n(s.errorMessage)},s=>{this.loader.hideSpinner(),n("Either Internet is not working or some internal server issue")})})}exportData(t){const i=[{property:"entityBusinessName",label:"Country Name"},{property:"entityBusinessShortCode",label:"Abbreviation"},{property:"createdByUser",label:"Last Updated By"},{property:"effectiveDateFrom",label:"Last Modified on"}];this.showLogCheckedFlag&&i.push({property:"auditAction",label:"Audit Action"}),this.exportService.generateFile(this.countryList$.getValue(),"Country List."+t,i)}showLog(t){this.countryList$.next([]),t?this.getCountryList(!0).then(i=>{this.showLogCheckedFlag=!0,this.countryList$.next(i),this.gridOptions.showAddButton=!1,this.gridOptions.showEditButton=!1,this.gridOptions.showActivateDeactivateButton=!1,this.gridOptions.columns.push({name:"auditAction",label:"Audit Action",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1})}).catch(i=>{this.countryList$.next([]),this.toastrService.show({type:"error",text:i})}):(this.showLogCheckedFlag=!1,this.ngOnInit())}actionButtonClickEvent(t,i){switch(i){case"add":case"update":this.disableToggleFlag=!0,this.gridOptions.showActivateDeactivateButton=!1;break;case"cancel":this.disableToggleFlag=!1,this.gridOptions.showActivateDeactivateButton=!0}}addNewCountry(t){this.masterService.requestActionRestAPI(t,{genericManipulationRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,entityBusinessName:t.entityBusinessName,entityBusinessShortCode:t.entityBusinessShortCode,auditAction:"C",mode:"W"}},"countryservice/createEntity","Adding ").then(n=>{this.changeDetection.next({originalObject:t,modifiedObject:n}),this.toastrService.show({type:"success",text:t.entityBusinessName+" Added!"}),this.disableToggleFlag=!1,this.gridOptions.showActivateDeactivateButton=!0}).catch(n=>{this.changeDetection.next({originalObject:t,modifiedObject:void 0}),this.disableToggleFlag=!0,this.gridOptions.showActivateDeactivateButton=!1,this.toastrService.show({type:"error",text:n})})}updateCountry(t){this.masterService.requestActionRestAPI(t,{genericManipulationRequestEntity:{entityID:t.entityID,entityBusinessID:t.entityBusinessID,entityBusinessName:t.entityBusinessName,entityBusinessShortCode:t.entityBusinessShortCode,auditAction:"U",companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W"}},"countryservice/updateEntity/","Updating ").then(n=>{this.changeDetection.next({originalObject:t,modifiedObject:n}),this.toastrService.show({type:"success",text:t.entityBusinessName+" Updated!"}),this.disableToggleFlag=!1,this.gridOptions.showActivateDeactivateButton=!0}).catch(n=>{this.changeDetection.next({originalObject:t,modifiedObject:void 0}),this.disableToggleFlag=!0,this.gridOptions.showActivateDeactivateButton=!1,this.toastrService.show({type:"error",text:n})})}activateCountry(t){this.masterService.requestActionRestAPI(t,{genericManipulationRequestEntity:{entityID:t.entityID,entityBusinessID:t.entityBusinessID,entityBusinessName:t.entityBusinessName,entityBusinessShortCode:t.entityBusinessShortCode,auditAction:"A",companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W"}},"countryservice/activateEntity","Activating ").then(n=>{this.changeDetection.next({originalObject:t,modifiedObject:n}),this.toastrService.show({type:"success",text:t.entityBusinessName+" Activated!"})}).catch(n=>{this.changeDetection.next({originalObject:t,modifiedObject:void 0}),this.toastrService.show({type:"error",text:n})})}deactivateCountry(t){this.masterService.requestActionRestAPI(t,{genericManipulationRequestEntity:{entityID:t.entityID,entityBusinessID:t.entityBusinessID,entityBusinessName:t.entityBusinessName,entityBusinessShortCode:t.entityBusinessShortCode,auditAction:"D",companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W"}},"countryservice/deactivateEntity","Deactivating ").then(n=>{this.changeDetection.next({originalObject:t,modifiedObject:n}),this.toastrService.show({type:"success",text:t.entityBusinessName+" Deactivated!"})}).catch(n=>{this.changeDetection.next({originalObject:t,modifiedObject:void 0}),this.toastrService.show({type:"error",text:n})})}}return(r=l).\u0275fac=function(t){return new(t||r)(e.Y36(b.D),e.Y36(C.$),e.Y36(v.c),e.Y36(N.u),e.Y36(f.k))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-country"]],decls:14,vars:4,consts:[[1,"container-fluid"],[1,"row"],["childLink","General Master","subchildLink","Country"],[1,"mat-elevation-z12","lms-master-card"],[1,"lms-matcardtitlegroup"],["mat-icon-button","",3,"disableRipple","click"],["aria-label","excel",1,"lms-excel-icon"],["aria-label","csv",1,"lms-csv-icon"],[1,"remaining-space"],["color","primary",1,"lms-matslidetoggle",3,"checked","disabled","change"]],template:function(t,i){1&t&&(e._UZ(0,"app-header"),e.TgZ(1,"div",0)(2,"div",1),e._UZ(3,"app-breadcrumb",2),e.qZA(),e.TgZ(4,"div",1)(5,"mat-card",3)(6,"mat-card-title-group",4)(7,"button",5),e.NdJ("click",function(){return i.exportData("xlsx")}),e._UZ(8,"div",6),e.qZA(),e.TgZ(9,"button",5),e.NdJ("click",function(){return i.exportData("csv")}),e._UZ(10,"div",7),e.qZA(),e._UZ(11,"span",8),e.TgZ(12,"mat-slide-toggle",9),e.NdJ("change",function(a){return i.showLog(a.checked)}),e._uU(13," Show Logs "),e.qZA()()()()()),2&t&&(e.xp6(7),e.Q6J("disableRipple",!0),e.xp6(2),e.Q6J("disableRipple",!0),e.xp6(3),e.Q6J("checked",i.showLogCheckedFlag)("disabled",i.disableToggleFlag))},dependencies:[S.G,_.RK,d.a8,d.C1,w.Rr,I.L]}),l})(),Ve=(()=>{var r;class l{constructor(t,i,n,a,s){this.loader=t,this.masterService=i,this.exportService=n,this.authService=a,this.toastrService=s,this.departmentList$=new p.X([]),this.inlineEditFlag=!0,this.showLogCheckedFlag=!1,this.gridOptions=new F.s8,this.changeDetection=new A.x,this.disableToggleFlag=!1}ngOnInit(){this.getdepartmentList(!1).then(t=>{this.departmentList$.next(t)}).catch(t=>{this.departmentList$.next([]),this.toastrService.show({type:"error",text:t})}),this.gridOptions={searchPlaceholder:"Search Department",pageSize:this.authService.pageSize,dateFormat:"yyyy-MM-dd",keyCodeForNextCell:13,showInlineEdit:this.inlineEditFlag,titleForMobileView:"entityBusinessName",pageSizeArray:[5,10,20],showDeleteButton:!1,showAddButton:!0,showEditButton:!0,showActivateDeactivateButton:!0,showSearchInput:!0,activateDeactivateCondition:{conditionalProperty:"activeFlag",valueForActivation:"1",valueForDeactivation:"0"},columns:[{name:"entityBusinessName",label:"Department",enable:!0,searchable:!0,sortable:!0,type:"text",editable:!0,isRequired:!0,shouldBeUnique:!0,min:1,max:100,pattern:"[^]*",columnPlaceholder:"Department Name",requiredLabel:"Please enter department",patternLabel:"Please match the requested format."},{name:"entityBusinessShortCode",label:"Abbreviation",enable:!0,searchable:!0,sortable:!0,type:"text",editable:!0,isRequired:!0,shouldBeUnique:!0,min:1,max:4,pattern:"[^]*",columnPlaceholder:"Abbreviation",requiredLabel:"Please enter abbreviation",patternLabel:"Please match the requested format."},{name:"departmentType",label:"Department Type",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!0,isRequired:!1,min:1,max:100,pattern:"[^]*",columnPlaceholder:"Department Type",patternLabel:"Please match the requested format."},{name:"remarks",label:"Remarks",enable:!0,sortable:!1,searchable:!1,type:"text",editable:!0,isRequired:!1,min:1,max:200,pattern:"[^]*",columnPlaceholder:"Remarks",patternLabel:"Please match the requested format."},{name:"createdByUser",label:"Last Updated By",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"effectiveDateFrom",label:"Created On",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"activeFlag",label:"",enable:!1,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"entityID",label:"",enable:!1,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"entityBusinessID",label:"",enable:!1,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1}]}}getdepartmentList(t){return new Promise((i,n)=>{this.loader.showSpinner("Department list on the way."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W",detailFlag:t,dropDown:!1}},"departmentservice/getAllDepartment").subscribe(s=>{this.loader.hideSpinner(),"200"===s.statusCode||"300"===s.statusCode?(s.responseList=null==s.responseList?[]:s.responseList,i(s.responseList)):n(s.errorMessage)},s=>{this.loader.hideSpinner(),n("Either Internet is not working or facing internal server issue")})})}exportData(t){const i=[{property:"entityBusinessName",label:"Department"},{property:"entityBusinessShortCode",label:"Abbreviation"},{property:"departmentType",label:"Department Type"},{property:"remarks",label:"Remarks"},{property:"createdByUser",label:"Last Updated By"},{property:"effectiveDateFrom",label:"Created On"}];this.showLogCheckedFlag&&i.push({property:"auditAction",label:"Audit Action"}),this.exportService.generateFile(this.departmentList$.getValue(),"Department List."+t,i)}showLog(t){this.departmentList$.next([]),t?this.getdepartmentList(!0).then(i=>{this.showLogCheckedFlag=!0,this.departmentList$.next(i),this.gridOptions.showAddButton=!1,this.gridOptions.showEditButton=!1,this.gridOptions.showActivateDeactivateButton=!1,this.gridOptions.columns.push({name:"auditAction",label:"Audit Action",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1})}).catch(i=>{this.departmentList$.next([]),this.toastrService.show({type:"error",text:i})}):(this.showLogCheckedFlag=!1,this.ngOnInit())}actionButtonClickEvent(t,i){switch(i){case"add":case"update":this.disableToggleFlag=!0,this.gridOptions.showActivateDeactivateButton=!1;break;case"cancel":this.disableToggleFlag=!1,this.gridOptions.showActivateDeactivateButton=!0}}addNewDepartment(t){this.masterService.requestActionRestAPI(t,{departmentRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,entityBusinessName:t.entityBusinessName,entityBusinessShortCode:t.entityBusinessShortCode,departmentType:t.departmentType,remarks:t.remarks,auditAction:"C",mode:"W"}},"departmentservice/createDepartmentEntity/","Adding ").then(n=>{this.changeDetection.next({originalObject:t,modifiedObject:n}),this.toastrService.show({type:"success",text:t.entityBusinessName+" Added!"}),this.disableToggleFlag=!1,this.gridOptions.showActivateDeactivateButton=!0}).catch(n=>{this.changeDetection.next({originalObject:t,modifiedObject:void 0}),this.disableToggleFlag=!0,this.gridOptions.showActivateDeactivateButton=!1,this.toastrService.show({type:"error",text:n})})}updateDepartment(t){this.masterService.requestActionRestAPI(t,{departmentRequestEntity:{entityID:t.entityID,entityBusinessID:t.entityBusinessID,entityBusinessName:t.entityBusinessName,entityBusinessShortCode:t.entityBusinessShortCode,departmentType:t.departmentType,remarks:t.remarks,auditAction:"U",companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W"}},"departmentservice/updateDepartmentEntity/","Updating ").then(n=>{this.changeDetection.next({originalObject:t,modifiedObject:n}),this.toastrService.show({type:"success",text:t.entityBusinessName+" Updated!"}),this.disableToggleFlag=!1,this.gridOptions.showActivateDeactivateButton=!0}).catch(n=>{this.changeDetection.next({originalObject:t,modifiedObject:void 0}),this.disableToggleFlag=!0,this.gridOptions.showActivateDeactivateButton=!1,this.toastrService.show({type:"error",text:n})})}activateDepartment(t){this.masterService.requestActionRestAPI(t,{departmentRequestEntity:{entityID:t.entityID,entityBusinessID:t.entityBusinessID,entityBusinessName:t.entityBusinessName,entityBusinessShortCode:t.entityBusinessShortCode,departmentType:t.departmentType,remarks:t.remarks,auditAction:"A",companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W"}},"departmentservice/activateDepartmentEntity","Activating ").then(n=>{this.changeDetection.next({originalObject:t,modifiedObject:n}),this.toastrService.show({type:"success",text:t.entityBusinessName+" Activated!"})}).catch(n=>{this.changeDetection.next({originalObject:t,modifiedObject:void 0}),this.toastrService.show({type:"error",text:n})})}deactivateDepartment(t){this.masterService.requestActionRestAPI(t,{departmentRequestEntity:{entityID:t.entityID,entityBusinessID:t.entityBusinessID,entityBusinessName:t.entityBusinessName,entityBusinessShortCode:t.entityBusinessShortCode,departmentType:t.departmentType,remarks:t.remarks,auditAction:"D",companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W"}},"departmentservice/deactivateDepartmentEntity","Deactivating ").then(n=>{this.changeDetection.next({originalObject:t,modifiedObject:n}),this.toastrService.show({type:"success",text:t.entityBusinessName+" Deactivated!"})}).catch(n=>{this.changeDetection.next({originalObject:t,modifiedObject:void 0}),this.toastrService.show({type:"error",text:n})})}}return(r=l).\u0275fac=function(t){return new(t||r)(e.Y36(b.D),e.Y36(v.c),e.Y36(N.u),e.Y36(C.$),e.Y36(f.k))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-department"]],decls:14,vars:4,consts:[[1,"container-fluid"],[1,"row"],["childLink","General Master","subchildLink","Department"],[1,"mat-elevation-z12","lms-master-card"],[1,"lms-matcardtitlegroup"],["mat-icon-button","",3,"disableRipple","click"],["aria-label","excel",1,"lms-excel-icon"],["aria-label","csv",1,"lms-csv-icon"],[1,"remaining-space"],["color","primary",1,"lms-matslidetoggle",3,"checked","disabled","change"]],template:function(t,i){1&t&&(e._UZ(0,"app-header"),e.TgZ(1,"div",0)(2,"div",1),e._UZ(3,"app-breadcrumb",2),e.qZA(),e.TgZ(4,"div",1)(5,"mat-card",3)(6,"mat-card-title-group",4)(7,"button",5),e.NdJ("click",function(){return i.exportData("xlsx")}),e._UZ(8,"div",6),e.qZA(),e.TgZ(9,"button",5),e.NdJ("click",function(){return i.exportData("csv")}),e._UZ(10,"div",7),e.qZA(),e._UZ(11,"span",8),e.TgZ(12,"mat-slide-toggle",9),e.NdJ("change",function(a){return i.showLog(a.checked)}),e._uU(13," Show Logs "),e.qZA()()()()()),2&t&&(e.xp6(7),e.Q6J("disableRipple",!0),e.xp6(2),e.Q6J("disableRipple",!0),e.xp6(3),e.Q6J("checked",i.showLogCheckedFlag)("disabled",i.disableToggleFlag))},dependencies:[S.G,_.RK,d.a8,d.C1,w.Rr,I.L]}),l})(),Ke=(()=>{var r;class l{constructor(t,i,n,a,s){this.loader=t,this.authService=i,this.masterService=n,this.exportService=a,this.toastrService=s,this.designationList$=new p.X([]),this.inlineEditFlag=!0,this.showLogCheckedFlag=!1,this.gridOptions=new F.s8,this.changeDetection=new A.x,this.disableToggleFlag=!1}ngOnInit(){this.getDesignationList(!1).then(t=>{this.designationList$.next(t)}).catch(t=>{this.designationList$.next([]),this.toastrService.show({type:"error",text:t})}),this.gridOptions={searchPlaceholder:"Search Designation",pageSize:this.authService.pageSize,dateFormat:"yyyy-MM-dd",keyCodeForNextCell:13,showInlineEdit:this.inlineEditFlag,titleForMobileView:"entityBusinessName",pageSizeArray:[5,10,20],showDeleteButton:!1,showAddButton:!0,showEditButton:!0,showActivateDeactivateButton:!0,showSearchInput:!0,activateDeactivateCondition:{conditionalProperty:"activeFlag",valueForActivation:"1",valueForDeactivation:"0"},columns:[{name:"entityBusinessName",label:"Designation",enable:!0,searchable:!0,sortable:!0,type:"text",editable:!0,isRequired:!0,shouldBeUnique:!0,min:1,max:100,pattern:"[^]*",columnPlaceholder:"Designation",requiredLabel:"Please enter designation",patternLabel:"Please match the requested format."},{name:"entityBusinessShortCode",label:"Abbreviation",enable:!0,searchable:!0,sortable:!0,type:"text",editable:!0,isRequired:!0,shouldBeUnique:!0,min:1,max:10,pattern:"[^]*",columnPlaceholder:"Abbreviation",requiredLabel:"Please enter abbreviation",patternLabel:"Please match the requested format."},{name:"createdByUser",label:"Last Updated By",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"effectiveDateFrom",label:"Last Modified on",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"activeFlag",label:"",enable:!1,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"entityID",label:"",enable:!1,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"entityBusinessID",label:"",enable:!1,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1}]}}getDesignationList(t){return new Promise((i,n)=>{this.loader.showSpinner("Designation list on the way."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W",detailFlag:t,dropDown:!1}},"designationservice/getAllDesignation/").subscribe(s=>{this.loader.hideSpinner(),"200"===s.statusCode||"300"===s.statusCode?(s.responseList=null==s.responseList?[]:s.responseList,i(s.responseList)):n(s.errorMessage)},s=>{this.loader.hideSpinner(),n("Either Internet is not working or some internal server issue")})})}exportData(t){const i=[{property:"entityBusinessName",label:"Designation"},{property:"entityBusinessShortCode",label:"Abbreviation"},{property:"createdByUser",label:"Last Updated By"},{property:"effectiveDateFrom",label:"Last Modified on"}];this.showLogCheckedFlag&&i.push({property:"auditAction",label:"Audit Action"}),this.exportService.generateFile(this.designationList$.getValue(),"Designation List."+t,i)}showLog(t){this.designationList$.next([]),t?this.getDesignationList(!0).then(i=>{this.showLogCheckedFlag=!0,this.designationList$.next(i),this.gridOptions.showAddButton=!1,this.gridOptions.showEditButton=!1,this.gridOptions.showActivateDeactivateButton=!1,this.gridOptions.columns.push({name:"auditAction",label:"Audit Action",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1})}).catch(i=>{this.designationList$.next([]),this.toastrService.show({type:"error",text:i})}):(this.showLogCheckedFlag=!1,this.ngOnInit())}addNewDesignation(t){this.masterService.requestActionRestAPI(t,{genericManipulationRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,entityBusinessName:t.entityBusinessName,entityBusinessShortCode:t.entityBusinessShortCode,auditAction:"C",mode:"W"}},"designationservice/createDesignation/","Adding ").then(n=>{this.changeDetection.next({originalObject:t,modifiedObject:n}),this.toastrService.show({type:"success",text:t.entityBusinessName+" Added!"}),this.disableToggleFlag=!1,this.gridOptions.showActivateDeactivateButton=!0}).catch(n=>{this.changeDetection.next({originalObject:t,modifiedObject:void 0}),this.disableToggleFlag=!0,this.gridOptions.showActivateDeactivateButton=!1,this.toastrService.show({type:"error",text:n})})}updateDesignation(t){this.masterService.requestActionRestAPI(t,{genericManipulationRequestEntity:{entityID:t.entityID,entityBusinessID:t.entityBusinessID,entityBusinessName:t.entityBusinessName,entityBusinessShortCode:t.entityBusinessShortCode,auditAction:"U",companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W"}},"designationservice/updateDesignation/","Updating ").then(n=>{this.changeDetection.next({originalObject:t,modifiedObject:n}),this.toastrService.show({type:"success",text:t.entityBusinessName+" Updated!"}),this.disableToggleFlag=!1,this.gridOptions.showActivateDeactivateButton=!0}).catch(n=>{this.changeDetection.next({originalObject:t,modifiedObject:void 0}),this.disableToggleFlag=!0,this.gridOptions.showActivateDeactivateButton=!1,this.toastrService.show({type:"error",text:n})})}actionButtonClickEvent(t,i){switch(i){case"add":case"update":this.disableToggleFlag=!0,this.gridOptions.showActivateDeactivateButton=!1;break;case"cancel":this.disableToggleFlag=!1,this.gridOptions.showActivateDeactivateButton=!0}}activateDesignation(t){this.masterService.requestActionRestAPI(t,{genericManipulationRequestEntity:{entityID:t.entityID,entityBusinessID:t.entityBusinessID,entityBusinessName:t.entityBusinessName,entityBusinessShortCode:t.entityBusinessShortCode,auditAction:"A",companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W"}},"designationservice/activateDesignation","Activating ").then(n=>{this.changeDetection.next({originalObject:t,modifiedObject:n}),this.toastrService.show({type:"success",text:t.entityBusinessName+" Activated!"})}).catch(n=>{this.changeDetection.next({originalObject:t,modifiedObject:void 0}),this.toastrService.show({type:"error",text:n})})}deactivateDesignation(t){this.masterService.requestActionRestAPI(t,{genericManipulationRequestEntity:{entityID:t.entityID,entityBusinessID:t.entityBusinessID,entityBusinessName:t.entityBusinessName,entityBusinessShortCode:t.entityBusinessShortCode,auditAction:"D",companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W"}},"designationservice/deactivateDesignation","Deactivating ").then(n=>{this.changeDetection.next({originalObject:t,modifiedObject:n}),this.toastrService.show({type:"success",text:t.entityBusinessName+" Deactivated!"})}).catch(n=>{this.changeDetection.next({originalObject:t,modifiedObject:void 0}),this.toastrService.show({type:"error",text:n})})}}return(r=l).\u0275fac=function(t){return new(t||r)(e.Y36(b.D),e.Y36(C.$),e.Y36(v.c),e.Y36(N.u),e.Y36(f.k))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-designation"]],decls:14,vars:4,consts:[[1,"container-fluid"],[1,"row"],["childLink","General Master","subchildLink","Designation"],[1,"mat-elevation-z12","lms-master-card"],[1,"lms-matcardtitlegroup"],["mat-icon-button","",3,"disableRipple","click"],["aria-label","excel",1,"lms-excel-icon"],["aria-label","csv",1,"lms-csv-icon"],[1,"remaining-space"],["color","primary",1,"lms-matslidetoggle",3,"checked","disabled","change"]],template:function(t,i){1&t&&(e._UZ(0,"app-header"),e.TgZ(1,"div",0)(2,"div",1),e._UZ(3,"app-breadcrumb",2),e.qZA(),e.TgZ(4,"div",1)(5,"mat-card",3)(6,"mat-card-title-group",4)(7,"button",5),e.NdJ("click",function(){return i.exportData("xlsx")}),e._UZ(8,"div",6),e.qZA(),e.TgZ(9,"button",5),e.NdJ("click",function(){return i.exportData("csv")}),e._UZ(10,"div",7),e.qZA(),e._UZ(11,"span",8),e.TgZ(12,"mat-slide-toggle",9),e.NdJ("change",function(a){return i.showLog(a.checked)}),e._uU(13," Show Logs "),e.qZA()()()()()),2&t&&(e.xp6(7),e.Q6J("disableRipple",!0),e.xp6(2),e.Q6J("disableRipple",!0),e.xp6(3),e.Q6J("checked",i.showLogCheckedFlag)("disabled",i.disableToggleFlag))},dependencies:[S.G,_.RK,d.a8,d.C1,w.Rr,I.L]}),l})();var Z=h(7328),g=h(9773),$=h(8738),Q=h(3680),P=h(8034),G=h(8525),O=h(4104);function He(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Employee Name is required field. "),e.qZA())}function et(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Please match the requested format. "),e.qZA())}function tt(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Employee Name is already taken. "),e.qZA())}function it(r,l){if(1&r&&(e.TgZ(0,"mat-option",52),e._uU(1),e.qZA()),2&r){const c=l.$implicit;e.Q6J("value",c.entityBusinessShortCode),e.xp6(1),e.hij(" ",c.entityBusinessName," ")}}function nt(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Gender is required field. "),e.qZA())}function at(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Please enter valid Mobile number. "),e.qZA())}function st(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Mobile Number is required field. "),e.qZA())}function rt(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Mobile Number is already taken. "),e.qZA())}function ot(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Please enter valid Email-ID. "),e.qZA())}function lt(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Email-ID is required field. "),e.qZA())}function ut(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Email-ID is already taken. "),e.qZA())}function ct(r,l){1&r&&e._UZ(0,"div",53)}function pt(r,l){1&r&&e._UZ(0,"div",54)}function dt(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Password is required field. "),e.qZA())}function mt(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Address is required field. "),e.qZA())}function ht(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Please enter valid contact number. "),e.qZA())}function yt(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Please enter valid pin code. "),e.qZA())}function gt(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Pin code is required field. "),e.qZA())}function bt(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Designation is required field. "),e.qZA())}function ft(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Please match the requested format [HSHGD1995R]. "),e.qZA())}function vt(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Pan Number is required field. "),e.qZA())}function Ct(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Joining Date is required field. "),e.qZA())}function Dt(r,l){if(1&r){const c=e.EpF();e.ynx(0),e.TgZ(1,"label",55),e._UZ(2,"div",56),e._uU(3," Upload Employee Image "),e.qZA(),e.TgZ(4,"input",57),e.NdJ("change",function(i){e.CHM(c);const n=e.oxw();return e.KtG(n.uploadEmployeeImage(i))}),e.qZA(),e.BQk()}}function _t(r,l){if(1&r){const c=e.EpF();e.ynx(0),e._UZ(1,"img",58),e.TgZ(2,"button",59),e.NdJ("click",function(){e.CHM(c);const i=e.oxw();return i.base64StringForEmployeeImage="",e.KtG(i.safeEmployeeImageURL="")}),e._UZ(3,"div",60),e.qZA(),e.BQk()}if(2&r){const c=e.oxw();e.xp6(1),e.Q6J("src",c.safeEmployeeImageURL,e.LSH),e.xp6(1),e.Q6J("disableRipple",!0)}}function St(r,l){if(1&r){const c=e.EpF();e.ynx(0),e.TgZ(1,"label",61),e._UZ(2,"div",56),e._uU(3," Upload Employee Signature "),e.qZA(),e.TgZ(4,"input",62),e.NdJ("change",function(i){e.CHM(c);const n=e.oxw();return e.KtG(n.uploadEmployeeSignature(i))}),e.qZA(),e.BQk()}}function It(r,l){if(1&r){const c=e.EpF();e.ynx(0),e._UZ(1,"img",63),e.TgZ(2,"button",59),e.NdJ("click",function(){e.CHM(c);const i=e.oxw();return i.base64StringForEmployeeSignature="",e.KtG(i.safeEmployeeSignatureURL="")}),e._UZ(3,"div",60),e.qZA(),e.BQk()}if(2&r){const c=e.oxw();e.xp6(1),e.Q6J("src",c.safeEmployeeSignatureURL,e.LSH),e.xp6(1),e.Q6J("disableRipple",!0)}}function wt(r,l){1&r&&(e.TgZ(0,"div",64)(1,"span"),e._uU(2,"*Please fill required fields of all tabs"),e.qZA()())}let K=(()=>{var r;class l{constructor(t,i,n,a,s,u,m){this.loader=t,this.masterService=i,this.authService=n,this.fb=a,this.toastrService=s,this._sanitizer=u,this.commonService=m,this.selectedMasterData={},this.masterList=[],this.submitButtonLabel="Submit",this.hidePassword=!0,this.currentDate=new Date,this.salutationList$=new p.X([]),this.genderList$=new p.X([]),this.bloodGroupList$=new p.X([]),this.maritalList$=new p.X([]),this.countryList$=new p.X([]),this.stateList$=new p.X([]),this.cityList$=new p.X([]),this.roleList$=new p.X([]),this.departmentList$=new p.X([]),this.designationList$=new p.X([]),this.fetchDataOnCloseDialog$=new p.X([]),this.base64StringForEmployeeImage="",this.base64StringForEmployeeSignature="",this.destroySubscription$=new Z.t(1),this.isSubmitted=!1}ngOnInit(){if(this.maritalList$.next([{entityBusinessID:"Married",entityBusinessName:"Married"},{entityBusinessID:"UnMarried",entityBusinessName:"UnMarried"}]),this.employeeForm=this.fb.group({entityBusinessName:new o.NI(null,[o.kI.required]),entitySalutationID:new o.NI(null),entityFatherName:new o.NI(null),entityMotherName:new o.NI(null),entityGender:new o.NI(null,[o.kI.required]),entityDob:new o.NI(null),entityMobileNumber:new o.NI(null,[o.kI.required]),entityEmailID:new o.NI(null,[o.kI.required,o.kI.email]),Password:new o.NI(null),entityCountryID:new o.NI(null,[o.kI.required]),entityStateID:new o.NI(null,[o.kI.required]),entityCityID:new o.NI(null,[o.kI.required]),entityAddress:new o.NI(null,[o.kI.required]),entityAlternateContactNumber:new o.NI(null),entityPinCode:new o.NI(null,[o.kI.required]),entityBloodGroupID:new o.NI(null),entityMaritalStatus:new o.NI(null),entityRoleID:new o.NI(null,[o.kI.required]),entityDepartmentID:new o.NI(null,[o.kI.required]),entityDesignationName:new o.NI(null,[o.kI.required]),entityPanCard:new o.NI(null),entityJoiningDate:new o.NI(this.currentDate,[o.kI.required]),entityResignitionDate:new o.NI(null),entityQualification:new o.NI(null),specialization:new o.NI(null),regNo:new o.NI(null),ipdConsultationCharges:new o.NI(null),opdNew:new o.NI(null),isPercentage:new o.NI(!1),amount:new o.NI(null),opdFollowUp:new o.NI(null)}),null!==this.selectedMasterData){this.employeeForm.controls.Password.clearValidators(),this.employeeForm.updateValueAndValidity(),this.getSalutaionList(!0).then(i=>{this.salutationList$.next(i),this.getGenderList(!0).then(n=>{this.genderList$.next(n),this.getCountryList(!0).then(a=>{this.countryList$.next(a),this.getStatesList(this.selectedMasterData.entityCountryID,!0).then(s=>{this.stateList$.next(s),this.getCitiesList(this.selectedMasterData.entityStateID,!0).then(u=>{this.cityList$.next(u),this.getBloodgroupList(!0).then(m=>{this.bloodGroupList$.next(m),this.getRoleList(!0).then(L=>{this.roleList$.next(L),this.getDepartmentList(!1).then(T=>{this.departmentList$.next(T)}).catch(()=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}).catch(()=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}).catch(()=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}).catch(()=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}).catch(()=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}).catch(()=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}).catch(()=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}).catch(()=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})});const t=Object.entries(this.employeeForm.value).reduce((i,[n,a])=>(i[n]=this.selectedMasterData[n],i),{});this.employeeForm.patchValue(t),this.employeeForm.controls.entityCountryID.setValue(this.selectedMasterData.employeePersonal.entityCountryID),this.employeeForm.controls.entityStateID.setValue(this.selectedMasterData.employeePersonal.entityStateID),this.employeeForm.controls.entityCityID.setValue(this.selectedMasterData.employeePersonal.entityCityID),this.employeeForm.controls.entityAddress.setValue(this.selectedMasterData.employeePersonal.entityAddress),this.employeeForm.controls.entityAlternateContactNumber.setValue(this.selectedMasterData.employeePersonal.entityAlternateContactNumber),this.employeeForm.controls.entityPinCode.setValue(this.selectedMasterData.employeePersonal.entityPinCode),this.employeeForm.controls.entityBloodGroupID.setValue(this.selectedMasterData.employeePersonal.entityBloodGroupID),this.employeeForm.controls.entityMaritalStatus.setValue(this.selectedMasterData.employeePersonal.entityMaritalStatus),this.employeeForm.controls.entityRoleID.setValue(this.selectedMasterData.employeeOfficial.entityRoleID),this.employeeForm.controls.entityDepartmentID.setValue(this.selectedMasterData.employeeOfficial.entityDepartmentID),this.employeeForm.controls.entityDesignationName.setValue(this.selectedMasterData.employeeOfficial.entityDesignationName),this.employeeForm.controls.entityPanCard.setValue(this.selectedMasterData.employeeOfficial.entityPanCard),this.employeeForm.controls.entityJoiningDate.setValue(this.selectedMasterData.employeeOfficial.entityJoiningDate),this.employeeForm.controls.entityResignitionDate.setValue(this.selectedMasterData.employeeOfficial.entityResignitionDate),this.employeeForm.controls.entityQualification.setValue(this.selectedMasterData.employeeOfficial.entityQualification),this.employeeForm.controls.entitySalutationID.setValue(this.selectedMasterData.entitySalutationID),this.employeeForm.controls.isPercentage.setValue(1==this.selectedMasterData.isPercentage),null!==this.selectedMasterData.entityProfilePicture&&(this.base64StringForEmployeeImage=this.selectedMasterData.entityProfilePicture,this.safeEmployeeImageURL=this._sanitizer.bypassSecurityTrustResourceUrl("data:image/jpg;base64,"+this.base64StringForEmployeeImage)),null!==this.selectedMasterData.employeeOfficial.entitySignature&&(this.base64StringForEmployeeSignature=this.selectedMasterData.employeeOfficial.entitySignature,this.safeEmployeeSignatureURL=this._sanitizer.bypassSecurityTrustResourceUrl("data:image/jpg;base64,"+this.base64StringForEmployeeSignature))}else this.employeeForm.controls.Password.setValidators([o.kI.required]),this.employeeForm.updateValueAndValidity(),this.getSalutaionList(!0).then(t=>{this.salutationList$.next(t),this.getGenderList(!0).then(i=>{this.genderList$.next(i),this.getCountryList(!0).then(n=>{this.countryList$.next(n),this.getBloodgroupList(!0).then(a=>{this.bloodGroupList$.next(a),this.getRoleList(!0).then(s=>{this.roleList$.next(s),this.getDepartmentList(!1).then(u=>{this.departmentList$.next(u)}).catch(()=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}).catch(()=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}).catch(()=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}).catch(()=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}).catch(()=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}).catch(()=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}onDOBChange(t){let i=this.currentDate.getFullYear()-t.getFullYear();const n=this.currentDate.getMonth()-t.getMonth();(n<0||0===n&&this.currentDate.getDate()<t.getDate())&&i--,i<18&&(this.toastrService.show({type:"error",text:"Employee age should be greater than or equal 18 years!"}),this.employeeForm.controls.entityDob.setValue(null),this.employeeForm.updateValueAndValidity())}get isPercentage(){return this.employeeForm.controls.isPercentage}getCountryList(t){return new Promise((i,n)=>{this.loader.showSpinner("Loading..."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,entityBusinessID:null,mode:"W",detailFlag:null!==this.selectedMasterData,dropDown:!0}},"countryservice/getAllCountry").pipe((0,g.R)(this.destroySubscription$)).subscribe(s=>{t?this.loader.showSpinner("Loading..."):this.loader.hideSpinner(),"200"===s.statusCode||"300"===s.statusCode?(s.responseList=null==s.responseList?[]:s.responseList,i(s.responseList)):(n(s.errorMessage),this.loader.hideSpinner())},s=>{this.loader.hideSpinner(),n("Either Internet is not working or facing internal server issue")})})}getStatesList(t,i){return new Promise((n,a)=>{this.loader.showSpinner("Loading..."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,entityBusinessID:t,mode:"W",detailFlag:null!==this.selectedMasterData,dropDown:!0}},"stateservice/getAllState/").pipe((0,g.R)(this.destroySubscription$)).subscribe(u=>{i?this.loader.showSpinner("Loading..."):this.loader.hideSpinner(),"200"===u.statusCode||"300"===u.statusCode?(u.responseList=null==u.responseList?[]:u.responseList,n(u.responseList)):(a(u.errorMessage),this.loader.hideSpinner())},u=>{this.loader.hideSpinner(),a("Either Internet is not working or facing internal server issue")})})}getCitiesList(t,i){return new Promise((n,a)=>{this.loader.showSpinner("Loading..."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,entityBusinessID:t,mode:"W",detailFlag:null!==this.selectedMasterData,dropDown:!0}},"cityservice/getAllCity/").pipe((0,g.R)(this.destroySubscription$)).subscribe(u=>{i?this.loader.showSpinner("Loading..."):this.loader.hideSpinner(),"200"===u.statusCode||"300"===u.statusCode?(u.responseList=null==u.responseList?[]:u.responseList,n(u.responseList)):(a(u.errorMessage),this.loader.hideSpinner())},u=>{this.loader.hideSpinner(),a("Either Internet is not working or facing internal server issue")})})}getSalutaionList(t){return new Promise((i,n)=>{this.loader.showSpinner("Loading..."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,entityBusinessID:null,mode:"W",detailFlag:null!==this.selectedMasterData,dropDown:!0}},"salutationservice/getAllSalutation/").pipe((0,g.R)(this.destroySubscription$)).subscribe(s=>{t?this.loader.showSpinner("Loading..."):this.loader.hideSpinner(),"200"===s.statusCode||"300"===s.statusCode?(s.responseList=null==s.responseList?[]:s.responseList.map(u=>({entityBusinessID:u.entityBusinessName,entityBusinessName:u.entityBusinessName})),i(s.responseList)):(this.loader.hideSpinner(),n(s.errorMessage))},s=>{this.loader.hideSpinner(),n("Either Internet is not working or facing internal server issue")})})}getGenderList(t){return new Promise((i,n)=>{this.loader.showSpinner("Loading..."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,entityType:"G",mode:"W",detailFlag:!1,dropDown:!0}},"enumservice/getAllReferenceEntity/").pipe((0,g.R)(this.destroySubscription$)).subscribe(s=>{t?this.loader.showSpinner("Loading..."):this.loader.hideSpinner(),"200"===s.statusCode||"300"===s.statusCode?(s.responseList=null==s.responseList?[]:s.responseList,i(s.responseList)):(n(s.errorMessage),this.loader.hideSpinner())},s=>{this.loader.hideSpinner(),n("Either Internet is not working or facing internal server issue")})})}getRoleList(t){return new Promise((i,n)=>{this.loader.showSpinner("Loading..."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,entityBusinessID:null,mode:"W",detailFlag:null!==this.selectedMasterData,dropDown:!0}},"roleservice/getAllRole/").pipe((0,g.R)(this.destroySubscription$)).subscribe(s=>{t?this.loader.showSpinner("Loading..."):this.loader.hideSpinner(),"200"===s.statusCode||"300"===s.statusCode?(s.responseList=null==s.responseList?[]:s.responseList,i(s.responseList)):(n(s.errorMessage),this.loader.hideSpinner())},s=>{this.loader.hideSpinner(),n("Either Internet is not working or facing internal server issue")})})}getDepartmentList(t){return new Promise((i,n)=>{this.loader.showSpinner("Loading..."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,entityBusinessID:null,mode:"W",detailFlag:null!==this.selectedMasterData,dropDown:!0}},"departmentservice/getAllDepartment").pipe((0,g.R)(this.destroySubscription$)).subscribe(s=>{t?this.loader.showSpinner("Loading..."):this.loader.hideSpinner(),"200"===s.statusCode||"300"===s.statusCode?(s.responseList=null==s.responseList?[]:s.responseList,i(s.responseList)):(n(s.errorMessage),this.loader.hideSpinner())},s=>{this.loader.hideSpinner(),n("Either Internet is not working or facing internal server issue")})})}getBloodgroupList(t){return new Promise((i,n)=>{this.loader.showSpinner("Loading..."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,entityBusinessID:null,mode:"W",detailFlag:null!==this.selectedMasterData,dropDown:!0}},"bloodgroupservice/getAllBloodGroup/").pipe((0,g.R)(this.destroySubscription$)).subscribe(s=>{t?this.loader.showSpinner("Loading..."):this.loader.hideSpinner(),"200"===s.statusCode||"300"===s.statusCode?(s.responseList=null==s.responseList?[]:s.responseList,i(s.responseList)):(n(s.errorMessage),this.loader.hideSpinner())},s=>{this.loader.hideSpinner(),n("Either Internet is not working or facing internal server issue")})})}checkMobileNumberIsExists(t){return new Promise((i,n)=>{this.loader.showSpinner("Loading..."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,entityBusinessName:t,mode:"W",detailFlag:!1,dropDown:!0}},"adminservice/validateMobileNo").pipe((0,g.R)(this.destroySubscription$)).subscribe(s=>{this.loader.hideSpinner(),"200"===s.statusCode?i(s.responseList[0]):"300"===s.statusCode?i(!1):n(s.errorMessage)},s=>{this.loader.hideSpinner(),n("Either Internet is not working or facing internal server issue")})})}uploadEmployeeImage(t){let i=t.target.files||t.srcElement.files;var n=i[0];if(parseFloat(this.calculateFileSize(n.size,2))>40)this.toastrService.show({type:"error",text:"File size should not greater than 40 kb"}),this.base64StringForEmployeeImage="";else if(i&&n){var a=new FileReader;a.onload=this.loadEmployeeImage.bind(this),a.readAsBinaryString(n)}}uploadEmployeeSignature(t){let i=t.target.files||t.srcElement.files;var n=i[0];if(parseFloat(this.calculateFileSize(n.size,2))>20)this.toastrService.show({type:"error",text:"File size should not greater than 20 kb"}),this.base64StringForEmployeeSignature="";else if(i&&n){var a=new FileReader;a.onload=this.loadEmployeeSignature.bind(this),a.readAsBinaryString(n)}}calculateFileSize(t,i){if(0==t)return"0 Bytes";var a=i||2,u=Math.floor(Math.log(t)/Math.log(1024));return parseFloat((t/Math.pow(1024,u)).toFixed(a))+" "+["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][u]}loadEmployeeImage(t){this.base64StringForEmployeeImage=btoa(t.target.result),this.safeEmployeeImageURL=this._sanitizer.bypassSecurityTrustResourceUrl("data:image/jpg;base64,"+this.base64StringForEmployeeImage)}loadEmployeeSignature(t){this.base64StringForEmployeeSignature=btoa(t.target.result),this.safeEmployeeSignatureURL=this._sanitizer.bypassSecurityTrustResourceUrl("data:image/jpg;base64,"+this.base64StringForEmployeeSignature)}keytab(t,i,n){if(13===t.keyCode){var a=t.srcElement.id.split("-").reduce((s,u)=>(Number(u)&&(u=Number(u)+1),s+"-"+u));document.getElementById(a).focus()}else this._uniqueColumnValidator(t.target.value,i,n)}_uniqueColumnValidator(t,i,n){if(n){const a=null===this.selectedMasterData?{entityBusinessID:null}:this.selectedMasterData;null!=this.masterList.find(u=>u[i].toString().trim().toLowerCase()===t.trim().toLowerCase()&&u.entityBusinessID!=a.entityBusinessID)&&this.employeeForm.controls[i].setErrors({mustBeUnique:!0})}else switch(i){case"amount":this.isPercentage.value?(Number(t)>100||Number(t)<0)&&(this.toastrService.show({type:"error",text:"Percentage value should be in between of 1 to 100"}),this.employeeForm.controls[i].setValue(null)):Number(t)<0&&(this.toastrService.show({type:"error",text:"Kindly enter natural number in between 0-9"}),this.employeeForm.controls[i].setValue(null));break;case"ipdConsultationCharges":case"opdNew":case"opdFollowUp":Number(t)<0&&(this.toastrService.show({type:"error",text:"Kindly enter natural number in between 0-9"}),this.employeeForm.controls[i].setValue(null));break;default:10===t.length&&this.checkMobileNumberIsExists(t).then(a=>{a&&(null===this.selectedMasterData?{entityMobileNumber:null}:this.selectedMasterData).entityMobileNumber!==t&&this.employeeForm.controls[i].setErrors({mustBeUnique:!0})}).catch(a=>{this.toastrService.show({type:"error",text:a})})}}onChangeOfDropdown(t){switch(t.type){case"Country":this.getStatesList(t.value,!1).then(i=>{this.stateList$.next(i)}).catch(i=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})});break;case"State":this.getCitiesList(t.value,!1).then(i=>{this.cityList$.next(i)}).catch(i=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}}updateEmployeeForm(){this.employeeForm.valid?(this.isSubmitted=!1,null===this.selectedMasterData?this.addNewEmployee(this.employeeForm.value):this.updateEmployee(this.selectedMasterData,this.employeeForm.value)):(this.isSubmitted=!0,this.employeeForm.markAllAsTouched(),this.employeeForm.updateValueAndValidity())}addNewEmployee(t){const i={employeeRequestEntity:{entityEmailID:t.entityEmailID,entityBusinessName:t.entityBusinessName,entitySalutationID:t.entitySalutationID,entityFatherName:t.entityFatherName,entityMotherName:t.entityMotherName,entityGender:t.entityGender,entityDob:this.commonService.parseDate(t.entityDob),entityMobileNumber:t.entityMobileNumber,entityProfilePicture:this.base64StringForEmployeeImage,entityStatus:1,entityPassword:t.Password,specialization:t.specialization,regNo:t.regNo,ipdConsultationCharges:t.ipdConsultationCharges,opdNew:t.opdNew,isPercentage:Number(t.isPercentage),amount:t.amount,opdFollowUp:t.opdFollowUp,employeePersonal:{entityCountryID:t.entityCountryID,entityStateID:t.entityStateID,entityCityID:t.entityCityID,entityPinCode:t.entityPinCode,entityAddress:t.entityAddress,entityAlternateContactNumber:t.entityAlternateContactNumber,entityBloodGroupID:t.entityBloodGroupID,entityMaritalStatus:t.entityMaritalStatus},employeeOfficial:{entityRoleID:t.entityRoleID,entityDepartmentID:t.entityDepartmentID,entityDesignationName:t.entityDesignationName,entityPanCard:t.entityPanCard,entityJoiningDate:this.commonService.parseDate(t.entityJoiningDate),entityResignitionDate:this.commonService.parseDate(t.entityResignitionDate),entityQualification:t.entityQualification,entitySignature:this.base64StringForEmployeeSignature},companyID:this.authService.companyID,createdBy:this.authService.employeeID,auditAction:"C",mode:"W"}};this.masterService.requestActionRestAPI(t,i,"employeeservice/createEmployee","Adding ").then(n=>{this.fetchDataOnCloseDialog$.next([{modifiedObject:n}])}).catch(n=>{this.toastrService.show({type:"error",text:n})})}updateEmployee(t,i){const n={employeeRequestEntity:{entityID:t.entityID,entityBusinessID:t.entityBusinessID,entityEmployeeCode:t.entityEmployeeCode,entityEmailID:i.entityEmailID,entityBusinessName:i.entityBusinessName,entitySalutationID:i.entitySalutationID,entityFatherName:i.entityFatherName,entityMotherName:i.entityMotherName,entityGender:i.entityGender,entityDob:this.commonService.parseDate(i.entityDob),entityMobileNumber:i.entityMobileNumber,entityProfilePicture:this.base64StringForEmployeeImage,entityStatus:1,entityPassword:i.Password,specialization:i.specialization,regNo:i.regNo,ipdConsultationCharges:i.ipdConsultationCharges,opdNew:i.opdNew,isPercentage:Number(i.isPercentage),amount:i.amount,opdFollowUp:i.opdFollowUp,employeePersonal:{entityCountryID:i.entityCountryID,entityStateID:i.entityStateID,entityCityID:i.entityCityID,entityPinCode:i.entityPinCode,entityAddress:i.entityAddress,entityAlternateContactNumber:i.entityAlternateContactNumber,entityBloodGroupID:i.entityBloodGroupID,entityMaritalStatus:i.entityMaritalStatus},employeeOfficial:{entityRoleID:i.entityRoleID,entityDepartmentID:i.entityDepartmentID,entityDesignationName:i.entityDesignationName,entityPanCard:i.entityPanCard,entityJoiningDate:this.commonService.parseDate(i.entityJoiningDate),entityResignitionDate:this.commonService.parseDate(i.entityResignitionDate),entityQualification:i.entityQualification,entitySignature:this.base64StringForEmployeeSignature},companyID:this.authService.companyID,createdBy:this.authService.employeeID,auditAction:"U",mode:"W"}};this.masterService.requestActionRestAPI(i,n,"employeeservice/updateEmployee","Updating ").then(a=>{this.fetchDataOnCloseDialog$.next([{modifiedObject:a}])}).catch(a=>{this.toastrService.show({type:"error",text:a})})}ngOnDestroy(){this.fetchDataOnCloseDialog$&&this.fetchDataOnCloseDialog$.unsubscribe(),this.destroySubscription$.next(null),this.destroySubscription$.complete()}}return(r=l).\u0275fac=function(t){return new(t||r)(e.Y36(b.D),e.Y36(v.c),e.Y36(C.$),e.Y36(o.qu),e.Y36(f.k),e.Y36(Y.H7),e.Y36($.v))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-employee-form"]],inputs:{selectedMasterData:"selectedMasterData",masterList:"masterList",submitButtonLabel:"submitButtonLabel"},decls:193,vars:92,consts:[["autocomplete","off",3,"formGroup"],["mat-stretch-tabs","","color","primary","backgroundColor","primary",1,"example-stretched-tabs"],["employeeMatTabGroup",""],["label","Basic"],[1,"container-fluid","employee-master-container"],[1,"row"],[1,"col-12","col-md-6","col-lg-4"],["customClass","lms-mat-form-field",3,"dropdownFor","isRequired","records","formControlsName","idForSelect","keyup","dropdownChangeEvent"],["appearance","outline",1,"lms-mat-form-field"],["matInput","","placeholder","Employee Name*","formControlName","entityBusinessName","minLength","1","maxLength","100","required","","id","basic-tab-2",3,"pattern","keyup"],[4,"ngIf"],["matInput","","placeholder","Father Name","formControlName","entityFatherName","minLength","1","maxLength","50","id","basic-tab-3",3,"keyup"],["matInput","","placeholder","Mother Name","formControlName","entityMotherName","minLength","1","maxLength","50","id","basic-tab-4",3,"keyup"],["formControlName","entityGender","required",""],[3,"value",4,"ngFor","ngForOf"],["matInput","","placeholder","Date of Birth (MM/DD/YYYY)","formControlName","entityDob","id","basic-tab-6","readonly","",3,"matDatepicker","max","click","dateChange"],["matSuffix","",3,"for"],["aria-label","calendar-icon","matDatepickerToggleIcon","",1,"lms-calendar-icon"],["dobpicker",""],["matInput","","placeholder","Mobile Number*","id","basic-tab-7","formControlName","entityMobileNumber","minLength","10","maxLength","10","required","",3,"pattern","keyup"],["matInput","","placeholder","Email ID*","formControlName","entityEmailID","minLength","1","maxLength","100","required","","id","basic-tab-8","autocomplete","off",3,"keyup"],["matInput","","placeholder","Password*","formControlName","Password","id","basic-tab-9","autocomplete","new-password",3,"type","keydown.enter"],["type","button","mat-icon-button","","matSuffix","",3,"click"],["aria-label","visibility-icon","class","lms-visibility-icon",4,"ngIf"],["aria-label","visibility-off-icon","class","lms-visibility-off-icon",4,"ngIf"],["label","Personal"],[3,"dropdownFor","isRequired","records","formControlsName","idForSelect","dropdownChangeEvent"],["matInput","","placeholder","Address*","formControlName","entityAddress","minLength","1","maxLength","200","id","personal-tab-4","rows","1","required","",3,"keyup"],["matInput","","placeholder","Alternate Contact Number","id","personal-tab-5","formControlName","entityAlternateContactNumber","minLength","10","maxLength","10",3,"pattern","keyup"],["matInput","","placeholder","Pin Code*","id","personal-tab-8","formControlName","entityPinCode","minLength","1","maxLength","6","required","",3,"pattern","keyup","keydown.enter"],["label","Official"],["matInput","","placeholder","Designation*","id","official-tab-3","formControlName","entityDesignationName","minLength","1","maxLength","100","required","",3,"pattern","keyup"],["matInput","","placeholder","Pan Number","formControlName","entityPanCard","minLength","10","maxLength","10","id","official-tab-4",2,"text-transform","uppercase",3,"pattern"],["matInput","","placeholder","Joining Date (MM/DD/YYYY)*","formControlName","entityJoiningDate","id","official-tab-5","required","","readonly","",3,"matDatepicker","click"],["joiningdatepicker",""],["matInput","","placeholder","Resignation Date (MM/DD/YYYY)","formControlName","entityResignitionDate","id","official-tab-6","readonly","",3,"matDatepicker","min","click"],["resignationdatepicker",""],["matInput","","placeholder","Qualification","id","official-tab-7","formControlName","entityQualification","minLength","1","maxLength","100","id","official-tab-7",3,"pattern","keyup"],[1,"col-12"],[1,"col-12","col-md-4","col-lg-4"],["label","For Doctor"],["matInput","","placeholder","Specialization","formControlName","specialization","minLength","1","maxLength","200","id","for-doctor-tab-1","rows","1",3,"keyup"],["matInput","","placeholder","Registration No","id","for-doctor-tab-2","formControlName","regNo","minLength","1","maxLength","25",3,"keyup"],["matInput","","placeholder","IPD Consultation Charges","id","for-doctor-tab-3","formControlName","ipdConsultationCharges","type","number",3,"keyup"],["matInput","","placeholder","OPD New Charges","id","for-doctor-tab-4","formControlName","opdNew","type","number",3,"keyup"],[1,"col-6"],["formControlName","isPercentage","id","for-doctor-tab-5","color","primary",1,"percentage-checkbox",3,"labelPosition"],["appearance","outline",1,"lms-flat-amount"],["matInput","","id","for-doctor-tab-6","formControlName","amount","type","number",3,"placeholder","keyup"],["matInput","","placeholder","OPD Follow UP Charges","id","for-doctor-tab-7","formControlName","opdFollowUp","type","number",3,"keyup"],["class","required-field-info",4,"ngIf"],["type","button",1,"btn","btn-primary","lms-submit-button",3,"keydown.enter","click"],[3,"value"],["aria-label","visibility-icon",1,"lms-visibility-icon"],["aria-label","visibility-off-icon",1,"lms-visibility-off-icon"],["for","official-tab-8",1,"custom-file-upload"],["aria-label","upload",1,"lms-upload-icon"],["id","official-tab-8","type","file","accept","image/*",3,"change"],["alt","Image Logo",1,"file-upload-image",3,"src"],["mat-icon-button","",1,"clear-image-icon",3,"disableRipple","click"],["aria-label","clear-image",1,"lms-clear-image-icon"],["for","official-tab-9",1,"custom-file-upload"],["id","official-tab-9","type","file","accept","image/*",3,"change"],["alt","Employee Profile Signature",1,"file-upload-image",3,"src"],[1,"required-field-info"]],template:function(t,i){if(1&t){const n=e.EpF();e.TgZ(0,"form",0)(1,"mat-tab-group",1,2)(3,"mat-tab",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"app-lms-select",7),e.NdJ("keyup",function(s){return i.keytab(s,"entitySalutationID",!1)})("dropdownChangeEvent",function(s){return i.onChangeOfDropdown(s)}),e.qZA()(),e.TgZ(8,"div",6)(9,"mat-form-field",8)(10,"mat-label"),e._uU(11,"Employee Name"),e.qZA(),e.TgZ(12,"input",9),e.NdJ("keyup",function(s){return i.keytab(s,"entityBusinessName",!0)}),e.qZA(),e.YNc(13,He,2,0,"mat-error",10),e.YNc(14,et,2,0,"mat-error",10),e.YNc(15,tt,2,0,"mat-error",10),e.qZA()(),e.TgZ(16,"div",6)(17,"mat-form-field",8)(18,"mat-label"),e._uU(19,"Father Name"),e.qZA(),e.TgZ(20,"input",11),e.NdJ("keyup",function(s){return i.keytab(s,"entityFatherName",!1)}),e.qZA()()(),e.TgZ(21,"div",6)(22,"mat-form-field",8)(23,"mat-label"),e._uU(24,"Mother Name"),e.qZA(),e.TgZ(25,"input",12),e.NdJ("keyup",function(s){return i.keytab(s,"entityMotherName",!1)}),e.qZA()()(),e.TgZ(26,"div",6)(27,"mat-form-field",8)(28,"mat-label"),e._uU(29,"Choose Gender"),e.qZA(),e.TgZ(30,"mat-select",13),e.YNc(31,it,2,2,"mat-option",14),e.ALo(32,"async"),e.qZA(),e.YNc(33,nt,2,0,"mat-error",10),e.qZA()(),e.TgZ(34,"div",6)(35,"mat-form-field",8)(36,"mat-label"),e._uU(37,"Date of Birth (MM/DD/YYYY)"),e.qZA(),e.TgZ(38,"input",15),e.NdJ("click",function(){e.CHM(n);const s=e.MAs(42);return e.KtG(s.open())})("dateChange",function(s){return i.onDOBChange(s.value)}),e.qZA(),e.TgZ(39,"mat-datepicker-toggle",16),e._UZ(40,"div",17),e.qZA(),e._UZ(41,"mat-datepicker",null,18),e.qZA()(),e.TgZ(43,"div",6)(44,"mat-form-field",8)(45,"mat-label"),e._uU(46,"Mobile Number"),e.qZA(),e.TgZ(47,"input",19),e.NdJ("keyup",function(s){return i.keytab(s,"entityMobileNumber",!1)}),e.qZA(),e.YNc(48,at,2,0,"mat-error",10),e.YNc(49,st,2,0,"mat-error",10),e.YNc(50,rt,2,0,"mat-error",10),e.qZA()(),e.TgZ(51,"div",6)(52,"mat-form-field",8)(53,"mat-label"),e._uU(54,"Email ID"),e.qZA(),e.TgZ(55,"input",20),e.NdJ("keyup",function(s){return i.keytab(s,"entityEmailID",!0)}),e.qZA(),e.YNc(56,ot,2,0,"mat-error",10),e.YNc(57,lt,2,0,"mat-error",10),e.YNc(58,ut,2,0,"mat-error",10),e.qZA()(),e.TgZ(59,"div",6)(60,"mat-form-field",8)(61,"mat-label"),e._uU(62,"Password"),e.qZA(),e.TgZ(63,"input",21),e.NdJ("keydown.enter",function(){e.CHM(n);const s=e.MAs(2);return e.KtG(s.selectedIndex=1)}),e.qZA(),e.TgZ(64,"button",22),e.NdJ("click",function(){return i.hidePassword=!i.hidePassword}),e.YNc(65,ct,1,0,"div",23),e.YNc(66,pt,1,0,"div",24),e.qZA(),e.YNc(67,dt,2,0,"mat-error",10),e.qZA()()()()(),e.TgZ(68,"mat-tab",25)(69,"div",4)(70,"div",5)(71,"div",6)(72,"app-lms-select",26),e.NdJ("dropdownChangeEvent",function(s){return i.onChangeOfDropdown(s)}),e.qZA()(),e.TgZ(73,"div",6)(74,"app-lms-select",26),e.NdJ("dropdownChangeEvent",function(s){return i.onChangeOfDropdown(s)}),e.qZA()(),e.TgZ(75,"div",6)(76,"app-lms-select",26),e.NdJ("dropdownChangeEvent",function(s){return i.onChangeOfDropdown(s)}),e.qZA()(),e.TgZ(77,"div",6)(78,"mat-form-field",8)(79,"mat-label"),e._uU(80,"Address"),e.qZA(),e.TgZ(81,"textarea",27),e.NdJ("keyup",function(s){return i.keytab(s,"entityAddress",!1)}),e.qZA(),e.YNc(82,mt,2,0,"mat-error",10),e.qZA()(),e.TgZ(83,"div",6)(84,"mat-form-field",8)(85,"mat-label"),e._uU(86,"Alternate Contact Number"),e.qZA(),e.TgZ(87,"input",28),e.NdJ("keyup",function(s){return i.keytab(s,"entityAlternateContactNumber",!1)}),e.qZA(),e.YNc(88,ht,2,0,"mat-error",10),e.qZA()(),e.TgZ(89,"div",6)(90,"app-lms-select",26),e.NdJ("dropdownChangeEvent",function(s){return i.onChangeOfDropdown(s)}),e.qZA()(),e.TgZ(91,"div",6)(92,"app-lms-select",26),e.NdJ("dropdownChangeEvent",function(s){return i.onChangeOfDropdown(s)}),e.qZA()(),e.TgZ(93,"div",6)(94,"mat-form-field",8)(95,"mat-label"),e._uU(96,"Pin Code"),e.qZA(),e.TgZ(97,"input",29),e.NdJ("keyup",function(s){return i.keytab(s,"entityPinCode",!1)})("keydown.enter",function(){e.CHM(n);const s=e.MAs(2);return e.KtG(s.selectedIndex=2)}),e.qZA(),e.YNc(98,yt,2,0,"mat-error",10),e.YNc(99,gt,2,0,"mat-error",10),e.qZA()()()()(),e.TgZ(100,"mat-tab",30)(101,"div",4)(102,"div",5)(103,"div",6)(104,"app-lms-select",26),e.NdJ("dropdownChangeEvent",function(s){return i.onChangeOfDropdown(s)}),e.qZA()(),e.TgZ(105,"div",6)(106,"app-lms-select",26),e.NdJ("dropdownChangeEvent",function(s){return i.onChangeOfDropdown(s)}),e.qZA()(),e.TgZ(107,"div",6)(108,"mat-form-field",8)(109,"mat-label"),e._uU(110,"Designation"),e.qZA(),e.TgZ(111,"input",31),e.NdJ("keyup",function(s){return i.keytab(s,"entityDesignationName",!1)}),e.qZA(),e.YNc(112,bt,2,0,"mat-error",10),e.qZA()(),e.TgZ(113,"div",6)(114,"mat-form-field",8)(115,"mat-label"),e._uU(116,"Pan Number"),e.qZA(),e._UZ(117,"input",32),e.YNc(118,ft,2,0,"mat-error",10),e.YNc(119,vt,2,0,"mat-error",10),e.qZA()(),e.TgZ(120,"div",6)(121,"mat-form-field",8)(122,"mat-label"),e._uU(123,"Joining Date (MM/DD/YYYY)"),e.qZA(),e.TgZ(124,"input",33),e.NdJ("click",function(){e.CHM(n);const s=e.MAs(128);return e.KtG(s.open())}),e.qZA(),e.TgZ(125,"mat-datepicker-toggle",16),e._UZ(126,"div",17),e.qZA(),e._UZ(127,"mat-datepicker",null,34),e.YNc(129,Ct,2,0,"mat-error",10),e.qZA()(),e.TgZ(130,"div",6)(131,"mat-form-field",8)(132,"mat-label"),e._uU(133,"Resignation Date (MM/DD/YYYY)"),e.qZA(),e.TgZ(134,"input",35),e.NdJ("click",function(){e.CHM(n);const s=e.MAs(138);return e.KtG(s.open())}),e.qZA(),e.TgZ(135,"mat-datepicker-toggle",16),e._UZ(136,"div",17),e.qZA(),e._UZ(137,"mat-datepicker",null,36),e.qZA()(),e.TgZ(139,"div",6)(140,"mat-form-field",8)(141,"mat-label"),e._uU(142,"Qualification"),e.qZA(),e.TgZ(143,"input",37),e.NdJ("keyup",function(s){return i.keytab(s,"entityQualification",!1)}),e.qZA()()(),e.TgZ(144,"div",38)(145,"div",5)(146,"div",39),e.YNc(147,Dt,5,0,"ng-container",10),e.YNc(148,_t,4,2,"ng-container",10),e.qZA(),e.TgZ(149,"div",39),e.YNc(150,St,5,0,"ng-container",10),e.YNc(151,It,4,2,"ng-container",10),e.qZA()()()()()(),e.TgZ(152,"mat-tab",40)(153,"div",4)(154,"div",5)(155,"div",6)(156,"mat-form-field",8)(157,"mat-label"),e._uU(158,"Specialization"),e.qZA(),e.TgZ(159,"textarea",41),e.NdJ("keyup",function(s){return i.keytab(s,"specialization",!1)}),e.qZA()()(),e.TgZ(160,"div",6)(161,"mat-form-field",8)(162,"mat-label"),e._uU(163,"Registration No"),e.qZA(),e.TgZ(164,"input",42),e.NdJ("keyup",function(s){return i.keytab(s,"regNo",!1)}),e.qZA()()(),e.TgZ(165,"div",6)(166,"mat-form-field",8)(167,"mat-label"),e._uU(168,"IPD Consultation Charges"),e.qZA(),e.TgZ(169,"input",43),e.NdJ("keyup",function(s){return i.keytab(s,"ipdConsultationCharges",!1)}),e.qZA()()(),e.TgZ(170,"div",6)(171,"mat-form-field",8)(172,"mat-label"),e._uU(173,"OPD New Charges"),e.qZA(),e.TgZ(174,"input",44),e.NdJ("keyup",function(s){return i.keytab(s,"opdNew",!1)}),e.qZA()()(),e.TgZ(175,"div",6)(176,"div",5)(177,"div",45)(178,"mat-checkbox",46),e._uU(179," Check for Percentage "),e.qZA()(),e.TgZ(180,"div",45)(181,"mat-form-field",47)(182,"mat-label"),e._uU(183),e.qZA(),e.TgZ(184,"input",48),e.NdJ("keyup",function(s){return i.keytab(s,"amount",!1)}),e.qZA()()()()(),e.TgZ(185,"div",6)(186,"mat-form-field",8)(187,"mat-label"),e._uU(188,"OPD Follow UP Charges"),e.qZA(),e.TgZ(189,"input",49),e.NdJ("keyup",function(s){return i.keytab(s,"opdFollowUp",!1)}),e.qZA()()()()()()(),e.YNc(190,wt,3,0,"div",50),e.TgZ(191,"button",51),e.NdJ("keydown.enter",function(s){return s.preventDefault()})("click",function(){return i.updateEmployeeForm()}),e._uU(192),e.qZA()()}if(2&t){const n=e.MAs(42),a=e.MAs(128),s=e.MAs(138);e.Q6J("formGroup",i.employeeForm),e.xp6(7),e.Q6J("dropdownFor","Salutation")("isRequired",!0)("records",i.salutationList$)("formControlsName",i.employeeForm.controls.entitySalutationID)("idForSelect","basic-tab-1"),e.xp6(5),e.Q6J("pattern","[^]*"),e.xp6(1),e.Q6J("ngIf",null==i.employeeForm.controls.entityBusinessName||null==i.employeeForm.controls.entityBusinessName.errors?null:i.employeeForm.controls.entityBusinessName.errors.required),e.xp6(1),e.Q6J("ngIf",null==i.employeeForm.controls.entityBusinessName||null==i.employeeForm.controls.entityBusinessName.errors?null:i.employeeForm.controls.entityBusinessName.errors.pattern),e.xp6(1),e.Q6J("ngIf",null==i.employeeForm.controls.entityBusinessName||null==i.employeeForm.controls.entityBusinessName.errors?null:i.employeeForm.controls.entityBusinessName.errors.mustBeUnique),e.xp6(16),e.Q6J("ngForOf",e.lcZ(32,90,i.genderList$)),e.xp6(2),e.Q6J("ngIf",null==i.employeeForm.controls.entityGender||null==i.employeeForm.controls.entityGender.errors?null:i.employeeForm.controls.entityGender.errors.required),e.xp6(5),e.Q6J("matDatepicker",n)("max",i.currentDate),e.xp6(1),e.Q6J("for",n),e.xp6(8),e.Q6J("pattern","[6-9]{1}[0-9]{9}"),e.xp6(1),e.Q6J("ngIf",null==i.employeeForm.controls.entityMobileNumber||null==i.employeeForm.controls.entityMobileNumber.errors?null:i.employeeForm.controls.entityMobileNumber.errors.pattern),e.xp6(1),e.Q6J("ngIf",null==i.employeeForm.controls.entityMobileNumber||null==i.employeeForm.controls.entityMobileNumber.errors?null:i.employeeForm.controls.entityMobileNumber.errors.required),e.xp6(1),e.Q6J("ngIf",null==i.employeeForm.controls.entityMobileNumber||null==i.employeeForm.controls.entityMobileNumber.errors?null:i.employeeForm.controls.entityMobileNumber.errors.mustBeUnique),e.xp6(6),e.Q6J("ngIf",null==i.employeeForm.controls.entityEmailID||null==i.employeeForm.controls.entityEmailID.errors?null:i.employeeForm.controls.entityEmailID.errors.email),e.xp6(1),e.Q6J("ngIf",null==i.employeeForm.controls.entityEmailID||null==i.employeeForm.controls.entityEmailID.errors?null:i.employeeForm.controls.entityEmailID.errors.required),e.xp6(1),e.Q6J("ngIf",null==i.employeeForm.controls.entityEmailID||null==i.employeeForm.controls.entityEmailID.errors?null:i.employeeForm.controls.entityEmailID.errors.mustBeUnique),e.xp6(5),e.Q6J("type",i.hidePassword?"password":"text"),e.xp6(1),e.uIk("aria-label","Hide password")("aria-pressed",i.hidePassword),e.xp6(1),e.Q6J("ngIf",!i.hidePassword),e.xp6(1),e.Q6J("ngIf",i.hidePassword),e.xp6(1),e.Q6J("ngIf",null==i.employeeForm.controls.Password||null==i.employeeForm.controls.Password.errors?null:i.employeeForm.controls.Password.errors.required),e.xp6(5),e.Q6J("dropdownFor","Country")("isRequired",!0)("records",i.countryList$)("formControlsName",i.employeeForm.controls.entityCountryID)("idForSelect","personal-tab-1"),e.xp6(2),e.Q6J("dropdownFor","State")("isRequired",!0)("records",i.stateList$)("formControlsName",i.employeeForm.controls.entityStateID)("idForSelect","personal-tab-2"),e.xp6(2),e.Q6J("dropdownFor","City")("isRequired",!0)("records",i.cityList$)("formControlsName",i.employeeForm.controls.entityCityID)("idForSelect","personal-tab-3"),e.xp6(6),e.Q6J("ngIf",null==i.employeeForm.controls.entityAddress||null==i.employeeForm.controls.entityAddress.errors?null:i.employeeForm.controls.entityAddress.errors.required),e.xp6(5),e.Q6J("pattern","[6-9]{1}[0-9]{9}"),e.xp6(1),e.Q6J("ngIf",null==i.employeeForm.controls.entityAlternateContactNumber||null==i.employeeForm.controls.entityAlternateContactNumber.errors?null:i.employeeForm.controls.entityAlternateContactNumber.errors.pattern),e.xp6(2),e.Q6J("dropdownFor","Blood Group")("isRequired",!1)("records",i.bloodGroupList$)("formControlsName",i.employeeForm.controls.entityBloodGroupID)("idForSelect","personal-tab-6"),e.xp6(2),e.Q6J("dropdownFor","Marital Status")("isRequired",!1)("records",i.maritalList$)("formControlsName",i.employeeForm.controls.entityMaritalStatus)("idForSelect","personal-tab-7"),e.xp6(5),e.Q6J("pattern","[0-9]{6}"),e.xp6(1),e.Q6J("ngIf",null==i.employeeForm.controls.entityPinCode||null==i.employeeForm.controls.entityPinCode.errors?null:i.employeeForm.controls.entityPinCode.errors.pattern),e.xp6(1),e.Q6J("ngIf",null==i.employeeForm.controls.entityPinCode||null==i.employeeForm.controls.entityPinCode.errors?null:i.employeeForm.controls.entityPinCode.errors.required),e.xp6(5),e.Q6J("dropdownFor","Role")("isRequired",!0)("records",i.roleList$)("formControlsName",i.employeeForm.controls.entityRoleID)("idForSelect","official-tab-1"),e.xp6(2),e.Q6J("dropdownFor","Department")("isRequired",!0)("records",i.departmentList$)("formControlsName",i.employeeForm.controls.entityDepartmentID)("idForSelect","official-tab-2"),e.xp6(5),e.Q6J("pattern","[^]*"),e.xp6(1),e.Q6J("ngIf",null==i.employeeForm.controls.entityDesignationName||null==i.employeeForm.controls.entityDesignationName.errors?null:i.employeeForm.controls.entityDesignationName.errors.required),e.xp6(5),e.Q6J("pattern","[a-zA-Z]{5}[0-9]{4}[a-zA-Z]{1}"),e.xp6(1),e.Q6J("ngIf",null==i.employeeForm.controls.entityPanCard||null==i.employeeForm.controls.entityPanCard.errors?null:i.employeeForm.controls.entityPanCard.errors.pattern),e.xp6(1),e.Q6J("ngIf",null==i.employeeForm.controls.entityPanCard||null==i.employeeForm.controls.entityPanCard.errors?null:i.employeeForm.controls.entityPanCard.errors.required),e.xp6(5),e.Q6J("matDatepicker",a),e.xp6(1),e.Q6J("for",a),e.xp6(4),e.Q6J("ngIf",null==i.employeeForm.controls.entityJoiningDate||null==i.employeeForm.controls.entityJoiningDate.errors?null:i.employeeForm.controls.entityJoiningDate.errors.required),e.xp6(5),e.Q6J("matDatepicker",s)("min",i.employeeForm.controls.entityJoiningDate.value),e.xp6(1),e.Q6J("for",s),e.xp6(8),e.Q6J("pattern","[^]*"),e.xp6(4),e.Q6J("ngIf",0===i.base64StringForEmployeeImage.length),e.xp6(1),e.Q6J("ngIf",i.base64StringForEmployeeImage.length>0),e.xp6(2),e.Q6J("ngIf",0===i.base64StringForEmployeeSignature.length),e.xp6(1),e.Q6J("ngIf",i.base64StringForEmployeeSignature.length>0),e.xp6(27),e.Q6J("labelPosition","after"),e.xp6(5),e.Oqu(i.isPercentage.value?"Percentage":"Flat Amount"),e.xp6(1),e.Q6J("placeholder",i.isPercentage.value?"Percentage":"Flat Amount"),e.xp6(6),e.Q6J("ngIf",i.isSubmitted&&i.employeeForm.invalid),e.xp6(2),e.hij(" ",i.submitButtonLabel," ")}},dependencies:[D.sg,D.O5,o._Y,o.Fj,o.wV,o.JJ,o.JL,o.Q7,o.c5,o.sg,o.u,k.P,Q.ey,_.RK,M.oG,P.Mq,P.hl,P.nW,P.Q0,x.Nt,y.KE,y.hX,y.TO,y.R9,G.gD,O.uX,O.SP,D.Ov],styles:[".example-stretched-tabs[_ngcontent-%COMP%]{max-width:100%}.employee-master-container[_ngcontent-%COMP%]{display:flex;margin-top:10px}input[type=file][_ngcontent-%COMP%]{display:none}input[_ngcontent-%COMP%]::-webkit-outer-spin-button, input[_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}input[type=number][_ngcontent-%COMP%]{-moz-appearance:textfield}.custom-file-upload[_ngcontent-%COMP%]{border:1px solid #ccc;display:inline-block;padding:6px 12px;cursor:pointer;height:200px;width:15vw;text-align:center;border-radius:5px}@media (max-width: 766px){.custom-file-upload[_ngcontent-%COMP%]{width:73vw}}.file-upload-image[_ngcontent-%COMP%]{border:1px solid #ccc;height:200px;width:15vw;border-radius:5px;object-fit:contain}@media (max-width: 766px){.file-upload-image[_ngcontent-%COMP%]{width:73vw}}.file-upload-image[_ngcontent-%COMP%]:hover{filter:blur(3px)}.clear-image-icon[_ngcontent-%COMP%]{position:relative;right:8vw;top:10px}@media (max-width: 766px){.clear-image-icon[_ngcontent-%COMP%]{right:-32vw;top:-15vh}}.lms-flat-amount[_ngcontent-%COMP%]{display:inline-block;position:relative;text-align:left;width:10vw}.percentage-checkbox[_ngcontent-%COMP%]{display:flex;flex-direction:row;margin-top:10px}@media (max-width: 766px){.percentage-checkbox[_ngcontent-%COMP%]{margin-top:5px;margin-bottom:5px}}.required-field-info[_ngcontent-%COMP%]{font-size:14px;font-style:italic;font-weight:100;color:red;text-align:center}"]}),l})();var R=h(8005);function Ft(r,l){if(1&r&&(e.TgZ(0,"div",4),e._uU(1),e.qZA()),2&r){const c=e.oxw();e.xp6(1),e.Oqu(c.cardItem.value)}}function At(r,l){if(1&r&&(e.TgZ(0,"div",4),e._uU(1),e.ALo(2,"date"),e.qZA()),2&r){const c=e.oxw();e.xp6(1),e.hij("",e.xi3(2,1,c.cardItem.value,"fullDate")," ")}}function Nt(r,l){if(1&r&&e._UZ(0,"img",6),2&r){const c=e.oxw(2);e.Q6J("src","data:image/jpg;base64,"+c.cardItem.value,e.LSH)}}function Lt(r,l){1&r&&(e.TgZ(0,"div",4),e._uU(1,"Not Available "),e.qZA())}function Bt(r,l){if(1&r&&(e.TgZ(0,"div"),e.YNc(1,Nt,1,1,"img",5),e.YNc(2,Lt,2,0,"div",2),e.qZA()),2&r){const c=e.oxw();e.xp6(1),e.Q6J("ngIf",c.cardItem.value.length>0),e.xp6(1),e.Q6J("ngIf",0===c.cardItem.value.length)}}let H=(()=>{var r;class l{constructor(){}ngOnInit(){}}return(r=l).\u0275fac=function(t){return new(t||r)},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-mini-card"]],inputs:{cardItem:"cardItem"},decls:6,vars:4,consts:[[1,"mini-card-container"],[1,"mini-card-title"],["class","mini-card-value",4,"ngIf"],[4,"ngIf"],[1,"mini-card-value"],["class","mini-card-image","height","80px",3,"src",4,"ngIf"],["height","80px",1,"mini-card-image",3,"src"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1),e._uU(2),e.qZA(),e.YNc(3,Ft,2,1,"div",2),e.YNc(4,At,3,4,"div",2),e.YNc(5,Bt,3,2,"div",3),e.qZA()),2&t&&(e.xp6(2),e.Oqu(i.cardItem.name),e.xp6(1),e.Q6J("ngIf","label"===i.cardItem.type),e.xp6(1),e.Q6J("ngIf","date"===i.cardItem.type),e.xp6(1),e.Q6J("ngIf","image"===i.cardItem.type))},dependencies:[D.O5,D.uU],styles:[".mini-card-container[_ngcontent-%COMP%]{height:120px;width:auto;border-radius:20px;background-color:#a99393;margin-top:10px}.mini-card-title[_ngcontent-%COMP%]{background-color:#ff0;height:40px;width:100%;border-top-left-radius:20px;border-top-right-radius:20px;text-align:center;font-size:16px;padding-top:10px}.mini-card-value[_ngcontent-%COMP%]{text-align:center;font-size:20px;padding-top:20px;color:#f0f8ff}.mini-card-image[_ngcontent-%COMP%]{display:block;margin-left:auto;margin-right:auto}"]}),l})();function Tt(r,l){if(1&r&&(e.TgZ(0,"div",7),e._UZ(1,"app-mini-card",8),e.qZA()),2&r){const c=l.$implicit;e.xp6(1),e.Q6J("cardItem",c)}}let kt=(()=>{var r;class l{constructor(t,i){this._bottomSheetRef=t,this.data=i,this.cardDetailList=[]}ngOnInit(){this.cardDetailList.push({type:"label",name:"Father's Name",value:this.data.entityFatherName||"N/A"},{type:"label",name:"Mother's Name",value:this.data.entityMotherName||"N/A"},{type:"label",name:"Gender",value:this.data.entityGender||"N/A"},{type:"date",name:"Date of birth",value:this.data.entityDob||"N/A"},{type:"label",name:"Mobile Number",value:this.data.entityMobileNumber||"N/A"},{type:"label",name:"Email ID",value:this.data.entityEmailID||"N/A"},{type:"label",name:"Country",value:this.data.employeePersonal.entityCountryName||"N/A"},{type:"label",name:"State",value:this.data.employeePersonal.entityStateName||"N/A"},{type:"label",name:"City",value:this.data.employeePersonal.entityCityName||"N/A"},{type:"label",name:"Address",value:this.data.employeePersonal.entityAddress||"N/A"},{type:"label",name:"Alternate Contact No.",value:this.data.employeePersonal.entityAlternateContactNumber||"N/A"},{type:"label",name:"Blood Group",value:this.data.employeePersonal.entityBloodGroupName||"N/A"},{type:"label",name:"Marital Status",value:this.data.employeePersonal.entityMaritalStatus||"N/A"},{type:"label",name:"Pin Code",value:this.data.employeePersonal.entityPinCode||"N/A"},{type:"label",name:"Role",value:this.data.employeeOfficial.entityRoleName||"N/A"},{type:"image",name:"Employee Image",value:this.data.entityProfilePicture||""},{type:"image",name:"Employee Signature",value:this.data.employeeOfficial.entitySignature||""},{type:"label",name:"Department",value:this.data.employeeOfficial.entityDepartmentName||"N/A"},{type:"label",name:"Designation",value:this.data.employeeOfficial.entityDesignationName||"N/A"},{type:"label",name:"PAN Number",value:this.data.employeeOfficial.entityPanCard||"N/A"},{type:"date",name:"Joining Date",value:this.data.employeeOfficial.entityJoiningDate||"N/A"},{type:"date",name:"Resignation Date",value:this.data.employeeOfficial.entityResignitionDate||"N/A"},{type:"label",name:"Qualification",value:this.data.employeeOfficial.entityQualification||"N/A"},{type:"label",name:"Specialization",value:this.data.specialization||"N/A"},{type:"label",name:"Registration No.",value:this.data.regNo||"N/A"},{type:"label",name:"IPD Consultation Charges",value:this.data.ipdConsultationCharges||"N/A"},{type:"label",name:"OPD New Charges",value:this.data.opdNew||"N/A"},{type:"label",name:"OPD Followup Charges",value:this.data.opdFollowUp||"N/A"})}ngOnDestroy(){this.cardDetailList=[]}closeProfilePanel(){this._bottomSheetRef.dismiss()}}return(r=l).\u0275fac=function(t){return new(t||r)(e.Y36(R.oL),e.Y36(R.OG))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-view-employee-profile"]],decls:9,vars:2,consts:[[1,"profile-header"],[1,"employee-name-label"],["mat-icon-button","",3,"click"],["aria-label","cancel",1,"lms-cancel-icon"],[1,"container-fluid"],[1,"row"],["class","col-lg-3 col-md-4 col-sm-12",4,"ngFor","ngForOf"],[1,"col-lg-3","col-md-4","col-sm-12"],[3,"cardItem"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1),e._uU(2),e.qZA(),e.TgZ(3,"div")(4,"button",2),e.NdJ("click",function(){return i.closeProfilePanel()}),e._UZ(5,"div",3),e.qZA()()(),e.TgZ(6,"div",4)(7,"div",5),e.YNc(8,Tt,2,1,"div",6),e.qZA()()),2&t&&(e.xp6(2),e.Oqu(i.data.entitySalutationID+" "+i.data.entityBusinessName||""),e.xp6(6),e.Q6J("ngForOf",i.cardDetailList))},dependencies:[D.sg,_.RK,H],styles:[".profile-header[_ngcontent-%COMP%]{background-color:#535562;color:#fff;margin-left:-16px;margin-right:-16px;margin-top:-8px;min-height:64px;display:flex;flex-direction:row;justify-content:space-between;align-items:center}.employee-name-label[_ngcontent-%COMP%]{font-size:18px;margin-left:10px}"]}),l})(),xt=(()=>{var r;class l{constructor(t,i,n,a,s,u,m){this.loader=t,this.toastrService=i,this.masterService=n,this.exportService=a,this.authService=s,this.dialog=u,this._bottomSheet=m,this.employeeList$=new p.X([]),this.inlineEditFlag=!1,this.showLogCheckedFlag=!1,this.gridOptions=new F.s8,this.changeDetection=new A.x}ngOnInit(){this.getEmployeeList(!1).then(t=>{this.employeeList$.next(t)}).catch(t=>{this.employeeList$.next([]),this.toastrService.show({type:"error",text:t})}),this.gridOptions={searchPlaceholder:"Search Employee",pageSize:this.authService.pageSize,dateFormat:"yyyy-MM-dd",keyCodeForNextCell:13,showInlineEdit:this.inlineEditFlag,titleForMobileView:"entityBusinessName",pageSizeArray:[5,10,20],showDeleteButton:!1,showAddButton:!0,showEditButton:!0,showActivateDeactivateButton:!0,showSearchInput:!0,activateDeactivateCondition:{conditionalProperty:"activeFlag",valueForActivation:"1",valueForDeactivation:"0"},columns:[{name:"entityEmployeeCode",label:"Employee Code",enable:!0,searchable:!0,sortable:!0,type:"text"},{name:"entityBusinessName",label:"Employee Name",enable:!0,searchable:!0,sortable:!0,type:"text",editable:!1},{name:"entityMobileNumber",label:"Mobile Number",enable:!0,searchable:!0,sortable:!0,type:"text",editable:!1},{name:"entityEmailID",label:"Email",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1},{name:"entityGender",label:"Gender",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1},{name:"createdByUser",label:"Last Updated By",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"effectiveDateFrom",label:"Last Modified on",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"activeFlag",label:"",enable:!1,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"entityID",label:"",enable:!1,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"entityBusinessID",label:"",enable:!1,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1}]}}getEmployeeList(t){return new Promise((i,n)=>{this.loader.showSpinner("Employee list on the way!"),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W",detailFlag:t,dropDown:!1}},"employeeservice/getAllEmployee/").subscribe(s=>{this.loader.hideSpinner(),"200"===s.statusCode||"300"===s.statusCode?(s.responseList=null==s.responseList?[]:s.responseList,i(s.responseList)):n(s.errorMessage)},s=>{this.loader.hideSpinner(),n("Either Internet is not working or facing internal server issue")})})}exportData(t){const i=[{property:"entityEmployeeCode",label:"Employee Code"},{property:"entityBusinessName",label:"Employee Name"},{property:"entityMobileNumber",label:"Mobile Number"},{property:"entityEmailID",label:"Email"},{property:"entityGender",label:"Gender"},{property:"createdByUser",label:"Last Updated By"},{property:"effectiveDateFrom",label:"Last Modified on"}];this.showLogCheckedFlag&&i.push({property:"auditAction",label:"Audit Action"}),this.exportService.generateFile(this.employeeList$.getValue(),"Employee List."+t,i)}showLog(t){this.employeeList$.next([]),t?this.getEmployeeList(!0).then(i=>{this.showLogCheckedFlag=!0,this.employeeList$.next(i),this.gridOptions.showAddButton=!1,this.gridOptions.showEditButton=!1,this.gridOptions.showActivateDeactivateButton=!1,this.gridOptions.columns.push({name:"auditAction",label:"Audit Action",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1})}).catch(i=>{this.employeeList$.next([]),this.toastrService.show({type:"error",text:i})}):(this.showLogCheckedFlag=!1,this.ngOnInit())}initiateAddEmployee(t){this.dialog.open(B.s,{disableClose:!0,data:{header:"Employee Form",buttonLabel:"Submit",records:{selectedItem:t,uniqueItemList:this.employeeList$.getValue().map(n=>({entityBusinessID:n.entityBusinessID,entityBusinessName:n.entityBusinessName,entityBusinessShortCode:n.entityBusinessShortCode,entityMobileNumber:n.entityMobileNumber,entityEmailID:n.entityEmailID}))},component:K},animation:{to:"right"},position:{top:"50vh",left:"50vw"},panelClass:"lms-dialog-box-center"}).afterClosed().subscribe(n=>{if(null!==n){let a=this.employeeList$.getValue();a.unshift(n[0].modifiedObject),this.employeeList$.next(a),this.toastrService.show({type:"success",text:n[0].modifiedObject.entityBusinessName+" Created!"})}})}initiateUpdateEmployee(t){this.dialog.open(B.s,{disableClose:!0,data:{header:"Employee Form",buttonLabel:"Update",records:{selectedItem:t,uniqueItemList:this.employeeList$.getValue().map(n=>({entityBusinessID:n.entityBusinessID,entityBusinessName:n.entityBusinessName,entityBusinessShortCode:n.entityBusinessShortCode,entityMobileNumber:n.entityMobileNumber,entityEmailID:n.entityEmailID}))},component:K},animation:{to:"right"},position:{top:"50vh",left:"50vw"},panelClass:"lms-dialog-box-center"}).afterClosed().subscribe(n=>{if(null!==n){let a=this.employeeList$.getValue(),s=a.findIndex(u=>u.entityBusinessID==n[0].modifiedObject.entityBusinessID);a[s]=n[0].modifiedObject,this.employeeList$.next(a),this.toastrService.show({type:"success",text:n[0].modifiedObject.entityBusinessName+" Updated!"})}})}activateEmployee(t){this.authService.employeeRole==t.employeeOfficial.entityRoleID?this.toastrService.show({type:"error",text:"You are not authorized to activate same role employee!"}):this.masterService.requestActionRestAPI(t,{employeeRequestEntity:{entityID:t.entityID,entityBusinessID:t.entityBusinessID,auditAction:"A",companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W",entityEmailID:t.entityEmailID,entityBusinessName:t.entityBusinessName,entityEmployeeCode:t.entityEmployeeCode,entitySalutationID:t.entitySalutationID,entityFatherName:t.entityFatherName,entityMotherName:t.entityMotherName,entityGender:t.entityGender,entityDob:t.entityDob,entityMobileNumber:t.entityMobileNumber,entityProfilePicture:t.entityProfilePicture,entityStatus:1,active:1,entityPassword:t.entityPassword,specialization:t.specialization,regNo:t.regNo,ipdConsultationCharges:t.ipdConsultationCharges,opdNew:t.opdNew,isPercentage:t.isPercentage,amount:t.amount,opdFollowUp:t.opdFollowUp,employeePersonal:{entityCountryID:t.employeePersonal.entityCountryID,entityStateID:t.employeePersonal.entityStateID,entityCityID:t.employeePersonal.entityCityID,entityPinCode:t.employeePersonal.entityPinCode,entityAddress:t.employeePersonal.entityAddress,entityAlternateContactNumber:t.employeePersonal.entityAlternateContactNumber,entityBloodGroupID:t.employeePersonal.entityBloodGroupID,entityMaritalStatus:t.employeePersonal.entityMaritalStatus},employeeOfficial:{entityRoleID:t.employeeOfficial.entityRoleID,entityDepartmentID:t.employeeOfficial.entityDepartmentID,entityDesignationName:t.employeeOfficial.entityDesignationName,entityPanCard:t.employeeOfficial.entityPanCard,entityJoiningDate:t.employeeOfficial.entityJoiningDate,entityResignitionDate:t.employeeOfficial.entityResignitionDate,entityQualification:t.employeeOfficial.entityQualification,entitySignature:t.employeeOfficial.entitySignature}}},"employeeservice/activateEmployee","Activating ").then(s=>{this.changeDetection.next({originalObject:t,modifiedObject:s}),this.toastrService.show({type:"success",text:t.entityBusinessName+" Activated!"})}).catch(s=>{this.toastrService.show({type:"error",text:s})})}deactivateEmployee(t){this.authService.employeeRole==t.employeeOfficial.entityRoleID?this.toastrService.show({type:"error",text:"You are not authorized to deactivate same role employee!"}):this.masterService.requestActionRestAPI(t,{employeeRequestEntity:{entityID:t.entityID,entityBusinessID:t.entityBusinessID,auditAction:"D",companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W",entityEmailID:t.entityEmailID,entityBusinessName:t.entityBusinessName,entityEmployeeCode:t.entityEmployeeCode,entitySalutationID:t.entitySalutationID,entityFatherName:t.entityFatherName,entityMotherName:t.entityMotherName,entityGender:t.entityGender,entityDob:t.entityDob,entityMobileNumber:t.entityMobileNumber,entityProfilePicture:t.entityProfilePicture,entityStatus:1,active:0,entityPassword:t.entityPassword,specialization:t.specialization,regNo:t.regNo,ipdConsultationCharges:t.ipdConsultationCharges,opdNew:t.opdNew,isPercentage:t.isPercentage,amount:t.amount,opdFollowUp:t.opdFollowUp,employeePersonal:{entityCountryID:t.employeePersonal.entityCountryID,entityStateID:t.employeePersonal.entityStateID,entityCityID:t.employeePersonal.entityCityID,entityPinCode:t.employeePersonal.entityPinCode,entityAddress:t.employeePersonal.entityAddress,entityAlternateContactNumber:t.employeePersonal.entityAlternateContactNumber,entityBloodGroupID:t.employeePersonal.entityBloodGroupID,entityMaritalStatus:t.employeePersonal.entityMaritalStatus},employeeOfficial:{entityRoleID:t.employeeOfficial.entityRoleID,entityDepartmentID:t.employeeOfficial.entityDepartmentID,entityDesignationName:t.employeeOfficial.entityDesignationName,entityPanCard:t.employeeOfficial.entityPanCard,entityJoiningDate:t.employeeOfficial.entityJoiningDate,entityResignitionDate:t.employeeOfficial.entityResignitionDate,entityQualification:t.employeeOfficial.entityQualification,entitySignature:t.employeeOfficial.entitySignature}}},"employeeservice/deactivateEmployee","Deactivating ").then(s=>{this.changeDetection.next({originalObject:t,modifiedObject:s}),this.toastrService.show({type:"success",text:t.entityBusinessName+" Deactivated!"})}).catch(s=>{this.toastrService.show({type:"error",text:s})})}previewEmployee(t){this._bottomSheet.open(kt,{disableClose:!0,data:t,panelClass:"lms-bottom-sheet-container"})}}return(r=l).\u0275fac=function(t){return new(t||r)(e.Y36(b.D),e.Y36(f.k),e.Y36(v.c),e.Y36(N.u),e.Y36(C.$),e.Y36(q.Y),e.Y36(R.ch))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-employee-master"]],decls:14,vars:3,consts:[[1,"container-fluid"],[1,"row"],["childLink","General Master","subchildLink","Employee Master"],[1,"mat-elevation-z12","lms-master-card"],[1,"lms-matcardtitlegroup"],["mat-icon-button","",3,"disableRipple","click"],["aria-label","excel",1,"lms-excel-icon"],["aria-label","csv",1,"lms-csv-icon"],[1,"remaining-space"],["color","primary",1,"lms-matslidetoggle",3,"checked","change"]],template:function(t,i){1&t&&(e._UZ(0,"app-header"),e.TgZ(1,"div",0)(2,"div",1),e._UZ(3,"app-breadcrumb",2),e.qZA(),e.TgZ(4,"div",1)(5,"mat-card",3)(6,"mat-card-title-group",4)(7,"button",5),e.NdJ("click",function(){return i.exportData("xlsx")}),e._UZ(8,"div",6),e.qZA(),e.TgZ(9,"button",5),e.NdJ("click",function(){return i.exportData("csv")}),e._UZ(10,"div",7),e.qZA(),e._UZ(11,"span",8),e.TgZ(12,"mat-slide-toggle",9),e.NdJ("change",function(a){return i.showLog(a.checked)}),e._uU(13," Show Logs "),e.qZA()()()()()),2&t&&(e.xp6(7),e.Q6J("disableRipple",!0),e.xp6(2),e.Q6J("disableRipple",!0),e.xp6(3),e.Q6J("checked",i.showLogCheckedFlag))},dependencies:[S.G,_.RK,d.a8,d.C1,w.Rr,I.L]}),l})();function Pt(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Insurance Name is required field. "),e.qZA())}function qt(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Please match the requested format. "),e.qZA())}function Mt(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Insurance Name is already taken. "),e.qZA())}function Zt(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Please match the requested format. "),e.qZA())}function Et(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Abbreviation is already taken. "),e.qZA())}function Ot(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Please enter valid website. "),e.qZA())}function Rt(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Please match the requested format [HSHGD1995R]. "),e.qZA())}function Ut(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Pan Number is required field. "),e.qZA())}function Jt(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Contact Person is required field. "),e.qZA())}function $t(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Please enter valid contact number. "),e.qZA())}function Qt(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Contact Number is required field. "),e.qZA())}function Gt(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Please enter valid email. "),e.qZA())}function Yt(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Email is required field. "),e.qZA())}function jt(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Contact Person is required field. "),e.qZA())}function Wt(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Please enter valid contact number. "),e.qZA())}function zt(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Contact Number is required field. "),e.qZA())}function Xt(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Please enter valid email. "),e.qZA())}function Vt(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Email is required field. "),e.qZA())}let ee=(()=>{var r;class l{constructor(t,i,n,a,s){this.loader=t,this.masterService=i,this.authService=n,this.fb=a,this.toastrService=s,this.selectedMasterData={},this.masterList=[],this.submitButtonLabel="Submit",this.countryList$=new p.X([]),this.stateList$=new p.X([]),this.cityList$=new p.X([]),this.designationList$=new p.X([]),this.fetchDataOnCloseDialog$=new p.X([])}ngOnInit(){if(this.insuranceForm=this.fb.group({entityBusinessName:new o.NI(null,[o.kI.required]),entityBusinessShortCode:new o.NI(null),entityCountryID:new o.NI(null,[o.kI.required]),entityStateID:new o.NI(null,[o.kI.required]),entityCityID:new o.NI(null,[o.kI.required]),entityAddress:new o.NI(null),entityWebsite:new o.NI(null),entityGSTIN:new o.NI(null),entityPanNumber:new o.NI(null,[o.kI.required]),entityContactPersonName:new o.NI(null,[o.kI.required]),entityContactNumber:new o.NI(null,[o.kI.required]),entityEmail:new o.NI(null,[o.kI.required,o.kI.email]),entityDesignation:new o.NI(null),entityEmpCode:new o.NI(null),entityContactPersonName2:new o.NI(null,[o.kI.required]),entityContactNumber2:new o.NI(null,[o.kI.required]),entityEmail2:new o.NI(null,[o.kI.required,o.kI.email]),entityDesignation2:new o.NI(null),entityEmpCode2:new o.NI(null)}),null!==this.selectedMasterData){this.getCountryList().then(i=>{this.countryList$.next(i),this.getStatesList(this.selectedMasterData.entityCountryID).then(n=>{this.stateList$.next(n),this.getCitiesList(this.selectedMasterData.entityStateID).then(a=>{this.cityList$.next(a),this.getDesignationList().then(s=>{this.designationList$.next(s)}).catch(s=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}).catch(a=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}).catch(n=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}).catch(i=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})});const t=Object.entries(this.insuranceForm.value).reduce((i,[n,a])=>(i[n]=this.selectedMasterData[n],i),{});this.insuranceForm.patchValue(t)}else this.getCountryList().then(t=>{this.countryList$.next(t),this.getDesignationList().then(i=>{this.designationList$.next(i)}).catch(i=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}).catch(t=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}getCountryList(){return new Promise((t,i)=>{this.loader.showSpinner("Loading..."),this.countryListSubscription=this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,entityBusinessID:null,mode:"W",detailFlag:null!==this.selectedMasterData,dropDown:!0}},"countryservice/getAllCountry").subscribe(a=>{this.loader.hideSpinner(),"200"===a.statusCode||"300"===a.statusCode?(a.responseList=null==a.responseList?[]:a.responseList,t(a.responseList)):i(a.errorMessage)},a=>{this.loader.hideSpinner(),i("Either Internet is not working or facing internal server issue")})})}getStatesList(t){return new Promise((i,n)=>{this.loader.showSpinner("Loading..."),this.stateListSubscription=this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,entityBusinessID:t,mode:"W",detailFlag:null!==this.selectedMasterData,dropDown:!0}},"stateservice/getAllState/").subscribe(s=>{this.loader.hideSpinner(),"200"===s.statusCode||"300"===s.statusCode?(s.responseList=null==s.responseList?[]:s.responseList,i(s.responseList)):n(s.errorMessage)},s=>{this.loader.hideSpinner(),n("Either Internet is not working or facing internal server issue")})})}getCitiesList(t){return new Promise((i,n)=>{this.loader.showSpinner("Loading..."),this.cityListSubscription=this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,entityBusinessID:t,mode:"W",detailFlag:null!==this.selectedMasterData,dropDown:!0}},"cityservice/getAllCity/").subscribe(s=>{this.loader.hideSpinner(),"200"===s.statusCode||"300"===s.statusCode?(s.responseList=null==s.responseList?[]:s.responseList,i(s.responseList)):n(s.errorMessage)},s=>{this.loader.hideSpinner(),n("Either Internet is not working or facing internal server issue")})})}getDesignationList(){return new Promise((t,i)=>{this.loader.showSpinner("Loading..."),this.designationListSubscription=this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,entityBusinessID:null,mode:"W",detailFlag:null!==this.selectedMasterData,dropDown:!0}},"designationservice/getAllDesignation/").subscribe(a=>{this.loader.hideSpinner(),"200"===a.statusCode||"300"===a.statusCode?(a.responseList=null==a.responseList?[]:a.responseList,t(a.responseList)):i(a.errorMessage)},a=>{this.loader.hideSpinner(),i("Either Internet is not working or facing internal server issue")})})}keytab(t,i,n){if(13===t.keyCode){var a=t.srcElement.id.split("-").reduce((s,u)=>(Number(u)&&(u=Number(u)+1),s+"-"+u));document.getElementById(a).focus()}else this._uniqueColumnValidator(t.target.value,i,n)}_uniqueColumnValidator(t,i,n){if(n){const a=null===this.selectedMasterData?{entityBusinessID:null}:this.selectedMasterData;null!=this.masterList.find(u=>u[i].toString().trim().toLowerCase()===t.trim().toLowerCase()&&u.entityBusinessID!=a.entityBusinessID)&&this.insuranceForm.controls[i].setErrors({mustBeUnique:!0})}}onChangeOfDropdown(t){switch(t.type){case"Country":this.getStatesList(t.value).then(i=>{this.stateList$.next(i)}).catch(i=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})});break;case"State":this.getCitiesList(t.value).then(i=>{this.cityList$.next(i)}).catch(i=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}}updateinsuranceForm(){null===this.selectedMasterData?this.addNewInsurance(this.insuranceForm.value):this.updateInsurance(this.selectedMasterData,this.insuranceForm.value)}addNewInsurance(t){this.masterService.requestActionRestAPI(t,{insuranceRequestEntity:{entityBusinessName:t.entityBusinessName,entityBusinessShortCode:t.entityBusinessShortCode,entityCountryID:t.entityCountryID,entityStateID:t.entityStateID,entityCityID:t.entityCityID,entityAddress:t.entityAddress,entityWebsite:t.entityWebsite,entityGSTIN:t.entityGSTIN,entityPanNumber:t.entityPanNumber,entityContactPersonName:t.entityContactPersonName,entityContactNumber:t.entityContactNumber,entityEmail:t.entityEmail,entityDesignation:t.entityDesignation,entityEmpCode:t.entityEmpCode,entityContactPersonName2:t.entityContactPersonName2,entityContactNumber2:t.entityContactNumber2,entityEmail2:t.entityEmail2,entityDesignation2:t.entityDesignation2,entityEmpCode2:t.entityEmpCode2,entityEmailID:null,companyID:this.authService.companyID,createdBy:this.authService.employeeID,auditAction:"C",mode:"W"}},"insuranceservice/createEntity","Adding ").then(n=>{this.fetchDataOnCloseDialog$.next([{modifiedObject:n}])}).catch(n=>{this.toastrService.show({type:"error",text:n})})}updateInsurance(t,i){this.masterService.requestActionRestAPI(i,{insuranceRequestEntity:{entityID:t.entityID,entityBusinessID:t.entityBusinessID,entityBusinessName:i.entityBusinessName,entityBusinessShortCode:i.entityBusinessShortCode,entityCountryID:i.entityCountryID,entityStateID:i.entityStateID,entityCityID:i.entityCityID,entityAddress:i.entityAddress,entityWebsite:i.entityWebsite,entityGSTIN:i.entityGSTIN,entityPanNumber:i.entityPanNumber,entityContactPersonName:i.entityContactPersonName,entityContactNumber:i.entityContactNumber,entityEmail:i.entityEmail,entityDesignation:i.entityDesignation,entityEmpCode:i.entityEmpCode,entityContactPersonName2:i.entityContactPersonName2,entityContactNumber2:i.entityContactNumber2,entityEmail2:i.entityEmail2,entityDesignation2:i.entityDesignation2,entityEmpCode2:i.entityEmpCode2,entityEmailID:null,companyID:this.authService.companyID,createdBy:this.authService.employeeID,auditAction:"U",mode:"W"}},"insuranceservice/updateInsurance","Updating ").then(a=>{this.fetchDataOnCloseDialog$.next([{modifiedObject:a}])}).catch(a=>{this.toastrService.show({type:"error",text:a})})}ngOnDestroy(){(this.fetchDataOnCloseDialog$||this.countryListSubscription||this.designationListSubscription)&&(this.fetchDataOnCloseDialog$.unsubscribe(),this.countryListSubscription.unsubscribe(),this.designationListSubscription.unsubscribe()),this.stateListSubscription&&this.stateListSubscription.unsubscribe(),this.cityListSubscription&&this.cityListSubscription.unsubscribe()}}return(r=l).\u0275fac=function(t){return new(t||r)(e.Y36(b.D),e.Y36(v.c),e.Y36(C.$),e.Y36(o.qu),e.Y36(f.k))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-insurance-form"]],inputs:{selectedMasterData:"selectedMasterData",masterList:"masterList",submitButtonLabel:"submitButtonLabel"},decls:112,vars:52,consts:[["autocomplete","off",3,"formGroup"],["mat-stretch-tabs","","color","primary","backgroundColor","primary",1,"example-stretched-tabs"],["insuranceMatTabGroup",""],["label","Basic"],[1,"container-fluid","insurance-master-container"],[1,"row"],[1,"col-12","col-md-4","col-lg-3"],["appearance","outline",1,"lms-mat-form-field"],["matInput","","placeholder","Insurance Name*","formControlName","entityBusinessName","minLength","1","maxLength","100","required","","id","basic-tab-1",3,"pattern","keyup"],[4,"ngIf"],["matInput","","placeholder","Abbreviation","formControlName","entityBusinessShortCode","minLength","1","maxLength","10","id","basic-tab-2",3,"pattern","keyup"],[3,"dropdownFor","isRequired","records","formControlsName","idForSelect","dropdownChangeEvent"],["matInput","","placeholder","Address","formControlName","entityAddress","minLength","1","maxLength","200","id","basic-tab-6","rows","1",3,"keyup"],["matInput","","placeholder","Website","formControlName","entityWebsite","minLength","1","maxLength","100","id","basic-tab-7",3,"pattern","keyup"],["matInput","","placeholder","GSTIN Number","id","basic-tab-8","formControlName","entityGSTIN","minLength","1","maxLength","15",2,"text-transform","uppercase",3,"keyup"],["matInput","","placeholder","Pan Number*","formControlName","entityPanNumber","minLength","10","maxLength","10","id","basic-tab-9","required","",2,"text-transform","uppercase",3,"pattern","keydown.enter"],["label","Personal"],["matInput","","placeholder","Contact Person*","id","personal-tab-1","formControlName","entityContactPersonName","minLength","1","maxLength","100","required","",3,"keyup"],["matInput","","placeholder","Contact Number*","id","personal-tab-2","formControlName","entityContactNumber","minLength","10","maxLength","10","required","",3,"pattern","keyup"],["matInput","","placeholder","Email*","formControlName","entityEmail","minLength","1","maxLength","100","required","","id","personal-tab-3",3,"keyup"],["matInput","","placeholder","Employee Code","formControlName","entityEmpCode","minLength","1","maxLength","20","id","personal-tab-5",3,"keydown.enter"],["label","Alternate"],["matInput","","placeholder","Contact Person*","id","alternate-tab-1","formControlName","entityContactPersonName2","minLength","1","maxLength","100","required","",3,"keyup"],["matInput","","placeholder","Contact Number*","id","alternate-tab-2","formControlName","entityContactNumber2","minLength","10","maxLength","10","required","",3,"pattern","keyup"],["matInput","","placeholder","Email*","formControlName","entityEmail2","minLength","1","maxLength","100","required","","id","alternate-tab-3",3,"keyup"],["matInput","","placeholder","Employee Code","formControlName","entityEmpCode2","minLength","1","maxLength","20","id","alternate-tab-5"],[1,"btn","btn-primary","lms-submit-button",3,"disabled","keydown.enter","click"]],template:function(t,i){if(1&t){const n=e.EpF();e.TgZ(0,"form",0)(1,"mat-tab-group",1,2)(3,"mat-tab",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"mat-form-field",7)(8,"mat-label"),e._uU(9,"Insurance Name"),e.qZA(),e.TgZ(10,"input",8),e.NdJ("keyup",function(s){return i.keytab(s,"entityBusinessName",!0)}),e.qZA(),e.YNc(11,Pt,2,0,"mat-error",9),e.YNc(12,qt,2,0,"mat-error",9),e.YNc(13,Mt,2,0,"mat-error",9),e.qZA()(),e.TgZ(14,"div",6)(15,"mat-form-field",7)(16,"mat-label"),e._uU(17,"Abbreviation"),e.qZA(),e.TgZ(18,"input",10),e.NdJ("keyup",function(s){return i.keytab(s,"entityBusinessShortCode",!0)}),e.qZA(),e.YNc(19,Zt,2,0,"mat-error",9),e.YNc(20,Et,2,0,"mat-error",9),e.qZA()(),e.TgZ(21,"div",6)(22,"app-lms-select",11),e.NdJ("dropdownChangeEvent",function(s){return i.onChangeOfDropdown(s)}),e.qZA()(),e.TgZ(23,"div",6)(24,"app-lms-select",11),e.NdJ("dropdownChangeEvent",function(s){return i.onChangeOfDropdown(s)}),e.qZA()(),e.TgZ(25,"div",6)(26,"app-lms-select",11),e.NdJ("dropdownChangeEvent",function(s){return i.onChangeOfDropdown(s)}),e.qZA()(),e.TgZ(27,"div",6)(28,"mat-form-field",7)(29,"mat-label"),e._uU(30,"Address"),e.qZA(),e.TgZ(31,"textarea",12),e.NdJ("keyup",function(s){return i.keytab(s,"entityAddress",!1)}),e.qZA()()(),e.TgZ(32,"div",6)(33,"mat-form-field",7)(34,"mat-label"),e._uU(35,"Website"),e.qZA(),e.TgZ(36,"input",13),e.NdJ("keyup",function(s){return i.keytab(s,"entityWebsite",!1)}),e.qZA(),e.YNc(37,Ot,2,0,"mat-error",9),e.qZA()(),e.TgZ(38,"div",6)(39,"mat-form-field",7)(40,"mat-label"),e._uU(41,"GSTIN Number"),e.qZA(),e.TgZ(42,"input",14),e.NdJ("keyup",function(s){return i.keytab(s,"entityGSTIN",!1)}),e.qZA()()(),e.TgZ(43,"div",6)(44,"mat-form-field",7)(45,"mat-label"),e._uU(46,"Pan Number"),e.qZA(),e.TgZ(47,"input",15),e.NdJ("keydown.enter",function(){e.CHM(n);const s=e.MAs(2);return e.KtG(s.selectedIndex=1)}),e.qZA(),e.YNc(48,Rt,2,0,"mat-error",9),e.YNc(49,Ut,2,0,"mat-error",9),e.qZA()()()()(),e.TgZ(50,"mat-tab",16)(51,"div",4)(52,"div",5)(53,"div",6)(54,"mat-form-field",7)(55,"mat-label"),e._uU(56,"Contact Person"),e.qZA(),e.TgZ(57,"input",17),e.NdJ("keyup",function(s){return i.keytab(s,"entityContactPersonName",!1)}),e.qZA(),e.YNc(58,Jt,2,0,"mat-error",9),e.qZA()(),e.TgZ(59,"div",6)(60,"mat-form-field",7)(61,"mat-label"),e._uU(62,"Contact Number"),e.qZA(),e.TgZ(63,"input",18),e.NdJ("keyup",function(s){return i.keytab(s,"entityContactNumber",!1)}),e.qZA(),e.YNc(64,$t,2,0,"mat-error",9),e.YNc(65,Qt,2,0,"mat-error",9),e.qZA()(),e.TgZ(66,"div",6)(67,"mat-form-field",7)(68,"mat-label"),e._uU(69,"Email"),e.qZA(),e.TgZ(70,"input",19),e.NdJ("keyup",function(s){return i.keytab(s,"entityEmail",!1)}),e.qZA(),e.YNc(71,Gt,2,0,"mat-error",9),e.YNc(72,Yt,2,0,"mat-error",9),e.qZA()(),e.TgZ(73,"div",6)(74,"app-lms-select",11),e.NdJ("dropdownChangeEvent",function(s){return i.onChangeOfDropdown(s)}),e.qZA()(),e.TgZ(75,"div",6)(76,"mat-form-field",7)(77,"mat-label"),e._uU(78,"Employee Code"),e.qZA(),e.TgZ(79,"input",20),e.NdJ("keydown.enter",function(){e.CHM(n);const s=e.MAs(2);return e.KtG(s.selectedIndex=2)}),e.qZA()()()()()(),e.TgZ(80,"mat-tab",21)(81,"div",4)(82,"div",5)(83,"div",6)(84,"mat-form-field",7)(85,"mat-label"),e._uU(86,"Contact Person 2"),e.qZA(),e.TgZ(87,"input",22),e.NdJ("keyup",function(s){return i.keytab(s,"entityContactPersonName2",!1)}),e.qZA(),e.YNc(88,jt,2,0,"mat-error",9),e.qZA()(),e.TgZ(89,"div",6)(90,"mat-form-field",7)(91,"mat-label"),e._uU(92,"Contact Number 2"),e.qZA(),e.TgZ(93,"input",23),e.NdJ("keyup",function(s){return i.keytab(s,"entityContactNumber2",!1)}),e.qZA(),e.YNc(94,Wt,2,0,"mat-error",9),e.YNc(95,zt,2,0,"mat-error",9),e.qZA()(),e.TgZ(96,"div",6)(97,"mat-form-field",7)(98,"mat-label"),e._uU(99,"Email 2"),e.qZA(),e.TgZ(100,"input",24),e.NdJ("keyup",function(s){return i.keytab(s,"entityEmail2",!1)}),e.qZA(),e.YNc(101,Xt,2,0,"mat-error",9),e.YNc(102,Vt,2,0,"mat-error",9),e.qZA()(),e.TgZ(103,"div",6)(104,"app-lms-select",11),e.NdJ("dropdownChangeEvent",function(s){return i.onChangeOfDropdown(s)}),e.qZA()(),e.TgZ(105,"div",6)(106,"mat-form-field",7)(107,"mat-label"),e._uU(108,"Employee Code 2"),e.qZA(),e._UZ(109,"input",25),e.qZA()()()()()(),e.TgZ(110,"button",26),e.NdJ("keydown.enter",function(s){return s.preventDefault()})("click",function(){return i.updateinsuranceForm()}),e._uU(111),e.qZA()()}2&t&&(e.Q6J("formGroup",i.insuranceForm),e.xp6(10),e.Q6J("pattern","[^]*"),e.xp6(1),e.Q6J("ngIf",null==i.insuranceForm.controls.entityBusinessName||null==i.insuranceForm.controls.entityBusinessName.errors?null:i.insuranceForm.controls.entityBusinessName.errors.required),e.xp6(1),e.Q6J("ngIf",null==i.insuranceForm.controls.entityBusinessName||null==i.insuranceForm.controls.entityBusinessName.errors?null:i.insuranceForm.controls.entityBusinessName.errors.pattern),e.xp6(1),e.Q6J("ngIf",null==i.insuranceForm.controls.entityBusinessName||null==i.insuranceForm.controls.entityBusinessName.errors?null:i.insuranceForm.controls.entityBusinessName.errors.mustBeUnique),e.xp6(5),e.Q6J("pattern","[^]*"),e.xp6(1),e.Q6J("ngIf",null==i.insuranceForm.controls.entityBusinessShortCode||null==i.insuranceForm.controls.entityBusinessShortCode.errors?null:i.insuranceForm.controls.entityBusinessShortCode.errors.pattern),e.xp6(1),e.Q6J("ngIf",null==i.insuranceForm.controls.entityBusinessShortCode||null==i.insuranceForm.controls.entityBusinessShortCode.errors?null:i.insuranceForm.controls.entityBusinessShortCode.errors.mustBeUnique),e.xp6(2),e.Q6J("dropdownFor","Country")("isRequired",!0)("records",i.countryList$)("formControlsName",i.insuranceForm.controls.entityCountryID)("idForSelect","basic-tab-3"),e.xp6(2),e.Q6J("dropdownFor","State")("isRequired",!0)("records",i.stateList$)("formControlsName",i.insuranceForm.controls.entityStateID)("idForSelect","basic-tab-4"),e.xp6(2),e.Q6J("dropdownFor","City")("isRequired",!0)("records",i.cityList$)("formControlsName",i.insuranceForm.controls.entityCityID)("idForSelect","basic-tab-5"),e.xp6(10),e.Q6J("pattern","((https?|ftp|smtp)://)?(www.)?[a-z0-9]+.[a-z]+(/[a-zA-Z0-9#]+/?)*$"),e.xp6(1),e.Q6J("ngIf",null==i.insuranceForm.controls.entityWebsite||null==i.insuranceForm.controls.entityWebsite.errors?null:i.insuranceForm.controls.entityWebsite.errors.pattern),e.xp6(10),e.Q6J("pattern","[a-zA-Z]{5}[0-9]{4}[a-zA-Z]{1}"),e.xp6(1),e.Q6J("ngIf",null==i.insuranceForm.controls.entityPanNumber||null==i.insuranceForm.controls.entityPanNumber.errors?null:i.insuranceForm.controls.entityPanNumber.errors.pattern),e.xp6(1),e.Q6J("ngIf",null==i.insuranceForm.controls.entityPanNumber||null==i.insuranceForm.controls.entityPanNumber.errors?null:i.insuranceForm.controls.entityPanNumber.errors.required),e.xp6(9),e.Q6J("ngIf",null==i.insuranceForm.controls.entityContactPersonName||null==i.insuranceForm.controls.entityContactPersonName.errors?null:i.insuranceForm.controls.entityContactPersonName.errors.required),e.xp6(5),e.Q6J("pattern","[6-9]{1}[0-9]{9}"),e.xp6(1),e.Q6J("ngIf",null==i.insuranceForm.controls.entityContactNumber||null==i.insuranceForm.controls.entityContactNumber.errors?null:i.insuranceForm.controls.entityContactNumber.errors.pattern),e.xp6(1),e.Q6J("ngIf",null==i.insuranceForm.controls.entityContactNumber||null==i.insuranceForm.controls.entityContactNumber.errors?null:i.insuranceForm.controls.entityContactNumber.errors.required),e.xp6(6),e.Q6J("ngIf",null==i.insuranceForm.controls.entityEmail||null==i.insuranceForm.controls.entityEmail.errors?null:i.insuranceForm.controls.entityEmail.errors.email),e.xp6(1),e.Q6J("ngIf",null==i.insuranceForm.controls.entityEmail||null==i.insuranceForm.controls.entityEmail.errors?null:i.insuranceForm.controls.entityEmail.errors.required),e.xp6(2),e.Q6J("dropdownFor","Designation")("isRequired",!1)("records",i.designationList$)("formControlsName",i.insuranceForm.controls.entityDesignation)("idForSelect","personal-tab-4"),e.xp6(14),e.Q6J("ngIf",null==i.insuranceForm.controls.entityContactPersonName2||null==i.insuranceForm.controls.entityContactPersonName2.errors?null:i.insuranceForm.controls.entityContactPersonName2.errors.required),e.xp6(5),e.Q6J("pattern","[6-9]{1}[0-9]{9}"),e.xp6(1),e.Q6J("ngIf",null==i.insuranceForm.controls.entityContactNumber2||null==i.insuranceForm.controls.entityContactNumber2.errors?null:i.insuranceForm.controls.entityContactNumber2.errors.pattern),e.xp6(1),e.Q6J("ngIf",null==i.insuranceForm.controls.entityContactNumber2||null==i.insuranceForm.controls.entityContactNumber2.errors?null:i.insuranceForm.controls.entityContactNumber2.errors.required),e.xp6(6),e.Q6J("ngIf",null==i.insuranceForm.controls.entityEmail2||null==i.insuranceForm.controls.entityEmail2.errors?null:i.insuranceForm.controls.entityEmail2.errors.email),e.xp6(1),e.Q6J("ngIf",null==i.insuranceForm.controls.entityEmail2||null==i.insuranceForm.controls.entityEmail2.errors?null:i.insuranceForm.controls.entityEmail2.errors.required),e.xp6(2),e.Q6J("dropdownFor","Designation 2")("isRequired",!1)("records",i.designationList$)("formControlsName",i.insuranceForm.controls.entityDesignation2)("idForSelect","alternate-tab-4"),e.xp6(6),e.Q6J("disabled",i.insuranceForm.invalid),e.xp6(1),e.hij(" ",i.submitButtonLabel," "))},dependencies:[D.O5,o._Y,o.Fj,o.JJ,o.JL,o.Q7,o.c5,o.sg,o.u,k.P,x.Nt,y.KE,y.hX,y.TO,O.uX,O.SP],styles:[".example-stretched-tabs[_ngcontent-%COMP%]{max-width:100%}.insurance-master-container[_ngcontent-%COMP%]{display:flex;margin-top:10px}"]}),l})(),Kt=(()=>{var r;class l{constructor(t,i,n,a,s,u){this.loader=t,this.toastrService=i,this.masterService=n,this.exportService=a,this.authService=s,this.dialog=u,this.insuranceList$=new p.X([]),this.inlineEditFlag=!1,this.showLogCheckedFlag=!1,this.gridOptions=new F.s8,this.changeDetection=new A.x}ngOnInit(){this.getInsuranceList(!1).then(t=>{this.insuranceList$.next(t)}).catch(t=>{this.insuranceList$.next([]),this.toastrService.show({type:"error",text:t})}),this.gridOptions={searchPlaceholder:"Search Insurance",pageSize:this.authService.pageSize,dateFormat:"yyyy-MM-dd",keyCodeForNextCell:13,showInlineEdit:this.inlineEditFlag,titleForMobileView:"entityBusinessName",pageSizeArray:[5,10,20],showDeleteButton:!1,showAddButton:!0,showEditButton:!0,showActivateDeactivateButton:!0,showSearchInput:!0,activateDeactivateCondition:{conditionalProperty:"activeFlag",valueForActivation:"1",valueForDeactivation:"0"},columns:[{name:"entityBusinessName",label:"Insurance",enable:!0,searchable:!0,sortable:!0,type:"text"},{name:"entityBusinessShortCode",label:"Abbreviation",enable:!0,searchable:!0,sortable:!0,type:"text",editable:!1},{name:"entityContactPersonName",label:"Contact Person",enable:!0,searchable:!0,sortable:!0,type:"text",editable:!1},{name:"entityContactNumber",label:"Contact No",enable:!0,searchable:!0,sortable:!0,type:"text",editable:!1},{name:"entityEmail",label:"Email",enable:!0,searchable:!0,sortable:!0,type:"text",editable:!1},{name:"createdByUser",label:"Last Updated By",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"effectiveDateFrom",label:"Last Modified on",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"activeFlag",label:"",enable:!1,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"entityID",label:"",enable:!1,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"entityBusinessID",label:"",enable:!1,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1}]}}getInsuranceList(t){return new Promise((i,n)=>{this.loader.showSpinner("Insurance list on the way!"),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W",detailFlag:t,dropDown:!1}},"insuranceservice/getAllEntity").subscribe(s=>{this.loader.hideSpinner(),"200"===s.statusCode||"300"===s.statusCode?(s.responseList=null==s.responseList?[]:s.responseList,i(s.responseList)):n(s.errorMessage)},s=>{this.loader.hideSpinner(),n("Either Internet is not working or facing internal server issue")})})}exportData(t){const i=[{property:"entityBusinessName",label:"Insurance"},{property:"entityBusinessShortCode",label:"Abbreviation"},{property:"entityContactPersonName",label:"Contact Person"},{property:"entityContactNumber",label:"Contact No"},{property:"entityEmail",label:"Email"},{property:"createdByUser",label:"Last Updated By"},{property:"effectiveDateFrom",label:"Last Modified on"}];this.showLogCheckedFlag&&i.push({property:"auditAction",label:"Audit Action"}),this.exportService.generateFile(this.insuranceList$.getValue(),"Insurance List."+t,i)}showLog(t){this.insuranceList$.next([]),t?this.getInsuranceList(!0).then(i=>{this.showLogCheckedFlag=!0,this.insuranceList$.next(i),this.gridOptions.showAddButton=!1,this.gridOptions.showEditButton=!1,this.gridOptions.showActivateDeactivateButton=!1,this.gridOptions.columns.push({name:"auditAction",label:"Audit Action",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1})}).catch(i=>{this.insuranceList$.next([]),this.toastrService.show({type:"error",text:i})}):(this.showLogCheckedFlag=!1,this.ngOnInit())}initiateAddInsurance(t){this.dialog.open(B.s,{disableClose:!0,data:{header:"Insurance Form",buttonLabel:"Submit",records:{selectedItem:t,uniqueItemList:this.insuranceList$.getValue().map(n=>({entityBusinessID:n.entityBusinessID,entityBusinessName:n.entityBusinessName,entityBusinessShortCode:n.entityBusinessShortCode}))},component:ee},animation:{to:"right"},position:{top:"50vh",left:"50vw"},panelClass:"lms-dialog-box-center"}).afterClosed().subscribe(n=>{if(null!==n){let a=this.insuranceList$.getValue();a.unshift(n[0].modifiedObject),this.insuranceList$.next(a),this.toastrService.show({type:"success",text:n[0].modifiedObject.entityBusinessName+" Created!"})}})}initiateUpdateInsurance(t){this.dialog.open(B.s,{disableClose:!0,data:{header:"Insurance Form",buttonLabel:"Update",records:{selectedItem:t,uniqueItemList:this.insuranceList$.getValue().map(n=>({entityBusinessID:n.entityBusinessID,entityBusinessName:n.entityBusinessName,entityBusinessShortCode:n.entityBusinessShortCode}))},component:ee},animation:{to:"right"},position:{top:"50vh",left:"50vw"},panelClass:"lms-dialog-box-center"}).afterClosed().subscribe(n=>{if(null!==n){let a=this.insuranceList$.getValue(),s=a.findIndex(u=>u.entityBusinessID==n[0].modifiedObject.entityBusinessID);a[s]=n[0].modifiedObject,this.insuranceList$.next(a),this.toastrService.show({type:"success",text:n[0].modifiedObject.entityBusinessName+" Updated!"})}})}activateInsurance(t){this.masterService.requestActionRestAPI(t,{insuranceRequestEntity:{entityID:t.entityID,entityBusinessID:t.entityBusinessID,auditAction:"A",companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W"}},"insuranceservice/activateEntity","Activating ").then(n=>{this.changeDetection.next({originalObject:t,modifiedObject:n}),this.toastrService.show({type:"success",text:t.entityBusinessName+" Activated!"})}).catch(n=>{this.toastrService.show({type:"error",text:n})})}deactivateInsurance(t){this.masterService.requestActionRestAPI(t,{insuranceRequestEntity:{entityID:t.entityID,entityBusinessID:t.entityBusinessID,auditAction:"D",companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W"}},"insuranceservice/deactivateEntity","Deactivating ").then(n=>{this.changeDetection.next({originalObject:t,modifiedObject:n}),this.toastrService.show({type:"success",text:t.entityBusinessName+" Deactivated!"})}).catch(n=>{this.toastrService.show({type:"error",text:n})})}}return(r=l).\u0275fac=function(t){return new(t||r)(e.Y36(b.D),e.Y36(f.k),e.Y36(v.c),e.Y36(N.u),e.Y36(C.$),e.Y36(q.Y))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-insurance-master"]],decls:14,vars:3,consts:[[1,"container-fluid"],[1,"row"],["childLink","General Master","subchildLink","Insurance Master"],[1,"mat-elevation-z12","lms-master-card"],[1,"lms-matcardtitlegroup"],["mat-icon-button","",3,"disableRipple","click"],["aria-label","excel",1,"lms-excel-icon"],["aria-label","csv",1,"lms-csv-icon"],[1,"remaining-space"],["color","primary",1,"lms-matslidetoggle",3,"checked","change"]],template:function(t,i){1&t&&(e._UZ(0,"app-header"),e.TgZ(1,"div",0)(2,"div",1),e._UZ(3,"app-breadcrumb",2),e.qZA(),e.TgZ(4,"div",1)(5,"mat-card",3)(6,"mat-card-title-group",4)(7,"button",5),e.NdJ("click",function(){return i.exportData("xlsx")}),e._UZ(8,"div",6),e.qZA(),e.TgZ(9,"button",5),e.NdJ("click",function(){return i.exportData("csv")}),e._UZ(10,"div",7),e.qZA(),e._UZ(11,"span",8),e.TgZ(12,"mat-slide-toggle",9),e.NdJ("change",function(a){return i.showLog(a.checked)}),e._uU(13," Show Logs "),e.qZA()()()()()),2&t&&(e.xp6(7),e.Q6J("disableRipple",!0),e.xp6(2),e.Q6J("disableRipple",!0),e.xp6(3),e.Q6J("checked",i.showLogCheckedFlag))},dependencies:[S.G,_.RK,d.a8,d.C1,w.Rr,I.L]}),l})();var U=h(5861);function ei(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Patient Name is required field. "),e.qZA())}function ti(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Please match the requested format. "),e.qZA())}function ii(r,l){if(1&r&&(e.TgZ(0,"mat-option",42),e._uU(1),e.qZA()),2&r){const c=l.$implicit;e.Q6J("value",c.entityBusinessShortCode),e.xp6(1),e.hij(" ",c.entityBusinessName," ")}}function ni(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Gender is required field. "),e.qZA())}function ai(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Weight should be numeric. "),e.qZA())}function si(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Height should be numeric. "),e.qZA())}function ri(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Please enter valid Mobile number. "),e.qZA())}function oi(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Mobile Number is required field. "),e.qZA())}function li(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Mobile Number is already taken. "),e.qZA())}function ui(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Please enter valid contact number. "),e.qZA())}function ci(r,l){if(1&r){const c=e.EpF();e.ynx(0),e.TgZ(1,"label",43),e._UZ(2,"div",44),e._uU(3," Upload Patient Image "),e.qZA(),e.TgZ(4,"input",45),e.NdJ("change",function(i){e.CHM(c);const n=e.oxw();return e.KtG(n.uploadPatientImage(i))}),e.qZA(),e.BQk()}}function pi(r,l){if(1&r){const c=e.EpF();e.ynx(0),e._UZ(1,"img",46),e.TgZ(2,"button",47),e.NdJ("click",function(){e.CHM(c);const i=e.oxw();return i.base64StringForPatientImage="",e.KtG(i.safePatientImageURL="")}),e._UZ(3,"div",48),e.qZA(),e.BQk()}if(2&r){const c=e.oxw();e.xp6(1),e.Q6J("src",c.safePatientImageURL,e.LSH),e.xp6(1),e.Q6J("disableRipple",!0)}}function di(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Please enter valid Email-ID. "),e.qZA())}function mi(r,l){if(1&r&&(e.TgZ(0,"mat-option",42),e._uU(1),e.qZA()),2&r){const c=l.$implicit;e.Q6J("value",c.entityBusinessID),e.xp6(1),e.hij(" ",c.entityBusinessName," ")}}function hi(r,l){1&r&&(e.TgZ(0,"div",49)(1,"span"),e._uU(2,"*Please fill required fields of all tabs"),e.qZA()())}let te=(()=>{var r;class l{constructor(t,i,n,a,s,u,m){this.loader=t,this.masterService=i,this.authService=n,this.fb=a,this.toastrService=s,this._sanitizer=u,this.commonService=m,this.selectedMasterData={},this.masterList=[],this.submitButtonLabel="Submit",this.hidePassword=!0,this.currentDate=new Date,this.salutationList$=new p.X([]),this.categoriesList$=new p.X([]),this.clubMemberList$=new p.X([]),this.genderList$=new p.X([]),this.patientTypeList$=new p.X([]),this.bloodGroupList$=new p.X([]),this.maritalList$=new p.X([]),this.countryList$=new p.X([]),this.stateList$=new p.X([]),this.cityList$=new p.X([]),this.corporateList$=new p.X([]),this.insuranceList$=new p.X([]),this.fetchDataOnCloseDialog$=new p.X([]),this.base64StringForPatientImage="",this.destroySubscription$=new Z.t(1),this.isSubmitted=!1}ngOnInit(){if(this.maritalList$.next([{entityBusinessID:"Married",entityBusinessName:"Married"},{entityBusinessID:"UnMarried",entityBusinessName:"UnMarried"}]),this.patientTypeList$.next([{entityBusinessID:"CASH",entityBusinessName:"CASH"},{entityBusinessID:"CORPORATE",entityBusinessName:"CORPORATE"},{entityBusinessID:"INSURANCE",entityBusinessName:"INSURANCE"}]),this.patientFormGroup=this.fb.group({entityBusinessName:new o.NI(null,[o.kI.required]),entitySalutationID:new o.NI(null,[o.kI.required]),entityCategoryID:new o.NI(null),entityClubMemberID:new o.NI(null),entityAllergy:new o.NI(null),entityDOB:new o.NI(null),entityAgeInYear:new o.NI(null),entityAgeInMonth:new o.NI(null),entityAgeInDays:new o.NI(null),entityGender:new o.NI(null,[o.kI.required]),entityBloodGroupID:new o.NI(null),entityWeight:new o.NI(null),entityHeight:new o.NI(null),entityCountryID:new o.NI(null,[o.kI.required]),entityStateID:new o.NI(null,[o.kI.required]),entityCityID:new o.NI(null,[o.kI.required]),entityAddress:new o.NI(null),entityMobileNumber:new o.NI(null,[o.kI.required]),entityResidentialNumber:new o.NI(null),entityEmailID:new o.NI(null,[o.kI.email]),entityPatientType:new o.NI(null),entityCorporateID:new o.NI(null),entityEmployeeNumber:new o.NI(null),entityEmployeeDesignation:new o.NI(null),entityEmployeeDepartment:new o.NI(null),entityInsuranceID:new o.NI(null),entityInsuranceCode:new o.NI(null),entityPolicyNumber:new o.NI(null)}),null!==this.selectedMasterData){this.getSalutaionList(!0).then(n=>{this.salutationList$.next(n),this.getCategoryList(!0).then(a=>{this.categoriesList$.next(a),this.getClubMemberList(!0).then(s=>{this.clubMemberList$.next(s),this.getGenderList(!0).then(u=>{this.genderList$.next(u),this.getCountryList(!0).then(m=>{this.countryList$.next(m),this.getStatesList(this.selectedMasterData.entityCountryID,!0).then(L=>{this.stateList$.next(L),this.getCitiesList(this.selectedMasterData.entityStateID,!0).then(T=>{this.cityList$.next(T),this.getBloodgroupList(!0).then(E=>{this.bloodGroupList$.next(E),this.getCorporateList(!0).then(wn=>{this.corporateList$.next(wn),this.getInsuranceList(!1).then(Fn=>{this.insuranceList$.next(Fn)}).catch(()=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}).catch(()=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}).catch(()=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}).catch(()=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}).catch(()=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}).catch(()=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}).catch(()=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}).catch(()=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}).catch(()=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}).catch(()=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})});const t=Object.entries(this.patientFormGroup.value).reduce((n,[a,s])=>(n[a]=this.selectedMasterData[a],n),{});this.patientFormGroup.patchValue(t);let i=this.commonService.convertDate(this.selectedMasterData.effectiveDateFrom)||new Date;this.setValuesOfYearMonthAndDays(this.selectedMasterData.entityDOB,i),this.patientFormGroup.controls.entitySalutationID.setValue(this.selectedMasterData.entitySalutationID),null!==this.selectedMasterData.entityPhoto&&(this.base64StringForPatientImage=this.selectedMasterData.entityPhoto,this.safePatientImageURL=this._sanitizer.bypassSecurityTrustResourceUrl("data:image/jpg;base64,"+this.base64StringForPatientImage))}else{this.getSalutaionList(!0).then(i=>{this.salutationList$.next(i),this.getCategoryList(!0).then(n=>{this.categoriesList$.next(n),this.getClubMemberList(!0).then(a=>{this.clubMemberList$.next(a),this.getGenderList(!0).then(s=>{this.genderList$.next(s),this.getCountryList(!0).then(u=>{this.countryList$.next(u),this.getBloodgroupList(!0).then(m=>{this.bloodGroupList$.next(m),this.getCorporateList(!0).then(L=>{this.corporateList$.next(L),this.getInsuranceList(!1).then(T=>{this.insuranceList$.next(T)}).catch(()=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}).catch(()=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}).catch(()=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}).catch(()=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}).catch(()=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}).catch(()=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}).catch(()=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}).catch(()=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})});let t=this.masterList[0]?.todayDate||new Date;this.patientFormGroup.controls.entityDOB.setValue(t),this.setValuesOfYearMonthAndDays(t,t)}}getCountryList(t){return new Promise((i,n)=>{this.loader.showSpinner("Loading..."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,entityBusinessID:null,mode:"W",detailFlag:null!==this.selectedMasterData,dropDown:!0}},"countryservice/getAllCountry").pipe((0,g.R)(this.destroySubscription$)).subscribe(s=>{t?this.loader.showSpinner("Loading..."):this.loader.hideSpinner(),"200"===s.statusCode||"300"===s.statusCode?(s.responseList=null==s.responseList?[]:s.responseList,i(s.responseList)):(n(s.errorMessage),this.loader.hideSpinner())},s=>{this.loader.hideSpinner(),n("Either Internet is not working or facing internal server issue")})})}getStatesList(t,i){return new Promise((n,a)=>{this.loader.showSpinner("Loading..."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,entityBusinessID:t,mode:"W",detailFlag:null!==this.selectedMasterData,dropDown:!0}},"stateservice/getAllState/").pipe((0,g.R)(this.destroySubscription$)).subscribe(u=>{i?this.loader.showSpinner("Loading..."):this.loader.hideSpinner(),"200"===u.statusCode||"300"===u.statusCode?(u.responseList=null==u.responseList?[]:u.responseList,n(u.responseList)):(a(u.errorMessage),this.loader.hideSpinner())},u=>{this.loader.hideSpinner(),a("Either Internet is not working or facing internal server issue")})})}getCitiesList(t,i){return new Promise((n,a)=>{this.loader.showSpinner("Loading..."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,entityBusinessID:t,mode:"W",detailFlag:null!==this.selectedMasterData,dropDown:!0}},"cityservice/getAllCity/").pipe((0,g.R)(this.destroySubscription$)).subscribe(u=>{i?this.loader.showSpinner("Loading..."):this.loader.hideSpinner(),"200"===u.statusCode||"300"===u.statusCode?(u.responseList=null==u.responseList?[]:u.responseList,n(u.responseList)):(a(u.errorMessage),this.loader.hideSpinner())},u=>{this.loader.hideSpinner(),a("Either Internet is not working or facing internal server issue")})})}getSalutaionList(t){return new Promise((i,n)=>{this.loader.showSpinner("Loading..."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,entityBusinessID:null,mode:"W",detailFlag:null!==this.selectedMasterData,dropDown:!0}},"salutationservice/getAllSalutation/").pipe((0,g.R)(this.destroySubscription$)).subscribe(s=>{t?this.loader.showSpinner("Loading..."):this.loader.hideSpinner(),"200"===s.statusCode||"300"===s.statusCode?(s.responseList=null==s.responseList?[]:s.responseList.map(u=>({entityBusinessID:u.entityBusinessName,entityBusinessName:u.entityBusinessName})),i(s.responseList)):(n(s.errorMessage),this.loader.hideSpinner())},s=>{this.loader.hideSpinner(),n("Either Internet is not working or facing internal server issue")})})}getCategoryList(t){return new Promise((i,n)=>{this.loader.showSpinner("Loading..."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,entityBusinessID:null,mode:"W",detailFlag:null!==this.selectedMasterData,dropDown:!0}},"categoryservice/getAllCategory/").pipe((0,g.R)(this.destroySubscription$)).subscribe(s=>{t?this.loader.showSpinner("Loading..."):this.loader.hideSpinner(),"200"===s.statusCode||"300"===s.statusCode?(s.responseList=null==s.responseList?[]:s.responseList,i(s.responseList)):(n(s.errorMessage),this.loader.hideSpinner())},s=>{this.loader.hideSpinner(),n("Either Internet is not working or facing internal server issue")})})}getClubMemberList(t){return new Promise((i,n)=>{this.loader.showSpinner("Loading..."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,entityBusinessID:null,mode:"W",detailFlag:null!==this.selectedMasterData,dropDown:!0}},"clubmemberservice/getAllClubMember/").pipe((0,g.R)(this.destroySubscription$)).subscribe(s=>{t?this.loader.showSpinner("Loading..."):this.loader.hideSpinner(),"200"===s.statusCode||"300"===s.statusCode?(s.responseList=null==s.responseList?[]:s.responseList,i(s.responseList)):(n(s.errorMessage),this.loader.hideSpinner())},s=>{this.loader.hideSpinner(),n("Either Internet is not working or facing internal server issue")})})}getGenderList(t){return new Promise((i,n)=>{this.loader.showSpinner("Loading..."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,entityType:"G",mode:"W",detailFlag:!1,dropDown:!0}},"enumservice/getAllReferenceEntity/").pipe((0,g.R)(this.destroySubscription$)).subscribe(s=>{t?this.loader.showSpinner("Loading..."):this.loader.hideSpinner(),"200"===s.statusCode||"300"===s.statusCode?(s.responseList=null==s.responseList?[]:s.responseList,i(s.responseList)):(n(s.errorMessage),this.loader.hideSpinner())},s=>{this.loader.hideSpinner(),n("Either Internet is not working or facing internal server issue")})})}getCorporateList(t){return new Promise((i,n)=>{this.loader.showSpinner("Loading..."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,entityBusinessID:null,mode:"W",detailFlag:null!==this.selectedMasterData,dropDown:!0}},"corporateservice/getAllCorporate/").pipe((0,g.R)(this.destroySubscription$)).subscribe(s=>{t?this.loader.showSpinner("Loading..."):this.loader.hideSpinner(),"200"===s.statusCode||"300"===s.statusCode?(s.responseList=null==s.responseList?[]:s.responseList,i(s.responseList)):(n(s.errorMessage),this.loader.hideSpinner())},s=>{this.loader.hideSpinner(),n("Either Internet is not working or facing internal server issue")})})}getInsuranceList(t){return new Promise((i,n)=>{this.loader.showSpinner("Loading..."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,entityBusinessID:null,mode:"W",detailFlag:null!==this.selectedMasterData,dropDown:!0}},"insuranceservice/getAllEntity").pipe((0,g.R)(this.destroySubscription$)).subscribe(s=>{t?this.loader.showSpinner("Loading..."):this.loader.hideSpinner(),"200"===s.statusCode||"300"===s.statusCode?(s.responseList=null==s.responseList?[]:s.responseList,i(s.responseList)):(n(s.errorMessage),this.loader.hideSpinner())},s=>{this.loader.hideSpinner(),n("Either Internet is not working or facing internal server issue")})})}getBloodgroupList(t){return new Promise((i,n)=>{this.loader.showSpinner("Loading..."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,entityBusinessID:null,mode:"W",detailFlag:null!==this.selectedMasterData,dropDown:!0}},"bloodgroupservice/getAllBloodGroup/").pipe((0,g.R)(this.destroySubscription$)).subscribe(s=>{t?this.loader.showSpinner("Loading..."):this.loader.hideSpinner(),"200"===s.statusCode||"300"===s.statusCode?(s.responseList=null==s.responseList?[]:s.responseList,i(s.responseList)):(n(s.errorMessage),this.loader.hideSpinner())},s=>{this.loader.hideSpinner(),n("Either Internet is not working or facing internal server issue")})})}checkMobileNumberIsExists(t){return new Promise((i,n)=>{this.loader.showSpinner("Loading..."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,entityBusinessName:t,mode:"W",detailFlag:!1,dropDown:!0}},"adminservice/validateMobileNo").pipe((0,g.R)(this.destroySubscription$)).subscribe(s=>{this.loader.hideSpinner(),"200"===s.statusCode?i(s.responseList[0]):"300"===s.statusCode?i(!1):n(s.errorMessage)},s=>{this.loader.hideSpinner(),n("Either Internet is not working or facing internal server issue")})})}uploadPatientImage(t){let i=t.target.files||t.srcElement.files;var n=i[0];if(parseFloat(this.calculateFileSize(n.size,2))>40)this.toastrService.show({type:"error",text:"File size should not greater than 40 kb"}),this.base64StringForPatientImage="";else if(i&&n){var a=new FileReader;a.onload=this.loadPatientImage.bind(this),a.readAsBinaryString(n)}}calculateFileSize(t,i){if(0==t)return"0 Bytes";var a=i||2,u=Math.floor(Math.log(t)/Math.log(1024));return parseFloat((t/Math.pow(1024,u)).toFixed(a))+" "+["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][u]}loadPatientImage(t){this.base64StringForPatientImage=btoa(t.target.result),this.safePatientImageURL=this._sanitizer.bypassSecurityTrustResourceUrl("data:image/jpg;base64,"+this.base64StringForPatientImage)}keytab(t,i,n){if(13===t.keyCode){var a=t.srcElement.id.split("-").reduce((s,u)=>(Number(u)&&(u=Number(u)+1),s+"-"+u));document.getElementById(a).focus()}else this._uniqueColumnValidator(t.target.value,i,n)}_uniqueColumnValidator(t,i,n){if(n){const a=null===this.selectedMasterData?{entityBusinessID:null}:this.selectedMasterData;null!=this.masterList.find(u=>u[i].toString().trim().toLowerCase()===t.trim().toLowerCase()&&u.entityBusinessID!=a.entityBusinessID)&&this.patientFormGroup.controls[i].setErrors({mustBeUnique:!0})}else switch(i){case"entityAgeInYear":Number(t)<0&&(this.toastrService.show({type:"error",text:"Kindly enter natural number in between 0-9"}),this.patientFormGroup.controls[i].setValue(0)),Number(t)>120&&(this.toastrService.show({type:"error",text:"Kindly enter valid year"}),this.patientFormGroup.controls[i].setValue(0)),this.onChangeOfYearMonthDaysInput();break;case"entityAgeInMonth":Number(t)<0&&(this.toastrService.show({type:"error",text:"Kindly enter natural number in between 0-9"}),this.patientFormGroup.controls[i].setValue(0)),Number(t)>11&&(this.toastrService.show({type:"error",text:"Kindly enter valid month"}),this.patientFormGroup.controls[i].setValue(0)),this.onChangeOfYearMonthDaysInput();break;case"entityAgeInDays":Number(t)<0&&(this.toastrService.show({type:"error",text:"Kindly enter natural number in between 0-9"}),this.patientFormGroup.controls[i].setValue(0)),Number(t)>31&&(this.toastrService.show({type:"error",text:"Kindly enter valid days"}),this.patientFormGroup.controls[i].setValue(0)),this.onChangeOfYearMonthDaysInput();break;case"entityMobileNumber":10===t.length&&this.checkMobileNumberIsExists(t).then(a=>{a&&(null===this.selectedMasterData?{entityMobileNumber:null}:this.selectedMasterData).entityMobileNumber!==t&&this.patientFormGroup.controls[i].setErrors({mustBeUnique:!0})}).catch(a=>{this.toastrService.show({type:"error",text:a})})}}onChangeOfDropdown(t){switch(t.type){case"Country":this.getStatesList(t.value,!1).then(i=>{this.stateList$.next(i)}).catch(i=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})});break;case"State":this.getCitiesList(t.value,!1).then(i=>{this.cityList$.next(i)}).catch(i=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}}onChangeOfPatientType(t){this.patientFormGroup.controls.entityCorporateID.setValue(null),this.patientFormGroup.controls.entityEmployeeNumber.setValue(null),this.patientFormGroup.controls.entityEmployeeDesignation.setValue(null),this.patientFormGroup.controls.entityEmployeeDepartment.setValue(null),this.patientFormGroup.controls.entityInsuranceID.setValue(null),this.patientFormGroup.controls.entityInsuranceCode.setValue(null),this.patientFormGroup.controls.entityPolicyNumber.setValue(null)}onChangeOfDOBInput(t){let i;if(null!==this.selectedMasterData){const n=this.commonService.convertDate(this.selectedMasterData?.effectiveDateFrom);i=this.commonService.parseDate(n)||new Date}else i=this.masterList[0]?.todayDate||new Date;this.setValuesOfYearMonthAndDays(i,t)}onChangeOfYearMonthDaysInput(){let a,t=Number(this.patientFormGroup.controls.entityAgeInYear.value),i=Number(this.patientFormGroup.controls.entityAgeInMonth.value),n=Number(this.patientFormGroup.controls.entityAgeInDays.value);if(null!==this.selectedMasterData){const T=this.commonService.convertDate(this.selectedMasterData?.effectiveDateFrom);a=this.commonService.parseDate(T)||new Date}else a=this.masterList[0]?.todayDate||new Date;let s=new Date(a).getFullYear()-t,u=new Date(a).getMonth()-i,m=new Date(a).getDate()-n;const L=new Date(s,u,m);this.patientFormGroup.controls.entityDOB.setValue(L)}setValuesOfYearMonthAndDays(t,i){const n=this.commonService.findValuesOfYearMonthAndDays(t,i);this.patientFormGroup.controls.entityAgeInYear.setValue(n.years),this.patientFormGroup.controls.entityAgeInMonth.setValue(n.months),this.patientFormGroup.controls.entityAgeInDays.setValue(n.days)}updatePatientForm(){this.patientFormGroup.valid?(this.isSubmitted=!1,null===this.selectedMasterData?this.addNewPatient(this.patientFormGroup.value):this.updatePatient(this.selectedMasterData,this.patientFormGroup.value)):(this.isSubmitted=!0,this.patientFormGroup.markAllAsTouched(),this.patientFormGroup.updateValueAndValidity())}addNewPatient(t){const i={patientEntity:{entitySalutationID:t.entitySalutationID,entityBusinessName:t.entityBusinessName,entityCategoryID:t.entityCategoryID,entityClubMemberID:t.entityClubMemberID,entityAllergy:t.entityAllergy,entityGender:t.entityGender,entityBloodGroupID:t.entityBloodGroupID,entityWeight:t.entityWeight,entityHeight:t.entityHeight,entityCountryID:t.entityCountryID,entityStateID:t.entityStateID,entityCityID:t.entityCityID,entityAddress:t.entityAddress,entityMobileNumber:t.entityMobileNumber,entityResidentialNumber:t.entityResidentialNumber,entityPatientType:t.entityPatientType,entityCorporateID:t.entityCorporateID,entityEmployeeNumber:t.entityEmployeeNumber,entityEmployeeDesignation:t.entityEmployeeDesignation,entityEmployeeDepartment:t.entityEmployeeDepartment,entityInsuranceID:t.entityInsuranceID,entityInsuranceCode:t.entityInsuranceCode,entityPolicyNumber:t.entityPolicyNumber,entityEmailID:t.entityEmailID,entityPhoto:this.base64StringForPatientImage,entityDOB:this.commonService.parseDate(t.entityDOB),entityAgeInMonth:t.entityAgeInMonth,entityAgeInYear:t.entityAgeInYear,entityAgeInDays:t.entityAgeInDays,companyID:this.authService.companyID,createdBy:this.authService.employeeID,auditAction:"C",mode:"W",activeFlag:1}};this.masterService.requestActionRestAPI(t,i,"patientservice/createPatient","Adding ").then(n=>{this.fetchDataOnCloseDialog$.next([{modifiedObject:n}])}).catch(n=>{this.toastrService.show({type:"error",text:n})})}updatePatient(t,i){const n={patientEntity:{entityID:t.entityID,entityBusinessID:t.entityBusinessID,entitySalutationID:i.entitySalutationID,entityBusinessName:i.entityBusinessName,entityCategoryID:i.entityCategoryID,entityClubMemberID:i.entityClubMemberID,entityAllergy:i.entityAllergy,entityGender:i.entityGender,entityBloodGroupID:i.entityBloodGroupID,entityWeight:i.entityWeight,entityHeight:i.entityHeight,entityCountryID:i.entityCountryID,entityStateID:i.entityStateID,entityCityID:i.entityCityID,entityAddress:i.entityAddress,entityMobileNumber:i.entityMobileNumber,entityResidentialNumber:i.entityResidentialNumber,entityPatientType:i.entityPatientType,entityCorporateID:i.entityCorporateID,entityEmployeeNumber:i.entityEmployeeNumber,entityEmployeeDesignation:i.entityEmployeeDesignation,entityEmployeeDepartment:i.entityEmployeeDepartment,entityInsuranceID:i.entityInsuranceID,entityInsuranceCode:i.entityInsuranceCode,entityPolicyNumber:i.entityPolicyNumber,entityEmailID:i.entityEmailID,entityPhoto:this.base64StringForPatientImage,entityDOB:this.commonService.parseDate(i.entityDOB),entityAgeInMonth:i.entityAgeInMonth,entityAgeInYear:i.entityAgeInYear,entityAgeInDays:i.entityAgeInDays,companyID:this.authService.companyID,createdBy:this.authService.employeeID,auditAction:"U",mode:"W",activeFlag:1}};this.masterService.requestActionRestAPI(i,n,"patientservice/updatePatient","Updating ").then(a=>{this.fetchDataOnCloseDialog$.next([{modifiedObject:a}])}).catch(a=>{this.toastrService.show({type:"error",text:a})})}ngOnDestroy(){this.fetchDataOnCloseDialog$&&this.fetchDataOnCloseDialog$.unsubscribe(),this.destroySubscription$.next(null),this.destroySubscription$.complete()}}return(r=l).\u0275fac=function(t){return new(t||r)(e.Y36(b.D),e.Y36(v.c),e.Y36(C.$),e.Y36(o.qu),e.Y36(f.k),e.Y36(Y.H7),e.Y36($.v))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-patient-form"]],inputs:{selectedMasterData:"selectedMasterData",masterList:"masterList",submitButtonLabel:"submitButtonLabel"},decls:151,vars:89,consts:[["autocomplete","off",3,"formGroup"],["mat-stretch-tabs","","color","primary","backgroundColor","primary",1,"example-stretched-tabs"],["employeeMatTabGroup",""],["label","Basic"],[1,"container-fluid","patient-master-container"],[1,"row"],[1,"col-12","col-md-6","col-lg-4"],[3,"dropdownFor","isRequired","records","formControlsName","idForSelect","keyup","dropdownChangeEvent"],["appearance","outline",1,"lms-mat-form-field"],["matInput","","placeholder","Patient Name*","formControlName","entityBusinessName","minLength","1","maxLength","100","required","","id","basic-tab-2","oninput","this.value = this.value.toUpperCase()",3,"pattern","keyup"],[4,"ngIf"],["matInput","","placeholder","Allergy","formControlName","entityAllergy","id","basic-tab-5",3,"keyup"],["matInput","","placeholder","Date of Birth (MM/DD/YYYY)","formControlName","entityDOB","id","basic-tab-6","readonly","",3,"matDatepicker","max","click","dateChange"],["matSuffix","",3,"for"],["aria-label","calendar-icon","matDatepickerToggleIcon","",1,"lms-calendar-icon"],["dobpicker",""],["matInput","","placeholder","Age (in year)","formControlName","entityAgeInYear","minLength","1","maxLength","3","id","basic-tab-7",3,"pattern","keyup"],["matInput","","placeholder","Age (in month)","formControlName","entityAgeInMonth","minLength","1","maxLength","2","id","basic-tab-8",3,"pattern","keyup"],["matInput","","placeholder","Age (in day)","formControlName","entityAgeInDays","minLength","1","maxLength","2","id","basic-tab-9",3,"pattern","keyup"],["formControlName","entityGender","required","","id","basic-tab-10"],[3,"value",4,"ngFor","ngForOf"],[3,"dropdownFor","isRequired","records","formControlsName","idForSelect","dropdownChangeEvent"],["matInput","","placeholder","Weight","id","basic-tab-12","formControlName","entityWeight","minLength","1","maxLength","3",3,"pattern","keyup"],["matInput","","placeholder","Height","id","basic-tab-13","formControlName","entityHeight","minLength","1","maxLength","3",3,"pattern","keyup"],["label","Personal"],["matInput","","placeholder","Address","formControlName","entityAddress","minLength","1","maxLength","200","id","personal-tab-4","rows","1",3,"keyup"],["matInput","","placeholder","Mobile Number*","id","personal-tab-5","formControlName","entityMobileNumber","minLength","10","maxLength","10","required","",3,"pattern","keyup"],["matInput","","placeholder","Residential Contact Number","id","personal-tab-6","formControlName","entityResidentialNumber","minLength","10","maxLength","10",3,"pattern","keyup"],[1,"col-12"],[1,"col-12","col-md-4","col-lg-4"],["label","User"],[1,"row",2,"width","100%"],["matInput","","placeholder","Email ID*","formControlName","entityEmailID","minLength","1","maxLength","100","id","user-tab-1",3,"keyup"],["formControlName","entityPatientType","id","user-tab-2",3,"selectionChange"],[1,"col-12","col-md-6","col-lg-4",3,"hidden"],["matInput","","placeholder","Employee Number","id","user-tab-4","formControlName","entityEmployeeNumber","minLength","1","maxLength","100",3,"pattern","keyup"],["matInput","","placeholder","Employee Designation","id","user-tab-5","formControlName","entityEmployeeDesignation","minLength","1","maxLength","100",3,"pattern","keyup"],["matInput","","placeholder","Employee Department","id","user-tab-6","formControlName","entityEmployeeDepartment","minLength","1","maxLength","100",3,"pattern","keyup"],["matInput","","placeholder","Insurance Card Number","id","user-tab-8","formControlName","entityInsuranceCode","minLength","1","maxLength","100",3,"pattern","keyup"],["matInput","","placeholder","Policy Number","id","user-tab-9","formControlName","entityPolicyNumber","minLength","1","maxLength","100",3,"pattern","keyup"],["class","required-field-info",4,"ngIf"],["type","button",1,"btn","btn-primary","lms-submit-button",3,"keydown.enter","click"],[3,"value"],["for","official-tab-8",1,"custom-file-upload"],["aria-label","upload",1,"lms-upload-icon"],["id","official-tab-8","type","file","accept","image/*",3,"change"],["alt","Image Logo",1,"file-upload-image",3,"src"],["mat-icon-button","",1,"clear-image-icon",3,"disableRipple","click"],["aria-label","clear-image",1,"lms-clear-image-icon"],[1,"required-field-info"]],template:function(t,i){if(1&t){const n=e.EpF();e.TgZ(0,"form",0)(1,"mat-tab-group",1,2)(3,"mat-tab",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"app-lms-select",7),e.NdJ("keyup",function(s){return i.keytab(s,"entitySalutationID",!1)})("dropdownChangeEvent",function(s){return i.onChangeOfDropdown(s)}),e.qZA()(),e.TgZ(8,"div",6)(9,"mat-form-field",8)(10,"mat-label"),e._uU(11,"Patient Name"),e.qZA(),e.TgZ(12,"input",9),e.NdJ("keyup",function(s){return i.keytab(s,"entityBusinessName",!1)}),e.qZA(),e.YNc(13,ei,2,0,"mat-error",10),e.YNc(14,ti,2,0,"mat-error",10),e.qZA()(),e.TgZ(15,"div",6)(16,"app-lms-select",7),e.NdJ("keyup",function(s){return i.keytab(s,"entityCategoryID",!1)})("dropdownChangeEvent",function(s){return i.onChangeOfDropdown(s)}),e.qZA()(),e.TgZ(17,"div",6)(18,"app-lms-select",7),e.NdJ("keyup",function(s){return i.keytab(s,"entityClubMemberID",!1)})("dropdownChangeEvent",function(s){return i.onChangeOfDropdown(s)}),e.qZA()(),e.TgZ(19,"div",6)(20,"mat-form-field",8)(21,"mat-label"),e._uU(22,"Allergy"),e.qZA(),e.TgZ(23,"input",11),e.NdJ("keyup",function(s){return i.keytab(s,"entityAllergy",!1)}),e.qZA()()(),e.TgZ(24,"div",6)(25,"mat-form-field",8)(26,"mat-label"),e._uU(27,"Date of Birth (MM/DD/YYYY)"),e.qZA(),e.TgZ(28,"input",12),e.NdJ("click",function(){e.CHM(n);const s=e.MAs(32);return e.KtG(s.open())})("dateChange",function(s){return i.onChangeOfDOBInput(s.target.value)}),e.qZA(),e.TgZ(29,"mat-datepicker-toggle",13),e._UZ(30,"div",14),e.qZA(),e._UZ(31,"mat-datepicker",null,15),e.qZA()(),e.TgZ(33,"div",6)(34,"mat-form-field",8)(35,"mat-label"),e._uU(36,"Age (in year)"),e.qZA(),e.TgZ(37,"input",16),e.NdJ("keyup",function(s){return i.keytab(s,"entityAgeInYear",!1)}),e.qZA()()(),e.TgZ(38,"div",6)(39,"mat-form-field",8)(40,"mat-label"),e._uU(41,"Age (in month)"),e.qZA(),e.TgZ(42,"input",17),e.NdJ("keyup",function(s){return i.keytab(s,"entityAgeInMonth",!1)}),e.qZA()()(),e.TgZ(43,"div",6)(44,"mat-form-field",8)(45,"mat-label"),e._uU(46,"Age (in day)"),e.qZA(),e.TgZ(47,"input",18),e.NdJ("keyup",function(s){return i.keytab(s,"entityAgeInDays",!1)}),e.qZA()()(),e.TgZ(48,"div",6)(49,"mat-form-field",8)(50,"mat-label"),e._uU(51,"Choose Gender"),e.qZA(),e.TgZ(52,"mat-select",19),e.YNc(53,ii,2,2,"mat-option",20),e.ALo(54,"async"),e.qZA(),e.YNc(55,ni,2,0,"mat-error",10),e.qZA()(),e.TgZ(56,"div",6)(57,"app-lms-select",21),e.NdJ("dropdownChangeEvent",function(s){return i.onChangeOfDropdown(s)}),e.qZA()(),e.TgZ(58,"div",6)(59,"mat-form-field",8)(60,"mat-label"),e._uU(61,"Weight (kg)"),e.qZA(),e.TgZ(62,"input",22),e.NdJ("keyup",function(s){return i.keytab(s,"entityWeight",!1)}),e.qZA(),e.YNc(63,ai,2,0,"mat-error",10),e.qZA()(),e.TgZ(64,"div",6)(65,"mat-form-field",8)(66,"mat-label"),e._uU(67,"Height (cm)"),e.qZA(),e.TgZ(68,"input",23),e.NdJ("keyup",function(s){return i.keytab(s,"entityHeight",!1)}),e.qZA(),e.YNc(69,si,2,0,"mat-error",10),e.qZA()()()()(),e.TgZ(70,"mat-tab",24)(71,"div",4)(72,"div",5)(73,"div",6)(74,"app-lms-select",21),e.NdJ("dropdownChangeEvent",function(s){return i.onChangeOfDropdown(s)}),e.qZA()(),e.TgZ(75,"div",6)(76,"app-lms-select",21),e.NdJ("dropdownChangeEvent",function(s){return i.onChangeOfDropdown(s)}),e.qZA()(),e.TgZ(77,"div",6)(78,"app-lms-select",21),e.NdJ("dropdownChangeEvent",function(s){return i.onChangeOfDropdown(s)}),e.qZA()(),e.TgZ(79,"div",6)(80,"mat-form-field",8)(81,"mat-label"),e._uU(82,"Address"),e.qZA(),e.TgZ(83,"textarea",25),e.NdJ("keyup",function(s){return i.keytab(s,"entityAddress",!1)}),e.qZA()()(),e.TgZ(84,"div",6)(85,"mat-form-field",8)(86,"mat-label"),e._uU(87,"Mobile Number"),e.qZA(),e.TgZ(88,"input",26),e.NdJ("keyup",function(s){return i.keytab(s,"entityMobileNumber",!1)}),e.qZA(),e.YNc(89,ri,2,0,"mat-error",10),e.YNc(90,oi,2,0,"mat-error",10),e.YNc(91,li,2,0,"mat-error",10),e.qZA()(),e.TgZ(92,"div",6)(93,"mat-form-field",8)(94,"mat-label"),e._uU(95,"Residential Contact Number"),e.qZA(),e.TgZ(96,"input",27),e.NdJ("keyup",function(s){return i.keytab(s,"entityResidentialNumber",!1)}),e.qZA(),e.YNc(97,ui,2,0,"mat-error",10),e.qZA()(),e.TgZ(98,"div",28)(99,"div",5)(100,"div",29),e.YNc(101,ci,5,0,"ng-container",10),e.YNc(102,pi,4,2,"ng-container",10),e.qZA()()()()()(),e.TgZ(103,"mat-tab",30)(104,"div",4)(105,"div",31)(106,"div",6)(107,"mat-form-field",8)(108,"mat-label"),e._uU(109,"Email ID"),e.qZA(),e.TgZ(110,"input",32),e.NdJ("keyup",function(s){return i.keytab(s,"entityEmailID",!1)}),e.qZA(),e.YNc(111,di,2,0,"mat-error",10),e.qZA()(),e.TgZ(112,"div",6)(113,"mat-form-field",8)(114,"mat-label"),e._uU(115,"Choose Patient Type"),e.qZA(),e.TgZ(116,"mat-select",33),e.NdJ("selectionChange",function(s){return i.onChangeOfPatientType(s.value)}),e.YNc(117,mi,2,2,"mat-option",20),e.ALo(118,"async"),e.qZA()()(),e.TgZ(119,"div",34)(120,"app-lms-select",21),e.NdJ("dropdownChangeEvent",function(s){return i.onChangeOfDropdown(s)}),e.qZA()(),e.TgZ(121,"div",34)(122,"mat-form-field",8)(123,"mat-label"),e._uU(124,"Employee Number"),e.qZA(),e.TgZ(125,"input",35),e.NdJ("keyup",function(s){return i.keytab(s,"entityEmployeeNumber",!1)}),e.qZA()()(),e.TgZ(126,"div",34)(127,"mat-form-field",8)(128,"mat-label"),e._uU(129,"Employee Designation"),e.qZA(),e.TgZ(130,"input",36),e.NdJ("keyup",function(s){return i.keytab(s,"entityEmployeeDesignation",!1)}),e.qZA()()(),e.TgZ(131,"div",34)(132,"mat-form-field",8)(133,"mat-label"),e._uU(134,"Employee Department"),e.qZA(),e.TgZ(135,"input",37),e.NdJ("keyup",function(s){return i.keytab(s,"entityEmployeeDepartment",!1)}),e.qZA()()(),e.TgZ(136,"div",34)(137,"app-lms-select",21),e.NdJ("dropdownChangeEvent",function(s){return i.onChangeOfDropdown(s)}),e.qZA()(),e.TgZ(138,"div",34)(139,"mat-form-field",8)(140,"mat-label"),e._uU(141,"Insurance Card Number"),e.qZA(),e.TgZ(142,"input",38),e.NdJ("keyup",function(s){return i.keytab(s,"entityInsuranceCode",!1)}),e.qZA()()(),e.TgZ(143,"div",34)(144,"mat-form-field",8)(145,"mat-label"),e._uU(146,"Policy Number"),e.qZA(),e.TgZ(147,"input",39),e.NdJ("keyup",function(s){return i.keytab(s,"entityPolicyNumber",!1)}),e.qZA()()()()()()(),e.YNc(148,hi,3,0,"div",40),e.TgZ(149,"button",41),e.NdJ("keydown.enter",function(s){return s.preventDefault()})("click",function(){return i.updatePatientForm()}),e._uU(150),e.qZA()()}if(2&t){const n=e.MAs(32);e.Q6J("formGroup",i.patientFormGroup),e.xp6(7),e.Q6J("dropdownFor","Salutation")("isRequired",!0)("records",i.salutationList$)("formControlsName",i.patientFormGroup.controls.entitySalutationID)("idForSelect","basic-tab-1"),e.xp6(5),e.Q6J("pattern","[^]*"),e.xp6(1),e.Q6J("ngIf",null==i.patientFormGroup.controls.entityBusinessName||null==i.patientFormGroup.controls.entityBusinessName.errors?null:i.patientFormGroup.controls.entityBusinessName.errors.required),e.xp6(1),e.Q6J("ngIf",null==i.patientFormGroup.controls.entityBusinessName||null==i.patientFormGroup.controls.entityBusinessName.errors?null:i.patientFormGroup.controls.entityBusinessName.errors.pattern),e.xp6(2),e.Q6J("dropdownFor","Category")("isRequired",!1)("records",i.categoriesList$)("formControlsName",i.patientFormGroup.controls.entityCategoryID)("idForSelect","basic-tab-3"),e.xp6(2),e.Q6J("dropdownFor","Club Member")("isRequired",!1)("records",i.clubMemberList$)("formControlsName",i.patientFormGroup.controls.entityClubMemberID)("idForSelect","basic-tab-4"),e.xp6(10),e.Q6J("matDatepicker",n)("max",i.currentDate),e.xp6(1),e.Q6J("for",n),e.xp6(8),e.Q6J("pattern","[0-9/]*"),e.xp6(5),e.Q6J("pattern","[0-9/]*"),e.xp6(5),e.Q6J("pattern","[0-9/]*"),e.xp6(6),e.Q6J("ngForOf",e.lcZ(54,85,i.genderList$)),e.xp6(2),e.Q6J("ngIf",null==i.patientFormGroup.controls.entityGender||null==i.patientFormGroup.controls.entityGender.errors?null:i.patientFormGroup.controls.entityGender.errors.required),e.xp6(2),e.Q6J("dropdownFor","Blood Group")("isRequired",!1)("records",i.bloodGroupList$)("formControlsName",i.patientFormGroup.controls.entityBloodGroupID)("idForSelect","basic-tab-11"),e.xp6(5),e.Q6J("pattern","[0-9/]*"),e.xp6(1),e.Q6J("ngIf",null==i.patientFormGroup.controls.entityWeight||null==i.patientFormGroup.controls.entityWeight.errors?null:i.patientFormGroup.controls.entityWeight.errors.pattern),e.xp6(5),e.Q6J("pattern","[0-9/]*"),e.xp6(1),e.Q6J("ngIf",null==i.patientFormGroup.controls.entityHeight||null==i.patientFormGroup.controls.entityHeight.errors?null:i.patientFormGroup.controls.entityHeight.errors.pattern),e.xp6(5),e.Q6J("dropdownFor","Country")("isRequired",!0)("records",i.countryList$)("formControlsName",i.patientFormGroup.controls.entityCountryID)("idForSelect","personal-tab-1"),e.xp6(2),e.Q6J("dropdownFor","State")("isRequired",!0)("records",i.stateList$)("formControlsName",i.patientFormGroup.controls.entityStateID)("idForSelect","personal-tab-2"),e.xp6(2),e.Q6J("dropdownFor","City")("isRequired",!0)("records",i.cityList$)("formControlsName",i.patientFormGroup.controls.entityCityID)("idForSelect","personal-tab-3"),e.xp6(10),e.Q6J("pattern","[6-9]{1}[0-9]{9}"),e.xp6(1),e.Q6J("ngIf",null==i.patientFormGroup.controls.entityMobileNumber||null==i.patientFormGroup.controls.entityMobileNumber.errors?null:i.patientFormGroup.controls.entityMobileNumber.errors.pattern),e.xp6(1),e.Q6J("ngIf",null==i.patientFormGroup.controls.entityMobileNumber||null==i.patientFormGroup.controls.entityMobileNumber.errors?null:i.patientFormGroup.controls.entityMobileNumber.errors.required),e.xp6(1),e.Q6J("ngIf",null==i.patientFormGroup.controls.entityMobileNumber||null==i.patientFormGroup.controls.entityMobileNumber.errors?null:i.patientFormGroup.controls.entityMobileNumber.errors.mustBeUnique),e.xp6(5),e.Q6J("pattern","[6-9]{1}[0-9]{9}"),e.xp6(1),e.Q6J("ngIf",null==i.patientFormGroup.controls.entityResidentialNumber||null==i.patientFormGroup.controls.entityResidentialNumber.errors?null:i.patientFormGroup.controls.entityResidentialNumber.errors.pattern),e.xp6(4),e.Q6J("ngIf",0===i.base64StringForPatientImage.length),e.xp6(1),e.Q6J("ngIf",i.base64StringForPatientImage.length>0),e.xp6(9),e.Q6J("ngIf",null==i.patientFormGroup.controls.entityEmailID||null==i.patientFormGroup.controls.entityEmailID.errors?null:i.patientFormGroup.controls.entityEmailID.errors.email),e.xp6(6),e.Q6J("ngForOf",e.lcZ(118,87,i.patientTypeList$)),e.xp6(2),e.Q6J("hidden","CORPORATE"!==i.patientFormGroup.controls.entityPatientType.value),e.xp6(1),e.Q6J("dropdownFor","Corporate")("isRequired",!1)("records",i.corporateList$)("formControlsName",i.patientFormGroup.controls.entityCorporateID)("idForSelect","user-tab-3"),e.xp6(1),e.Q6J("hidden","CORPORATE"!==i.patientFormGroup.controls.entityPatientType.value),e.xp6(4),e.Q6J("pattern","[^]*"),e.xp6(1),e.Q6J("hidden","CORPORATE"!==i.patientFormGroup.controls.entityPatientType.value),e.xp6(4),e.Q6J("pattern","[^]*"),e.xp6(1),e.Q6J("hidden","CORPORATE"!==i.patientFormGroup.controls.entityPatientType.value),e.xp6(4),e.Q6J("pattern","[^]*"),e.xp6(1),e.Q6J("hidden","INSURANCE"!==i.patientFormGroup.controls.entityPatientType.value),e.xp6(1),e.Q6J("dropdownFor","Insurance")("isRequired",!1)("records",i.insuranceList$)("formControlsName",i.patientFormGroup.controls.entityInsuranceID)("idForSelect","user-tab-7"),e.xp6(1),e.Q6J("hidden","INSURANCE"!==i.patientFormGroup.controls.entityPatientType.value),e.xp6(4),e.Q6J("pattern","[^]*"),e.xp6(1),e.Q6J("hidden","INSURANCE"!==i.patientFormGroup.controls.entityPatientType.value),e.xp6(4),e.Q6J("pattern","[^]*"),e.xp6(1),e.Q6J("ngIf",i.isSubmitted&&i.patientFormGroup.invalid),e.xp6(2),e.hij(" ",i.submitButtonLabel," ")}},dependencies:[D.sg,D.O5,o._Y,o.Fj,o.JJ,o.JL,o.Q7,o.c5,o.sg,o.u,k.P,Q.ey,_.RK,P.Mq,P.hl,P.nW,P.Q0,x.Nt,y.KE,y.hX,y.TO,y.R9,G.gD,O.uX,O.SP,D.Ov],styles:[".example-stretched-tabs{max-width:100vw}.patient-master-container{display:flex;margin-top:10px}input[type=file]{display:none}input::-webkit-outer-spin-button,input::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}input[type=number]{-moz-appearance:textfield}.custom-file-upload{border:1px solid #ccc;display:inline-block;padding:6px 12px;cursor:pointer;height:200px;width:15vw;text-align:center;border-radius:5px}@media (max-width: 766px){.custom-file-upload{width:73vw}}.file-upload-image{border:1px solid #ccc;height:200px;width:15vw;border-radius:5px;object-fit:contain}@media (max-width: 766px){.file-upload-image{width:73vw}}.file-upload-image:hover{filter:blur(3px)}.clear-image-icon{position:relative;right:8vw;top:10px}@media (max-width: 766px){.clear-image-icon{right:-32vw;top:-15vh}}.lms-flat-amount{display:inline-block;position:relative;text-align:left;width:10vw}.percentage-checkbox{display:flex;flex-direction:row;margin-top:10px}@media (max-width: 766px){.percentage-checkbox{margin-top:5px;margin-bottom:5px}}.required-field-info{font-size:14px;font-style:italic;font-weight:100;color:red;text-align:center}\n"],encapsulation:2}),l})();function yi(r,l){if(1&r&&(e.TgZ(0,"div",7),e._UZ(1,"app-mini-card",8),e.qZA()),2&r){const c=l.$implicit;e.xp6(1),e.Q6J("cardItem",c)}}let gi=(()=>{var r;class l{constructor(t,i){this._bottomSheetRef=t,this.data=i,this.cardDetailList=[]}ngOnInit(){this.cardDetailList.push({type:"label",name:"Category",value:this.data.entityCategoryName||"N/A"},{type:"label",name:"Club Member",value:this.data.entityClubMemberName||"N/A"},{type:"label",name:"Allergy",value:this.data.entityAllergy||"N/A"},{type:"date",name:"Date of birth",value:this.data.entityDOB||"N/A"},{type:"label",name:"Age (in year)",value:this.data.entityAgeInYear||0},{type:"label",name:"Age (in month)",value:this.data.entityAgeInMonth||0},{type:"label",name:"Age (in day)",value:this.data.entityAgeInDays||0},{type:"label",name:"Gender",value:this.data.entityGender||"N/A"},{type:"label",name:"Blood Group",value:this.data.entityBloodGroupNmae||"N/A"},{type:"label",name:"Weight (in kg)",value:this.data.entityWeight||"N/A"},{type:"label",name:"Height (in cm)",value:this.data.entityHeight||"N/A"},{type:"label",name:"Country",value:this.data.entityCountryName||"N/A"},{type:"label",name:"State",value:this.data.entityStateName||"N/A"},{type:"label",name:"City",value:this.data.entityCityName||"N/A"},{type:"label",name:"Address",value:this.data.entityAddress||"N/A"},{type:"label",name:"Mobile Number",value:this.data.entityMobileNumber||"N/A"},{type:"label",name:"Residential Contact Number",value:this.data.entityResidentialNumber||"N/A"},{type:"image",name:"Patient Image",value:this.data.entityPhoto||""},{type:"label",name:"Email ID",value:this.data.entityEmailID||"N/A"},{type:"label",name:"Patient Type",value:this.data.entityPatientType||"N/A"}),"CORPORATE"===this.data.entityPatientType&&this.cardDetailList.push({type:"label",name:"Corporate",value:this.data.entityCorporateName||"N/A"},{type:"label",name:"Employee Number",value:this.data.entityEmployeeNumber||"N/A"},{type:"label",name:"Employee Designation",value:this.data.entityEmployeeDesignation||"N/A"},{type:"label",name:"Employee Department",value:this.data.entityEmployeeDepartment||"N/A"}),"INSURANCE"===this.data.entityPatientType&&this.cardDetailList.push({type:"label",name:"Insurance",value:this.data.entityInsuranceName||"N/A"},{type:"label",name:"Insurance Card Number",value:this.data.entityInsuranceCode||"N/A"},{type:"label",name:"Policy Number",value:this.data.entityPolicyNumber||"N/A"})}ngOnDestroy(){this.cardDetailList=[]}closeProfilePanel(){this._bottomSheetRef.dismiss()}}return(r=l).\u0275fac=function(t){return new(t||r)(e.Y36(R.oL),e.Y36(R.OG))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-view-patient-profile"]],decls:9,vars:2,consts:[[1,"profile-header"],[1,"patient-name-label"],["mat-icon-button","",3,"click"],["aria-label","cancel",1,"lms-cancel-icon"],[1,"container-fluid"],[1,"row"],["class","col-lg-3 col-md-4 col-sm-12",4,"ngFor","ngForOf"],[1,"col-lg-3","col-md-4","col-sm-12"],[3,"cardItem"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1),e._uU(2),e.qZA(),e.TgZ(3,"div")(4,"button",2),e.NdJ("click",function(){return i.closeProfilePanel()}),e._UZ(5,"div",3),e.qZA()()(),e.TgZ(6,"div",4)(7,"div",5),e.YNc(8,yi,2,1,"div",6),e.qZA()()),2&t&&(e.xp6(2),e.Oqu(i.data.entitySalutationID+" "+i.data.entityBusinessName||""),e.xp6(6),e.Q6J("ngForOf",i.cardDetailList))},dependencies:[D.sg,_.RK,H],styles:[".profile-header[_ngcontent-%COMP%]{background-color:#535562;color:#fff;margin-left:-16px;margin-right:-16px;margin-top:-8px;min-height:64px;display:flex;flex-direction:row;justify-content:space-between;align-items:center}.patient-name-label[_ngcontent-%COMP%]{font-size:18px;margin-left:10px}"]}),l})();var bi=h(2198),fi=h(2154);function vi(r,l){if(1&r){const c=e.EpF();e.TgZ(0,"div",1)(1,"div",2)(2,"div",3),e._UZ(3,"app-breadcrumb",4),e.qZA(),e.TgZ(4,"div",5)(5,"mat-form-field",6)(6,"mat-label"),e._uU(7,"Start Date"),e.qZA(),e.TgZ(8,"input",7),e.NdJ("ngModelChange",function(i){e.CHM(c);const n=e.oxw();return e.KtG(n.selectedStartDate=i)})("click",function(){e.CHM(c);const i=e.MAs(12);return e.KtG(i.open())}),e.qZA(),e.TgZ(9,"mat-datepicker-toggle",8),e._UZ(10,"div",9),e.qZA(),e._UZ(11,"mat-datepicker",null,10),e.qZA()(),e.TgZ(13,"div",5)(14,"mat-form-field",6)(15,"mat-label"),e._uU(16,"End Date"),e.qZA(),e.TgZ(17,"input",11),e.NdJ("ngModelChange",function(i){e.CHM(c);const n=e.oxw();return e.KtG(n.selectedEndDate=i)})("click",function(){e.CHM(c);const i=e.MAs(21);return e.KtG(i.open())}),e.qZA(),e.TgZ(18,"mat-datepicker-toggle",8),e._UZ(19,"div",9),e.qZA(),e._UZ(20,"mat-datepicker",null,12),e.qZA()(),e.TgZ(22,"div",13)(23,"button",14),e.NdJ("click",function(){e.CHM(c);const i=e.oxw();return e.KtG(i.resetDateFilter())}),e._uU(24," Reset "),e.qZA(),e.TgZ(25,"button",15),e.NdJ("click",function(){e.CHM(c);const i=e.oxw();return e.KtG(i.searchPatientForSelectedDate())}),e._uU(26," Search Patient "),e.qZA()()(),e.TgZ(27,"div",2)(28,"mat-card",16)(29,"mat-card-title-group",17)(30,"button",18),e.NdJ("click",function(){e.CHM(c);const i=e.oxw();return e.KtG(i.exportData("xlsx"))}),e._UZ(31,"div",19),e.qZA(),e.TgZ(32,"button",18),e.NdJ("click",function(){e.CHM(c);const i=e.oxw();return e.KtG(i.exportData("csv"))}),e._UZ(33,"div",20),e.qZA(),e._UZ(34,"span",21),e.TgZ(35,"mat-slide-toggle",22),e.NdJ("change",function(i){e.CHM(c);const n=e.oxw();return e.KtG(n.showLog(i.checked))}),e._uU(36," Show Logs "),e.qZA()()()()()}if(2&r){const c=e.MAs(12),t=e.MAs(21),i=e.oxw();e.xp6(8),e.Q6J("matDatepicker",c)("ngModel",i.selectedStartDate)("max",i.currentDate),e.xp6(1),e.Q6J("for",c),e.xp6(8),e.Q6J("matDatepicker",t)("ngModel",i.selectedEndDate)("max",i.currentDate)("min",i.selectedStartDate),e.xp6(1),e.Q6J("for",t),e.xp6(12),e.Q6J("disableRipple",!0),e.xp6(2),e.Q6J("disableRipple",!0),e.xp6(3),e.Q6J("checked",i.showLogCheckedFlag)}}function Ci(r,l){1&r&&(e.TgZ(0,"div",1),e._UZ(1,"app-access-denied",23),e.qZA())}let Di=(()=>{var r;class l{constructor(t,i,n,a,s,u,m,L,T){this.loader=t,this.toastrService=i,this.masterService=n,this.exportService=a,this.authService=s,this.dialog=u,this.commonService=m,this.winRef=L,this._bottomSheet=T,this.patientList$=new p.X([]),this.inlineEditFlag=!1,this.showLogCheckedFlag=!1,this.gridOptions=new F.s8,this.changeDetection=new A.x,this.destroySubscription$=new Z.t(1),this.currentDate=new Date,this.selectedStartDate=new Date,this.selectedEndDate=new Date,this.pageAccessDetail={},this.canViewRecord=!0}ngOnInit(){this.getPageAccessDetail().then(i=>{this.pageAccessDetail=i,this.canViewRecord=1==this.pageAccessDetail?.data?.entityIsBillView,this.gridOptions.showAddButton=1==this.pageAccessDetail?.data?.entityIsInsert,this.canViewRecord?this.getPatientList(!1).then(n=>{this.patientList$.next(n)}).catch(n=>{this.patientList$.next([]),this.toastrService.show({type:"error",text:n})}):this.loader.hideSpinner()}).catch(i=>{this.toastrService.show({type:"error",text:i})}),this.companyLogo="data:image/png;base64,"+this.authService.currentUserValue.responseList[0].companyLogo,this.gridOptions={searchPlaceholder:"Search Patient",pageSize:this.authService.pageSize,dateFormat:"yyyy-MM-dd",keyCodeForNextCell:13,showInlineEdit:this.inlineEditFlag,titleForMobileView:"entityBusinessName",pageSizeArray:[5,10,20],showDeleteButton:!1,showAddButton:!1,showEditButton:!1,showActivateDeactivateButton:!0,showSearchInput:!0,activateDeactivateCondition:{conditionalProperty:"activeFlag",valueForActivation:"1",valueForDeactivation:"0"},columns:[{name:"entityBusinessShortCode",label:"Patient Code",enable:!0,searchable:!0,sortable:!0,type:"text"},{name:"entityBusinessName",label:"Patient Name",enable:!0,searchable:!0,sortable:!0,type:"text",editable:!1},{name:"entityCityName",label:"City",enable:!0,searchable:!0,sortable:!1,type:"text",editable:!1},{name:"entityDOB",label:"Date Of Birth",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1},{name:"entityMobileNumber",label:"Mobile Number",enable:!0,searchable:!0,sortable:!1,type:"text",editable:!1},{name:"entityGender",label:"Gender",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1},{name:"createdByUser",label:"Last Updated By",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"effectiveDateFrom",label:"Last Modified on",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"activeFlag",label:"",enable:!1,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"entityID",label:"",enable:!1,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"entityBusinessID",label:"",enable:!1,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1}]}}ngOnDestroy(){this.destroySubscription$.next(null),this.destroySubscription$.complete()}resetDateFilter(){this.selectedStartDate=new Date,this.selectedEndDate=new Date,this.getPatientList(this.showLogCheckedFlag).then(t=>{this.patientList$.next(t)}).catch(t=>{this.patientList$.next([]),this.toastrService.show({type:"error",text:t})})}searchPatientForSelectedDate(){const t=new Date(this.selectedStartDate),i=new Date(this.selectedEndDate),n=Math.abs(i-t),a=Math.floor(n/864e5),s=this.authService.dateRangeLimit;a>s?this.toastrService.show({type:"error",text:`Date range should be in between of ${s} days.`}):this.getPatientList(this.showLogCheckedFlag).then(u=>{this.patientList$.next(u)}).catch(u=>{this.patientList$.next([]),this.toastrService.show({type:"error",text:u})})}assignPermissionForPatientList(t){var i=this;return(0,U.Z)(function*(){let n=i.pageAccessDetail?.currentDate||new Date,a=i.pageAccessDetail?.data?.entityDays||10,s=1==i.pageAccessDetail?.data?.entityIsDelete,u=1==i.pageAccessDetail?.data?.entityIsUpdate,m=new Date(n).setDate(new Date(n).getDate()-a),L=new Date(m).toISOString().substring(0,10);return t=yield t.map(T=>{let E=i.commonService.convertDate(T?.effectiveDateFrom).toISOString();return{...T,createdAtInMilliseconds:Date.parse(E),showEditButton:!!(u&&Date.parse(E.substring(0,10))>=Date.parse(L)),showActiveFlagButton:!!(s&&Date.parse(E.substring(0,10))>=Date.parse(L))}}).sort((T,E)=>T.createdAtInMilliseconds>E.createdAtInMilliseconds?-1:0)})()}getPatientList(t){var i=this;return new Promise((n,a)=>{this.loader.showSpinner("Patient list on the way!");const s={genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W",detailFlag:t,dropDown:!1,entityType:1,fromDate:this.commonService.parseDate(this.selectedStartDate,"yyyy-MM-dd"),toDate:this.commonService.parseDate(this.selectedEndDate,"yyyy-MM-dd")}};this.masterService.requestApiForGeneralMaster(s,"patientservice/getAllPatient").pipe((0,g.R)(this.destroySubscription$)).subscribe(function(){var u=(0,U.Z)(function*(m){i.loader.hideSpinner(),"200"===m.statusCode||"300"===m.statusCode?(m.responseList=t?null==m.responseList?[]:m.responseList:null==m.responseList?[]:yield i.assignPermissionForPatientList(m.responseList),n(m.responseList)):a(m.errorMessage)});return function(m){return u.apply(this,arguments)}}(),u=>{this.loader.hideSpinner(),a("Either Internet is not working or facing internal server issue")})})}getPageAccessDetail(){return new Promise((t,i)=>{this.loader.showSpinner("Loading..."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,roleID:this.authService.employeeID,entityBusinessID:7,mode:"W"}},"pageaccessservice/getAllEntity").pipe((0,g.R)(this.destroySubscription$)).subscribe(a=>{"200"===a.statusCode||"300"===a.statusCode?(a.responseList=null==a?.responseList?null:a?.responseList[0]?.pageList.find(s=>7===s.pageID)||null,t({data:a.responseList,currentDate:a?.date})):(this.loader.hideSpinner(),i(a.errorMessage))},a=>{this.loader.hideSpinner(),i("Either Internet is not working or facing internal server issue")})})}generateBarCode(t){var i=this;return new Promise((n,a)=>{this.loader.showSpinner("Printing health card..."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W",entityBusinessName:t}},"adminservice/getBarCode").pipe((0,g.R)(this.destroySubscription$)).subscribe(function(){var u=(0,U.Z)(function*(m){i.loader.hideSpinner(),"200"===m.statusCode?n(m.responseList[0]):a(m.errorMessage)});return function(m){return u.apply(this,arguments)}}(),u=>{this.loader.hideSpinner(),a("Either Internet is not working or facing internal server issue")})})}exportData(t){const i=[{property:"entityBusinessShortCode",label:"Patient Code"},{property:"entityBusinessName",label:"Patient Name"},{property:"entityCityName",label:"City"},{property:"entityDOB",label:"Date Of Birth"},{property:"entityMobileNumber",label:"Mobile Number"},{property:"entityGender",label:"Gender"},{property:"createdByUser",label:"Last Updated By"},{property:"effectiveDateFrom",label:"Last Modified on"}];this.showLogCheckedFlag&&i.push({property:"auditAction",label:"Audit Action"}),this.exportService.generateFile(this.patientList$.getValue(),"Patient List."+t,i)}showLog(t){this.patientList$.next([]),this.showLogCheckedFlag=t,t?this.getPatientList(!0).then(i=>{this.patientList$.next(i),this.gridOptions.showAddButton=!1,this.gridOptions.showEditButton=!1,this.gridOptions.showActivateDeactivateButton=!1,this.gridOptions.columns.push({name:"auditAction",label:"Audit Action",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1})}).catch(i=>{this.patientList$.next([]),this.toastrService.show({type:"error",text:i})}):this.ngOnInit()}initiateAddPatient(t){var i=this;this.dialog.open(B.s,{disableClose:!0,data:{header:"Patient Form",buttonLabel:"Submit",records:{selectedItem:t,uniqueItemList:[{todayDate:this.pageAccessDetail?.currentDate}]},component:te},animation:{to:"right"},position:{top:"50vh",left:"50vw"},panelClass:"lms-dialog-box-center"}).afterClosed().subscribe(function(){var a=(0,U.Z)(function*(s){if(null!==s){let u=i.patientList$.getValue();u.unshift(s[0].modifiedObject);let m=yield i.assignPermissionForPatientList(u);i.patientList$.next(m),i.toastrService.show({type:"success",text:s[0].modifiedObject.entityBusinessName+" Created!"})}});return function(s){return a.apply(this,arguments)}}())}initiateEditPatient(t){var i=this;this.dialog.open(B.s,{disableClose:!0,data:{header:"Patient Form",buttonLabel:"Update",records:{selectedItem:t,uniqueItemList:[{todayDate:this.pageAccessDetail?.currentDate}]},component:te},animation:{to:"right"},position:{top:"50vh",left:"50vw"},panelClass:"lms-dialog-box-center"}).afterClosed().subscribe(function(){var a=(0,U.Z)(function*(s){if(null!==s){let u=i.patientList$.getValue(),m=u.findIndex(T=>T.entityBusinessID==s[0].modifiedObject.entityBusinessID);u[m]=s[0].modifiedObject;let L=yield i.assignPermissionForPatientList(u);i.patientList$.next(L),i.toastrService.show({type:"success",text:s[0].modifiedObject.entityBusinessName+" Updated!"})}});return function(s){return a.apply(this,arguments)}}())}activatePatient(t){this.changeStatus(t,1,"A")}deactivatePatient(t){this.changeStatus(t,0,"D")}changeStatus(t,i,n){const m=0===i?" Deactivated!":" Activated!";this.masterService.requestActionRestAPI(t,{patientEntity:{companyName:t.companyName,createdByUser:t.createdByUser,createdIP:t.createdIP,effectiveDateFrom:t.effectiveDateFrom,effectiveDateTo:t.effectiveDateTo,entityAddress:t.entityAddress,entityAgeInDays:t.entityAgeInDays,entityAgeInMonth:t.entityAgeInMonth,entityAgeInYear:t.entityAgeInYear,entityAllergy:t.entityAllergy,entityBloodGroupID:t.entityBloodGroupID,entityBloodGroupNmae:t.entityBloodGroupNmae,entityBusinessID:t.entityBusinessID,entityBusinessName:t.entityBusinessName,entityBusinessShortCode:t.entityBusinessShortCode,entityCategoryID:t.entityCategoryID,entityCategoryName:t.entityCategoryName,entityCityID:t.entityCityID,entityCityName:t.entityCityName,entityClubMemberID:t.entityClubMemberID,entityClubMemberName:t.entityClubMemberName,entityCorporateID:t.entityCorporateID,entityCorporateName:t.entityCorporateName,entityCountryID:t.entityCountryID,entityCountryName:t.entityCountryName,entityDOB:t.entityDOB,entityEmailID:t.entityEmailID,entityEmployeeDepartment:t.entityEmployeeDepartment,entityEmployeeDesignation:t.entityEmployeeDesignation,entityEmployeeNumber:t.entityEmployeeNumber,entityGender:t.entityGender,entityHeight:t.entityHeight,entityID:t.entityID,entityInsuranceCode:t.entityInsuranceCode,entityInsuranceID:t.entityInsuranceID,entityInsuranceName:t.entityInsuranceName,entityMobileNumber:t.entityMobileNumber,entityParentBusinessID:t.entityParentBusinessID,entityParentBusinessName:t.entityParentBusinessName,entityPassword:t.entityPassword,entityPatientType:t.entityPatientType,entityPhoto:t.entityPhoto,entityPolicyNumber:t.entityPolicyNumber,entityResidentialNumber:t.entityResidentialNumber,entitySalutationID:t.entitySalutationID,entitySalutationName:t.entitySalutationName,entityStateID:t.entityStateID,entityStateName:t.entityStateName,entityUserID:t.entityUserID,entityWeight:t.entityWeight,activeFlag:i,auditAction:n,companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W"}},0===i?"patientservice/deactivateEntity":"patientservice/activateEntity",0===i?"Deactivating ":"Activating ").then(L=>{this.changeDetection.next({originalObject:t,modifiedObject:L}),this.toastrService.show({type:"success",text:t.entityBusinessName+m})}).catch(L=>{this.toastrService.show({type:"error",text:L})})}generateHealthCard(t){let i;i=null==t.entityPhoto||""==t.entityPhoto?"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAOEAAADhCAMAAAAJbSJIAAAAMFBMVEX////Z2dnY2Nj8/Pz4+Pje3t7k5OTw8PDn5+f09PTs7Ozh4eHd3d3y8vLp6en6+voBnDYzAAAFM0lEQVR4nO2dDZqqMAxFRRAREPe/2weiMzozQdpeyE1fzgo4X2n+KHA4OI7jOI7jOI7jOI7jOP8dt8u5HYahPVc37UvBczvXfXH8pu/aSvuacJSXepIr3pg062upfW0Iqqb4afdiWV+1ry+VqpP0npL9YHkhyw9+D8nGrON1hd/saHQd23V+d8firH21EZzXC06OJ3PLWAYJTreqpWW8DHXXhwlOjo32da+l7Y+/Evw6xU770tfRxcg9FHsLm7GPF7ShmLCCd8WTtsAnAnKgoFhrKyxTpQqOiq22xCKndMPiyNw4XgGC3FsRsYSjIm9xA9iFs6K2iMiAMhy0TSTCS1EJbROB0G5ChnUnXnCGpCV4cj3zoshZntZAQ87bNLHofjPkrE5xobQgjaZIQ8qNWAIFOctvrCHj8wysIWOXiDVkLE2xhozpAmtIWbdBswVlo5+/IWaGwWwIrEtJDYG9BWmkabI3BHbAnPkQMw9+GlI+LUWNS++GjHUpcNZGO8ZAGl60Zf4EJ8jZAUOLGsopBjQhkj6cASbEXtvlb/If6+MSImdJA334xDimmYD1wJwlzQHYIZKWNMB0QTkQnoClC9Ki7VCD/GgNw449f1CkTIjISRTnTkROEzkzInYNGccYWEPGNUROEzlzPnKayJkvcM1TQdrkI2dtpC0wUJC0QUQeimIMNNije5xvewNDDec2RE4xOLchcorBuQ2BT4FJh/rIUMOY7ydQoYaz/51AhRrKxmIGFGooy+4ZUKihLLtnMMMozuNCM5iNSLwNQdMo0qJ0BnGbMt+kI5EfG/jWG2EtaGaqfkhZx2N9brgFJ24phqwPDt+JF+RtKt5JCKjE1cwrCaNh4mrmlZRQo33t64g/dUKeCr+If7eEdj7zk+jBqZFkkTDNMBJKU3K+jVB6iM6IVgLNITpfmNmGh9gj3+RdxRtxnzkhfVrxN1FLaKPsfhD1Ao32RYcRXn5THoNaIrSwoTwjtEzYKhoUDJvxmxQMmvHbiqNP8jcMiTUmDcus92HZ9EVgtmB+WPGbKmK0f+zMNIexHfCxsNLhx89pzHRPCfNSIzdq/HkF3mMmbyQ9XWN+wP1F0pETC/PExAfdBqJN8qkhdsX0b5aTVzeIt52p9yLmdW7iyTDqgOmxo7xTyyG0nVhQJPxF0mXNv52CHDum7VgNPdZvdixI/sxWnk94vS/JTn1OPN2dG/k9JWvFGmDhx3hQyb5Via2bbD5Rcve7tWw323ySY7/jqcV7bNnV7yF52mWqWl43ji3LkpuHnfs/RZX0Ho6ndrskuU/o/Oy40UKW7X6h8xPjhcAX8gouO5MZFxJYt952zHzrmQoBzEKiuwYckB1ZtgzBRSY1R96ATe1WjAswxFatZU29fN9E3qxlY8RvYrxZgyPrYMhvYuw+gtbxmvQ7UR3Ge3V98oB+EGk/jmtnyRdjN+gL6450QL+GtDdrnrEifwCgwGdF44Kf37tB/YdSkeUDZNDvdamxlDQMpsHfLD2cQ/7AQZGFtxqMZvqfLLyJqn1pIOTSBvrVPEXkaIr8y4gmcqjJI1csnR3LJJQulDWma+4X5No0g5LtjvwuKvQ7uZqIKd98X/FENMykpCnkNxmh3xzXRCzboP+d1kT8llY+hsLoFPo3WFX+A0OhuUj5hBUX0kvTGRkK7VMuzZPcPuXSPMntU0aGQvuUS3soGyJ/9qOL1CDm0gDLDWI+hlL7lEuLP9L/3VxkZCg8nMlmiCE2iE3R5wL5G36O4ziO4ziO4ziO4zhOhvwD53dg/APbd3YAAAAASUVORK5CYII=":"data:image/png;base64,"+t.entityPhoto,this.generateBarCode(t.entityBusinessID).then(a=>{const s="data:image/jpg;base64,"+a.entityBusinessName,u=this.commonService.convertDate(t.effectiveDateFrom);let m=this.commonService.findValuesOfYearMonthAndDays(t.entityDOB,u);this.winRef.nativeWindow.pdfMake.createPdf({pageSize:{height:200,width:315},info:{title:"Health Card"},pageMargins:[5,0,5,10],content:[{style:"tableExample",widths:[300],table:{body:[[[{image:this.companyLogo,width:295,height:40,margin:[0,0,0,0],alignment:"center",border:[!1,!1,!1,!1]}]],[{table:{widths:[180,90],body:[[{style:"tableExample",table:{widths:[40,140],border:[!1,!1,!1,!1],body:[[{text:"UHID",border:[!1,!1,!1,!1],fontSize:"10",alignment:"left",bold:!1,margin:[0,0,0,0]},{text:": "+t.entityBusinessID,border:[!1,!1,!1,!1],fontSize:"10",alignment:"left",bold:!0,margin:[0,0,0,0]}],[{text:"Name",border:[!1,!1,!1,!1],fontSize:"10",alignment:"left",bold:!1,margin:[0,0,0,0]},{text:": "+t.entitySalutationID+"."+t.entityBusinessName,border:[!1,!1,!1,!1],fontSize:"10",alignment:"left",bold:!1,margin:[0,0,0,0]}],[{text:"Age",border:[!1,!1,!1,!1],fontSize:"10",alignment:"left",bold:!1,margin:[0,0,0,0]},{text:": "+(0==m.years?m.months+" M , "+m.days+" D":m.years+" Y"),border:[!1,!1,!1,!1],fontSize:"10",alignment:"left",bold:!1,margin:[0,0,0,0]}],[{text:"Mobile",border:[!1,!1,!1,!1],fontSize:"10",alignment:"left",bold:!1,margin:[0,0,0,0]},{text:": "+t.entityMobileNumber,border:[!1,!1,!1,!1],fontSize:"10",alignment:"left",bold:!1,margin:[0,0,0,0]}],[{text:"B-G",border:[!1,!1,!1,!1],fontSize:"10",alignment:"left",bold:!1,margin:[0,0,0,0]},{text:": "+t.entityBloodGroupNmae==null?"":": "+t.entityBloodGroupNmae,border:[!1,!1,!1,!1],fontSize:"10",alignment:"left",bold:!1,margin:[0,0,0,0]}],[{text:"Allergy",border:[!1,!1,!1,!1],fontSize:"10",alignment:"left",bold:!1,margin:[0,0,0,0]},{text:": "+t.entityAllergy,border:[!1,!1,!1,!1],fontSize:"10",alignment:"left",bold:!1,margin:[0,0,0,0]}]]},layout:"noBorders"},{style:"tableExample",table:{widths:[80],body:[[{image:i,width:75,height:75,margin:[0,0,0,0],alignment:"right",border:[!1,!1,!1,!1]}],[{image:s,width:60,height:16,margin:[0,0,0,0],alignment:"right",border:[!1,!1,!1,!1]}],[{text:"*"+t.entityBusinessID+"*",border:[!1,!1,!1,!1],fontSize:"10",alignment:"center",bold:!0,margin:[0,0,0,0]}]]},layout:"noBorders"}]]},layout:"noBorders"}]]}}],styles:{header:{fontSize:20,bold:!0,margin:[0,0,0,0],alignment:"center",decoration:"underline",color:"black"},commitment:{fontSize:12,bold:!1,margin:[0,0,0,12],alignment:"center"},subheader:{fontSize:12,bold:!0,margin:[40,0,0,4],alignment:"center"},tableExample:{margin:[0,5,0,15],alignment:"center",bold:!0},tableHeader:{bold:!0,fontSize:13,color:"black",alignment:"center"},patientdetails:{bold:!1,fontsize:8,color:"black",alignment:"left"},imageStyle:{alignment:"left",margin:[0,-50,0,0]}}}).open()}).catch(a=>{this.toastrService.show({type:"error",text:a})})}previewPatient(t){this._bottomSheet.open(gi,{disableClose:!0,data:t,panelClass:"lms-bottom-sheet-container"})}}return(r=l).\u0275fac=function(t){return new(t||r)(e.Y36(b.D),e.Y36(f.k),e.Y36(v.c),e.Y36(N.u),e.Y36(C.$),e.Y36(q.Y),e.Y36($.v),e.Y36(bi.f),e.Y36(R.ch))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-patient"]],decls:3,vars:2,consts:[["class","container-fluid",4,"ngIf"],[1,"container-fluid"],[1,"row"],[1,"col-lg-5","col-md-5","col-sm-12"],["childLink","General Master","subchildLink","Patient"],[1,"col-lg-2","col-md-2","col-sm-12","patient-search-parameter"],["appearance","outline",2,"width","100%"],["matInput","","placeholder","Start Date","id","start-date-block","readonly","",3,"matDatepicker","ngModel","max","ngModelChange","click"],["matSuffix","",3,"for"],["aria-label","calendar-icon","matDatepickerToggleIcon","",1,"lms-calendar-icon"],["startDatePicker",""],["matInput","","placeholder","End Date","id","end-date-block","readonly","",3,"matDatepicker","ngModel","max","min","ngModelChange","click"],["endDatePicker",""],[1,"col-lg-3","col-md-3","col-sm-12","patient-search-parameter"],["mat-raised-button","","color","warn",1,"warn-action-btn",3,"click"],["mat-raised-button","","color","primary",1,"primary-action-btn",3,"click"],[1,"mat-elevation-z12","lms-master-card"],[1,"lms-matcardtitlegroup"],["mat-icon-button","",3,"disableRipple","click"],["aria-label","excel",1,"lms-excel-icon"],["aria-label","csv",1,"lms-csv-icon"],[1,"remaining-space"],["color","primary",1,"lms-matslidetoggle",3,"checked","change"],["childLinkLabel","General Master","subchildLinkLabel","Patient"]],template:function(t,i){1&t&&(e._UZ(0,"app-header"),e.YNc(1,vi,37,12,"div",0),e.YNc(2,Ci,2,0,"div",0)),2&t&&(e.xp6(1),e.Q6J("ngIf",i.canViewRecord),e.xp6(1),e.Q6J("ngIf",!i.canViewRecord))},dependencies:[D.O5,S.G,o.Fj,o.JJ,o.On,_.lW,_.RK,d.a8,d.C1,P.Mq,P.hl,P.nW,P.Q0,x.Nt,y.KE,y.hX,y.R9,w.Rr,I.L,fi.A],styles:[".search-patient-container[_ngcontent-%COMP%]{display:flow-root;margin-top:-10px;margin-left:10px;margin-right:30px}.patient-search-parameter[_ngcontent-%COMP%]{margin-top:11px}.warn-action-btn[_ngcontent-%COMP%]{float:right;margin-top:5px}.primary-action-btn[_ngcontent-%COMP%]{float:right;margin-right:10px;margin-top:5px}"]}),l})();var _i=h(1476);const Si=["rcMappingPaginator"],Ii=function(r){return{"background-color":r}};function wi(r,l){if(1&r){const c=e.EpF();e.TgZ(0,"div",36)(1,"mat-card",37)(2,"mat-card-header"),e._UZ(3,"div",38),e.TgZ(4,"mat-card-title"),e._uU(5),e.qZA(),e.TgZ(6,"mat-card-subtitle"),e._uU(7),e.qZA()(),e.TgZ(8,"mat-card-content")(9,"div",1)(10,"div",39)(11,"div"),e._uU(12,"Department :"),e.qZA(),e.TgZ(13,"div"),e._uU(14),e.qZA()(),e.TgZ(15,"div",39)(16,"div"),e._uU(17,"Sub-Department :"),e.qZA(),e.TgZ(18,"div"),e._uU(19),e.qZA()(),e.TgZ(20,"div",39)(21,"div"),e._uU(22,"Test Charge :"),e.qZA(),e.TgZ(23,"div"),e._uU(24),e.qZA()(),e.TgZ(25,"div",39)(26,"div",40),e._uU(27,"Share :"),e.qZA(),e.TgZ(28,"div",41)(29,"div",42)(30,"mat-form-field",43)(31,"mat-label"),e._uU(32,"Flat"),e.qZA(),e.TgZ(33,"input",44),e.NdJ("ngModelChange",function(i){const a=e.CHM(c).$implicit;return e.KtG(a.isPercentage?null:a.unitDiscountValue=i)})("keyup",function(){const n=e.CHM(c).$implicit,a=e.oxw();return e.KtG(a.flatDiscountOnTestPackage(n,"share"))}),e.qZA()()(),e.TgZ(34,"div",45)(35,"mat-slide-toggle",46),e.NdJ("ngModelChange",function(i){const a=e.CHM(c).$implicit;return e.KtG(a.isPercentage=i)})("change",function(){const n=e.CHM(c).$implicit;return e.KtG(n.unitDiscountValue=null)}),e.qZA()(),e.TgZ(36,"div",47)(37,"mat-form-field",48)(38,"mat-label"),e._uU(39,"Percentage"),e.qZA(),e.TgZ(40,"input",49),e.NdJ("ngModelChange",function(i){const a=e.CHM(c).$implicit;return e.KtG(a.isPercentage?a.unitDiscountValue=i:null)})("keyup",function(){const n=e.CHM(c).$implicit,a=e.oxw();return e.KtG(a.percentageDiscountOnTestPackage(n,"share"))}),e.qZA()()()()(),e.TgZ(41,"div",39)(42,"div",40),e._uU(43,"New Rate :"),e.qZA(),e.TgZ(44,"div",41)(45,"div",42)(46,"mat-form-field",43)(47,"mat-label"),e._uU(48,"Flat"),e.qZA(),e.TgZ(49,"input",44),e.NdJ("ngModelChange",function(i){const a=e.CHM(c).$implicit;return e.KtG(a.isNewPricePercentage?null:a.unitNewPrice=i)})("keyup",function(){const n=e.CHM(c).$implicit,a=e.oxw();return e.KtG(a.flatDiscountOnTestPackage(n,"newRate"))}),e.qZA()()(),e.TgZ(50,"div",45)(51,"mat-slide-toggle",46),e.NdJ("ngModelChange",function(i){const a=e.CHM(c).$implicit;return e.KtG(a.isNewPricePercentage=i)})("change",function(){const n=e.CHM(c).$implicit;return e.KtG(n.unitNewPrice=null)}),e.qZA()(),e.TgZ(52,"div",47)(53,"mat-form-field",48)(54,"mat-label"),e._uU(55,"Percentage"),e.qZA(),e.TgZ(56,"input",49),e.NdJ("ngModelChange",function(i){const a=e.CHM(c).$implicit;return e.KtG(a.isNewPricePercentage?a.unitNewPrice=i:null)})("keyup",function(){const n=e.CHM(c).$implicit,a=e.oxw();return e.KtG(a.percentageDiscountOnTestPackage(n,"newRate"))}),e.qZA()()()()()()()()()}if(2&r){const c=l.$implicit,t=e.oxw();e.Q6J("hidden",0===t.referralChargeMappingList.length),e.xp6(1),e.Q6J("ngClass",c.isMappingValid?null:"invalid-mapping-card"),e.xp6(2),e.Q6J("ngStyle",e.VKq(18,Ii,null===c.voilType?"#f5f5f5":c.voilType)),e.xp6(2),e.Oqu((null==c?null:c.entityBusinessName)||""),e.xp6(2),e.Oqu((null==c?null:c.entityBusinessShortCode)||""),e.xp6(7),e.Oqu((null==c?null:c.entitySuperParentBusinessName)||""),e.xp6(5),e.Oqu((null==c?null:c.entityParentBusinessName)||""),e.xp6(5),e.Oqu((null==c?null:c.testBaseCharge)||""),e.xp6(9),e.Q6J("ngModel",c.isPercentage?null:c.unitDiscountValue)("disabled",c.isPercentage),e.xp6(2),e.Q6J("ngModel",c.isPercentage),e.xp6(5),e.Q6J("ngModel",c.isPercentage?c.unitDiscountValue:null)("disabled",!c.isPercentage),e.xp6(9),e.Q6J("ngModel",c.isNewPricePercentage?null:c.unitNewPrice)("disabled",c.isNewPricePercentage),e.xp6(2),e.Q6J("ngModel",c.isNewPricePercentage),e.xp6(5),e.Q6J("ngModel",c.isNewPricePercentage?c.unitNewPrice:null)("disabled",!c.isNewPricePercentage)}}function Fi(r,l){1&r&&(e.TgZ(0,"div",50),e._UZ(1,"img",51),e.qZA())}const Ai=function(){return[12,24,60]};let Ni=(()=>{var r;class l{constructor(t,i,n,a,s,u){this.loader=t,this.masterService=i,this.authService=n,this.fb=a,this.toastrService=s,this.commonService=u,this.totalLength=0,this.pageIndex=0,this.pageSize=12,this.referralChargeMappingList=[],this.cloneReferralChargeMappingList=[],this.consultantList$=new p.X([]),this.departmentList$=new p.X([]),this.subdepartmentList$=new p.X([]),this.destroySubscription$=new Z.t(1),this.searchTestString="",this.disableShareInput={},this.disableNewrateInput={},this.showDiscountFlag=!1,this.applyShareOrRateFilter={shareAmount:null,isShareValueInPercentage:!1,newrateAmount:null,isNewrateValueInPercentage:!1}}ngOnInit(){this.rcSearchFormGroup=this.fb.group({entityConsultantID:new o.NI(null,[o.kI.required]),entityDepartmentID:new o.NI(null,[o.kI.required]),entitySubdepartmentID:new o.NI(null,[o.kI.required])}),this.getConsultantList().then(t=>{this.consultantList$.next(t),this.getDepartmentList().then(i=>{this.departmentList$.next(i)}).catch(i=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}).catch(t=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}ngOnDestroy(){this.destroySubscription$.next(null),this.destroySubscription$.complete()}getConsultantList(){return new Promise((t,i)=>{this.loader.showSpinner("Loading..."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,entityBusinessID:null,mode:"W",detailFlag:!1,dropDown:!0}},"referralservice/getAllReferral/").pipe((0,g.R)(this.destroySubscription$)).subscribe(a=>{this.loader.hideSpinner(),"200"===a.statusCode||"300"===a.statusCode?(a.responseList=null==a.responseList?[]:a.responseList,t(a.responseList)):i(a.errorMessage)},a=>{this.loader.hideSpinner(),i("Either Internet is not working or facing internal server issue")})})}getDepartmentList(){return new Promise((t,i)=>{this.loader.showSpinner("Loading..."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,entityBusinessID:null,mode:"W",detailFlag:!1,dropDown:!0}},"departmentservice/getAllDepartment").pipe((0,g.R)(this.destroySubscription$)).subscribe(a=>{this.loader.hideSpinner(),"200"===a.statusCode||"300"===a.statusCode?(a.responseList=null==a.responseList?[]:a.responseList,t(a.responseList)):i(a.errorMessage)},a=>{this.loader.hideSpinner(),i("Either Internet is not working or facing internal server issue")})})}getSubdepartmentList(t){return new Promise((i,n)=>{this.loader.showSpinner("Loading..."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,entityBusinessID:t,mode:"W",detailFlag:!1,dropDown:!0}},"subdepartmentservice/getAllSubDepartment/").pipe((0,g.R)(this.destroySubscription$)).subscribe(s=>{this.loader.hideSpinner(),"200"===s.statusCode||"300"===s.statusCode?(s.responseList=null==s.responseList?[]:s.responseList,i(s.responseList)):n(s.errorMessage)},s=>{this.loader.hideSpinner(),n("Either Internet is not working or facing internal server issue")})})}getAllTestList(t){return new Promise((i,n)=>{this.loader.showSpinner("Test list on the way..."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,departmentID:t.entityDepartmentID,subDepartmentID:t.entitySubdepartmentID,mode:"W",detailFlag:!1,dropDown:!1}},"testservice/getAllTest/").pipe((0,g.R)(this.destroySubscription$)).subscribe(s=>{this.loader.hideSpinner(),"200"===s.statusCode||"300"===s.statusCode?(s.responseList=null==s.responseList?[]:s.responseList,i(s.responseList)):n(s.errorMessage)},s=>{this.loader.hideSpinner(),n("Either Internet is not working or facing internal server issue")})})}getAllReferralChargeMapping(t){return new Promise((i,n)=>{this.loader.showSpinner("Loading..."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,referredFrom:t.entityConsultantID,subDepartmentID:t.entitySubdepartmentID,mode:"W",detailFlag:!1,dropDown:!1}},"referralmappingservice/getAllReferralMapping/").pipe((0,g.R)(this.destroySubscription$)).subscribe(s=>{this.loader.hideSpinner(),"200"===s.statusCode||"300"===s.statusCode?(s.responseList=null==s.responseList?[]:s.responseList,i(s.responseList)):n(s.errorMessage)},s=>{this.loader.hideSpinner(),n("Either Internet is not working or facing internal server issue")})})}flatDiscountOnTestPackage(t,i){if("share"==i){let n=Number(t.unitDiscountValue),a=Number(t.testBaseCharge);Number(n)>Number(a)||Number(n)<0?(this.toastrService.show({type:"error",text:"Discount amount should be less than Test Base Charge"}),t.unitDiscountValue=null):t.isMappingValid=!0}else{let n=Number(t.unitNewPrice),a=Number(t.testBaseCharge);Number(n)>Number(a)||Number(n)<0?(this.toastrService.show({type:"error",text:"Discount amount should be less than Test Base Charge"}),t.unitNewPrice=null):t.isMappingValid=!0}return t}percentageDiscountOnTestPackage(t,i){if("share"==i){let n=Number(t.unitDiscountValue);(n>100||n<0)&&(this.toastrService.show({type:"error",text:"Percentage value should be in between of 1 to 100"}),t.unitDiscountValue=null)}else{let n=Number(t.unitNewPrice);(n>100||n<0)&&(this.toastrService.show({type:"error",text:"Percentage value should be in between of 1 to 100"}),t.unitNewPrice=null)}return t}changePageEvent(t){this.pageIndex=t.pageIndex,this.pageSize=t.pageSize,this.searchTestString="",this.searchTestMapping(this.searchTestString),window.scrollTo({top:0,behavior:"smooth"})}onChangeOfDropdown(t){"Department"===t.type&&this.getSubdepartmentList(t.value).then(i=>{this.subdepartmentList$.next(i)}).catch(i=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}clearFormControl(){this.rcSearchFormGroup.reset(),this.referralChargeMappingList=[],this.applyShareOrRateFilter={shareAmount:null,isShareValueInPercentage:!1,newrateAmount:null,isNewrateValueInPercentage:!1}}searchReferralMappingList(){this.getAllTestList(this.rcSearchFormGroup.value).then(t=>{this.getAllReferralChargeMapping(this.rcSearchFormGroup.value).then(i=>{let n=null==i[0].referralMappingTestComponents?[]:i[0].referralMappingTestComponents;this.showDiscountFlag=0!==n.length&&!!n[0].showDiscount,t=t.map((s,u)=>{let m=n.find(L=>L.entityTestID==s.entityBusinessID);return void 0!==m?{voilType:s.voilType,entityBusinessID:s.entityBusinessID,entityBusinessName:s.entityBusinessName,entityBusinessShortCode:s.entityBusinessShortCode,entitySuperParentBusinessName:s.entitySuperParentBusinessName,entityParentBusinessName:s.entityParentBusinessName,testBaseCharge:s.testBaseCharge,entityID:m.id,isNewPricePercentage:!!m.entityIsNewRatePercentage,isPercentage:!!m.entityIsPercentage,showDiscount:this.showDiscountFlag,subDepartment:this.rcSearchFormGroup.value.entitySubdepartmentID,unitDiscountValue:m.shareValue,unitNewPrice:m.entityNewRate,isMappingValid:!0}:{voilType:s.voilType,entityBusinessID:s.entityBusinessID,entityBusinessName:s.entityBusinessName,entityBusinessShortCode:s.entityBusinessShortCode,entitySuperParentBusinessName:s.entitySuperParentBusinessName,entityParentBusinessName:s.entityParentBusinessName,testBaseCharge:s.testBaseCharge,entityID:void 0,isNewPricePercentage:!1,isPercentage:!1,showDiscount:this.showDiscountFlag,subDepartment:this.rcSearchFormGroup.value.entitySubdepartmentID,unitDiscountValue:null,unitNewPrice:null,isMappingValid:!0}}),this.cloneReferralChargeMappingList=this.commonService.MutateArray(t),this.referralChargeMappingList=t.slice(this.pageIndex*this.pageSize,this.pageSize*(this.pageIndex+1)),this.totalLength=t.length}).catch(i=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}).catch(t=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}validatePercentageInputValue(t){if("share"===t){let i=Number(this.applyShareOrRateFilter.shareAmount);(i>100||i<0)&&(this.toastrService.show({type:"error",text:"Percentage value should be in between of 1 to 100"}),this.applyShareOrRateFilter.shareAmount=null)}else{let i=Number(this.applyShareOrRateFilter.newrateAmount);(i>100||i<0)&&(this.toastrService.show({type:"error",text:"Percentage value should be in between of 1 to 100"}),this.applyShareOrRateFilter.newrateAmount=null)}}searchTestMapping(t){t=t.toLowerCase();var i=this.cloneReferralChargeMappingList.filter(n=>{if(!t||-1!==n.entityBusinessName.toLowerCase().indexOf(t))return n});this.referralChargeMappingList=i.slice(this.pageIndex*this.pageSize,this.pageSize*(this.pageIndex+1)),this.totalLength=i.length}applyAmountFilter(){this.applyShareOrRateFilter.shareAmount=""===this.applyShareOrRateFilter.shareAmount?null:this.applyShareOrRateFilter.shareAmount,this.applyShareOrRateFilter.newrateAmount=""===this.applyShareOrRateFilter.newrateAmount?null:this.applyShareOrRateFilter.newrateAmount,null===this.applyShareOrRateFilter.shareAmount&&null===this.applyShareOrRateFilter.newrateAmount?this.toastrService.show({type:"error",text:"Please input Share Amount or New Rate."}):(this.cloneReferralChargeMappingList=this.cloneReferralChargeMappingList.map(t=>({...t,isPercentage:this.applyShareOrRateFilter.isShareValueInPercentage,unitDiscountValue:this.applyShareOrRateFilter.shareAmount,isNewPricePercentage:this.applyShareOrRateFilter.isNewrateValueInPercentage,unitNewPrice:this.applyShareOrRateFilter.newrateAmount,isMappingValid:!(Number(this.applyShareOrRateFilter.shareAmount)>t.testBaseCharge||Number(this.applyShareOrRateFilter.newrateAmount)>t.testBaseCharge)})),this.searchTestMapping(""),this.toastrService.show({type:"success",text:"Amount applied for every test."}))}submitReferralChargeMapping(){if(this.cloneReferralChargeMappingList.some(i=>0==i.isMappingValid))this.toastrService.show({type:"error",text:"Share Amount or New Rate should not more than test base charge."});else{let i=this.rcSearchFormGroup.value;const n=this.cloneReferralChargeMappingList.map(a=>null===a.unitDiscountValue&&null===a.unitNewPrice?null:{entityBusinessID:a.entityBusinessID,testBaseCharge:a.testBaseCharge,isPercentage:Number(a.isPercentage),unitDiscountValue:a.unitDiscountValue,isNewPricePercentage:Number(a.isNewPricePercentage),unitNewPrice:a.unitNewPrice,entityID:a.entityID,showDiscount:Number(this.showDiscountFlag),subDepartment:i.entitySubdepartmentID}).filter(a=>void 0!==a);n.length>0?(this.loader.showSpinner("Updating Referral Charge Mapping..."),this.masterService.requestApiForGeneralMaster({referralMappingRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,entityDepartment:i.entityDepartmentID,entityReferralID:i.entityConsultantID,entityReferralTypeID:1,entitySubDepartment:i.entitySubdepartmentID,mode:"W",auditAction:"U",testRequestEntities:n}},"referralmappingservice/updateReferralMapping").pipe((0,g.R)(this.destroySubscription$)).subscribe(s=>{this.loader.hideSpinner(),this.toastrService.show("200"===s.statusCode?{type:"success",text:"Referral Charge Mapped Successfully!"}:{type:"error",text:s.errorMessage})},s=>{this.loader.hideSpinner(),this.toastrService.show({type:"error",text:"Either Internet is not working or facing internal server issue"})})):this.toastrService.show({type:"error",text:"Please input Share Amount or New Rate."})}}}return(r=l).\u0275fac=function(t){return new(t||r)(e.Y36(b.D),e.Y36(v.c),e.Y36(C.$),e.Y36(o.qu),e.Y36(f.k),e.Y36($.v))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-referral-charge-mapping"]],viewQuery:function(t,i){if(1&t&&e.Gf(Si,5),2&t){let n;e.iGM(n=e.CRH())&&(i.paginator=n.first)}},decls:64,vars:45,consts:[[1,"container-fluid"],[1,"row"],["childLink","General Master","subchildLink","Referral Charge Mapping"],[1,"row","search-parameter-container"],[1,"col-sm-12","col-md-6","col-lg-3",3,"ngClass"],[3,"dropdownFor","isRequired","records","formControlsName","idForSelect","customClass","dropdownChangeEvent"],[1,"col-sm-12","col-md-6","col-lg-3","action-button-container"],["mat-raised-button","","color","warn",1,"warn-btn",3,"click"],["mat-raised-button","","color","primary",1,"primary-btn",3,"ngClass","disabled","click"],[1,"row","search-filter-container",3,"hidden"],[1,"col-sm-12","col-md-6","col-lg-2"],["appearance","outline",1,"rc-search-test-input"],["matInput","","placeholder","Search Test","id","rc-tab-11",3,"ngModel","ngModelChange","keyup"],[1,"col-sm-12","col-md-6","col-lg-3","rc-filter-panel"],[1,"rc-filter-input-block"],["appearance","outline",1,"rc-filter-inner-flat-input"],["matInput","","placeholder","Flat (Share)","minLength","1","maxLength","10","id","rc-tab-4",3,"ngModel","disabled","ngModelChange"],[1,"rc-filter-percentage-block"],["id","rc-tab-5","color","primary",1,"rc-filter-inner-percentage-block",3,"ngModel","ngModelChange","change"],[1,"rc-filter-percentage-input-block"],["appearance","outline",1,"rc-filter-inner-percentage-input-block"],["matInput","","placeholder","Percentage (Share)","minLength","1","maxLength","3","id","rc-tab-6",3,"ngModel","disabled","ngModelChange","keyup"],["matInput","","placeholder","Flat (New Rate)","minLength","1","maxLength","10","id","rc-tab-7",3,"ngModel","disabled","ngModelChange"],["id","rc-tab-8","color","primary",1,"rc-filter-inner-percentage-block",3,"ngModel","ngModelChange","change"],["matInput","","placeholder","Percentage (New Rate)","minLength","1","maxLength","3","id","rc-tab-9",3,"ngModel","disabled","ngModelChange","keyup"],[1,"col-sm-12","col-md-6","col-lg-4","mapping-parameter-label"],["id","rc-tab-10","color","primary",1,"rc-show-discount-checkbox",3,"labelPosition","ngModel","ngModelChange"],[1,"rc-action-filter-container"],["mat-raised-button","",2,"background-color","#007bff","color","#ffffff","margin-right","10px",3,"click"],["mat-raised-button","","color","primary",3,"click"],[1,"row","mapping-main-block"],["class","col-lg-4 col-md-4 col-12",3,"hidden",4,"ngFor","ngForOf"],["style","background-color: white",4,"ngIf"],[1,"row",2,"flex-direction","column",3,"hidden"],[3,"length","pageIndex","pageSize","pageSizeOptions","page"],["rcMappingPaginator",""],[1,"col-lg-4","col-md-4","col-12",3,"hidden"],[1,"lms-mapping-card",3,"ngClass"],["mat-card-avatar","",2,"background-size","cover",3,"ngStyle"],[1,"col-lg-12","mapping-parameter-label"],[2,"margin-top","10px"],[1,"row-block"],[1,"flat-input-container"],["appearance","outline",1,"rc-flat-input"],["matInput","","placeholder","Flat","minLength","1","maxLength","10",3,"ngModel","disabled","ngModelChange","keyup"],[1,"percentage-toggle-container"],["color","primary",1,"rc-slide-toggle",3,"ngModel","ngModelChange","change"],[1,"percentage-input-container"],["appearance","outline",1,"rc-percentage-input"],["matInput","","placeholder","Percentage","minLength","1","maxLength","3",3,"ngModel","disabled","ngModelChange","keyup"],[2,"background-color","white"],["src","assets/images/noitemfound.png",1,"no-item-found"]],template:function(t,i){1&t&&(e._UZ(0,"app-header"),e.TgZ(1,"div",0)(2,"div",1),e._UZ(3,"app-breadcrumb",2),e.qZA(),e.TgZ(4,"div",3)(5,"div",4)(6,"app-lms-select",5),e.NdJ("dropdownChangeEvent",function(a){return i.onChangeOfDropdown(a)}),e.qZA()(),e.TgZ(7,"div",4)(8,"app-lms-select",5),e.NdJ("dropdownChangeEvent",function(a){return i.onChangeOfDropdown(a)}),e.qZA()(),e.TgZ(9,"div",4)(10,"app-lms-select",5),e.NdJ("dropdownChangeEvent",function(a){return i.onChangeOfDropdown(a)}),e.qZA()(),e.TgZ(11,"div",6)(12,"button",7),e.NdJ("click",function(){return i.clearFormControl()}),e._uU(13," Clear "),e.qZA(),e.TgZ(14,"button",8),e.NdJ("click",function(){return i.searchReferralMappingList()}),e._uU(15," Find Mapping "),e.qZA()()(),e.TgZ(16,"div",9)(17,"div",10)(18,"mat-form-field",11)(19,"mat-label"),e._uU(20,"Search Test"),e.qZA(),e.TgZ(21,"input",12),e.NdJ("ngModelChange",function(a){return i.searchTestString=a})("keyup",function(a){return i.searchTestMapping(a.target.value)}),e.qZA()()(),e.TgZ(22,"div",13)(23,"div",14)(24,"mat-form-field",15)(25,"mat-label"),e._uU(26,"Flat (Share)"),e.qZA(),e.TgZ(27,"input",16),e.NdJ("ngModelChange",function(a){return i.applyShareOrRateFilter.isShareValueInPercentage?null:i.applyShareOrRateFilter.shareAmount=a}),e.qZA()()(),e.TgZ(28,"div",17)(29,"mat-slide-toggle",18),e.NdJ("ngModelChange",function(a){return i.applyShareOrRateFilter.isShareValueInPercentage=a})("change",function(){return i.applyShareOrRateFilter.shareAmount=null}),e.qZA()(),e.TgZ(30,"div",19)(31,"mat-form-field",20)(32,"mat-label"),e._uU(33,"Percentage (Share)"),e.qZA(),e.TgZ(34,"input",21),e.NdJ("ngModelChange",function(a){return i.applyShareOrRateFilter.isShareValueInPercentage?i.applyShareOrRateFilter.shareAmount=a:null})("keyup",function(){return i.validatePercentageInputValue("share")}),e.qZA()()()(),e.TgZ(35,"div",13)(36,"div",14)(37,"mat-form-field",15)(38,"mat-label"),e._uU(39,"Flat (New Rate)"),e.qZA(),e.TgZ(40,"input",22),e.NdJ("ngModelChange",function(a){return i.applyShareOrRateFilter.isNewrateValueInPercentage?null:i.applyShareOrRateFilter.newrateAmount=a}),e.qZA()()(),e.TgZ(41,"div",17)(42,"mat-slide-toggle",23),e.NdJ("ngModelChange",function(a){return i.applyShareOrRateFilter.isNewrateValueInPercentage=a})("change",function(){return i.applyShareOrRateFilter.newrateAmount=null}),e.qZA()(),e.TgZ(43,"div",19)(44,"mat-form-field",20)(45,"mat-label"),e._uU(46,"Percentage (New Rate)"),e.qZA(),e.TgZ(47,"input",24),e.NdJ("ngModelChange",function(a){return i.applyShareOrRateFilter.isNewrateValueInPercentage?i.applyShareOrRateFilter.newrateAmount=a:null})("keyup",function(){return i.validatePercentageInputValue("newrate")}),e.qZA()()()(),e.TgZ(48,"div",25)(49,"div")(50,"mat-checkbox",26),e.NdJ("ngModelChange",function(a){return i.showDiscountFlag=a}),e._uU(51," Show as discount "),e.qZA()(),e.TgZ(52,"div",27)(53,"button",28),e.NdJ("click",function(){return i.applyAmountFilter()}),e._uU(54," Apply All "),e.qZA(),e.TgZ(55,"button",29),e.NdJ("click",function(){return i.submitReferralChargeMapping()}),e._uU(56," Submit "),e.qZA()()()(),e.TgZ(57,"div",30),e.YNc(58,wi,57,20,"div",31),e.YNc(59,Fi,2,0,"div",32),e.qZA(),e._UZ(60,"br"),e.TgZ(61,"div",33)(62,"mat-paginator",34,35),e.NdJ("page",function(a){return i.changePageEvent(a)}),e.qZA()()()),2&t&&(e.xp6(5),e.Q6J("ngClass",i.referralChargeMappingList.length>0?"rc-disable-div-block":null),e.xp6(1),e.Q6J("dropdownFor","Consultant")("isRequired",!0)("records",i.consultantList$)("formControlsName",i.rcSearchFormGroup.controls.entityConsultantID)("idForSelect","rc-tab-1")("customClass","referral-mapping-input-select"),e.xp6(1),e.Q6J("ngClass",i.referralChargeMappingList.length>0?"rc-disable-div-block":null),e.xp6(1),e.Q6J("dropdownFor","Department")("isRequired",!0)("records",i.departmentList$)("formControlsName",i.rcSearchFormGroup.controls.entityDepartmentID)("idForSelect","rc-tab-2")("customClass","referral-mapping-input-select"),e.xp6(1),e.Q6J("ngClass",i.referralChargeMappingList.length>0?"rc-disable-div-block":null),e.xp6(1),e.Q6J("dropdownFor","Test Group")("isRequired",!0)("records",i.subdepartmentList$)("formControlsName",i.rcSearchFormGroup.controls.entitySubdepartmentID)("idForSelect","rc-tab-3")("customClass","referral-mapping-input-select"),e.xp6(4),e.Q6J("ngClass",i.referralChargeMappingList.length>0?"rc-disable-div-block":null)("disabled",i.rcSearchFormGroup.invalid),e.xp6(2),e.Q6J("hidden",0===i.referralChargeMappingList.length),e.xp6(5),e.Q6J("ngModel",i.searchTestString),e.xp6(6),e.Q6J("ngModel",i.applyShareOrRateFilter.isShareValueInPercentage?null:i.applyShareOrRateFilter.shareAmount)("disabled",i.applyShareOrRateFilter.isShareValueInPercentage),e.xp6(2),e.Q6J("ngModel",i.applyShareOrRateFilter.isShareValueInPercentage),e.xp6(5),e.Q6J("ngModel",i.applyShareOrRateFilter.isShareValueInPercentage?i.applyShareOrRateFilter.shareAmount:null)("disabled",!i.applyShareOrRateFilter.isShareValueInPercentage),e.xp6(6),e.Q6J("ngModel",i.applyShareOrRateFilter.isNewrateValueInPercentage?null:i.applyShareOrRateFilter.newrateAmount)("disabled",i.applyShareOrRateFilter.isNewrateValueInPercentage),e.xp6(2),e.Q6J("ngModel",i.applyShareOrRateFilter.isNewrateValueInPercentage),e.xp6(5),e.Q6J("ngModel",i.applyShareOrRateFilter.isNewrateValueInPercentage?i.applyShareOrRateFilter.newrateAmount:null)("disabled",!i.applyShareOrRateFilter.isNewrateValueInPercentage),e.xp6(3),e.Q6J("labelPosition","after")("ngModel",i.showDiscountFlag),e.xp6(8),e.Q6J("ngForOf",i.referralChargeMappingList),e.xp6(1),e.Q6J("ngIf",0===i.referralChargeMappingList.length),e.xp6(2),e.Q6J("hidden",0===i.referralChargeMappingList.length),e.xp6(1),e.Q6J("length",i.totalLength)("pageIndex",i.pageIndex)("pageSize",i.pageSize)("pageSizeOptions",e.DdM(44,Ai)))},dependencies:[D.mk,D.sg,D.O5,D.PC,S.G,o.Fj,o.JJ,o.On,k.P,_.lW,d.a8,d.kc,d.dn,d.dk,d.$j,d.n5,M.oG,x.Nt,y.KE,y.hX,_i.NW,w.Rr,I.L],styles:[".rfmapping_form_block[_ngcontent-%COMP%]{display:contents!important}.search-parameter-container[_ngcontent-%COMP%]{margin-top:10px}.search-filter-container[_ngcontent-%COMP%]{background:white;margin-top:5px}.mapping-main-block[_ngcontent-%COMP%]{background-color:#f5f5f5}.warn-btn[_ngcontent-%COMP%]{float:right;margin-top:10px}.primary-btn[_ngcontent-%COMP%]{float:right;margin-top:10px;margin-right:10px}.mapping-parameter-label[_ngcontent-%COMP%]{margin-top:10px!important}.col-12[_ngcontent-%COMP%]{margin-top:30px!important}.lms-mapping-card[_ngcontent-%COMP%]{max-width:500px;height:320px}.invalid-mapping-card[_ngcontent-%COMP%]{background-color:#ff02027d}.mat-card-header[_ngcontent-%COMP%]   .mat-card-title[_ngcontent-%COMP%]{font-size:15px!important}.mapping-parameter-label[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between}.row-block[_ngcontent-%COMP%]{display:flex;flex-direction:row}.flat-input-container[_ngcontent-%COMP%]{width:100px!important;font-size:10px}.rc-flat-input[_ngcontent-%COMP%]{width:100%}.percentage-toggle-container[_ngcontent-%COMP%]{width:20%;padding:5px}.rc-slide-toggle[_ngcontent-%COMP%]{display:flex;flex-direction:row;margin-top:4px}.percentage-input-container[_ngcontent-%COMP%]{width:100px!important;font-size:10px}.rc-percentage-input[_ngcontent-%COMP%]{width:100%}.no-item-found[_ngcontent-%COMP%]{position:absolute;top:50vh;left:50vw;transform:translate(-50%,-50%);height:40%}@media (max-width: 766px){.no-item-found[_ngcontent-%COMP%]{top:75%;width:60%;height:25%}}.rc-filter-panel[_ngcontent-%COMP%]{display:flex;flex-direction:row}.rc-filter-input-block[_ngcontent-%COMP%]{max-width:43%!important}.rc-filter-inner-flat-input[_ngcontent-%COMP%]{width:100%}.rc-filter-percentage-block[_ngcontent-%COMP%]{width:14%;margin-top:4px;padding-left:7px}@media (max-width: 766px){.rc-filter-percentage-block[_ngcontent-%COMP%]{padding-left:15px}}.rc-filter-inner-percentage-block[_ngcontent-%COMP%]{display:flex;flex-direction:row;margin-top:14px}@media (max-width: 766px){.rc-filter-inner-percentage-block[_ngcontent-%COMP%]{margin-left:-8px}}.rc-filter-percentage-input-block[_ngcontent-%COMP%]{max-width:43%!important}.rc-filter-inner-percentage-input-block[_ngcontent-%COMP%]{width:100%}.rc-show-discount-checkbox[_ngcontent-%COMP%]{display:flex;flex-direction:row;margin-top:10px}@media (max-width: 766px){.rc-show-discount-checkbox[_ngcontent-%COMP%]{margin-top:0}}.rc-action-filter-container[_ngcontent-%COMP%]{margin-top:2px}@media (max-width: 766px){.rc-action-filter-container[_ngcontent-%COMP%]{margin-top:-8px}}.rc-search-test-input[_ngcontent-%COMP%]{width:100%}.rc-disable-div-block[_ngcontent-%COMP%]{pointer-events:none;opacity:.5}"]}),l})();function Li(r,l){if(1&r&&(e.TgZ(0,"mat-option",17),e._uU(1),e.qZA()),2&r){const c=l.$implicit;e.Q6J("value",c.entityBusinessID),e.xp6(1),e.hij(" ",c.entityBusinessName," ")}}function Bi(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Referral Name is required field. "),e.qZA())}function Ti(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Please match the requested format. "),e.qZA())}function ki(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Please match the requested format. "),e.qZA())}function xi(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Abbreviation is already taken. "),e.qZA())}function Pi(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Please enter valid contact number. "),e.qZA())}function qi(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Contact Number is required field. "),e.qZA())}function Mi(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Contact Number is already taken. "),e.qZA())}function Zi(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Address is required field. "),e.qZA())}function Ei(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Qualification is required field. "),e.qZA())}function Oi(r,l){if(1&r){const c=e.EpF();e.TgZ(0,"div",3)(1,"mat-form-field",4)(2,"mat-label"),e._uU(3,"Qualification"),e.qZA(),e.TgZ(4,"input",18),e.NdJ("keyup",function(i){e.CHM(c);const n=e.oxw();return e.KtG(n.keytab(i,"entityQualification",!1))}),e.qZA(),e.YNc(5,Ei,2,0,"mat-error",9),e.qZA()()}if(2&r){const c=e.oxw();e.Udp("display",2!==c.selectedEntityType?"block":"none"),e.xp6(5),e.Q6J("ngIf",null==c.referralForm.controls.entityQualification||null==c.referralForm.controls.entityQualification.errors?null:c.referralForm.controls.entityQualification.errors.required)}}let ie=(()=>{var r;class l{constructor(t,i,n,a,s){this.loader=t,this.masterService=i,this.authService=n,this.fb=a,this.toastrService=s,this.selectedMasterData={},this.masterList=[],this.submitButtonLabel="Submit",this.countryList$=new p.X([]),this.stateList$=new p.X([]),this.cityList$=new p.X([]),this.salutationList$=new p.X([]),this.referralTypeList=[{entityBusinessID:1,entityBusinessName:"Doctor"},{entityBusinessID:2,entityBusinessName:"Patholab"},{entityBusinessID:3,entityBusinessName:"Others"}],this.fetchDataOnCloseDialog$=new p.X([]),this.selectedEntityType=2}ngOnInit(){if(this.referralForm=this.fb.group({entityType:new o.NI(2,[o.kI.required]),salutationID:new o.NI(null),entityBusinessName:new o.NI(null,[o.kI.required]),entityBusinessShortCode:new o.NI(null),entityContactNumber:new o.NI(null,[o.kI.required]),entityCountry:new o.NI(null),entityState:new o.NI(null),entityCity:new o.NI(null),entityAddress:new o.NI(null,[o.kI.required]),entityGSTN:new o.NI(null),showDiscount:new o.NI(!1)}),null!==this.selectedMasterData){this.selectedEntityType=this.selectedMasterData.entityType,this.getCountryList().then(i=>{this.countryList$.next(i),this.getStatesList(this.selectedMasterData.entityCountry).then(n=>{this.stateList$.next(n),this.getCitiesList(this.selectedMasterData.entityState).then(a=>{this.cityList$.next(a),this.getSalutationList().then(s=>{this.salutationList$.next(s)}).catch(s=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}).catch(a=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}).catch(n=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}).catch(i=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})});const t=Object.entries(this.referralForm.value).reduce((i,[n,a])=>(i[n]=this.selectedMasterData[n],i),{});2!==this.selectedMasterData.entityType?this.referralForm.addControl("entityQualification",new o.NI(this.selectedMasterData.entityQualification,[o.kI.required])):this.referralForm.removeControl("entityQualification"),this.referralForm.patchValue(t)}else this.getCountryList().then(t=>{this.countryList$.next(t),this.getSalutationList().then(i=>{this.salutationList$.next(i)}).catch(i=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}).catch(t=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})});this.updateFormControl()}getCountryList(){return new Promise((t,i)=>{this.loader.showSpinner("Loading..."),this.countryListSubscription=this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,entityBusinessID:null,mode:"W",detailFlag:null!==this.selectedMasterData,dropDown:!0}},"countryservice/getAllCountry").subscribe(a=>{this.loader.hideSpinner(),"200"===a.statusCode||"300"===a.statusCode?(a.responseList=null==a.responseList?[]:a.responseList,t(a.responseList)):i(a.errorMessage)},a=>{this.loader.hideSpinner(),i("Either Internet is not working or facing internal server issue")})})}getStatesList(t){return new Promise((i,n)=>{this.loader.showSpinner("Loading..."),this.StateListSubscription=this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,entityBusinessID:t,mode:"W",detailFlag:null!==this.selectedMasterData,dropDown:!0}},"stateservice/getAllState/").subscribe(s=>{this.loader.hideSpinner(),"200"===s.statusCode||"300"===s.statusCode?(s.responseList=null==s.responseList?[]:s.responseList,i(s.responseList)):n(s.errorMessage)},s=>{this.loader.hideSpinner(),n("Either Internet is not working or facing internal server issue")})})}getCitiesList(t){return new Promise((i,n)=>{this.loader.showSpinner("Loading..."),this.CityListSubscription=this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,entityBusinessID:t,mode:"W",detailFlag:null!==this.selectedMasterData,dropDown:!0}},"cityservice/getAllCity/").subscribe(s=>{this.loader.hideSpinner(),"200"===s.statusCode||"300"===s.statusCode?(s.responseList=null==s.responseList?[]:s.responseList,i(s.responseList)):n(s.errorMessage)},s=>{this.loader.hideSpinner(),n("Either Internet is not working or facing internal server issue")})})}getSalutationList(){return new Promise((t,i)=>{this.loader.showSpinner("Loading..."),this.SalutationListSubscription=this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,entityBusinessID:null,mode:"W",detailFlag:null!==this.selectedMasterData,dropDown:!0}},"salutationservice/getAllSalutation/").subscribe(a=>{this.loader.hideSpinner(),"200"===a.statusCode||"300"===a.statusCode?(a.responseList=null==a.responseList?[]:a.responseList.map(s=>({entityBusinessID:s.entityBusinessName,entityBusinessName:s.entityBusinessName})),t(a.responseList)):i(a.errorMessage)},a=>{this.loader.hideSpinner(),i("Either Internet is not working or facing internal server issue")})})}get entityType(){return this.referralForm.get("entityType")}get entityQualification(){return this.referralForm.get("entityQualification")}get entityBusinessName(){return this.referralForm.get("entityBusinessName")}get entityAddress(){return this.referralForm.get("entityAddress")}updateFormControl(){this.entityType.valueChanges.subscribe(t=>{this.selectedEntityType=t,2===t?this.referralForm.removeControl("entityQualification"):this.referralForm.addControl("entityQualification",new o.NI(null,[o.kI.required])),this.referralForm.updateValueAndValidity()})}keytab(t,i,n){if(13===t.keyCode){var a=t.srcElement.id.split("-").reduce((s,u)=>(Number(u)&&(u=Number(u)+1),s+"-"+u));document.getElementById(a).focus()}else this._uniqueColumnValidator(t.target.value,i,n)}_uniqueColumnValidator(t,i,n){if(n){const a=null===this.selectedMasterData?{entityBusinessID:null}:this.selectedMasterData;null!=this.masterList.find(u=>u[i].toString().trim().toLowerCase()===t.trim().toLowerCase()&&u.entityBusinessID!=a.entityBusinessID)&&this.referralForm.controls[i].setErrors({mustBeUnique:!0})}}onChangeOfDropdown(t){switch(t.type){case"Country":this.getStatesList(t.value).then(i=>{this.stateList$.next(i)}).catch(i=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})});break;case"State":this.getCitiesList(t.value).then(i=>{this.cityList$.next(i)}).catch(i=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}}updateReferralForm(){const t=null===this.selectedMasterData?{entityBusinessID:null}:this.selectedMasterData,i=this.referralForm.value,n=i.entityBusinessName.trim()+" "+i.entityAddress.trim();void 0!==this.masterList.find(s=>s.combinedNameAndAddress.toString().trim().toLowerCase()===n.trim().toLowerCase()&&s.entityBusinessID!=t.entityBusinessID)?this.toastrService.show({type:"error",text:"The combination of Referral name and Address is already taken!"}):null===this.selectedMasterData?this.addNewReferral(i):this.updateReferral(this.selectedMasterData,i)}addNewReferral(t){const i={referralRequest:{entityType:t.entityType,salutationID:t.salutationID,entityBusinessName:t.entityBusinessName,entityBusinessShortCode:t.entityBusinessShortCode,entityCountry:t.entityCountry,entityState:t.entityState,entityCity:t.entityCity,entityAddress:t.entityAddress,entityGSTN:t.entityGSTN,entityContactNumber:t.entityContactNumber,entityQualification:void 0===t.entityQualification?null:t.entityQualification,showDiscount:Number(t.showDiscount),companyID:this.authService.companyID,createdBy:this.authService.employeeID,auditAction:"C",mode:"W"}};this.masterService.requestActionRestAPI(t,i,"referralservice/createReferral","Adding ").then(n=>{this.fetchDataOnCloseDialog$.next([{modifiedObject:n}])}).catch(n=>{this.toastrService.show({type:"error",text:n})})}updateReferral(t,i){const n={referralRequest:{entityID:t.entityID,entityBusinessID:t.entityBusinessID,entityType:i.entityType,salutationID:i.salutationID,entityBusinessName:i.entityBusinessName,entityBusinessShortCode:i.entityBusinessShortCode,entityCountry:i.entityCountry,entityState:i.entityState,entityCity:i.entityCity,entityAddress:i.entityAddress,entityGSTN:i.entityGSTN,entityContactNumber:i.entityContactNumber,entityQualification:void 0===i.entityQualification?null:i.entityQualification,showDiscount:Number(i.showDiscount),companyID:this.authService.companyID,createdBy:this.authService.employeeID,auditAction:"U",mode:"W"}};this.masterService.requestActionRestAPI(i,n,"referralservice/updateReferral/","Updating ").then(a=>{this.fetchDataOnCloseDialog$.next([{modifiedObject:a}])}).catch(a=>{this.toastrService.show({type:"error",text:a})})}ngOnDestroy(){(this.fetchDataOnCloseDialog$||this.countryListSubscription||this.SalutationListSubscription)&&(this.fetchDataOnCloseDialog$.unsubscribe(),this.countryListSubscription.unsubscribe(),this.SalutationListSubscription.unsubscribe()),this.StateListSubscription&&this.StateListSubscription.unsubscribe(),this.CityListSubscription&&this.CityListSubscription.unsubscribe()}}return(r=l).\u0275fac=function(t){return new(t||r)(e.Y36(b.D),e.Y36(v.c),e.Y36(C.$),e.Y36(o.qu),e.Y36(f.k))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-referral-form"]],inputs:{selectedMasterData:"selectedMasterData",masterList:"masterList",submitButtonLabel:"submitButtonLabel"},decls:56,vars:41,consts:[["autocomplete","off",3,"formGroup"],[1,"container-fluid","referral-master-container"],[1,"row"],[1,"col-12","col-md-4","col-lg-3"],["appearance","outline",1,"lms-mat-form-field"],["formControlName","entityType","id","lms-referral-master-1","required",""],[3,"value",4,"ngFor","ngForOf"],[3,"dropdownFor","isRequired","records","formControlsName","idForSelect","dropdownChangeEvent"],["matInput","","placeholder","Referral Name*","formControlName","entityBusinessName","minLength","1","maxLength","100","required","","id","lms-referral-master-3",3,"pattern","keyup"],[4,"ngIf"],["matInput","","placeholder","Abbreviation","formControlName","entityBusinessShortCode","minLength","1","maxLength","100","id","lms-referral-master-4",3,"pattern","keyup"],["matInput","","placeholder","Contact Number*","id","lms-referral-master-5","formControlName","entityContactNumber","minLength","10","maxLength","10","required","",3,"pattern","keyup"],["matInput","","placeholder","Address","formControlName","entityAddress","minLength","1","maxLength","50","id","lms-referral-master-9","rows","1","required","",3,"keyup"],["matInput","","placeholder","GSTIN Number","id","lms-referral-master-10","formControlName","entityGSTN","minLength","1","maxLength","15",2,"text-transform","uppercase",3,"keyup"],["class","col-12 col-md-4 col-lg-3",3,"display",4,"ngIf"],["formControlName","showDiscount","id","lms-referral-master-12","color","primary",1,"referral-form-checkbox",3,"labelPosition"],[1,"btn","btn-primary","lms-submit-button",3,"disabled","click","keydown.enter"],[3,"value"],["matInput","","placeholder","Qualification*","formControlName","entityQualification","minLength","1","maxLength","100","required","","id","lms-referral-master-11",3,"keyup"]],template:function(t,i){1&t&&(e.TgZ(0,"form",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"mat-form-field",4)(5,"mat-label"),e._uU(6,"Referral Type"),e.qZA(),e.TgZ(7,"mat-select",5),e.YNc(8,Li,2,2,"mat-option",6),e.qZA()()(),e.TgZ(9,"div",3)(10,"app-lms-select",7),e.NdJ("dropdownChangeEvent",function(a){return i.onChangeOfDropdown(a)}),e.qZA()(),e.TgZ(11,"div",3)(12,"mat-form-field",4)(13,"mat-label"),e._uU(14,"Referral Name"),e.qZA(),e.TgZ(15,"input",8),e.NdJ("keyup",function(a){return i.keytab(a,"entityBusinessName",!1)}),e.qZA(),e.YNc(16,Bi,2,0,"mat-error",9),e.YNc(17,Ti,2,0,"mat-error",9),e.qZA()(),e.TgZ(18,"div",3)(19,"mat-form-field",4)(20,"mat-label"),e._uU(21,"Abbreviation"),e.qZA(),e.TgZ(22,"input",10),e.NdJ("keyup",function(a){return i.keytab(a,"entityBusinessShortCode",!1)}),e.qZA(),e.YNc(23,ki,2,0,"mat-error",9),e.YNc(24,xi,2,0,"mat-error",9),e.qZA()(),e.TgZ(25,"div",3)(26,"mat-form-field",4)(27,"mat-label"),e._uU(28,"Contact Number"),e.qZA(),e.TgZ(29,"input",11),e.NdJ("keyup",function(a){return i.keytab(a,"entityContactNumber",!0)}),e.qZA(),e.YNc(30,Pi,2,0,"mat-error",9),e.YNc(31,qi,2,0,"mat-error",9),e.YNc(32,Mi,2,0,"mat-error",9),e.qZA()(),e.TgZ(33,"div",3)(34,"app-lms-select",7),e.NdJ("dropdownChangeEvent",function(a){return i.onChangeOfDropdown(a)}),e.qZA()(),e.TgZ(35,"div",3)(36,"app-lms-select",7),e.NdJ("dropdownChangeEvent",function(a){return i.onChangeOfDropdown(a)}),e.qZA()(),e.TgZ(37,"div",3)(38,"app-lms-select",7),e.NdJ("dropdownChangeEvent",function(a){return i.onChangeOfDropdown(a)}),e.qZA()(),e.TgZ(39,"div",3)(40,"mat-form-field",4)(41,"mat-label"),e._uU(42,"Address"),e.qZA(),e.TgZ(43,"textarea",12),e.NdJ("keyup",function(a){return i.keytab(a,"entityAddress",!1)}),e.qZA(),e.YNc(44,Zi,2,0,"mat-error",9),e.qZA()(),e.TgZ(45,"div",3)(46,"mat-form-field",4)(47,"mat-label"),e._uU(48,"GSTIN Number"),e.qZA(),e.TgZ(49,"input",13),e.NdJ("keyup",function(a){return i.keytab(a,"entityGSTN",!1)}),e.qZA()()(),e.YNc(50,Oi,6,3,"div",14),e.TgZ(51,"div",3)(52,"mat-checkbox",15),e._uU(53," Show Discount "),e.qZA()()()(),e.TgZ(54,"button",16),e.NdJ("click",function(){return i.updateReferralForm()})("keydown.enter",function(a){return a.preventDefault()}),e._uU(55),e.qZA()()),2&t&&(e.Q6J("formGroup",i.referralForm),e.xp6(8),e.Q6J("ngForOf",i.referralTypeList),e.xp6(1),e.Udp("display",2!==i.selectedEntityType?"block":"none"),e.xp6(1),e.Q6J("dropdownFor","Salutation")("isRequired",!1)("records",i.salutationList$)("formControlsName",i.referralForm.controls.salutationID)("idForSelect","lms-referral-master-2"),e.xp6(5),e.Q6J("pattern","[^]*"),e.xp6(1),e.Q6J("ngIf",null==i.referralForm.controls.entityBusinessName||null==i.referralForm.controls.entityBusinessName.errors?null:i.referralForm.controls.entityBusinessName.errors.required),e.xp6(1),e.Q6J("ngIf",null==i.referralForm.controls.entityBusinessName||null==i.referralForm.controls.entityBusinessName.errors?null:i.referralForm.controls.entityBusinessName.errors.pattern),e.xp6(5),e.Q6J("pattern","[^]*"),e.xp6(1),e.Q6J("ngIf",null==i.referralForm.controls.entityBusinessShortCode||null==i.referralForm.controls.entityBusinessShortCode.errors?null:i.referralForm.controls.entityBusinessShortCode.errors.pattern),e.xp6(1),e.Q6J("ngIf",null==i.referralForm.controls.entityBusinessShortCode||null==i.referralForm.controls.entityBusinessShortCode.errors?null:i.referralForm.controls.entityBusinessShortCode.errors.mustBeUnique),e.xp6(5),e.Q6J("pattern","[6-9]{1}[0-9]{9}"),e.xp6(1),e.Q6J("ngIf",null==i.referralForm.controls.entityContactNumber||null==i.referralForm.controls.entityContactNumber.errors?null:i.referralForm.controls.entityContactNumber.errors.pattern),e.xp6(1),e.Q6J("ngIf",null==i.referralForm.controls.entityContactNumber||null==i.referralForm.controls.entityContactNumber.errors?null:i.referralForm.controls.entityContactNumber.errors.required),e.xp6(1),e.Q6J("ngIf",null==i.referralForm.controls.entityContactNumber||null==i.referralForm.controls.entityContactNumber.errors?null:i.referralForm.controls.entityContactNumber.errors.mustBeUnique),e.xp6(2),e.Q6J("dropdownFor","Country")("isRequired",!1)("records",i.countryList$)("formControlsName",i.referralForm.controls.entityCountry)("idForSelect","lms-referral-master-6"),e.xp6(2),e.Q6J("dropdownFor","State")("isRequired",!1)("records",i.stateList$)("formControlsName",i.referralForm.controls.entityState)("idForSelect","lms-referral-master-7"),e.xp6(2),e.Q6J("dropdownFor","City")("isRequired",!1)("records",i.cityList$)("formControlsName",i.referralForm.controls.entityCity)("idForSelect","lms-referral-master-8"),e.xp6(6),e.Q6J("ngIf",null==i.referralForm.controls.entityAddress||null==i.referralForm.controls.entityAddress.errors?null:i.referralForm.controls.entityAddress.errors.required),e.xp6(1),e.Udp("display",1!==i.selectedEntityType?"block":"none"),e.xp6(5),e.Q6J("ngIf",i.entityQualification),e.xp6(2),e.Q6J("labelPosition","after"),e.xp6(2),e.Q6J("disabled",i.referralForm.invalid),e.xp6(1),e.hij(" ",i.submitButtonLabel," "))},dependencies:[D.sg,D.O5,o._Y,o.Fj,o.JJ,o.JL,o.Q7,o.c5,o.sg,o.u,k.P,Q.ey,M.oG,x.Nt,y.KE,y.hX,y.TO,G.gD],styles:[".referral-master-container[_ngcontent-%COMP%]{display:flex;margin-top:12px}.referral-form-checkbox[_ngcontent-%COMP%]{display:flex;flex-direction:row;margin-top:14px}@media (max-width: 766px){.referral-form-checkbox[_ngcontent-%COMP%]{margin-top:0}}"]}),l})(),Ri=(()=>{var r;class l{constructor(t,i,n,a,s,u){this.loader=t,this.toastrService=i,this.masterService=n,this.exportService=a,this.authService=s,this.dialog=u,this.referralList$=new p.X([]),this.inlineEditFlag=!1,this.showLogCheckedFlag=!1,this.gridOptions=new F.s8,this.changeDetection=new A.x}ngOnInit(){this.getReferralList(!1).then(t=>{this.referralList$.next(t)}).catch(t=>{this.referralList$.next([]),this.toastrService.show({type:"error",text:t})}),this.gridOptions={searchPlaceholder:"Search Referral",pageSize:this.authService.pageSize,dateFormat:"yyyy-MM-dd",keyCodeForNextCell:13,showInlineEdit:this.inlineEditFlag,titleForMobileView:"entityBusinessName",pageSizeArray:[5,10,20],showDeleteButton:!1,showAddButton:!0,showEditButton:!0,showActivateDeactivateButton:!0,showSearchInput:!0,activateDeactivateCondition:{conditionalProperty:"activeFlag",valueForActivation:"1",valueForDeactivation:"0"},columns:[{name:"entityTypeName",label:"Referral Type",enable:!0,searchable:!0,sortable:!0,type:"text"},{name:"entityBusinessName",label:"Referral Name",enable:!0,searchable:!0,sortable:!0,type:"text"},{name:"entityContactNumber",label:"Contact Number",enable:!0,searchable:!0,sortable:!0,type:"text",editable:!1},{name:"entityQualification",label:"Qualification",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1},{name:"entityAddress",label:"Address",enable:!0,searchable:!0,sortable:!1,type:"text",editable:!1},{name:"createdByUser",label:"Last Updated By",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"effectiveDateFrom",label:"Last Modified on",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"activeFlag",label:"",enable:!1,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1}]}}getReferralList(t){return new Promise((i,n)=>{this.loader.showSpinner("Referral list on the way!"),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W",detailFlag:t,dropDown:!1}},"referralservice/getAllReferral/").subscribe(s=>{this.loader.hideSpinner(),"200"===s.statusCode||"300"===s.statusCode?(s.responseList=null==s.responseList?[]:s.responseList.reverse(),i(s.responseList)):n(s.errorMessage)},s=>{this.loader.hideSpinner(),n("Either Internet is not working or facing internal server issue")})})}exportData(t){const i=[{property:"entityTypeName",label:"Referral Type"},{property:"entityBusinessName",label:"Referral Name"},{property:"entityContactNumber",label:"Contact Number"},{property:"entityQualification",label:"Qualification"},{property:"entityAddress",label:"Address"},{property:"createdByUser",label:"Last Updated By"},{property:"effectiveDateFrom",label:"Last Modified on"}];this.showLogCheckedFlag&&i.push({property:"auditAction",label:"Audit Action"}),this.exportService.generateFile(this.referralList$.getValue(),"Referral List."+t,i)}showLog(t){this.referralList$.next([]),t?this.getReferralList(!0).then(i=>{this.showLogCheckedFlag=!0,this.referralList$.next(i),this.gridOptions.showAddButton=!1,this.gridOptions.showEditButton=!1,this.gridOptions.showActivateDeactivateButton=!1,this.gridOptions.columns.push({name:"auditAction",label:"Audit Action",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1})}).catch(i=>{this.referralList$.next([]),this.toastrService.show({type:"error",text:i})}):(this.showLogCheckedFlag=!1,this.ngOnInit())}initiateAddReferral(t){this.dialog.open(B.s,{disableClose:!0,data:{header:"Referral Form",buttonLabel:"Submit",records:{selectedItem:t,uniqueItemList:this.referralList$.getValue().map(n=>({entityBusinessID:n.entityBusinessID,entityBusinessName:n.entityBusinessName.trim(),entityBusinessShortCode:n.entityBusinessShortCode,entityAddress:null===n.entityAddress?"":n.entityAddress.trim(),entityContactNumber:n.entityContactNumber,combinedNameAndAddress:n.entityBusinessName.trim()+" "+(null===n.entityAddress?"":n.entityAddress.trim())}))},component:ie},animation:{to:"right"},position:{top:"50vh",left:"50vw"},panelClass:"lms-dialog-box-center"}).afterClosed().subscribe(n=>{if(null!==n){let a=this.referralList$.getValue();a.unshift(n[0].modifiedObject),this.referralList$.next(a),this.toastrService.show({type:"success",text:n[0].modifiedObject.entityBusinessName+" Created!"})}})}initiateUpdateReferral(t){this.dialog.open(B.s,{disableClose:!0,data:{header:"Referral Form",buttonLabel:"Update",records:{selectedItem:t,uniqueItemList:this.referralList$.getValue().map(n=>({entityBusinessID:n.entityBusinessID,entityBusinessName:n.entityBusinessName.trim(),entityBusinessShortCode:n.entityBusinessShortCode,entityAddress:null===n.entityAddress?"":n.entityAddress.trim(),entityContactNumber:n.entityContactNumber,combinedNameAndAddress:n.entityBusinessName.trim()+" "+(null===n.entityAddress?"":n.entityAddress.trim())}))},component:ie},animation:{to:"right"},position:{top:"50vh",left:"50vw"},panelClass:"lms-dialog-box-center"}).afterClosed().subscribe(n=>{if(null!==n){let a=this.referralList$.getValue(),s=a.findIndex(u=>u.entityBusinessID==n[0].modifiedObject.entityBusinessID);a[s]=n[0].modifiedObject,this.referralList$.next(a),this.toastrService.show({type:"success",text:n[0].modifiedObject.entityBusinessName+" Updated!"})}})}activateReferral(t){this.masterService.requestActionRestAPI(t,{referralRequest:{entityType:t.entityType,entityID:t.entityID,entityBusinessID:t.entityBusinessID,entityBusinessName:t.entityBusinessName,entityBusinessShortCode:t.entityBusinessShortCode,entityCountry:t.entityCountry,entityState:t.entityState,entityCity:t.entityCity,entityAddress:t.entityAddress,entityGSTN:t.entityGSTN,entityContactNumber:t.entityContactNumber,entityQualification:t.entityQualification,auditAction:"A",companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W"}},"referralservice/activateReferral/","Activating ").then(n=>{this.changeDetection.next({originalObject:t,modifiedObject:n}),this.toastrService.show({type:"success",text:t.entityBusinessName+" Activated!"})}).catch(n=>{this.toastrService.show({type:"error",text:n})})}deactivateReferral(t){this.masterService.requestActionRestAPI(t,{referralRequest:{entityType:t.entityType,entityID:t.entityID,entityBusinessID:t.entityBusinessID,entityBusinessName:t.entityBusinessName,entityBusinessShortCode:t.entityBusinessShortCode,entityCountry:t.entityCountry,entityState:t.entityState,entityCity:t.entityCity,entityAddress:t.entityAddress,entityGSTN:t.entityGSTN,entityContactNumber:t.entityContactNumber,entityQualification:t.entityQualification,auditAction:"D",companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W"}},"referralservice/deactivateReferral/","Deactivating ").then(n=>{this.changeDetection.next({originalObject:t,modifiedObject:n}),this.toastrService.show({type:"success",text:t.entityBusinessName+" Deactivated!"})}).catch(n=>{this.toastrService.show({type:"error",text:n})})}}return(r=l).\u0275fac=function(t){return new(t||r)(e.Y36(b.D),e.Y36(f.k),e.Y36(v.c),e.Y36(N.u),e.Y36(C.$),e.Y36(q.Y))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-referral-master"]],decls:14,vars:3,consts:[[1,"container-fluid"],[1,"row"],["childLink","General Master","subchildLink","Referral Master"],[1,"mat-elevation-z12","lms-master-card"],[1,"lms-matcardtitlegroup"],["mat-icon-button","",3,"disableRipple","click"],["aria-label","excel",1,"lms-excel-icon"],["aria-label","csv",1,"lms-csv-icon"],[1,"remaining-space"],["color","primary",1,"lms-matslidetoggle",3,"checked","change"]],template:function(t,i){1&t&&(e._UZ(0,"app-header"),e.TgZ(1,"div",0)(2,"div",1),e._UZ(3,"app-breadcrumb",2),e.qZA(),e.TgZ(4,"div",1)(5,"mat-card",3)(6,"mat-card-title-group",4)(7,"button",5),e.NdJ("click",function(){return i.exportData("xlsx")}),e._UZ(8,"div",6),e.qZA(),e.TgZ(9,"button",5),e.NdJ("click",function(){return i.exportData("csv")}),e._UZ(10,"div",7),e.qZA(),e._UZ(11,"span",8),e.TgZ(12,"mat-slide-toggle",9),e.NdJ("change",function(a){return i.showLog(a.checked)}),e._uU(13," Show Logs "),e.qZA()()()()()),2&t&&(e.xp6(7),e.Q6J("disableRipple",!0),e.xp6(2),e.Q6J("disableRipple",!0),e.xp6(3),e.Q6J("checked",i.showLogCheckedFlag))},dependencies:[S.G,_.RK,d.a8,d.C1,w.Rr,I.L]}),l})(),Ui=(()=>{var r;class l{constructor(t,i,n,a,s){this.loader=t,this.authService=i,this.masterService=n,this.exportService=a,this.toastrService=s,this.roleList$=new p.X([]),this.inlineEditFlag=!0,this.showLogCheckedFlag=!1,this.gridOptions=new F.s8,this.changeDetection=new A.x,this.disableToggleFlag=!1}ngOnInit(){this.getRoleList(!1).then(t=>{this.roleList$.next(t)}).catch(t=>{this.roleList$.next([]),this.toastrService.show({type:"error",text:t})}),this.gridOptions={searchPlaceholder:"Search Role",pageSize:this.authService.pageSize,dateFormat:"yyyy-MM-dd",keyCodeForNextCell:13,showInlineEdit:this.inlineEditFlag,titleForMobileView:"entityBusinessName",pageSizeArray:[5,10,20],showDeleteButton:!1,showAddButton:!0,showEditButton:!0,showActivateDeactivateButton:!0,showSearchInput:!0,activateDeactivateCondition:{conditionalProperty:"activeFlag",valueForActivation:"1",valueForDeactivation:"0"},columns:[{name:"entityBusinessName",label:"Role",enable:!0,searchable:!0,sortable:!0,type:"text",editable:!0,isRequired:!0,shouldBeUnique:!0,min:1,max:100,pattern:"[^]*",columnPlaceholder:"Role",requiredLabel:"Please enter role",patternLabel:"Please match the requested format."},{name:"entityBusinessShortCode",label:"Abbreviation",enable:!0,searchable:!0,sortable:!0,type:"text",editable:!0,isRequired:!0,shouldBeUnique:!0,min:1,max:10,pattern:"[^]*",columnPlaceholder:"Abbreviation",requiredLabel:"Please enter abbreviation",patternLabel:"Please match the requested format."},{name:"createdByUser",label:"Last Updated By",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"effectiveDateFrom",label:"Last Modified on",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"activeFlag",label:"",enable:!1,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"entityID",label:"",enable:!1,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"entityBusinessID",label:"",enable:!1,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1}]}}getRoleList(t){return new Promise((i,n)=>{this.loader.showSpinner("Role list on the way."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W",detailFlag:t,dropDown:!1}},"roleservice/getAllRole/").subscribe(s=>{this.loader.hideSpinner(),"200"===s.statusCode||"300"===s.statusCode?(s.responseList=null==s.responseList?[]:s.responseList,i(s.responseList)):n(s.errorMessage)},s=>{this.loader.hideSpinner(),n("Either Internet is not working or some internal server issue")})})}exportData(t){const i=[{property:"entityBusinessName",label:"Role"},{property:"entityBusinessShortCode",label:"Abbreviation"},{property:"createdByUser",label:"Last Updated By"},{property:"effectiveDateFrom",label:"Last Modified on"}];this.showLogCheckedFlag&&i.push({property:"auditAction",label:"Audit Action"}),this.exportService.generateFile(this.roleList$.getValue(),"Role List."+t,i)}showLog(t){this.roleList$.next([]),t?this.getRoleList(!0).then(i=>{this.showLogCheckedFlag=!0,this.roleList$.next(i),this.gridOptions.showAddButton=!1,this.gridOptions.showEditButton=!1,this.gridOptions.showActivateDeactivateButton=!1,this.gridOptions.columns.push({name:"auditAction",label:"Audit Action",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1})}).catch(i=>{this.roleList$.next([]),this.toastrService.show({type:"error",text:i})}):(this.showLogCheckedFlag=!1,this.ngOnInit())}actionButtonClickEvent(t,i){switch(i){case"add":case"update":this.disableToggleFlag=!0,this.gridOptions.showActivateDeactivateButton=!1;break;case"cancel":this.disableToggleFlag=!1,this.gridOptions.showActivateDeactivateButton=!0}}addNewRole(t){this.masterService.requestActionRestAPI(t,{genericManipulationRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,entityBusinessName:t.entityBusinessName,entityBusinessShortCode:t.entityBusinessShortCode,auditAction:"C",mode:"W"}},"roleservice/createRole/","Adding ").then(n=>{this.changeDetection.next({originalObject:t,modifiedObject:n}),this.toastrService.show({type:"success",text:t.entityBusinessName+" Added!"}),this.disableToggleFlag=!1,this.gridOptions.showActivateDeactivateButton=!0}).catch(n=>{this.changeDetection.next({originalObject:t,modifiedObject:void 0}),this.disableToggleFlag=!0,this.gridOptions.showActivateDeactivateButton=!1,this.toastrService.show({type:"error",text:n})})}updateRole(t){this.masterService.requestActionRestAPI(t,{genericManipulationRequestEntity:{entityID:t.entityID,entityBusinessID:t.entityBusinessID,entityBusinessName:t.entityBusinessName,entityBusinessShortCode:t.entityBusinessShortCode,auditAction:"U",companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W"}},"roleservice/updateRole/","Updating ").then(n=>{this.changeDetection.next({originalObject:t,modifiedObject:n}),this.toastrService.show({type:"success",text:t.entityBusinessName+" Updated!"}),this.disableToggleFlag=!1,this.gridOptions.showActivateDeactivateButton=!0}).catch(n=>{this.changeDetection.next({originalObject:t,modifiedObject:void 0}),this.disableToggleFlag=!0,this.gridOptions.showActivateDeactivateButton=!1,this.toastrService.show({type:"error",text:n})})}activateRole(t){this.masterService.requestActionRestAPI(t,{genericManipulationRequestEntity:{entityID:t.entityID,entityBusinessID:t.entityBusinessID,entityBusinessName:t.entityBusinessName,entityBusinessShortCode:t.entityBusinessShortCode,auditAction:"A",companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W"}},"roleservice/activateRole","Activating ").then(n=>{this.changeDetection.next({originalObject:t,modifiedObject:n}),this.toastrService.show({type:"success",text:t.entityBusinessName+" Activated!"})}).catch(n=>{this.changeDetection.next({originalObject:t,modifiedObject:void 0}),this.toastrService.show({type:"error",text:n})})}deactivateRole(t){this.masterService.requestActionRestAPI(t,{genericManipulationRequestEntity:{entityID:t.entityID,entityBusinessID:t.entityBusinessID,entityBusinessName:t.entityBusinessName,entityBusinessShortCode:t.entityBusinessShortCode,auditAction:"D",companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W"}},"roleservice/deactivateRole","Deactivating ").then(n=>{this.changeDetection.next({originalObject:t,modifiedObject:n}),this.toastrService.show({type:"success",text:t.entityBusinessName+" Deactivated!"})}).catch(n=>{this.changeDetection.next({originalObject:t,modifiedObject:void 0}),this.toastrService.show({type:"error",text:n})})}}return(r=l).\u0275fac=function(t){return new(t||r)(e.Y36(b.D),e.Y36(C.$),e.Y36(v.c),e.Y36(N.u),e.Y36(f.k))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-role"]],decls:14,vars:4,consts:[[1,"container-fluid"],[1,"row"],["childLink","General Master","subchildLink","Role Master"],[1,"mat-elevation-z12","lms-master-card"],[1,"lms-matcardtitlegroup"],["mat-icon-button","",3,"disableRipple","click"],["aria-label","excel",1,"lms-excel-icon"],["aria-label","csv",1,"lms-csv-icon"],[1,"remaining-space"],["color","primary",1,"lms-matslidetoggle",3,"checked","disabled","change"]],template:function(t,i){1&t&&(e._UZ(0,"app-header"),e.TgZ(1,"div",0)(2,"div",1),e._UZ(3,"app-breadcrumb",2),e.qZA(),e.TgZ(4,"div",1)(5,"mat-card",3)(6,"mat-card-title-group",4)(7,"button",5),e.NdJ("click",function(){return i.exportData("xlsx")}),e._UZ(8,"div",6),e.qZA(),e.TgZ(9,"button",5),e.NdJ("click",function(){return i.exportData("csv")}),e._UZ(10,"div",7),e.qZA(),e._UZ(11,"span",8),e.TgZ(12,"mat-slide-toggle",9),e.NdJ("change",function(a){return i.showLog(a.checked)}),e._uU(13," Show Logs "),e.qZA()()()()()),2&t&&(e.xp6(7),e.Q6J("disableRipple",!0),e.xp6(2),e.Q6J("disableRipple",!0),e.xp6(3),e.Q6J("checked",i.showLogCheckedFlag)("disabled",i.disableToggleFlag))},dependencies:[S.G,_.RK,d.a8,d.C1,w.Rr,I.L]}),l})(),Ji=(()=>{var r;class l{constructor(t,i,n,a,s){this.loader=t,this.masterService=i,this.exportService=n,this.authService=a,this.toastrService=s,this.salutationList$=new p.X([]),this.inlineEditFlag=!0,this.showLogCheckedFlag=!1,this.gridOptions=new F.s8,this.changeDetection=new A.x,this.disableToggleFlag=!1}ngOnInit(){this.getSalutationList(!1).then(t=>{this.salutationList$.next(t)}).catch(t=>{this.salutationList$.next([]),this.toastrService.show({type:"error",text:t})}),this.gridOptions={searchPlaceholder:"Search Salutation",pageSize:this.authService.pageSize,dateFormat:"yyyy-MM-dd",keyCodeForNextCell:13,showInlineEdit:this.inlineEditFlag,titleForMobileView:"entityBusinessName",pageSizeArray:[5,10,20],showDeleteButton:!1,showAddButton:!0,showEditButton:!0,showActivateDeactivateButton:!0,showSearchInput:!0,activateDeactivateCondition:{conditionalProperty:"activeFlag",valueForActivation:"1",valueForDeactivation:"0"},columns:[{name:"gender",label:"Gender",enable:!0,searchable:!1,sortable:!1,type:"select",selectionList:{data:[],key:"entityBusinessShortCode",value:"entityBusinessShortCode"},dropdownSelectedValue:"gender",editable:!0,isRequired:!0,columnPlaceholder:"Choose Gender",requiredLabel:"Please choose gender"},{name:"entityBusinessName",label:"Name",enable:!0,searchable:!0,sortable:!0,type:"text",editable:!0,isRequired:!0,shouldBeUnique:!0,min:1,max:100,pattern:"[^]*",columnPlaceholder:"Salutation",requiredLabel:"Please enter salutation",patternLabel:"Please match the requested format."},{name:"entityBusinessShortCode",label:"Abbreviation",enable:!0,searchable:!0,sortable:!0,type:"text",editable:!0,isRequired:!0,shouldBeUnique:!0,min:1,max:10,pattern:"[A-Za-z ]*",columnPlaceholder:"Abbreviation",requiredLabel:"Please enter abbreviation",patternLabel:"Please match the requested format."},{name:"orderIndex",label:"Order Index",enable:!0,searchable:!1,sortable:!0,type:"text",editable:!0,isRequired:!0,shouldBeUnique:!0,min:1,max:10,pattern:"[0-9 ]*",columnPlaceholder:"Order Index",requiredLabel:"Please enter order Index",patternLabel:"Please match the requested format."},{name:"createdByUser",label:"Last Updated By",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"effectiveDateFrom",label:"Last Modified on",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"activeFlag",label:"",enable:!1,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"entityID",label:"",enable:!1,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"entityBusinessID",label:"",enable:!1,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1}]}}getGenderList(){return new Promise((t,i)=>{this.loader.showSpinner("Loading..."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,entityType:"G",mode:"W",detailFlag:!1,dropDown:!0}},"enumservice/getAllReferenceEntity/").subscribe(a=>{this.loader.hideSpinner(),"200"===a.statusCode||"300"===a.statusCode?(a.responseList=null==a.responseList?[]:a.responseList,t(a.responseList)):i(a.errorMessage)},a=>{this.loader.hideSpinner(),i("Either Internet is not working or facing internal server issue")})})}getSalutationList(t){return new Promise((i,n)=>{this.loader.showSpinner("Salutation list on the way."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W",detailFlag:t,dropDown:!1}},"salutationservice/getAllSalutation/").subscribe(s=>{this.loader.hideSpinner(),"200"===s.statusCode||"300"===s.statusCode?(s.responseList=null==s.responseList?[]:s.responseList,i(s.responseList)):n(s.errorMessage)},s=>{this.loader.hideSpinner(),n("Either Internet is not working or facing internal server issue")})})}exportData(t){const i=[{property:"gender",label:"Gender"},{property:"entityBusinessName",label:"Name"},{property:"entityBusinessShortCode",label:"Abbreviation"},{property:"orderIndex",label:"Order Index"},{property:"createdByUser",label:"Last Updated By"},{property:"effectiveDateFrom",label:"Last Modified on"}];this.showLogCheckedFlag&&i.push({property:"auditAction",label:"Audit Action"}),this.exportService.generateFile(this.salutationList$.getValue(),"Salutation List."+t,i)}showLog(t){this.salutationList$.next([]),t?this.getSalutationList(!0).then(i=>{this.showLogCheckedFlag=!0,this.salutationList$.next(i),this.gridOptions.showAddButton=!1,this.gridOptions.showEditButton=!1,this.gridOptions.showActivateDeactivateButton=!1,this.gridOptions.columns.push({name:"auditAction",label:"Audit Action",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1})}).catch(i=>{this.salutationList$.next([]),this.toastrService.show({type:"error",text:i})}):(this.showLogCheckedFlag=!1,this.ngOnInit())}initiateAddSalutation(t){this.actionButtonClickEvent(null,"add"),null===t?alert("Custom code goes here"):this.getGenderList().then(i=>{this.gridOptions.columns.find(n=>"gender"===n.name).selectionList.data=i,this.changeDetection.next("Fetched Gender")}).catch(i=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}initiateUpdateSalutation(t){this.actionButtonClickEvent(null,"update"),this.inlineEditFlag?this.getGenderList().then(i=>{this.gridOptions.columns.find(n=>"gender"===n.name).selectionList.data=i,this.changeDetection.next("Fetched Gender")}).catch(i=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})}):alert("Custom code goes here")}actionButtonClickEvent(t,i){switch(i){case"add":case"update":this.disableToggleFlag=!0,this.gridOptions.showActivateDeactivateButton=!1;break;case"cancel":this.disableToggleFlag=!1,this.gridOptions.showActivateDeactivateButton=!0}}addNewSalutation(t){this.masterService.requestActionRestAPI(t,{salutationRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,entityBusinessName:t.entityBusinessName,entityBusinessShortCode:t.entityBusinessShortCode,entityParentBusinessID:t.entityParentBusinessID,gender:t.gender,orderIndex:t.orderIndex,auditAction:"C",mode:"W"}},"salutationservice/createSalutation/","Adding ").then(n=>{this.changeDetection.next({originalObject:t,modifiedObject:n}),this.toastrService.show({type:"success",text:t.entityBusinessName+" Added!"}),this.disableToggleFlag=!1,this.gridOptions.showActivateDeactivateButton=!0}).catch(n=>{this.changeDetection.next({originalObject:t,modifiedObject:void 0}),this.disableToggleFlag=!0,this.gridOptions.showActivateDeactivateButton=!1,this.toastrService.show({type:"error",text:n})})}updateSalutation(t){this.masterService.requestActionRestAPI(t,{salutationRequestEntity:{entityID:t.entityID,entityBusinessID:t.entityBusinessID,entityBusinessName:t.entityBusinessName,entityBusinessShortCode:t.entityBusinessShortCode,gender:t.gender,orderIndex:t.orderIndex,auditAction:"U",companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W"}},"salutationservice/updateSalutation/","Updating ").then(n=>{this.changeDetection.next({originalObject:t,modifiedObject:n}),this.toastrService.show({type:"success",text:t.entityBusinessName+" Updated!"}),this.disableToggleFlag=!1,this.gridOptions.showActivateDeactivateButton=!0}).catch(n=>{this.changeDetection.next({originalObject:t,modifiedObject:void 0}),this.disableToggleFlag=!0,this.gridOptions.showActivateDeactivateButton=!1,this.toastrService.show({type:"error",text:n})})}activateSalutation(t){this.masterService.requestActionRestAPI(t,{salutationRequestEntity:{entityID:t.entityID,entityBusinessID:t.entityBusinessID,entityBusinessName:t.entityBusinessName,entityBusinessShortCode:t.entityBusinessShortCode,gender:t.gender,orderIndex:t.orderIndex,auditAction:"A",companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W"}},"salutationservice/activateSalutation","Activating ").then(n=>{this.changeDetection.next({originalObject:t,modifiedObject:n}),this.toastrService.show({type:"success",text:t.entityBusinessName+" Activated!"})}).catch(n=>{this.changeDetection.next({originalObject:t,modifiedObject:void 0}),this.toastrService.show({type:"error",text:n})})}deactivateSalutation(t){this.masterService.requestActionRestAPI(t,{salutationRequestEntity:{entityID:t.entityID,entityBusinessID:t.entityBusinessID,entityBusinessName:t.entityBusinessName,entityBusinessShortCode:t.entityBusinessShortCode,gender:t.gender,orderIndex:t.orderIndex,auditAction:"D",companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W"}},"salutationservice/deactivateSalutation","Deactivating ").then(n=>{this.changeDetection.next({originalObject:t,modifiedObject:n}),this.toastrService.show({type:"success",text:t.entityBusinessName+" Deactivated!"})}).catch(n=>{this.changeDetection.next({originalObject:t,modifiedObject:void 0}),this.toastrService.show({type:"error",text:n})})}}return(r=l).\u0275fac=function(t){return new(t||r)(e.Y36(b.D),e.Y36(v.c),e.Y36(N.u),e.Y36(C.$),e.Y36(f.k))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-salutation"]],decls:14,vars:4,consts:[[1,"container-fluid"],[1,"row"],["childLink","General Master","subchildLink","Salutation"],[1,"mat-elevation-z12","lms-master-card"],[1,"lms-matcardtitlegroup"],["mat-icon-button","",3,"disableRipple","click"],["aria-label","excel",1,"lms-excel-icon"],["aria-label","csv",1,"lms-csv-icon"],[1,"remaining-space"],["color","primary",1,"lms-matslidetoggle",3,"checked","disabled","change"]],template:function(t,i){1&t&&(e._UZ(0,"app-header"),e.TgZ(1,"div",0)(2,"div",1),e._UZ(3,"app-breadcrumb",2),e.qZA(),e.TgZ(4,"div",1)(5,"mat-card",3)(6,"mat-card-title-group",4)(7,"button",5),e.NdJ("click",function(){return i.exportData("xlsx")}),e._UZ(8,"div",6),e.qZA(),e.TgZ(9,"button",5),e.NdJ("click",function(){return i.exportData("csv")}),e._UZ(10,"div",7),e.qZA(),e._UZ(11,"span",8),e.TgZ(12,"mat-slide-toggle",9),e.NdJ("change",function(a){return i.showLog(a.checked)}),e._uU(13," Show Logs "),e.qZA()()()()()),2&t&&(e.xp6(7),e.Q6J("disableRipple",!0),e.xp6(2),e.Q6J("disableRipple",!0),e.xp6(3),e.Q6J("checked",i.showLogCheckedFlag)("disabled",i.disableToggleFlag))},dependencies:[S.G,_.RK,d.a8,d.C1,w.Rr,I.L]}),l})(),$i=(()=>{var r;class l{constructor(t,i,n,a,s){this.loader=t,this.masterService=i,this.exportService=n,this.authService=a,this.toastrService=s,this.statesList$=new p.X([]),this.inlineEditFlag=!0,this.showLogCheckedFlag=!1,this.gridOptions=new F.s8,this.changeDetection=new A.x,this.disableToggleFlag=!1}ngOnInit(){this.getStatesList(!1).then(t=>{this.statesList$.next(t)}).catch(t=>{this.statesList$.next([]),this.toastrService.show({type:"error",text:t})}),this.gridOptions={searchPlaceholder:"Search State",pageSize:this.authService.pageSize,dateFormat:"yyyy-MM-dd",keyCodeForNextCell:13,showInlineEdit:this.inlineEditFlag,titleForMobileView:"entityBusinessName",pageSizeArray:[5,10,20],showDeleteButton:!1,showAddButton:!0,showEditButton:!0,showActivateDeactivateButton:!0,showSearchInput:!0,activateDeactivateCondition:{conditionalProperty:"activeFlag",valueForActivation:"1",valueForDeactivation:"0"},columns:[{name:"entityParentBusinessID",label:"Country Name",enable:!0,searchable:!1,sortable:!1,type:"select",selectionList:{data:[],key:"entityBusinessID",value:"entityBusinessName"},dropdownSelectedValue:"entityParentBusinessName",editable:!0,isRequired:!0,columnPlaceholder:"Choose Country",requiredLabel:"Please choose country"},{name:"entityBusinessName",label:"State Name",enable:!0,searchable:!0,sortable:!0,type:"text",editable:!0,isRequired:!0,shouldBeUnique:!0,min:1,max:100,pattern:"[A-Za-z ]*",columnPlaceholder:"State Name",requiredLabel:"Please enter state",patternLabel:"Please match the requested format."},{name:"entityBusinessShortCode",label:"Abbreviation",enable:!0,searchable:!0,sortable:!0,type:"text",editable:!0,isRequired:!0,shouldBeUnique:!0,min:1,max:10,pattern:"[A-Za-z ]*",columnPlaceholder:"Abbreviation",requiredLabel:"Please enter abbreviation",patternLabel:"Please match the requested format."},{name:"createdByUser",label:"Last Updated By",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"effectiveDateFrom",label:"Last Modified on",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"activeFlag",label:"",enable:!1,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"entityID",label:"",enable:!1,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"entityBusinessID",label:"",enable:!1,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"entityParentBusinessName",label:"",enable:!1,searchable:!0,sortable:!1,type:"text",editable:!1,isRequired:!1}]}}getCountryList(t=!1){return new Promise((i,n)=>{this.loader.showSpinner("Loading..."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,entityBusinessID:null,mode:"W",detailFlag:t,dropDown:!0}},"countryservice/getAllCountry").subscribe(s=>{this.loader.hideSpinner(),"200"===s.statusCode||"300"===s.statusCode?(s.responseList=null==s.responseList?[]:s.responseList,i(s.responseList)):n(s.errorMessage)},s=>{this.loader.hideSpinner(),n("Either Internet is not working or facing internal server issue")})})}getStatesList(t){return new Promise((i,n)=>{this.loader.showSpinner("State list on the way."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W",detailFlag:t,dropDown:!1}},"stateservice/getAllState/").subscribe(s=>{this.loader.hideSpinner(),"200"===s.statusCode||"300"===s.statusCode?(s.responseList=null==s.responseList?[]:s.responseList,i(s.responseList)):n(s.errorMessage)},s=>{this.loader.hideSpinner(),n("Either Internet is not working or facing internal server issue")})})}exportData(t){const i=[{property:"entityParentBusinessName",label:"Country Name"},{property:"entityBusinessName",label:"State Name"},{property:"entityBusinessShortCode",label:"Abbreviation"},{property:"createdByUser",label:"Last Updated By"},{property:"effectiveDateFrom",label:"Last Modified on"}];this.showLogCheckedFlag&&i.push({property:"auditAction",label:"Audit Action"}),this.exportService.generateFile(this.statesList$.getValue(),"States List."+t,i)}showLog(t){this.statesList$.next([]),t?this.getStatesList(!0).then(i=>{this.showLogCheckedFlag=!0,this.statesList$.next(i),this.gridOptions.showAddButton=!1,this.gridOptions.showEditButton=!1,this.gridOptions.showActivateDeactivateButton=!1,this.gridOptions.columns.push({name:"auditAction",label:"Audit Action",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1})}).catch(i=>{this.statesList$.next([]),this.toastrService.show({type:"error",text:i})}):(this.showLogCheckedFlag=!1,this.ngOnInit())}initiateAddState(t){this.actionButtonClickEvent(null,"add"),null===t?alert("Custom code goes here"):this.getCountryList(!1).then(i=>{this.gridOptions.columns.find(n=>"entityParentBusinessID"===n.name).selectionList.data=i,this.changeDetection.next("Fetched Country")}).catch(i=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}initiateUpdateState(t){this.actionButtonClickEvent(null,"update"),this.inlineEditFlag?this.getCountryList(!0).then(i=>{this.gridOptions.columns.find(n=>"entityParentBusinessID"===n.name).selectionList.data=i,this.changeDetection.next("Fetched Country")}).catch(i=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})}):alert("Custom code goes here")}actionButtonClickEvent(t,i){switch(i){case"add":case"update":this.disableToggleFlag=!0,this.gridOptions.showActivateDeactivateButton=!1;break;case"cancel":this.disableToggleFlag=!1,this.gridOptions.showActivateDeactivateButton=!0}}addNewState(t){this.masterService.requestActionRestAPI(t,{genericManipulationRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,entityBusinessName:t.entityBusinessName,entityBusinessShortCode:t.entityBusinessShortCode,entityParentBusinessID:t.entityParentBusinessID,auditAction:"C",mode:"W"}},"stateservice/createChildEntity/","Adding ").then(n=>{this.changeDetection.next({originalObject:t,modifiedObject:n}),this.toastrService.show({type:"success",text:t.entityBusinessName+" Added!"}),this.disableToggleFlag=!1,this.gridOptions.showActivateDeactivateButton=!0}).catch(n=>{this.changeDetection.next({originalObject:t,modifiedObject:void 0}),this.disableToggleFlag=!0,this.gridOptions.showActivateDeactivateButton=!1,this.toastrService.show({type:"error",text:n})})}updateState(t){this.masterService.requestActionRestAPI(t,{genericManipulationRequestEntity:{entityID:t.entityID,entityBusinessID:t.entityBusinessID,entityBusinessName:t.entityBusinessName,entityBusinessShortCode:t.entityBusinessShortCode,entityParentBusinessID:t.entityParentBusinessID,auditAction:"U",companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W"}},"stateservice/updateChildEntity/","Updating ").then(n=>{this.changeDetection.next({originalObject:t,modifiedObject:n}),this.toastrService.show({type:"success",text:t.entityBusinessName+" Updated!"}),this.disableToggleFlag=!1,this.gridOptions.showActivateDeactivateButton=!0}).catch(n=>{this.changeDetection.next({originalObject:t,modifiedObject:void 0}),this.disableToggleFlag=!0,this.gridOptions.showActivateDeactivateButton=!1,this.toastrService.show({type:"error",text:n})})}activateState(t){this.masterService.requestActionRestAPI(t,{genericManipulationRequestEntity:{entityID:t.entityID,entityBusinessID:t.entityBusinessID,entityBusinessName:t.entityBusinessName,entityBusinessShortCode:t.entityBusinessShortCode,entityParentBusinessID:t.entityParentBusinessID,auditAction:"A",companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W"}},"stateservice/activateChildEntity","Activating ").then(n=>{this.changeDetection.next({originalObject:t,modifiedObject:n}),this.toastrService.show({type:"success",text:t.entityBusinessName+" Activated!"})}).catch(n=>{this.changeDetection.next({originalObject:t,modifiedObject:void 0}),this.toastrService.show({type:"error",text:n})})}deactivateState(t){this.masterService.requestActionRestAPI(t,{genericManipulationRequestEntity:{entityID:t.entityID,entityBusinessID:t.entityBusinessID,entityBusinessName:t.entityBusinessName,entityBusinessShortCode:t.entityBusinessShortCode,entityParentBusinessID:t.entityParentBusinessID,auditAction:"D",companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W"}},"stateservice/deactivateChildEntity","Deactivating ").then(n=>{this.changeDetection.next({originalObject:t,modifiedObject:n}),this.toastrService.show({type:"success",text:t.entityBusinessName+" Deactivated!"})}).catch(n=>{this.changeDetection.next({originalObject:t,modifiedObject:void 0}),this.toastrService.show({type:"error",text:n})})}}return(r=l).\u0275fac=function(t){return new(t||r)(e.Y36(b.D),e.Y36(v.c),e.Y36(N.u),e.Y36(C.$),e.Y36(f.k))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-states"]],decls:14,vars:4,consts:[[1,"container-fluid"],[1,"row"],["childLink","General Master","subchildLink","States"],[1,"mat-elevation-z12","lms-master-card"],[1,"lms-matcardtitlegroup"],["mat-icon-button","",3,"disableRipple","click"],["aria-label","excel",1,"lms-excel-icon"],["aria-label","csv",1,"lms-csv-icon"],[1,"remaining-space"],["color","primary",1,"lms-matslidetoggle",3,"checked","disabled","change"]],template:function(t,i){1&t&&(e._UZ(0,"app-header"),e.TgZ(1,"div",0)(2,"div",1),e._UZ(3,"app-breadcrumb",2),e.qZA(),e.TgZ(4,"div",1)(5,"mat-card",3)(6,"mat-card-title-group",4)(7,"button",5),e.NdJ("click",function(){return i.exportData("xlsx")}),e._UZ(8,"div",6),e.qZA(),e.TgZ(9,"button",5),e.NdJ("click",function(){return i.exportData("csv")}),e._UZ(10,"div",7),e.qZA(),e._UZ(11,"span",8),e.TgZ(12,"mat-slide-toggle",9),e.NdJ("change",function(a){return i.showLog(a.checked)}),e._uU(13," Show Logs "),e.qZA()()()()()),2&t&&(e.xp6(7),e.Q6J("disableRipple",!0),e.xp6(2),e.Q6J("disableRipple",!0),e.xp6(3),e.Q6J("checked",i.showLogCheckedFlag)("disabled",i.disableToggleFlag))},dependencies:[S.G,_.RK,d.a8,d.C1,w.Rr,I.L]}),l})(),Qi=(()=>{var r;class l{constructor(t,i,n,a,s){this.loader=t,this.masterService=i,this.exportService=n,this.authService=a,this.toastrService=s,this.subdepartmentList$=new p.X([]),this.inlineEditFlag=!0,this.showLogCheckedFlag=!1,this.gridOptions=new F.s8,this.changeDetection=new A.x,this.disableToggleFlag=!1}ngOnInit(){this.getSubdepartmentList(!1).then(t=>{this.subdepartmentList$.next(t)}).catch(t=>{this.subdepartmentList$.next([]),this.toastrService.show({type:"error",text:t})}),this.gridOptions={searchPlaceholder:"Search Subdepartment",pageSize:this.authService.pageSize,dateFormat:"yyyy-MM-dd",keyCodeForNextCell:13,showInlineEdit:this.inlineEditFlag,titleForMobileView:"entityBusinessName",pageSizeArray:[5,10,20],showDeleteButton:!1,showAddButton:!0,showEditButton:!0,showActivateDeactivateButton:!0,showSearchInput:!0,activateDeactivateCondition:{conditionalProperty:"activeFlag",valueForActivation:"1",valueForDeactivation:"0"},columns:[{name:"entityParentBusinessID",label:"Department",enable:!0,searchable:!1,sortable:!1,type:"select",selectionList:{data:[],key:"entityBusinessID",value:"entityBusinessName"},dropdownSelectedValue:"entityParentBusinessName",editable:!0,isRequired:!0,columnPlaceholder:"Choose Department",requiredLabel:"Please choose department"},{name:"entityBusinessName",label:"Subdepartment",enable:!0,searchable:!0,sortable:!0,type:"text",editable:!0,isRequired:!0,shouldBeUnique:!0,min:1,max:100,pattern:"[^]*",columnPlaceholder:"Subdepartment Name",requiredLabel:"Please enter Subdepartment name",patternLabel:"Please match the requested format."},{name:"entityBusinessShortCode",label:"Abbreviation",enable:!0,searchable:!0,sortable:!0,type:"text",editable:!0,isRequired:!0,shouldBeUnique:!0,min:1,max:100,pattern:"[^]*",columnPlaceholder:"Abbreviation",requiredLabel:"Please enter abbreviation",patternLabel:"Please match the requested format."},{name:"departmentType",label:"Subdepartment Type",enable:!0,sortable:!1,type:"text",editable:!0,isRequired:!1,min:1,max:100,pattern:"[^]*",columnPlaceholder:"Subdepartment Type",patternLabel:"Please match the requested format."},{name:"remarks",label:"Remarks",enable:!0,sortable:!0,type:"text",editable:!0,isRequired:!1,min:1,max:200,pattern:"[^]*",columnPlaceholder:"Remarks",patternLabel:"Please match the requested format."},{name:"createdByUser",label:"Last Updated By",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"effectiveDateFrom",label:"Created On",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"activeFlag",label:"",enable:!1,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"entityID",label:"",enable:!1,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"entityBusinessID",label:"",enable:!1,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"entityParentBusinessName",label:"",enable:!1,searchable:!0,sortable:!1,type:"text",editable:!1,isRequired:!1}]}}getDepartmentList(t=!1){return new Promise((i,n)=>{this.loader.showSpinner("Loading..."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,entityBusinessID:null,mode:"W",detailFlag:t,dropDown:!0}},"departmentservice/getAllDepartment").subscribe(s=>{this.loader.hideSpinner(),"200"===s.statusCode||"300"===s.statusCode?(s.responseList=null==s.responseList?[]:s.responseList,i(s.responseList)):n(s.errorMessage)},s=>{this.loader.hideSpinner(),n("Either Internet is not working or facing internal server issue")})})}getSubdepartmentList(t){return new Promise((i,n)=>{this.loader.showSpinner("Subdepartment list on the way."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W",detailFlag:t,dropDown:!1}},"subdepartmentservice/getAllSubDepartment/").subscribe(s=>{this.loader.hideSpinner(),"200"===s.statusCode||"300"===s.statusCode?(s.responseList=null==s.responseList?[]:s.responseList,i(s.responseList)):n(s.errorMessage)},s=>{this.loader.hideSpinner(),n("Either Internet is not working or facing internal server issue")})})}exportData(t){const i=[{property:"entityParentBusinessName",label:"Department"},{property:"entityBusinessName",label:"Subdepartment"},{property:"entityBusinessShortCode",label:"Abbreviation"},{property:"departmentType",label:"Subdepartment Type"},{property:"remarks",label:"Remarks"},{property:"createdByUser",label:"Last Updated By"},{property:"effectiveDateFrom",label:"Created On"}];this.showLogCheckedFlag&&i.push({property:"auditAction",label:"Audit Action"}),this.exportService.generateFile(this.subdepartmentList$.getValue(),"Subdepartment List."+t,i)}showLog(t){this.subdepartmentList$.next([]),t?this.getSubdepartmentList(!0).then(i=>{this.showLogCheckedFlag=!0,this.subdepartmentList$.next(i),this.gridOptions.showAddButton=!1,this.gridOptions.showEditButton=!1,this.gridOptions.showActivateDeactivateButton=!1,this.gridOptions.columns.push({name:"auditAction",label:"Audit Action",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1})}).catch(i=>{this.subdepartmentList$.next([]),this.toastrService.show({type:"error",text:i})}):(this.showLogCheckedFlag=!1,this.ngOnInit())}initiateAddSubdepartment(t){this.actionButtonClickEvent(null,"add"),null===t?alert("Custom code goes here"):this.getDepartmentList(!1).then(i=>{this.gridOptions.columns.find(n=>"entityParentBusinessID"===n.name).selectionList.data=i,this.changeDetection.next("Fetched Department")}).catch(i=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}initiateUpdateSubdepartment(t){this.actionButtonClickEvent(null,"update"),this.inlineEditFlag?this.getDepartmentList(!0).then(i=>{this.gridOptions.columns.find(n=>"entityParentBusinessID"===n.name).selectionList.data=i,this.changeDetection.next("Fetched Department")}).catch(i=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})}):alert("Custom code goes here")}actionButtonClickEvent(t,i){switch(i){case"add":case"update":this.disableToggleFlag=!0,this.gridOptions.showActivateDeactivateButton=!1;break;case"cancel":this.disableToggleFlag=!1,this.gridOptions.showActivateDeactivateButton=!0}}addNewSubdepartment(t){this.masterService.requestActionRestAPI(t,{departmentRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,entityBusinessName:t.entityBusinessName,entityBusinessShortCode:t.entityBusinessShortCode,entityParentBusinessID:t.entityParentBusinessID,departmentType:t.departmentType,remarks:t.remarks,auditAction:"C",mode:"W"}},"subdepartmentservice/createSubDepartment/","Adding ").then(n=>{this.changeDetection.next({originalObject:t,modifiedObject:n}),this.toastrService.show({type:"success",text:t.entityBusinessName+" Added!"}),this.disableToggleFlag=!1,this.gridOptions.showActivateDeactivateButton=!0}).catch(n=>{this.changeDetection.next({originalObject:t,modifiedObject:void 0}),this.disableToggleFlag=!0,this.gridOptions.showActivateDeactivateButton=!1,this.toastrService.show({type:"error",text:n})})}updateSubdepartment(t){this.masterService.requestActionRestAPI(t,{departmentRequestEntity:{entityID:t.entityID,entityBusinessID:t.entityBusinessID,entityBusinessName:t.entityBusinessName,entityBusinessShortCode:t.entityBusinessShortCode,entityParentBusinessID:t.entityParentBusinessID,departmentType:t.departmentType,remarks:t.remarks,auditAction:"U",companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W"}},"subdepartmentservice/updateSubDepartment/","Updating ").then(n=>{this.changeDetection.next({originalObject:t,modifiedObject:n}),this.toastrService.show({type:"success",text:t.entityBusinessName+" Updated!"}),this.disableToggleFlag=!1,this.gridOptions.showActivateDeactivateButton=!0}).catch(n=>{this.changeDetection.next({originalObject:t,modifiedObject:void 0}),this.disableToggleFlag=!0,this.gridOptions.showActivateDeactivateButton=!1,this.toastrService.show({type:"error",text:n})})}activateSubdepartment(t){this.masterService.requestActionRestAPI(t,{departmentRequestEntity:{entityID:t.entityID,entityBusinessID:t.entityBusinessID,entityBusinessName:t.entityBusinessName,entityBusinessShortCode:t.entityBusinessShortCode,entityParentBusinessID:t.entityParentBusinessID,departmentType:t.departmentType,remarks:t.remarks,auditAction:"A",companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W"}},"subdepartmentservice/activateSubDepartment","Activating ").then(n=>{this.changeDetection.next({originalObject:t,modifiedObject:n}),this.toastrService.show({type:"success",text:t.entityBusinessName+" Activated!"})}).catch(n=>{this.changeDetection.next({originalObject:t,modifiedObject:void 0}),this.toastrService.show({type:"error",text:n})})}deactivateSubdepartment(t){this.masterService.requestActionRestAPI(t,{departmentRequestEntity:{entityID:t.entityID,entityBusinessID:t.entityBusinessID,entityBusinessName:t.entityBusinessName,entityBusinessShortCode:t.entityBusinessShortCode,entityParentBusinessID:t.entityParentBusinessID,departmentType:t.departmentType,remarks:t.remarks,auditAction:"D",companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W"}},"subdepartmentservice/deactivateSubDepartment","Deactivating ").then(n=>{this.changeDetection.next({originalObject:t,modifiedObject:n}),this.toastrService.show({type:"success",text:t.entityBusinessName+" Deactivated!"})}).catch(n=>{this.changeDetection.next({originalObject:t,modifiedObject:void 0}),this.toastrService.show({type:"error",text:n})})}}return(r=l).\u0275fac=function(t){return new(t||r)(e.Y36(b.D),e.Y36(v.c),e.Y36(N.u),e.Y36(C.$),e.Y36(f.k))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-sub-department"]],decls:14,vars:4,consts:[[1,"container-fluid"],[1,"row"],["childLink","General Master","subchildLink","Sub-Department"],[1,"mat-elevation-z12","lms-master-card"],[1,"lms-matcardtitlegroup"],["mat-icon-button","",3,"disableRipple","click"],["aria-label","excel",1,"lms-excel-icon"],["aria-label","csv",1,"lms-csv-icon"],[1,"remaining-space"],["color","primary",1,"lms-matslidetoggle",3,"checked","disabled","change"]],template:function(t,i){1&t&&(e._UZ(0,"app-header"),e.TgZ(1,"div",0)(2,"div",1),e._UZ(3,"app-breadcrumb",2),e.qZA(),e.TgZ(4,"div",1)(5,"mat-card",3)(6,"mat-card-title-group",4)(7,"button",5),e.NdJ("click",function(){return i.exportData("xlsx")}),e._UZ(8,"div",6),e.qZA(),e.TgZ(9,"button",5),e.NdJ("click",function(){return i.exportData("csv")}),e._UZ(10,"div",7),e.qZA(),e._UZ(11,"span",8),e.TgZ(12,"mat-slide-toggle",9),e.NdJ("change",function(a){return i.showLog(a.checked)}),e._uU(13," Show Logs "),e.qZA()()()()()),2&t&&(e.xp6(7),e.Q6J("disableRipple",!0),e.xp6(2),e.Q6J("disableRipple",!0),e.xp6(3),e.Q6J("checked",i.showLogCheckedFlag)("disabled",i.disableToggleFlag))},dependencies:[S.G,_.RK,d.a8,d.C1,w.Rr,I.L]}),l})();function Gi(r,l){if(1&r&&(e.TgZ(0,"mat-option",24),e._uU(1),e.qZA()),2&r){const c=l.$implicit;e.Q6J("value",c.entityBusinessShortCode),e.xp6(1),e.hij(" ",c.entityBusinessName," ")}}function Yi(r,l){if(1&r&&(e.TgZ(0,"mat-option",24),e._uU(1),e.qZA()),2&r){const c=l.$implicit;e.Q6J("value",c.id),e.xp6(1),e.hij(" ",c.value," ")}}let ne=(()=>{var r;class l{constructor(t,i,n,a,s){this.loader=t,this.masterService=i,this.authService=n,this.fb=a,this.toastrService=s,this.selectedMasterData={},this.masterList=[],this.submitButtonLabel="Submit",this.testComponentList$=new p.X([]),this.genderList$=new p.X([]),this.unitMeasurementList$=new p.X([]),this.levelList$=new p.X([]),this.destroySubscription$=new Z.t(1),this.fetchDataOnCloseDialog$=new p.X([])}ngOnInit(){if(this.levelList$.next([{id:0,value:"Level 0"},{id:1,value:"Level 1"},{id:2,value:"Level 2"}]),this.testComponentMappingFormGroup=this.fb.group({testComponentID:new o.NI(null,[o.kI.required]),order:new o.NI(null),gender:new o.NI(null),ageLower:new o.NI(null),ageUpper:new o.NI(null),rangeLower:new o.NI(null),rangeUpper:new o.NI(null),defaultRange:new o.NI(null),unitName:new o.NI(null),generalDescription:new o.NI(null),level:new o.NI(null),mapCode:new o.NI(null),isList:new o.NI(null),isReadOnly:new o.NI(null),isGeneral:new o.NI(null),expression:new o.NI(null),technology:new o.NI(null),sample:new o.NI(null)}),null!==this.selectedMasterData){this.getTestComponentList().then(i=>{this.testComponentList$.next(i),this.getGenderList().then(n=>{this.genderList$.next(n),this.getUnitMeasurementList().then(a=>{this.unitMeasurementList$.next(a);const s=this.unitMeasurementList$.value.find(u=>u.entityBusinessName===this.selectedMasterData?.unitName);void 0!==s&&this.testComponentMappingFormGroup.controls.unitName.setValue(s.entityBusinessID)}).catch(a=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}).catch(n=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}).catch(i=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})});const t=Object.entries(this.testComponentMappingFormGroup.value).reduce((i,[n,a])=>(i[n]=this.selectedMasterData[n],i),{});this.testComponentMappingFormGroup.patchValue(t)}else this.getTestComponentList().then(t=>{this.testComponentList$.next(t),this.getGenderList().then(i=>{this.genderList$.next(i),this.getUnitMeasurementList().then(n=>{this.unitMeasurementList$.next(n)}).catch(n=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}).catch(i=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}).catch(t=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}getTestComponentList(){return new Promise((t,i)=>{this.loader.showSpinner("Loading..."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,entityBusinessID:null,mode:"W",detailFlag:null!==this.selectedMasterData,dropDown:!1}},"testcomponentservice/getAllTestComponent/").pipe((0,g.R)(this.destroySubscription$)).subscribe(a=>{this.loader.hideSpinner(),"200"===a.statusCode||"300"===a.statusCode?(a.responseList=null==a.responseList?[]:a.responseList,t(a.responseList)):i(a.errorMessage)},a=>{this.loader.hideSpinner(),i("Either Internet is not working or facing internal server issue")})})}getGenderList(){return new Promise((t,i)=>{this.loader.showSpinner("Loading..."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,entityType:"G",mode:"W",detailFlag:!1,dropDown:!0}},"enumservice/getAllReferenceEntity/").pipe((0,g.R)(this.destroySubscription$)).subscribe(a=>{this.loader.hideSpinner(),"200"===a.statusCode||"300"===a.statusCode?(a.responseList=null==a.responseList?[]:a.responseList,t(a.responseList)):i(a.errorMessage)},a=>{this.loader.hideSpinner(),i("Either Internet is not working or facing internal server issue")})})}getUnitMeasurementList(){return new Promise((t,i)=>{this.loader.showSpinner("Loading..."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,entityBusinessID:null,mode:"W",detailFlag:null!==this.selectedMasterData,dropDown:!0}},"unitmeasurementservice/getAllUnitMeasurement/").pipe((0,g.R)(this.destroySubscription$)).subscribe(a=>{this.loader.hideSpinner(),"200"===a.statusCode||"300"===a.statusCode?(a.responseList=null==a.responseList?[]:a.responseList,t(a.responseList)):i(a.errorMessage)},a=>{this.loader.hideSpinner(),i("Either Internet is not working or facing internal server issue")})})}keytab(t,i,n){if(13===t.keyCode){var a=t.srcElement.id.split("-").reduce((s,u)=>(Number(u)&&(u=Number(u)+1),s+"-"+u));document.getElementById(a).focus()}else this._uniqueColumnValidator(t.target.value,i,n)}_uniqueColumnValidator(t,i,n){if(n){const a=null===this.selectedMasterData?{entityBusinessID:null}:this.selectedMasterData;null!=this.masterList.find(u=>u[i].toString().trim().toLowerCase()===t.trim().toLowerCase()&&u.entityBusinessID!=a.entityBusinessID)&&this.testComponentMappingFormGroup.controls[i].setErrors({mustBeUnique:!0})}}onChangeOfDropdown(t){if("Test Component"===t.type){let i=this.testComponentList$.value.find(a=>a.entityBusinessID==t?.value).unitName||null,n=null===i?null:this.unitMeasurementList$.value.find(a=>a.entityBusinessName==i.trim()).entityBusinessID||null;this.testComponentMappingFormGroup.controls.unitName.setValue(n)}}updateTestComponentMappingForm(){null===this.selectedMasterData?this.addTestComponentMapping(this.testComponentMappingFormGroup.value):this.updateTestComponentMapping(this.selectedMasterData,this.testComponentMappingFormGroup.value)}addTestComponentMapping(t){let i=this.masterList[0].selectedTest,n=this.unitMeasurementList$.value.find(u=>u.entityBusinessID===t.unitName).entityBusinessName,a=[];a=null!==t.gender?[{ageUpper:t.ageUpper,ageLower:t.ageLower,order:t.order,gender:t.gender,ageType:"D",rangeUpper:t.rangeUpper,defaultRange:t.defaultRange,testComponentID:t.testComponentID,rangeLower:t.rangeLower,unitName:n,level:t.level,isList:Number(t.isList),listValue:t.listValue,isReadOnly:Number(t.isReadOnly),generalDescription:t.generalDescription,mapCode:t.mapCode,expression:t.expression,technology:t.technology,sample:t.sample,isGeneral:Number(t.isGeneral)}]:["M","F","TG"].map(u=>({ageUpper:t.ageUpper,ageLower:t.ageLower,order:t.order,gender:u,ageType:"D",rangeUpper:t.rangeUpper,defaultRange:t.defaultRange,testComponentID:t.testComponentID,rangeLower:t.rangeLower,unitName:n,level:t.level,isList:Number(t.isList),listValue:t.listValue,isReadOnly:Number(t.isReadOnly),generalDescription:t.generalDescription,mapCode:t.mapCode,expression:t.expression,technology:t.technology,sample:t.sample,isGeneral:Number(t.isGeneral)})),this.loader.showSpinner("Creating new test component mapping."),this.masterService.requestApiForGeneralMaster({testComponentMappingEntity:{testID:i,companyID:this.authService.companyID,createdBy:this.authService.employeeID,auditAction:"C",mode:"W",testComponentEntityList:a}},"testcomponentmappingservice/createEntity").pipe((0,g.R)(this.destroySubscription$)).subscribe(u=>{this.loader.hideSpinner(),"200"===u.statusCode?(this.fetchDataOnCloseDialog$.next([{value:i}]),this.toastrService.show({type:"success",text:"New test component mapping created."})):this.toastrService.show({type:"error",text:u.errorMessage})},u=>{this.loader.hideSpinner(),this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}updateTestComponentMapping(t,i){let n=this.masterList[0].selectedTest,a=this.unitMeasurementList$.value.find(u=>u.entityBusinessID===i.unitName).entityBusinessName;this.loader.showSpinner("Updating "+t.testComponentName+" for "+t.gender+" Gender");const s={testComponentMappingEntity:{testID:n,companyID:this.authService.companyID,createdBy:this.authService.employeeID,auditAction:"U",mode:"W",testComponentEntityList:[{ageUpper:i.ageUpper,ageLower:i.ageLower,order:i.order,gender:i.gender,ageType:"D",rangeUpper:i.rangeUpper,defaultRange:i.defaultRange,testComponentID:i.testComponentID,rangeLower:i.rangeLower,unitName:a,level:i.level,isList:Number(i.isList),listValue:i.listValue,isReadOnly:Number(i.isReadOnly),entityID:t.entityID,entityBusinessID:t.entityBusinessID,generalDescription:i.generalDescription,mapCode:i.mapCode,expression:i.expression,technology:i.technology,sample:i.sample,isGeneral:Number(i.isGeneral)}]}};this.masterService.requestApiForGeneralMaster(s,"testcomponentmappingservice/updateEntity").pipe((0,g.R)(this.destroySubscription$)).subscribe(u=>{this.loader.hideSpinner(),"200"===u.statusCode?(this.fetchDataOnCloseDialog$.next([{value:n}]),this.toastrService.show({type:"success",text:"Updated "+t.testComponentName+" for "+t.gender+" Gender"})):this.toastrService.show({type:"error",text:u.errorMessage})},u=>{this.loader.hideSpinner(),this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}ngOnDestroy(){this.fetchDataOnCloseDialog$&&this.fetchDataOnCloseDialog$.unsubscribe(),this.destroySubscription$.next(null),this.destroySubscription$.complete()}}return(r=l).\u0275fac=function(t){return new(t||r)(e.Y36(b.D),e.Y36(v.c),e.Y36(C.$),e.Y36(o.qu),e.Y36(f.k))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-test-component-mapping-form"]],inputs:{selectedMasterData:"selectedMasterData",masterList:"masterList",submitButtonLabel:"submitButtonLabel"},decls:87,vars:22,consts:[["autocomplete","off",3,"formGroup"],[1,"container-fluid","corporate-master-container"],[1,"row"],[1,"col-12","col-md-4","col-lg-3"],[3,"dropdownFor","isRequired","records","formControlsName","idForSelect","dropdownChangeEvent"],["appearance","outline",1,"lms-mat-form-field"],["matInput","","placeholder","Order ID","id","tc-field-2","formControlName","order",3,"keyup"],["formControlName","gender","id","tc-field-3"],[3,"value",4,"ngFor","ngForOf"],["matInput","","placeholder","Lower Age","id","tc-field-4","formControlName","ageLower",3,"keyup"],["matInput","","placeholder","Upper Age","id","tc-field-5","formControlName","ageUpper",3,"keyup"],["matInput","","placeholder","Lower Range","id","tc-field-6","formControlName","rangeLower",3,"keyup"],["matInput","","placeholder","Upper Range","id","tc-field-7","formControlName","rangeUpper",3,"keyup"],["matInput","","placeholder","Default Range","id","tc-field-8","formControlName","defaultRange",3,"keyup"],["matInput","","placeholder","General Description","formControlName","generalDescription","id","tc-field-10","rows","1",3,"keyup"],["formControlName","level","id","tc-field-11"],["matInput","","placeholder","Map Code","id","tc-field-12","formControlName","mapCode",3,"keyup"],["formControlName","isList","id","tc-field-13","color","primary",1,"tc-mapping-checkbox",3,"labelPosition"],["formControlName","isReadOnly","id","tc-field-14","color","primary",1,"tc-mapping-checkbox",3,"labelPosition"],["formControlName","isGeneral","id","tc-field-15","color","primary",1,"tc-mapping-checkbox",3,"labelPosition"],["matInput","","placeholder","Expression","id","tc-field-16","formControlName","expression",3,"keyup"],["matInput","","placeholder","Technology","id","tc-field-17","formControlName","technology",3,"keyup"],["matInput","","placeholder","Sample","id","tc-field-18","formControlName","sample",3,"keyup"],["type","button",1,"btn","btn-primary","lms-submit-button",3,"disabled","click"],[3,"value"]],template:function(t,i){1&t&&(e.TgZ(0,"form",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"app-lms-select",4),e.NdJ("dropdownChangeEvent",function(a){return i.onChangeOfDropdown(a)}),e.qZA()(),e.TgZ(5,"div",3)(6,"mat-form-field",5)(7,"mat-label"),e._uU(8,"Order ID"),e.qZA(),e.TgZ(9,"input",6),e.NdJ("keyup",function(a){return i.keytab(a,"order",!1)}),e.qZA()()(),e.TgZ(10,"div",3)(11,"mat-form-field",5)(12,"mat-label"),e._uU(13,"Choose Gender"),e.qZA(),e.TgZ(14,"mat-select",7),e.YNc(15,Gi,2,2,"mat-option",8),e.ALo(16,"async"),e.qZA()()(),e.TgZ(17,"div",3)(18,"mat-form-field",5)(19,"mat-label"),e._uU(20,"Lower Age (in days)"),e.qZA(),e.TgZ(21,"input",9),e.NdJ("keyup",function(a){return i.keytab(a,"ageLower",!1)}),e.qZA()()(),e.TgZ(22,"div",3)(23,"mat-form-field",5)(24,"mat-label"),e._uU(25,"Upper Age (in days)"),e.qZA(),e.TgZ(26,"input",10),e.NdJ("keyup",function(a){return i.keytab(a,"ageUpper",!1)}),e.qZA()()(),e.TgZ(27,"div",3)(28,"mat-form-field",5)(29,"mat-label"),e._uU(30,"Lower Range"),e.qZA(),e.TgZ(31,"input",11),e.NdJ("keyup",function(a){return i.keytab(a,"rangeLower",!1)}),e.qZA()()(),e.TgZ(32,"div",3)(33,"mat-form-field",5)(34,"mat-label"),e._uU(35,"Upper Range"),e.qZA(),e.TgZ(36,"input",12),e.NdJ("keyup",function(a){return i.keytab(a,"rangeUpper",!1)}),e.qZA()()(),e.TgZ(37,"div",3)(38,"mat-form-field",5)(39,"mat-label"),e._uU(40,"Default Range"),e.qZA(),e.TgZ(41,"input",13),e.NdJ("keyup",function(a){return i.keytab(a,"defaultRange",!1)}),e.qZA()()(),e.TgZ(42,"div",3)(43,"app-lms-select",4),e.NdJ("dropdownChangeEvent",function(a){return i.onChangeOfDropdown(a)}),e.qZA()(),e.TgZ(44,"div",3)(45,"mat-form-field",5)(46,"mat-label"),e._uU(47,"General Description"),e.qZA(),e.TgZ(48,"textarea",14),e.NdJ("keyup",function(a){return i.keytab(a,"generalDescription",!1)}),e.qZA()()(),e.TgZ(49,"div",3)(50,"mat-form-field",5)(51,"mat-label"),e._uU(52,"Choose Level"),e.qZA(),e.TgZ(53,"mat-select",15),e.YNc(54,Yi,2,2,"mat-option",8),e.ALo(55,"async"),e.qZA()()(),e.TgZ(56,"div",3)(57,"mat-form-field",5)(58,"mat-label"),e._uU(59,"Map Code"),e.qZA(),e.TgZ(60,"input",16),e.NdJ("keyup",function(a){return i.keytab(a,"mapCode",!1)}),e.qZA()()(),e.TgZ(61,"div",3)(62,"mat-checkbox",17),e._uU(63," is List? "),e.qZA()(),e.TgZ(64,"div",3)(65,"mat-checkbox",18),e._uU(66," is Readonly? "),e.qZA()(),e.TgZ(67,"div",3)(68,"mat-checkbox",19),e._uU(69," is General? "),e.qZA()(),e.TgZ(70,"div",3)(71,"mat-form-field",5)(72,"mat-label"),e._uU(73,"Expression"),e.qZA(),e.TgZ(74,"input",20),e.NdJ("keyup",function(a){return i.keytab(a,"expression",!1)}),e.qZA()()(),e.TgZ(75,"div",3)(76,"mat-form-field",5)(77,"mat-label"),e._uU(78,"Technology"),e.qZA(),e.TgZ(79,"input",21),e.NdJ("keyup",function(a){return i.keytab(a,"technology",!1)}),e.qZA()()(),e.TgZ(80,"div",3)(81,"mat-form-field",5)(82,"mat-label"),e._uU(83,"Sample"),e.qZA(),e.TgZ(84,"input",22),e.NdJ("keyup",function(a){return i.keytab(a,"sample",!1)}),e.qZA()()()()(),e.TgZ(85,"button",23),e.NdJ("click",function(){return i.updateTestComponentMappingForm()}),e._uU(86),e.qZA()()),2&t&&(e.Q6J("formGroup",i.testComponentMappingFormGroup),e.xp6(4),e.Q6J("dropdownFor","Test Component")("isRequired",!0)("records",i.testComponentList$)("formControlsName",i.testComponentMappingFormGroup.controls.testComponentID)("idForSelect","tc-field-1"),e.xp6(11),e.Q6J("ngForOf",e.lcZ(16,18,i.genderList$)),e.xp6(28),e.Q6J("dropdownFor","Unit")("isRequired",!1)("records",i.unitMeasurementList$)("formControlsName",i.testComponentMappingFormGroup.controls.unitName)("idForSelect","tc-field-9"),e.xp6(11),e.Q6J("ngForOf",e.lcZ(55,20,i.levelList$)),e.xp6(8),e.Q6J("labelPosition","after"),e.xp6(3),e.Q6J("labelPosition","after"),e.xp6(3),e.Q6J("labelPosition","after"),e.xp6(17),e.Q6J("disabled",i.testComponentMappingFormGroup.invalid),e.xp6(1),e.hij(" ",i.submitButtonLabel," "))},dependencies:[D.sg,o._Y,o.Fj,o.JJ,o.JL,o.sg,o.u,k.P,Q.ey,M.oG,x.Nt,y.KE,y.hX,G.gD,D.Ov],styles:[".corporate-master-container[_ngcontent-%COMP%]{display:flex;margin-top:12px}.tc-mapping-checkbox[_ngcontent-%COMP%]{display:flex;flex-direction:row;margin-top:10px}@media (max-width: 766px){.tc-mapping-checkbox[_ngcontent-%COMP%]{margin-top:5px;margin-bottom:5px}}"]}),l})(),ji=(()=>{var r;class l{constructor(t,i,n,a,s){this.loader=t,this.toastrService=i,this.masterService=n,this.authService=a,this.dialog=s,this.testComponentMappingList$=new p.X([]),this.testList$=new p.X([]),this.destroySubscription$=new Z.t(1),this.inlineEditFlag=!1,this.showLogCheckedFlag=!1,this.gridOptions=new F.s8,this.changeDetection=new A.x}ngOnInit(){this.entityTest=new o.NI(null),this.getTestList().then(t=>{this.testList$.next(t)}).catch(t=>{this.testList$.next([]),this.toastrService.show({type:"error",text:t})}),this.gridOptions={searchPlaceholder:"Search Test Component Mapping",pageSize:this.authService.pageSize,dateFormat:"yyyy-MM-dd",keyCodeForNextCell:13,showInlineEdit:this.inlineEditFlag,titleForMobileView:"testComponentName",pageSizeArray:[5,10,20],showDeleteButton:!0,showAddButton:!0,showEditButton:!0,showActivateDeactivateButton:!1,showSearchInput:!1,activateDeactivateCondition:{conditionalProperty:"activeFlag",valueForActivation:"1",valueForDeactivation:"0"},columns:[{name:"testComponentName",label:"Parameter",enable:!0,searchable:!0,sortable:!1,type:"text"},{name:"unitName",label:"Unit Name",enable:!0,searchable:!0,sortable:!1,type:"text",editable:!1},{name:"gender",label:"Gender",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1},{name:"order",label:"Order By",enable:!0,searchable:!0,sortable:!0,type:"text",editable:!1},{name:"ageLower",label:"Age (Lower)",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1},{name:"ageUpper",label:"Age (Upper)",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1},{name:"rangeLower",label:"Range (Lower)",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1},{name:"rangeUpper",label:"Range (Upper)",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1},{name:"defaultRange",label:"Default Range",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1},{name:"mapCode",label:"Map Code",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1},{name:"level",label:"level",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"isReadOnly",label:"Read Only",enable:!0,searchable:!1,sortable:!1,type:"boolean",editable:!1,isRequired:!1},{name:"activeFlag",label:"",enable:!1,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"entityID",label:"",enable:!1,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"entityBusinessID",label:"",enable:!1,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1}]}}ngOnDestroy(){this.destroySubscription$.next(null),this.destroySubscription$.complete()}getTestList(){return new Promise((t,i)=>{this.loader.showSpinner("Loading..."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W",detailFlag:!1,dropDown:!0}},"testservice/getAllTest/").pipe((0,g.R)(this.destroySubscription$)).subscribe(a=>{this.loader.hideSpinner(),"200"===a.statusCode||"300"===a.statusCode?(a.responseList=null==a.responseList?[]:a.responseList,t(a.responseList)):i(a.errorMessage)},a=>{this.loader.hideSpinner(),i("Either Internet is not working or facing internal server issue")})})}onChangeOfTest(t){this.getTestComponentMapping(t.value).then(i=>{this.testComponentMappingList$.next(i)}).catch(i=>{this.testComponentMappingList$.next([]),this.toastrService.show({type:"error",text:i})})}getTestComponentMapping(t){return new Promise((i,n)=>{this.loader.showSpinner("Fetching Test Component For Selected Test ID"),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W",detailFlag:!1,dropDown:!1,entityID:t}},"testcomponentmappingservice/getAllEntity").pipe((0,g.R)(this.destroySubscription$)).subscribe(s=>{this.loader.hideSpinner(),"200"===s.statusCode||"300"===s.statusCode?(s.responseList=null==s.responseList[0].testComponentEntityList?[]:s.responseList[0].testComponentEntityList,i(s.responseList)):n(s.errorMessage)},s=>{this.loader.hideSpinner(),n("Either Internet is not working or facing internal server issue")})})}initiateAddTestComponentMapping(t){null!==this.entityTest.value?this.dialog.open(B.s,{disableClose:!0,data:{header:"Add Component Mapping",buttonLabel:"Submit",records:{selectedItem:t,uniqueItemList:[{selectedTest:this.entityTest.value}]},component:ne},animation:{to:"right"},position:{top:"50vh",left:"50vw"},panelClass:"lms-dialog-box-center"}).afterClosed().subscribe(n=>{null!==n&&this.onChangeOfTest(n[0])}):this.toastrService.show({type:"error",text:"For test component mapping , test must be selected!"})}initiateUpdateTestComponentMapping(t){this.dialog.open(B.s,{disableClose:!0,data:{header:"Update Component Mapping",buttonLabel:"Update",records:{selectedItem:t,uniqueItemList:[{selectedTest:this.entityTest.value}]},component:ne},animation:{to:"right"},position:{top:"50vh",left:"50vw"},panelClass:"lms-dialog-box-center"}).afterClosed().subscribe(n=>{null!==n&&this.onChangeOfTest(n[0])})}deleteTestComponentMapping(t){this.loader.showSpinner("Deleting "+t.testComponentName+" for "+t.gender+" Gender"),this.masterService.requestApiForGeneralMaster({testComponentMappingEntity:{testID:this.entityTest.value,companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W",activeFlag:0,auditAction:"D",testComponentEntityList:[{ageLower:t.ageLower,ageType:t.ageType,ageUpper:t.ageUpper,defaultRange:t.defaultRange,entityBusinessID:t.entityBusinessID,entityID:t.entityID,gender:t.gender,isList:t.isList,isReadOnly:t.isReadOnly,level:t.level,listValue:t.listValue,order:t.order,rangeLower:t.rangeLower,rangeUpper:t.rangeUpper,testComponentID:t.testComponentID,unitName:t.unitName}]}},"testcomponentmappingservice/deactivateEntity").pipe((0,g.R)(this.destroySubscription$)).subscribe(n=>{this.loader.hideSpinner(),"200"===n.statusCode?(this.toastrService.show({type:"success",text:"Deleted "+t.testComponentName+" for "+t.gender+" Gender"}),this.onChangeOfTest({value:this.entityTest.value})):this.toastrService.show({type:"error",text:n.errorMessage})},n=>{this.loader.hideSpinner(),this.toastrService.show({type:"error",text:"Either Internet is not working or facing internal server issue"})})}}return(r=l).\u0275fac=function(t){return new(t||r)(e.Y36(b.D),e.Y36(f.k),e.Y36(v.c),e.Y36(C.$),e.Y36(q.Y))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-test-component-mapping"]],decls:8,vars:5,consts:[[1,"container-fluid"],[1,"row"],["childLink","General Master","subchildLink","Test Component Mapping"],[1,"mat-elevation-z12","lms-master-card"],[1,"lms-matcardtitlegroup-testcomponentmapping"],[3,"dropdownFor","isRequired","records","formControlsName","idForSelect","dropdownChangeEvent"]],template:function(t,i){1&t&&(e._UZ(0,"app-header"),e.TgZ(1,"div",0)(2,"div",1),e._UZ(3,"app-breadcrumb",2),e.qZA(),e.TgZ(4,"div",1)(5,"mat-card",3)(6,"mat-card-title-group",4)(7,"app-lms-select",5),e.NdJ("dropdownChangeEvent",function(a){return i.onChangeOfTest(a)}),e.qZA()()()()()),2&t&&(e.xp6(7),e.Q6J("dropdownFor","Test")("isRequired",!1)("records",i.testList$)("formControlsName",i.entityTest)("idForSelect","lms-field-12"))},dependencies:[S.G,k.P,d.a8,d.C1,I.L],styles:[".lms-matcardtitlegroup-testcomponentmapping[_ngcontent-%COMP%]{float:right;position:relative;right:6%;top:17px}@media (max-width: 900px){.lms-matcardtitlegroup-testcomponentmapping[_ngcontent-%COMP%]{float:inherit;right:19%;top:0}}@media (max-width: 900px){.vkc-search-input[_ngcontent-%COMP%]{width:100%;padding:0;overflow:hidden;display:none!important}}"]}),l})(),Wi=(()=>{var r;class l{constructor(t,i,n,a,s){this.loader=t,this.masterService=i,this.exportService=n,this.authService=a,this.toastrService=s,this.testComponentList$=new p.X([]),this.inlineEditFlag=!0,this.showLogCheckedFlag=!1,this.gridOptions=new F.s8,this.changeDetection=new A.x,this.disableToggleFlag=!1}ngOnInit(){this.getTestComponentList(!1).then(t=>{this.testComponentList$.next(t)}).catch(t=>{this.testComponentList$.next([]),this.toastrService.show({type:"error",text:t})}),this.gridOptions={searchPlaceholder:"Search Test Component",pageSize:this.authService.pageSize,dateFormat:"yyyy-MM-dd",keyCodeForNextCell:13,showInlineEdit:this.inlineEditFlag,titleForMobileView:"entityBusinessName",pageSizeArray:[5,10,20],showDeleteButton:!1,showAddButton:!0,showEditButton:!0,showActivateDeactivateButton:!0,showSearchInput:!0,activateDeactivateCondition:{conditionalProperty:"activeFlag",valueForActivation:"1",valueForDeactivation:"0"},columns:[{name:"entityBusinessName",label:"Test Component",enable:!0,searchable:!0,sortable:!0,type:"text",editable:!0,isRequired:!0,shouldBeUnique:!0,min:1,max:100,pattern:"[^]*",columnPlaceholder:"Test Component",requiredLabel:"Please enter test component",patternLabel:"Please match the requested format."},{name:"entityBusinessShortCode",label:"Abbreviation",enable:!0,searchable:!0,sortable:!0,type:"text",editable:!0,isRequired:!0,shouldBeUnique:!0,min:1,max:100,pattern:"[^]*",columnPlaceholder:"Abbreviation",requiredLabel:"Please enter abbreviation",patternLabel:"Please match the requested format."},{name:"unitName",label:"Unit",enable:!0,searchable:!0,sortable:!1,type:"select",selectionList:{data:[],key:"entityBusinessName",value:"entityBusinessName"},dropdownSelectedValue:"unitName",editable:!0,isRequired:!1,columnPlaceholder:"Unit Measurement"},{name:"createdByUser",label:"Last Updated By",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"effectiveDateFrom",label:"Last Modified on",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"activeFlag",label:"",enable:!1,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"entityID",label:"",enable:!1,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"entityBusinessID",label:"",enable:!1,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1}]}}getUnitMeasurementList(t=!1){return new Promise((i,n)=>{this.loader.showSpinner("Loading..."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,entityBusinessID:null,mode:"W",detailFlag:t,dropDown:!0}},"unitmeasurementservice/getAllUnitMeasurement/").subscribe(s=>{this.loader.hideSpinner(),"200"===s.statusCode||"300"===s.statusCode?(s.responseList=null==s.responseList?[]:s.responseList,i(s.responseList)):n(s.errorMessage)},s=>{this.loader.hideSpinner(),n("Either Internet is not working or facing internal server issue")})})}getTestComponentList(t){return new Promise((i,n)=>{this.loader.showSpinner("Test Component list on the way."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W",detailFlag:t,dropDown:!1}},"testcomponentservice/getAllTestComponent/").subscribe(s=>{this.loader.hideSpinner(),"200"===s.statusCode||"300"===s.statusCode?(s.responseList=null==s.responseList?[]:s.responseList,i(s.responseList)):n(s.errorMessage)},s=>{this.loader.hideSpinner(),n("Either Internet is not working or facing internal server issue")})})}exportData(t){const i=[{property:"entityBusinessName",label:"Test Component"},{property:"entityBusinessShortCode",label:"Abbreviation"},{property:"unitName",label:"Unit"},{property:"createdByUser",label:"Last Updated By"},{property:"effectiveDateFrom",label:"Last Modified on"}];this.showLogCheckedFlag&&i.push({property:"auditAction",label:"Audit Action"}),this.exportService.generateFile(this.testComponentList$.getValue(),"Test Component List."+t,i)}showLog(t){this.testComponentList$.next([]),t?this.getTestComponentList(!0).then(i=>{this.showLogCheckedFlag=!0,this.testComponentList$.next(i),this.gridOptions.showAddButton=!1,this.gridOptions.showEditButton=!1,this.gridOptions.showActivateDeactivateButton=!1,this.gridOptions.columns.push({name:"auditAction",label:"Audit Action",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1})}).catch(i=>{this.testComponentList$.next([]),this.toastrService.show({type:"error",text:i})}):(this.showLogCheckedFlag=!1,this.ngOnInit())}initiateAddTestComponent(t){this.actionButtonClickEvent(null,"add"),null===t?alert("Custom code goes here"):this.getUnitMeasurementList(!1).then(i=>{this.gridOptions.columns.find(n=>"unitName"===n.name).selectionList.data=i,this.changeDetection.next("Fetched Unit Measurement")}).catch(i=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}initiateUpdateTestComponent(t){this.actionButtonClickEvent(null,"update"),this.inlineEditFlag?this.getUnitMeasurementList(!0).then(i=>{this.gridOptions.columns.find(n=>"unitName"===n.name).selectionList.data=i,this.changeDetection.next("Fetched Unit Measurement")}).catch(i=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})}):alert("Custom code goes here")}actionButtonClickEvent(t,i){switch(i){case"add":case"update":this.disableToggleFlag=!0,this.gridOptions.showActivateDeactivateButton=!1;break;case"cancel":this.disableToggleFlag=!1,this.gridOptions.showActivateDeactivateButton=!0}}addNewTestComponent(t){this.masterService.requestActionRestAPI(t,{testComponentEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,entityBusinessName:t.entityBusinessName,entityBusinessShortCode:t.entityBusinessShortCode,unitName:t.unitName,auditAction:"C",mode:"W"}},"testcomponentservice/createTestComponent/","Adding ").then(n=>{this.changeDetection.next({originalObject:t,modifiedObject:n}),this.toastrService.show({type:"success",text:t.entityBusinessName+" Added!"}),this.disableToggleFlag=!1,this.gridOptions.showActivateDeactivateButton=!0}).catch(n=>{this.changeDetection.next({originalObject:t,modifiedObject:void 0}),this.disableToggleFlag=!0,this.gridOptions.showActivateDeactivateButton=!1,this.toastrService.show({type:"error",text:n})})}updateTestComponent(t){this.masterService.requestActionRestAPI(t,{testComponentEntity:{entityID:t.entityID,entityBusinessID:t.entityBusinessID,entityBusinessName:t.entityBusinessName,entityBusinessShortCode:t.entityBusinessShortCode,unitName:t.unitName,auditAction:"U",companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W"}},"testcomponentservice/updateTestComponent/","Updating ").then(n=>{this.changeDetection.next({originalObject:t,modifiedObject:n}),this.toastrService.show({type:"success",text:t.entityBusinessName+" Updated!"}),this.disableToggleFlag=!1,this.gridOptions.showActivateDeactivateButton=!0}).catch(n=>{this.changeDetection.next({originalObject:t,modifiedObject:void 0}),this.disableToggleFlag=!0,this.gridOptions.showActivateDeactivateButton=!1,this.toastrService.show({type:"error",text:n})})}activateTestComponent(t){this.masterService.requestActionRestAPI(t,{testComponentEntity:{entityID:t.entityID,entityBusinessID:t.entityBusinessID,entityBusinessName:t.entityBusinessName,entityBusinessShortCode:t.entityBusinessShortCode,unitName:t.unitName,auditAction:"A",companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W"}},"testcomponentservice/activateTestComponent","Activating ").then(n=>{this.changeDetection.next({originalObject:t,modifiedObject:n}),this.toastrService.show({type:"success",text:t.entityBusinessName+" Activated!"})}).catch(n=>{this.changeDetection.next({originalObject:t,modifiedObject:void 0}),this.toastrService.show({type:"error",text:n})})}deactivateTestComponent(t){this.masterService.requestActionRestAPI(t,{testComponentEntity:{entityID:t.entityID,entityBusinessID:t.entityBusinessID,entityBusinessName:t.entityBusinessName,entityBusinessShortCode:t.entityBusinessShortCode,unitName:t.unitName,auditAction:"D",companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W"}},"testcomponentservice/deactivateTestComponent","Deactivating ").then(n=>{this.changeDetection.next({originalObject:t,modifiedObject:n}),this.toastrService.show({type:"success",text:t.entityBusinessName+" Deactivated!"})}).catch(n=>{this.changeDetection.next({originalObject:t,modifiedObject:void 0}),this.toastrService.show({type:"error",text:n})})}}return(r=l).\u0275fac=function(t){return new(t||r)(e.Y36(b.D),e.Y36(v.c),e.Y36(N.u),e.Y36(C.$),e.Y36(f.k))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-test-component"]],decls:14,vars:4,consts:[[1,"container-fluid"],[1,"row"],["childLink","General Master","subchildLink","Test Component"],[1,"mat-elevation-z12","lms-master-card"],[1,"lms-matcardtitlegroup"],["mat-icon-button","",3,"disableRipple","click"],["aria-label","excel",1,"lms-excel-icon"],["aria-label","csv",1,"lms-csv-icon"],[1,"remaining-space"],["color","primary",1,"lms-matslidetoggle",3,"checked","disabled","change"]],template:function(t,i){1&t&&(e._UZ(0,"app-header"),e.TgZ(1,"div",0)(2,"div",1),e._UZ(3,"app-breadcrumb",2),e.qZA(),e.TgZ(4,"div",1)(5,"mat-card",3)(6,"mat-card-title-group",4)(7,"button",5),e.NdJ("click",function(){return i.exportData("xlsx")}),e._UZ(8,"div",6),e.qZA(),e.TgZ(9,"button",5),e.NdJ("click",function(){return i.exportData("csv")}),e._UZ(10,"div",7),e.qZA(),e._UZ(11,"span",8),e.TgZ(12,"mat-slide-toggle",9),e.NdJ("change",function(a){return i.showLog(a.checked)}),e._uU(13," Show Logs "),e.qZA()()()()()),2&t&&(e.xp6(7),e.Q6J("disableRipple",!0),e.xp6(2),e.Q6J("disableRipple",!0),e.xp6(3),e.Q6J("checked",i.showLogCheckedFlag)("disabled",i.disableToggleFlag))},dependencies:[S.G,_.RK,d.a8,d.C1,w.Rr,I.L]}),l})();var ae=h(1903);function zi(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Test Name is required field. "),e.qZA())}function Xi(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Please match the requested format. "),e.qZA())}function Vi(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Test Name is already taken. "),e.qZA())}function Ki(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Abbreviation is required field. "),e.qZA())}function Hi(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Please match the requested format. "),e.qZA())}function en(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Abbreviation is already taken. "),e.qZA())}function tn(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Base Charge is required field. "),e.qZA())}function nn(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Please enter numerical value. "),e.qZA())}let se=(()=>{var r;class l{constructor(t,i,n,a,s){this.loader=t,this.masterService=i,this.authService=n,this.fb=a,this.toastrService=s,this.selectedMasterData={},this.masterList=[],this.submitButtonLabel="Submit",this.departmentList$=new p.X([]),this.subdepartmentList$=new p.X([]),this.classificationTypeList$=new p.X([]),this.voilColorList$=new p.X([]),this.fetchDataOnCloseDialog$=new p.X([])}ngOnInit(){if(this.classificationTypeList$.next(this.classificationType),this.voilColorList$.next(this.voilColors),this.testMasterForm=this.fb.group({entityBusinessName:new o.NI(null,[o.kI.required]),entityBusinessShortCode:new o.NI(null,[o.kI.required]),entitySuperParentBusinessID:new o.NI(null,[o.kI.required]),entityParentBusinessID:new o.NI(null,[o.kI.required]),classificationType:new o.NI(null,[o.kI.required]),testBaseCharge:new o.NI(null,[o.kI.required]),voilType:new o.NI(null),isProfile:new o.NI(null),isHeaderPrinting:new o.NI(null),isExternal:new o.NI(null),comments:new o.NI(null,[o.kI.required])}),null!==this.selectedMasterData){this.getDepartmentList().then(i=>{this.departmentList$.next(i),this.getSubdepartmentList(this.selectedMasterData.entitySuperParentBusinessID).then(n=>{this.subdepartmentList$.next(n)}).catch(n=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}).catch(i=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})});const t=Object.entries(this.testMasterForm.value).reduce((i,[n,a])=>(i[n]=this.selectedMasterData[n],i),{});this.testMasterForm.patchValue(t)}else this.getDepartmentList().then(t=>{this.departmentList$.next(t)}).catch(t=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}get classificationType(){return[{entityBusinessID:"COMPONENT",entityBusinessName:"Component"},{entityBusinessID:"TEMPLATE",entityBusinessName:"Template"},{entityBusinessID:"Others",entityBusinessName:"Others"}]}get voilColors(){return[{entityBusinessID:"Red",entityBusinessName:"Red"},{entityBusinessID:"Lavendar",entityBusinessName:"Lavendar"},{entityBusinessID:"Orange",entityBusinessName:"Orange"},{entityBusinessID:"lightblue",entityBusinessName:"Light Blue"},{entityBusinessID:"Gray",entityBusinessName:"Gray"},{entityBusinessID:"Green",entityBusinessName:"Green"}]}getDepartmentList(){return new Promise((t,i)=>{this.loader.showSpinner("Loading..."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,entityBusinessID:null,mode:"W",detailFlag:null!==this.selectedMasterData,dropDown:!0}},"departmentservice/getAllDepartment").subscribe(a=>{this.loader.hideSpinner(),"200"===a.statusCode||"300"===a.statusCode?(a.responseList=null==a.responseList?[]:a.responseList,t(a.responseList)):i(a.errorMessage)},a=>{this.loader.hideSpinner(),i("Either Internet is not working or facing internal server issue")})})}getSubdepartmentList(t){return new Promise((i,n)=>{this.loader.showSpinner("Loading..."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,entityBusinessID:t,mode:"W",detailFlag:null!==this.selectedMasterData,dropDown:!0}},"subdepartmentservice/getAllSubDepartment/").subscribe(s=>{this.loader.hideSpinner(),"200"===s.statusCode||"300"===s.statusCode?(s.responseList=null==s.responseList?[]:s.responseList,i(s.responseList)):n(s.errorMessage)},s=>{this.loader.hideSpinner(),n("Either Internet is not working or facing internal server issue")})})}keytab(t,i,n){if(13===t.keyCode){var a=t.srcElement.id.split("-").reduce((s,u)=>(Number(u)&&(u=Number(u)+1),s+"-"+u));document.getElementById(a).focus()}else this._uniqueColumnValidator(t.target.value,i,n)}_uniqueColumnValidator(t,i,n){if(n){const a=null===this.selectedMasterData?{entityBusinessID:null}:this.selectedMasterData;null!=this.masterList.find(u=>u[i].toString().trim().toLowerCase()===t.trim().toLowerCase()&&u.entityBusinessID!=a.entityBusinessID)&&this.testMasterForm.controls[i].setErrors({mustBeUnique:!0})}}onChangeOfDropdown(t){"Department"===t.type&&this.getSubdepartmentList(t.value).then(i=>{this.subdepartmentList$.next(i)}).catch(i=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}updatetestMasterForm(){null===this.selectedMasterData?this.addNewTestMaster(this.testMasterForm.value):this.updateTestMaster(this.selectedMasterData,this.testMasterForm.value)}addNewTestMaster(t){const i={testRequestEntity:{entityBusinessName:t.entityBusinessName,entityBusinessShortCode:t.entityBusinessShortCode,entitySuperParentBusinessID:t.entitySuperParentBusinessID,entityParentBusinessID:t.entityParentBusinessID,testBaseCharge:t.testBaseCharge,comments:t.comments,isProfile:Number(t.isProfile),isHeaderPrinting:Number(t.isHeaderPrinting),isExternal:Number(t.isExternal),classificationType:t.classificationType,voilType:t.voilType,companyID:this.authService.companyID,createdBy:this.authService.employeeID,auditAction:"C",mode:"W"}};this.masterService.requestActionRestAPI(t,i,"testservice/createTest","Adding ").then(n=>{this.fetchDataOnCloseDialog$.next([{modifiedObject:n}])}).catch(n=>{this.toastrService.show({type:"error",text:n})})}updateTestMaster(t,i){const n={testRequestEntity:{entityID:t.entityID,entityBusinessID:t.entityBusinessID,entityBusinessName:i.entityBusinessName,entityBusinessShortCode:i.entityBusinessShortCode,entitySuperParentBusinessID:i.entitySuperParentBusinessID,entityParentBusinessID:i.entityParentBusinessID,testBaseCharge:i.testBaseCharge,comments:i.comments,isProfile:Number(i.isProfile),isHeaderPrinting:Number(i.isHeaderPrinting),isExternal:Number(i.isExternal),classificationType:i.classificationType,voilType:i.voilType,companyID:this.authService.companyID,createdBy:this.authService.employeeID,auditAction:"U",mode:"W"}};this.masterService.requestActionRestAPI(i,n,"testservice/updateTest","Updating ").then(a=>{this.fetchDataOnCloseDialog$.next([{modifiedObject:a}])}).catch(a=>{this.toastrService.show({type:"error",text:a})})}ngOnDestroy(){this.fetchDataOnCloseDialog$&&(this.fetchDataOnCloseDialog$.unsubscribe(),this.departmentList$.unsubscribe(),this.subdepartmentList$.unsubscribe())}}return(r=l).\u0275fac=function(t){return new(t||r)(e.Y36(b.D),e.Y36(v.c),e.Y36(C.$),e.Y36(o.qu),e.Y36(f.k))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-test-master-form"]],inputs:{selectedMasterData:"selectedMasterData",masterList:"masterList",submitButtonLabel:"submitButtonLabel"},decls:47,vars:39,consts:[["autocomplete","off","ngNativeValidate","",3,"formGroup"],[1,"container-fluid","test-master-container"],[1,"row"],[1,"col-12","col-md-4","col-lg-3"],[3,"dropdownFor","isRequired","records","formControlsName","idForSelect","dropdownChangeEvent"],["appearance","outline",1,"lms-mat-form-field"],["matInput","","placeholder","Test Name*","formControlName","entityBusinessName","minLength","1","maxLength","100","required","","id","test-master-3",3,"pattern","keyup"],[4,"ngIf"],["matInput","","placeholder","Abbreviation","formControlName","entityBusinessShortCode","minLength","1","maxLength","10","id","test-master-4","required","",3,"pattern","keyup"],["matInput","","placeholder","Base Charge (\u20b9)","formControlName","testBaseCharge","minLength","1","maxLength","10","id","test-master-6","required","",3,"pattern","keyup"],["formControlName","isProfile","id","test-master-8","color","primary",1,"test-master-form-checkbox",3,"labelPosition"],["formControlName","isHeaderPrinting","id","test-master-9","color","primary",1,"test-master-form-checkbox",3,"labelPosition"],["formControlName","isExternal","id","test-master-10","color","primary",1,"test-master-form-checkbox",3,"labelPosition"],[1,"col-12","col-md-12","col-lg-12"],["editorHeight","280px",3,"editorControl","requiredFlag"],[1,"btn","btn-primary","lms-submit-button",3,"disabled","click","keydown.enter"]],template:function(t,i){1&t&&(e.TgZ(0,"form",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"app-lms-select",4),e.NdJ("dropdownChangeEvent",function(a){return i.onChangeOfDropdown(a)}),e.qZA()(),e.TgZ(5,"div",3)(6,"app-lms-select",4),e.NdJ("dropdownChangeEvent",function(a){return i.onChangeOfDropdown(a)}),e.qZA()(),e.TgZ(7,"div",3)(8,"mat-form-field",5)(9,"mat-label"),e._uU(10,"Test Name"),e.qZA(),e.TgZ(11,"input",6),e.NdJ("keyup",function(a){return i.keytab(a,"entityBusinessName",!0)}),e.qZA(),e.YNc(12,zi,2,0,"mat-error",7),e.YNc(13,Xi,2,0,"mat-error",7),e.YNc(14,Vi,2,0,"mat-error",7),e.qZA()(),e.TgZ(15,"div",3)(16,"mat-form-field",5)(17,"mat-label"),e._uU(18,"Abbreviation"),e.qZA(),e.TgZ(19,"input",8),e.NdJ("keyup",function(a){return i.keytab(a,"entityBusinessShortCode",!0)}),e.qZA(),e.YNc(20,Ki,2,0,"mat-error",7),e.YNc(21,Hi,2,0,"mat-error",7),e.YNc(22,en,2,0,"mat-error",7),e.qZA()(),e.TgZ(23,"div",3)(24,"app-lms-select",4),e.NdJ("dropdownChangeEvent",function(a){return i.onChangeOfDropdown(a)}),e.qZA()(),e.TgZ(25,"div",3)(26,"mat-form-field",5)(27,"mat-label"),e._uU(28,"Base Charge (\u20b9)"),e.qZA(),e.TgZ(29,"input",9),e.NdJ("keyup",function(a){return i.keytab(a,"testBaseCharge",!1)}),e.qZA(),e.YNc(30,tn,2,0,"mat-error",7),e.YNc(31,nn,2,0,"mat-error",7),e.qZA()(),e.TgZ(32,"div",3)(33,"app-lms-select",4),e.NdJ("dropdownChangeEvent",function(a){return i.onChangeOfDropdown(a)}),e.qZA()(),e.TgZ(34,"div",3)(35,"mat-checkbox",10),e._uU(36," is Profile "),e.qZA()(),e.TgZ(37,"div",3)(38,"mat-checkbox",11),e._uU(39," is Header Printing "),e.qZA()(),e.TgZ(40,"div",3)(41,"mat-checkbox",12),e._uU(42," is External "),e.qZA()(),e.TgZ(43,"div",13),e._UZ(44,"app-editor",14),e.qZA()()(),e.TgZ(45,"button",15),e.NdJ("click",function(){return i.updatetestMasterForm()})("keydown.enter",function(a){return a.preventDefault()}),e._uU(46),e.qZA()()),2&t&&(e.Q6J("formGroup",i.testMasterForm),e.xp6(4),e.Q6J("dropdownFor","Department")("isRequired",!0)("records",i.departmentList$)("formControlsName",i.testMasterForm.controls.entitySuperParentBusinessID)("idForSelect","test-master-1"),e.xp6(2),e.Q6J("dropdownFor","Subdepartment")("isRequired",!0)("records",i.subdepartmentList$)("formControlsName",i.testMasterForm.controls.entityParentBusinessID)("idForSelect","test-master-2"),e.xp6(5),e.Q6J("pattern","[^]*"),e.xp6(1),e.Q6J("ngIf",null==i.testMasterForm.controls.entityBusinessName||null==i.testMasterForm.controls.entityBusinessName.errors?null:i.testMasterForm.controls.entityBusinessName.errors.required),e.xp6(1),e.Q6J("ngIf",null==i.testMasterForm.controls.entityBusinessName||null==i.testMasterForm.controls.entityBusinessName.errors?null:i.testMasterForm.controls.entityBusinessName.errors.pattern),e.xp6(1),e.Q6J("ngIf",null==i.testMasterForm.controls.entityBusinessName||null==i.testMasterForm.controls.entityBusinessName.errors?null:i.testMasterForm.controls.entityBusinessName.errors.mustBeUnique),e.xp6(5),e.Q6J("pattern","[^]*"),e.xp6(1),e.Q6J("ngIf",null==i.testMasterForm.controls.entityBusinessShortCode||null==i.testMasterForm.controls.entityBusinessShortCode.errors?null:i.testMasterForm.controls.entityBusinessShortCode.errors.required),e.xp6(1),e.Q6J("ngIf",null==i.testMasterForm.controls.entityBusinessShortCode||null==i.testMasterForm.controls.entityBusinessShortCode.errors?null:i.testMasterForm.controls.entityBusinessShortCode.errors.pattern),e.xp6(1),e.Q6J("ngIf",null==i.testMasterForm.controls.entityBusinessShortCode||null==i.testMasterForm.controls.entityBusinessShortCode.errors?null:i.testMasterForm.controls.entityBusinessShortCode.errors.mustBeUnique),e.xp6(2),e.Q6J("dropdownFor","Classification Type")("isRequired",!0)("records",i.classificationTypeList$)("formControlsName",i.testMasterForm.controls.classificationType)("idForSelect","test-master-5"),e.xp6(5),e.Q6J("pattern","[0-9 ]*"),e.xp6(1),e.Q6J("ngIf",null==i.testMasterForm.controls.testBaseCharge||null==i.testMasterForm.controls.testBaseCharge.errors?null:i.testMasterForm.controls.testBaseCharge.errors.required),e.xp6(1),e.Q6J("ngIf",null==i.testMasterForm.controls.testBaseCharge||null==i.testMasterForm.controls.testBaseCharge.errors?null:i.testMasterForm.controls.testBaseCharge.errors.pattern),e.xp6(2),e.Q6J("dropdownFor","Voil Type")("isRequired",!1)("records",i.voilColorList$)("formControlsName",i.testMasterForm.controls.voilType)("idForSelect","test-master-7"),e.xp6(2),e.Q6J("labelPosition","after"),e.xp6(3),e.Q6J("labelPosition","after"),e.xp6(3),e.Q6J("labelPosition","after"),e.xp6(3),e.Q6J("editorControl",i.testMasterForm.controls.comments)("requiredFlag",!0),e.xp6(1),e.Q6J("disabled",i.testMasterForm.invalid),e.xp6(1),e.hij(" ",i.submitButtonLabel," "))},dependencies:[D.O5,o.Fj,o.JJ,o.JL,o.Q7,o.c5,o.sg,o.u,k.P,ae.P,M.oG,x.Nt,y.KE,y.hX,y.TO],styles:[".test-master-container[_ngcontent-%COMP%]{margin-top:12px;overflow:auto}.test-master-form-checkbox[_ngcontent-%COMP%]{display:flex;flex-direction:row;margin-top:14px}@media (max-width: 766px){.test-master-form-checkbox[_ngcontent-%COMP%]{margin-top:0}}"]}),l})(),an=(()=>{var r;class l{constructor(t,i,n,a,s,u){this.loader=t,this.toastrService=i,this.masterService=n,this.exportService=a,this.authService=s,this.dialog=u,this.testMasterList$=new p.X([]),this.inlineEditFlag=!1,this.showLogCheckedFlag=!1,this.gridOptions=new F.s8,this.changeDetection=new A.x,this.totalSubcription$=[]}ngOnInit(){this.getTestMasterList(!1).then(t=>{this.testMasterList$.next(t)}).catch(t=>{this.testMasterList$.next([]),this.toastrService.show({type:"error",text:t})}),this.gridOptions={searchPlaceholder:"Search Test",pageSize:this.authService.pageSize,dateFormat:"yyyy-MM-dd",keyCodeForNextCell:13,showInlineEdit:this.inlineEditFlag,titleForMobileView:"entityBusinessName",pageSizeArray:[5,10,20],showDeleteButton:!1,showAddButton:!0,showEditButton:!0,showActivateDeactivateButton:!0,showSearchInput:!0,activateDeactivateCondition:{conditionalProperty:"activeFlag",valueForActivation:"1",valueForDeactivation:"0"},columns:[{name:"entitySuperParentBusinessName",label:"Department",enable:!0,searchable:!0,sortable:!0,type:"text"},{name:"entityParentBusinessName",label:"Sub Department",enable:!0,searchable:!0,sortable:!0,type:"text"},{name:"entityBusinessName",label:"Test",enable:!0,searchable:!0,sortable:!0,type:"text"},{name:"entityBusinessShortCode",label:"Abbreviation",enable:!0,searchable:!0,sortable:!0,type:"text",editable:!1},{name:"classificationType",label:"Classification Type",enable:!0,searchable:!1,sortable:!0,type:"text"},{name:"testBaseCharge",label:"Base Charge",enable:!0,searchable:!1,sortable:!0,type:"text"},{name:"createdByUser",label:"Last Updated By",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"effectiveDateFrom",label:"Last Modified on",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"activeFlag",label:"",enable:!1,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"entityID",label:"",enable:!1,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"entityBusinessID",label:"",enable:!1,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1}]}}ngOnDestroy(){this.totalSubcription$&&this.totalSubcription$.forEach(t=>{t.unsubscribe()})}getTestMasterList(t){return new Promise((i,n)=>{this.loader.showSpinner("Test Master list on the way!");const s=this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W",detailFlag:t,dropDown:!1}},"testservice/getAllTest/").subscribe(u=>{this.loader.hideSpinner(),"200"===u.statusCode||"300"===u.statusCode?(u.responseList=null==u.responseList?[]:u.responseList,i(u.responseList)):n(u.errorMessage)},u=>{this.loader.hideSpinner(),n("Either Internet is not working or facing internal server issue")});this.totalSubcription$.push(s)})}exportData(t){const i=[{property:"entitySuperParentBusinessName",label:"Department"},{property:"entityParentBusinessName",label:"Sub Department"},{property:"entityBusinessName",label:"Test"},{property:"entityBusinessShortCode",label:"Abbreviation"},{property:"classificationType",label:"Classification Type"},{property:"testBaseCharge",label:"Base Charge"},{property:"createdByUser",label:"Last Updated By"},{property:"effectiveDateFrom",label:"Last Modified on"}];this.showLogCheckedFlag&&i.push({property:"auditAction",label:"Audit Action"}),this.exportService.generateFile(this.testMasterList$.getValue(),"Test Master List."+t,i)}showLog(t){this.testMasterList$.next([]),t?this.getTestMasterList(!0).then(i=>{this.showLogCheckedFlag=!0,this.testMasterList$.next(i),this.gridOptions.showAddButton=!1,this.gridOptions.showEditButton=!1,this.gridOptions.showActivateDeactivateButton=!1,this.gridOptions.columns.push({name:"auditAction",label:"Audit Action",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1})}).catch(i=>{this.testMasterList$.next([]),this.toastrService.show({type:"error",text:i})}):(this.showLogCheckedFlag=!1,this.ngOnInit())}initiateAddTestMaster(t){this.dialog.open(B.s,{disableClose:!0,data:{header:"Test Master Form",buttonLabel:"Submit",records:{selectedItem:t,uniqueItemList:this.testMasterList$.getValue().map(n=>({entityBusinessID:n.entityBusinessID,entityBusinessName:n.entityBusinessName,entityBusinessShortCode:n.entityBusinessShortCode}))},component:se},animation:{to:"right"},position:{top:"50vh",left:"50vw"},panelClass:"lms-dialog-box-center"}).afterClosed().subscribe(n=>{if(null!==n){let a=this.testMasterList$.getValue();a.unshift(n[0].modifiedObject),this.testMasterList$.next(a),this.toastrService.show({type:"success",text:n[0].modifiedObject.entityBusinessName+" Created!"})}})}initiateUpdateTestMaster(t){this.dialog.open(B.s,{disableClose:!0,data:{header:"Test Master Form",buttonLabel:"Update",records:{selectedItem:t,uniqueItemList:this.testMasterList$.getValue().map(n=>({entityBusinessID:n.entityBusinessID,entityBusinessName:n.entityBusinessName,entityBusinessShortCode:n.entityBusinessShortCode}))},component:se},animation:{to:"right"},position:{top:"50vh",left:"50vw"},panelClass:"lms-dialog-box-center"}).afterClosed().subscribe(n=>{if(null!==n){let a=this.testMasterList$.getValue(),s=a.findIndex(u=>u.entityBusinessID==n[0].modifiedObject.entityBusinessID);a[s]=n[0].modifiedObject,this.testMasterList$.next(a),this.toastrService.show({type:"success",text:n[0].modifiedObject.entityBusinessName+" Updated!"})}})}activateTestMaster(t){const i={testRequestEntity:{entityID:t.entityID,entityBusinessID:t.entityBusinessID,entityBusinessName:t.entityBusinessName,entityBusinessShortCode:t.entityBusinessShortCode,entitySuperParentBusinessID:t.entitySuperParentBusinessID,entityParentBusinessID:t.entityParentBusinessID,testBaseCharge:t.testBaseCharge,comments:t.comments,isProfile:Number(t.isProfile),isHeaderPrinting:Number(t.isHeaderPrinting),isExternal:Number(t.isExternal),classificationType:t.classificationType,voilType:t.voilType,auditAction:"A",companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W"}};this.masterService.requestActionRestAPI(t,i,"testservice/activateTest","Activating ").then(n=>{this.changeDetection.next({originalObject:t,modifiedObject:n}),this.toastrService.show({type:"success",text:t.entityBusinessName+" Activated!"})}).catch(n=>{this.toastrService.show({type:"error",text:n})})}deactivateTestMaster(t){const i={testRequestEntity:{entityID:t.entityID,entityBusinessID:t.entityBusinessID,entityBusinessName:t.entityBusinessName,entityBusinessShortCode:t.entityBusinessShortCode,entitySuperParentBusinessID:t.entitySuperParentBusinessID,entityParentBusinessID:t.entityParentBusinessID,testBaseCharge:t.testBaseCharge,comments:t.comments,isProfile:Number(t.isProfile),isHeaderPrinting:Number(t.isHeaderPrinting),isExternal:Number(t.isExternal),classificationType:t.classificationType,voilType:t.voilType,auditAction:"D",companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W"}};this.masterService.requestActionRestAPI(t,i,"testservice/deactivateTest","Deactivating ").then(n=>{this.changeDetection.next({originalObject:t,modifiedObject:n}),this.toastrService.show({type:"success",text:t.entityBusinessName+" Deactivated!"})}).catch(n=>{this.toastrService.show({type:"error",text:n})})}}return(r=l).\u0275fac=function(t){return new(t||r)(e.Y36(b.D),e.Y36(f.k),e.Y36(v.c),e.Y36(N.u),e.Y36(C.$),e.Y36(q.Y))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-test-master"]],decls:14,vars:3,consts:[[1,"container-fluid"],[1,"row"],["childLink","General Master","subchildLink","Test Master"],[1,"mat-elevation-z12","lms-master-card"],[1,"lms-matcardtitlegroup"],["mat-icon-button","",3,"disableRipple","click"],["aria-label","excel",1,"lms-excel-icon"],["aria-label","csv",1,"lms-csv-icon"],[1,"remaining-space"],["color","primary",1,"lms-matslidetoggle",3,"checked","change"]],template:function(t,i){1&t&&(e._UZ(0,"app-header"),e.TgZ(1,"div",0)(2,"div",1),e._UZ(3,"app-breadcrumb",2),e.qZA(),e.TgZ(4,"div",1)(5,"mat-card",3)(6,"mat-card-title-group",4)(7,"button",5),e.NdJ("click",function(){return i.exportData("xlsx")}),e._UZ(8,"div",6),e.qZA(),e.TgZ(9,"button",5),e.NdJ("click",function(){return i.exportData("csv")}),e._UZ(10,"div",7),e.qZA(),e._UZ(11,"span",8),e.TgZ(12,"mat-slide-toggle",9),e.NdJ("change",function(a){return i.showLog(a.checked)}),e._uU(13," Show Logs "),e.qZA()()()()()),2&t&&(e.xp6(7),e.Q6J("disableRipple",!0),e.xp6(2),e.Q6J("disableRipple",!0),e.xp6(3),e.Q6J("checked",i.showLogCheckedFlag))},dependencies:[S.G,_.RK,d.a8,d.C1,w.Rr,I.L]}),l})();function sn(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Package Name is required field. "),e.qZA())}function rn(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Please match the requested format. "),e.qZA())}function on(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Package Name is already taken. "),e.qZA())}function ln(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Abbreviation is required field. "),e.qZA())}function un(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Please match the requested format. "),e.qZA())}function cn(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Abbreviation is already taken. "),e.qZA())}function pn(r,l){if(1&r){const c=e.EpF();e.TgZ(0,"div",37)(1,"span",38),e._uU(2,"is Percentage? : "),e.qZA(),e.TgZ(3,"span",39)(4,"mat-checkbox",41),e.NdJ("change",function(i){e.CHM(c);const n=e.oxw().$implicit,a=e.oxw();return e.KtG(a.onChangeOfPercentageCheckbox(i.checked,n))}),e.qZA()()()}if(2&r){const c=e.oxw().$implicit,t=e.oxw();e.xp6(4),e.Q6J("ngClass",t.isPercentage.value?"not-clickable":null)("checked",c.isPercentage)}}function dn(r,l){if(1&r){const c=e.EpF();e.TgZ(0,"div",37)(1,"span",38),e._uU(2),e.qZA(),e.TgZ(3,"input",42),e.NdJ("keyup",function(i){e.CHM(c);const n=e.oxw().$implicit,a=e.oxw();return n.unitDiscountValue=i.target.value,e.KtG(a.applyDiscountOnSelectedTestService(n,i.target.value))})("valueChange",function(i){e.CHM(c);const n=e.oxw().$implicit;return e.KtG(n.unitDiscountValue=i)}),e.qZA()()}if(2&r){const c=e.oxw().$implicit;e.xp6(2),e.hij("Discount Amount ",1===c.isPercentage?"(in %)":"(in \u20b9)"," : "),e.xp6(1),e.Q6J("value",c.unitDiscountValue)}}function mn(r,l){if(1&r){const c=e.EpF();e.TgZ(0,"div",30)(1,"div",31)(2,"div",32)(3,"div",33)(4,"button",34),e.NdJ("click",function(){const n=e.CHM(c).index,a=e.oxw();return e.KtG(a.removeTestService(n))}),e._UZ(5,"div",35),e.qZA()(),e.TgZ(6,"div",36)(7,"div",37)(8,"span",38),e._uU(9,"Department : "),e.qZA(),e.TgZ(10,"span",39),e._uU(11),e.qZA()(),e.TgZ(12,"div",37)(13,"span",38),e._uU(14,"Subdepartment : "),e.qZA(),e.TgZ(15,"span",39),e._uU(16),e.qZA()(),e.TgZ(17,"div",37)(18,"span",38),e._uU(19,"Service Name : "),e.qZA(),e.TgZ(20,"span",39),e._uU(21),e.qZA()(),e.TgZ(22,"div",37)(23,"span",38),e._uU(24,"Base Amount (in \u20b9) : "),e.qZA(),e.TgZ(25,"span",39),e._uU(26),e.qZA()(),e.YNc(27,pn,5,2,"div",40),e.YNc(28,dn,4,2,"div",40),e.TgZ(29,"div",37)(30,"span",38),e._uU(31,"Final Amount (in \u20b9) : "),e.qZA(),e.TgZ(32,"span",39),e._uU(33),e.qZA()()()()()()}if(2&r){const c=l.$implicit,t=e.oxw();e.xp6(4),e.Q6J("disableRipple",!0),e.xp6(7),e.Oqu(c.entitySuperParentBusinessName),e.xp6(5),e.Oqu(c.entityParentBusinessName),e.xp6(5),e.Oqu(c.entityBusinessName),e.xp6(5),e.Oqu(c.testBaseCharge),e.xp6(1),e.Q6J("ngIf",!t.entityIsDefaultPrice.value),e.xp6(1),e.Q6J("ngIf",!t.entityIsDefaultPrice.value),e.xp6(5),e.Oqu(c.unitNewPrice)}}let re=(()=>{var r;class l{constructor(t,i,n,a,s){this.loader=t,this.masterService=i,this.authService=n,this._fb=a,this.toastrService=s,this.selectedMasterData={},this.masterList=[],this.submitButtonLabel="Submit",this.testEntitiesList=[],this.testServiceList$=new p.X([]),this.destroySubscription$=new Z.t(1),this.fetchDataOnCloseDialog$=new p.X([])}ngOnInit(){this.getTestServiceList().then(t=>{this.testServiceList$.next(t)}).catch(t=>{this.testServiceList$.next([]),this.toastrService.show({type:"error",text:t})}),this.testPackageForm=this._fb.group({serviceListControl:new o.NI(null),isPercentage:new o.NI(!1),discount:new o.NI(null),flatDiscount:new o.NI({value:null,disabled:!1}),percentageDiscount:new o.NI({value:null,disabled:!0}),entityBusinessName:new o.NI(null,[o.kI.required]),entityBusinessShortCode:new o.NI(null,[o.kI.required]),entityTotalBasePrice:new o.NI(null,[o.kI.required]),entityIsDefaultPrice:new o.NI(!1,[o.kI.required]),entityWholePrice:new o.NI(null,[o.kI.required])}),null!==this.selectedMasterData&&(this.testPackageForm.patchValue(this.selectedMasterData),1==this.selectedMasterData.isPercentage?(this.testPackageForm.controls.flatDiscount.reset(),this.testPackageForm.controls.flatDiscount.disable(),this.testPackageForm.controls.percentageDiscount.enable(),this.testPackageForm.controls.percentageDiscount.setValue(this.selectedMasterData.discount)):(this.testPackageForm.controls.percentageDiscount.reset(),this.testPackageForm.controls.percentageDiscount.disable(),this.testPackageForm.controls.flatDiscount.enable(),this.testPackageForm.controls.flatDiscount.setValue(this.selectedMasterData.discount)),this.testEntitiesList=this.selectedMasterData.testResponseEntities,this.setAmountForTestService())}get isPercentage(){return this.testPackageForm.controls.isPercentage}get flatDiscount(){return this.testPackageForm.controls.flatDiscount}get percentageDiscount(){return this.testPackageForm.controls.percentageDiscount}get entityIsDefaultPrice(){return this.testPackageForm.controls.entityIsDefaultPrice}ngOnDestroy(){this.fetchDataOnCloseDialog$&&this.fetchDataOnCloseDialog$.unsubscribe(),this.destroySubscription$.next(null),this.destroySubscription$.complete()}getTestServiceList(){return new Promise((t,i)=>{this.loader.showSpinner("Loading..."),this.testListSubscription=this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,entityBusinessID:null,mode:"W",detailFlag:null!==this.selectedMasterData,dropDown:!1}},"testservice/getAllTest/").pipe((0,g.R)(this.destroySubscription$)).subscribe(a=>{this.loader.hideSpinner(),"200"===a.statusCode||"300"===a.statusCode?(a.responseList=null==a.responseList?[]:a.responseList,t(a.responseList)):i(a.errorMessage)},a=>{this.loader.hideSpinner(),i("Either Internet is not working or facing internal server issue")})})}flatDiscountOnTestPackage(t){let i=this.testEntitiesList.reduce(function(n,a){return n+Number(a.testBaseCharge)},0);t>i||t<0?(this.toastrService.show({type:"error",text:"Flat Discount amount should be less than Total Base Charge"}),this.testPackageForm.controls.flatDiscount.setValue(null),this.testPackageForm.controls.entityTotalBasePrice.setValue(i.toFixed(2)),this.testPackageForm.controls.entityWholePrice.setValue(i.toFixed(2)),this.testEntitiesList=this.testEntitiesList.map(n=>({...n,isPercentage:0,unitDiscountValue:null,unitNewPrice:n.testBaseCharge})),this.setAmountForTestService()):(this.testEntitiesList=this.testEntitiesList.map(n=>({...n,isPercentage:1,unitDiscountValue:(100-100*(i-t)/i).toFixed(2),unitNewPrice:(n.testBaseCharge-n.testBaseCharge*(100-100*(i-t)/i)/100).toFixed(2)})),this.setAmountForTestService())}changePercentageToggleEvent(t){t?(this.testPackageForm.controls.flatDiscount.reset(),this.testPackageForm.controls.flatDiscount.disable(),this.testPackageForm.controls.percentageDiscount.enable(),this.testEntitiesList=this.testEntitiesList.map(n=>({...n,unitNewPrice:n.testBaseCharge,isPercentage:1,unitDiscountValue:null})),this.isPercentage.setValue(1)):(this.testPackageForm.controls.percentageDiscount.reset(),this.testPackageForm.controls.percentageDiscount.disable(),this.testPackageForm.controls.flatDiscount.enable(),this.testEntitiesList=this.testEntitiesList.map(n=>({...n,unitNewPrice:n.testBaseCharge,isPercentage:0,unitDiscountValue:null})),this.isPercentage.setValue(0));let i=this.testEntitiesList.reduce(function(n,a){return n+Number(a.testBaseCharge)},0);this.testPackageForm.controls.entityTotalBasePrice.setValue(i.toFixed(2)),this.testPackageForm.controls.entityWholePrice.setValue(i.toFixed(2))}percentageDiscountOnTestPackage(t){t>100||t<0?(this.toastrService.show({type:"error",text:"Percentage value should be in between of 1 to 100"}),this.testPackageForm.controls.percentageDiscount.setValue(null),this.testEntitiesList=this.testEntitiesList.map(i=>({...i,isPercentage:1,unitDiscountValue:null,unitNewPrice:i.testBaseCharge}))):this.testEntitiesList=this.testEntitiesList.map(i=>({...i,isPercentage:1,unitDiscountValue:t,unitNewPrice:i.testBaseCharge-t*i.testBaseCharge/100})),this.setAmountForTestService()}applyDiscountOnSelectedTestService(t,i){(null!==this.flatDiscount.value||null!==this.percentageDiscount.value)&&(this.percentageDiscount.reset(),this.percentageDiscount.disable(),this.flatDiscount.enable(),this.flatDiscount.setValue(null),this.percentageDiscount.setValue(null),this.isPercentage.setValue(!1),this.testPackageForm.updateValueAndValidity()),1===t.isPercentage?i>100||i<0?(this.toastrService.show({type:"error",text:"Percentage value should be in between of 1 to 100"}),t.unitDiscountValue=0,t.unitNewPrice=t.testBaseCharge):t.unitNewPrice=t.testBaseCharge-i*t.testBaseCharge/100:i>t.testBaseCharge||i<0?(this.toastrService.show({type:"error",text:"Discount amount should be less than Test Base Charge"}),t.unitDiscountValue=0,t.unitNewPrice=t.testBaseCharge):(t.unitDiscountValue=i,t.unitNewPrice=t.testBaseCharge-i),this.setAmountForTestService()}onChangeOfDropdown(t){let i=this.testServiceList$.getValue();if(this.testEntitiesList.find(a=>a.entityBusinessID===t.value))this.toastrService.show({type:"error",text:t.viewValue+" already in list"});else{let a=i.find(s=>s.entityBusinessID===t.value);if(a={...a,isPercentage:0,unitDiscountValue:null,unitNewPrice:a.testBaseCharge},this.testEntitiesList.push(a),1===this.isPercentage.value)this.percentageDiscountOnTestPackage(this.testPackageForm.controls.percentageDiscount.value);else{let s=this.testPackageForm.controls.flatDiscount.value;null===s?this.setAmountForTestService():this.flatDiscountOnTestPackage(s)}}this.testPackageForm.controls.serviceListControl.setValue(null)}setToDefaultPrice(t){if(1==this.isPercentage.value?(this.testPackageForm.controls.flatDiscount.reset(),this.testPackageForm.controls.flatDiscount.disable(),this.testPackageForm.controls.percentageDiscount.enable(),this.testPackageForm.controls.percentageDiscount.setValue(null)):(this.testPackageForm.controls.percentageDiscount.reset(),this.testPackageForm.controls.percentageDiscount.disable(),this.testPackageForm.controls.flatDiscount.enable(),this.testPackageForm.controls.flatDiscount.setValue(null)),t){let i=this.testEntitiesList.reduce(function(n,a){return n+Number(a.testBaseCharge)},0);this.testPackageForm.controls.entityTotalBasePrice.setValue(i.toFixed(2)),this.testPackageForm.controls.entityWholePrice.setValue(i.toFixed(2)),this.testPackageForm.controls.isPercentage.setValue(0),this.changePercentageToggleEvent(!1),this.testEntitiesList=this.testEntitiesList.map(n=>({...n,unitNewPrice:n.testBaseCharge,isPercentage:0,unitDiscountValue:null}))}else this.setAmountForTestService()}keytab(t,i,n){if(13===t.keyCode){var a=t.srcElement.id.split("-").reduce((s,u)=>(Number(u)&&(u=Number(u)+1),s+"-"+u));document.getElementById(a).focus()}else this._uniqueColumnValidator(t.target.value,i,n)}_uniqueColumnValidator(t,i,n){if(n){const a=null===this.selectedMasterData?{entityBusinessID:null}:this.selectedMasterData;null!=this.masterList.find(u=>u[i].toString().trim().toLowerCase()===t.trim().toLowerCase()&&u.entityBusinessID!=a.entityBusinessID)&&this.testPackageForm.controls[i].setErrors({mustBeUnique:!0})}}removeTestService(t){this.testEntitiesList.splice(t,1),this.setAmountForTestService()}onChangeOfPercentageCheckbox(t,i){return console.log(i.unitDiscountValue),i.isPercentage=t?1:0,this.applyDiscountOnSelectedTestService(i,i.unitDiscountValue),i}setAmountForTestService(){let t=this.testEntitiesList.reduce(function(n,a){return n+Number(a.testBaseCharge)},0),i=this.testEntitiesList.reduce(function(n,a){return n+Number(a.unitNewPrice)},0);this.testPackageForm.controls.entityTotalBasePrice.setValue(Math.round(t).toFixed(2)),this.testPackageForm.controls.entityWholePrice.setValue(Math.round(i).toFixed(2))}onFormSubmit(){const t=this.testPackageForm.value;let i={testPackageRequestEntity:{entityBusinessName:t.entityBusinessName,entityBusinessShortCode:t.entityBusinessShortCode,entityWholePrice:t.entityWholePrice,entityIsDefaultPrice:Number(this.entityIsDefaultPrice.value),entityTotalBasePrice:t.entityTotalBasePrice,isPercentage:Number(this.isPercentage.value),discount:1===this.isPercentage.value?t.percentageDiscount:t.flatDiscount,entityTestRequestEntities:this.testEntitiesList.map(n=>({entityBusinessID:n.entityBusinessID,entityBusinessName:n.entityBusinessName,entitySuperParentBusinessName:n.entitySuperParentBusinessName,testBaseCharge:n.testBaseCharge,isPercentage:n.isPercentage,unitDiscountValue:n.unitDiscountValue,unitNewPrice:n.unitNewPrice,entityParentBusinessID:n.entityParentBusinessID,entitySuperParentBusinessID:n.entitySuperParentBusinessID,activeFlag:n.activeFlag,auditAction:n.auditAction})),activeFlag:1,companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W"}};null===this.selectedMasterData?(i.testPackageRequestEntity=Object.assign(i.testPackageRequestEntity,{auditAction:"C"}),this.masterService.requestActionRestAPI(t,i,"testpackageservice/createEntity","Adding ").then(n=>{this.fetchDataOnCloseDialog$.next([{modifiedObject:n}])}).catch(n=>{this.toastrService.show({type:"error",text:n})})):(i.testPackageRequestEntity=Object.assign(i.testPackageRequestEntity,{entityID:this.selectedMasterData.entityID,entityBusinessID:this.selectedMasterData.entityBusinessID,auditAction:"U"}),this.masterService.requestActionRestAPI(t,i,"testpackageservice/updateEntity","Updating ").then(n=>{this.fetchDataOnCloseDialog$.next([{modifiedObject:n}])}).catch(n=>{this.toastrService.show({type:"error",text:n})}))}}return(r=l).\u0275fac=function(t){return new(t||r)(e.Y36(b.D),e.Y36(v.c),e.Y36(C.$),e.Y36(o.qu),e.Y36(f.k))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-test-package-form"]],inputs:{selectedMasterData:"selectedMasterData",masterList:"masterList",submitButtonLabel:"submitButtonLabel"},decls:57,vars:20,consts:[["autocomplete","off",3,"formGroup"],[1,"container-fluid","test-package-container"],[1,"row","test-package-primary-container"],[1,"col-12","col-md-3","col-lg-3"],[3,"dropdownFor","isRequired","records","formControlsName","idForSelect","dropdownChangeEvent"],[1,"col-12","col-md-3","col-lg-3",3,"ngClass"],[1,"percentage-panel-title"],[1,"col-12","col-md-6","col-lg-6","test-package-percentage-panel",3,"ngClass"],[1,"flat-input-block"],["appearance","outline",1,"test-package-flat-input"],["matInput","","placeholder","Flat","minLength","1","maxLength","10","id","test-package-field-7","formControlName","flatDiscount",3,"keyup"],[1,"percentage-toggle-block"],["id","test-package-field-8","color","primary","formControlName","isPercentage",1,"test-package-toggle",3,"change"],[1,"percentage-input-block"],["appearance","outline",1,"test-package-percentage-input"],["matInput","","placeholder","Percentage","minLength","1","maxLength","3","id","test-package-field-9","formControlName","percentageDiscount",3,"keyup"],[1,"row","test-package-service-main-block"],[1,"col-12","col-md-3","col-lg-3","test-package-secondary-form"],[1,"col-12","col-md-12","col-lg-12"],["appearance","outline",1,"lms-mat-form-field"],["matInput","","placeholder","Package Name*","formControlName","entityBusinessName","minLength","1","maxLength","100","required","","id","test-package-field-2",3,"pattern","keyup"],[4,"ngIf"],["matInput","","placeholder","Abbreviation","formControlName","entityBusinessShortCode","minLength","1","maxLength","10","id","test-package-field-3","required","",3,"pattern","keyup"],["matInput","","placeholder","Base Charge","formControlName","entityTotalBasePrice","minLength","1","maxLength","10","id","test-package-field-4","readonly","",3,"keyup"],["formControlName","entityIsDefaultPrice","id","test-package-field-5","color","primary",1,"test-package-form-checkbox",3,"labelPosition","change"],["matInput","","placeholder","Whole Charge","formControlName","entityWholePrice","minLength","1","maxLength","10","id","test-package-field-6","readonly","",3,"keyup"],[1,"col-12","col-md-9","col-lg-9","test-package-service-list"],[1,"row"],["class","col-12 col-md-6 col-lg-6",4,"ngFor","ngForOf"],[1,"btn","btn-primary","lms-submit-button",3,"disabled","keydown.enter","click"],[1,"col-12","col-md-6","col-lg-6"],[1,"test-package-service-block"],[1,"test-package-service-column"],[1,"action-block"],["mat-icon-button","",1,"delete-test-service",3,"disableRipple","click"],["aria-label","delete",1,"lms-delete-icon"],[1,"label-values-column"],[1,"label-and-name-block"],[1,"label-block"],[1,"name-block"],["class","label-and-name-block",4,"ngIf"],["color","primary",1,"percentage-checkbox",3,"ngClass","checked","change"],["matInput","","placeholder","Discount Amount","minLength","1","maxLength","10",1,"discount-amount-input",3,"value","keyup","valueChange"]],template:function(t,i){1&t&&(e.TgZ(0,"form",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"app-lms-select",4),e.NdJ("dropdownChangeEvent",function(a){return i.onChangeOfDropdown(a)}),e.qZA()(),e.TgZ(5,"div",5)(6,"span",6),e._uU(7,"Overall Discount :"),e.qZA()(),e.TgZ(8,"div",7)(9,"div",8)(10,"mat-form-field",9)(11,"mat-label"),e._uU(12,"Flat"),e.qZA(),e.TgZ(13,"input",10),e.NdJ("keyup",function(a){return i.flatDiscountOnTestPackage(a.target.value)}),e.qZA()()(),e.TgZ(14,"div",11)(15,"mat-slide-toggle",12),e.NdJ("change",function(a){return i.changePercentageToggleEvent(a.checked)}),e.qZA()(),e.TgZ(16,"div",13)(17,"mat-form-field",14)(18,"mat-label"),e._uU(19,"Percentage"),e.qZA(),e.TgZ(20,"input",15),e.NdJ("keyup",function(a){return i.percentageDiscountOnTestPackage(a.target.value)}),e.qZA()()()()(),e.TgZ(21,"div",16)(22,"div",17)(23,"div",18)(24,"mat-form-field",19)(25,"mat-label"),e._uU(26,"Package Name"),e.qZA(),e.TgZ(27,"input",20),e.NdJ("keyup",function(a){return i.keytab(a,"entityBusinessName",!0)}),e.qZA(),e.YNc(28,sn,2,0,"mat-error",21),e.YNc(29,rn,2,0,"mat-error",21),e.YNc(30,on,2,0,"mat-error",21),e.qZA()(),e.TgZ(31,"div",18)(32,"mat-form-field",19)(33,"mat-label"),e._uU(34,"Abbreviation"),e.qZA(),e.TgZ(35,"input",22),e.NdJ("keyup",function(a){return i.keytab(a,"entityBusinessShortCode",!0)}),e.qZA(),e.YNc(36,ln,2,0,"mat-error",21),e.YNc(37,un,2,0,"mat-error",21),e.YNc(38,cn,2,0,"mat-error",21),e.qZA()(),e.TgZ(39,"div",18)(40,"mat-form-field",19)(41,"mat-label"),e._uU(42,"Total Base Charge"),e.qZA(),e.TgZ(43,"input",23),e.NdJ("keyup",function(a){return i.keytab(a,"entityTotalBasePrice",!1)}),e.qZA()()(),e.TgZ(44,"div",18)(45,"mat-checkbox",24),e.NdJ("change",function(a){return i.setToDefaultPrice(a.checked)}),e._uU(46," Set to Default Price "),e.qZA()(),e.TgZ(47,"div",18)(48,"mat-form-field",19)(49,"mat-label"),e._uU(50,"Whole Charge"),e.qZA(),e.TgZ(51,"input",25),e.NdJ("keyup",function(a){return i.keytab(a,"entityWholePrice",!1)}),e.qZA()()()(),e.TgZ(52,"div",26)(53,"div",27),e.YNc(54,mn,34,8,"div",28),e.qZA()()()(),e.TgZ(55,"button",29),e.NdJ("keydown.enter",function(a){return a.preventDefault()})("click",function(){return i.onFormSubmit()}),e._uU(56),e.qZA()()),2&t&&(e.Q6J("formGroup",i.testPackageForm),e.xp6(4),e.Q6J("dropdownFor","Service List")("isRequired",!1)("records",i.testServiceList$)("formControlsName",i.testPackageForm.get("serviceListControl"))("idForSelect","test-package-field-1"),e.xp6(1),e.Q6J("ngClass",i.entityIsDefaultPrice.value?"disable-div-block":null),e.xp6(3),e.Q6J("ngClass",i.entityIsDefaultPrice.value?"disable-div-block":null),e.xp6(19),e.Q6J("pattern","[^]*"),e.xp6(1),e.Q6J("ngIf",null==i.testPackageForm.controls.entityBusinessName||null==i.testPackageForm.controls.entityBusinessName.errors?null:i.testPackageForm.controls.entityBusinessName.errors.required),e.xp6(1),e.Q6J("ngIf",null==i.testPackageForm.controls.entityBusinessName||null==i.testPackageForm.controls.entityBusinessName.errors?null:i.testPackageForm.controls.entityBusinessName.errors.pattern),e.xp6(1),e.Q6J("ngIf",null==i.testPackageForm.controls.entityBusinessName||null==i.testPackageForm.controls.entityBusinessName.errors?null:i.testPackageForm.controls.entityBusinessName.errors.mustBeUnique),e.xp6(5),e.Q6J("pattern","[^]*"),e.xp6(1),e.Q6J("ngIf",null==i.testPackageForm.controls.entityBusinessShortCode||null==i.testPackageForm.controls.entityBusinessShortCode.errors?null:i.testPackageForm.controls.entityBusinessShortCode.errors.required),e.xp6(1),e.Q6J("ngIf",null==i.testPackageForm.controls.entityBusinessShortCode||null==i.testPackageForm.controls.entityBusinessShortCode.errors?null:i.testPackageForm.controls.entityBusinessShortCode.errors.pattern),e.xp6(1),e.Q6J("ngIf",null==i.testPackageForm.controls.entityBusinessShortCode||null==i.testPackageForm.controls.entityBusinessShortCode.errors?null:i.testPackageForm.controls.entityBusinessShortCode.errors.mustBeUnique),e.xp6(7),e.Q6J("labelPosition","after"),e.xp6(9),e.Q6J("ngForOf",i.testEntitiesList),e.xp6(1),e.Q6J("disabled",i.testPackageForm.invalid),e.xp6(1),e.hij(" ",i.submitButtonLabel," "))},dependencies:[D.mk,D.sg,D.O5,o._Y,o.Fj,o.JJ,o.JL,o.Q7,o.c5,o.sg,o.u,k.P,_.RK,M.oG,x.Nt,y.KE,y.hX,y.TO,w.Rr],styles:[".test-package-container[_ngcontent-%COMP%]{margin-top:10px}.test-package-service-list[_ngcontent-%COMP%]{overflow:auto;height:48vh}@media (max-width: 766px){.test-package-service-list[_ngcontent-%COMP%]{height:auto;overflow:hidden}}.test-package-primary-container[_ngcontent-%COMP%]{position:sticky!important;top:-5px!important;z-index:999!important;background:white}.test-package-form-checkbox[_ngcontent-%COMP%]{display:flex;flex-direction:row;margin-bottom:6px}@media (max-width: 766px){.test-package-form-checkbox[_ngcontent-%COMP%]{margin-top:0}}.test-package-service-main-block[_ngcontent-%COMP%]{display:flex;flex-direction:row}@media (max-width: 766px){.test-package-service-main-block[_ngcontent-%COMP%]{margin-left:-4%;flex-direction:column-reverse}}.test-package-secondary-form[_ngcontent-%COMP%]{margin-left:-1%}@media (max-width: 766px){.test-package-secondary-form[_ngcontent-%COMP%]{margin-left:-4%}}.percentage-panel-title[_ngcontent-%COMP%]{font-weight:700;display:flex;flex-direction:row;margin-top:16px;font-size:15px}@media (max-width: 766px){.percentage-panel-title[_ngcontent-%COMP%]{margin-top:0;margin-bottom:10px}}.test-package-percentage-panel[_ngcontent-%COMP%]{display:flex;flex-direction:row;margin-left:-7%}@media (max-width: 766px){.test-package-percentage-panel[_ngcontent-%COMP%]{margin-left:0}}.flat-input-block[_ngcontent-%COMP%]{width:40%;margin-right:-22%}@media (max-width: 766px){.flat-input-block[_ngcontent-%COMP%]{margin-right:0}}.test-package-flat-input[_ngcontent-%COMP%]{width:50%}@media (max-width: 766px){.test-package-flat-input[_ngcontent-%COMP%]{width:85%}}.percentage-toggle-block[_ngcontent-%COMP%]{width:15%;margin-left:2%}.test-package-toggle[_ngcontent-%COMP%]{display:flex;flex-direction:row;margin-top:14px;margin-left:14px}@media (max-width: 766px){.test-package-toggle[_ngcontent-%COMP%]{margin-left:-8px}}.percentage-input-block[_ngcontent-%COMP%]{width:40%}.test-package-percentage-input[_ngcontent-%COMP%]{width:50%;margin-left:0}@media (max-width: 766px){.test-package-percentage-input[_ngcontent-%COMP%]{width:85%}}.test-package-service-block[_ngcontent-%COMP%]{background:#e6e6e6;cursor:pointer}.test-package-service-block[_ngcontent-%COMP%]   .test-package-service-column[_ngcontent-%COMP%]{display:flex;flex-direction:column;color:#1f1f1b;font-size:14px;margin-bottom:4%}.label-values-column[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-top:-35px}.label-and-name-block[_ngcontent-%COMP%]{float:left;margin-left:10px;margin-top:7px;margin-bottom:5px}.delete-test-service[_ngcontent-%COMP%]{float:right}.label-block[_ngcontent-%COMP%]{display:inline;font-size:14px;font-weight:bolder}.name-block[_ngcontent-%COMP%]{display:inline;font-size:13px}.percentage-checkbox[_ngcontent-%COMP%]{position:relative;top:3px;left:10px}.discount-amount-input[_ngcontent-%COMP%]{width:45%;border:2px solid #d7d7d7;border-radius:10px;padding-left:7px}.disable-div-block[_ngcontent-%COMP%]{pointer-events:none;opacity:.4}.not-clickable[_ngcontent-%COMP%]{pointer-events:none}"]}),l})(),hn=(()=>{var r;class l{constructor(t,i,n,a,s,u){this.loader=t,this.toastrService=i,this.masterService=n,this.exportService=a,this.authService=s,this.dialog=u,this.testPackageList$=new p.X([]),this.inlineEditFlag=!1,this.showLogCheckedFlag=!1,this.gridOptions=new F.s8,this.changeDetection=new A.x,this.showFormBlock=!1,this.totalSubcription$=[]}ngOnInit(){this.getTestPackageList(!1).then(t=>{this.testPackageList$.next(t)}).catch(t=>{this.testPackageList$.next([]),this.toastrService.show({type:"error",text:t})}),this.gridOptions={searchPlaceholder:"Search Test Package",pageSize:this.authService.pageSize,dateFormat:"yyyy-MM-dd",keyCodeForNextCell:13,showInlineEdit:this.inlineEditFlag,titleForMobileView:"entityBusinessName",pageSizeArray:[5,10,20],showDeleteButton:!1,showAddButton:!0,showEditButton:!0,showActivateDeactivateButton:!0,showSearchInput:!0,activateDeactivateCondition:{conditionalProperty:"activeFlag",valueForActivation:"1",valueForDeactivation:"0"},columns:[{name:"entityBusinessName",label:"Test Package",enable:!0,searchable:!0,sortable:!0,type:"text"},{name:"entityBusinessShortCode",label:"Abbreviation",enable:!0,searchable:!0,sortable:!0,type:"text",editable:!1},{name:"entityTotalBasePrice",label:"Total Amount (\u20b9)",enable:!0,searchable:!0,sortable:!0,type:"text"},{name:"entityWholePrice",label:"Payable Amount (\u20b9)",enable:!0,searchable:!0,sortable:!0,type:"text"},{name:"createdByUser",label:"Last Updated By",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"effectiveDateFrom",label:"Last Modified on",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"activeFlag",label:"",enable:!1,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1}]}}ngOnDestroy(){this.totalSubcription$&&this.totalSubcription$.forEach(t=>{t.unsubscribe()})}getTestPackageList(t){return new Promise((i,n)=>{this.loader.showSpinner("Test Package list on the way!");const s=this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W",detailFlag:t,dropDown:!1}},"testpackageservice/getAllEntity").subscribe(u=>{this.loader.hideSpinner(),"200"===u.statusCode||"300"===u.statusCode?(u.responseList=null==u.responseList?[]:u.responseList.reverse(),i(u.responseList)):n(u.errorMessage)},u=>{this.loader.hideSpinner(),n("Either Internet is not working or facing internal server issue")});this.totalSubcription$.push(s)})}exportData(t){const i=[{property:"entityBusinessName",label:"Test Package"},{property:"entityBusinessShortCode",label:"Abbreviation"},{property:"entityTotalBasePrice",label:"Total Amount (\u20b9)"},{property:"entityWholePrice",label:"Payable Amount (\u20b9)"},{property:"createdByUser",label:"Last Updated By"},{property:"effectiveDateFrom",label:"Last Modified on"}];this.showLogCheckedFlag&&i.push({property:"auditAction",label:"Audit Action"}),this.exportService.generateFile(this.testPackageList$.getValue(),"Test Package List."+t,i)}showLog(t){this.testPackageList$.next([]),t?this.getTestPackageList(!0).then(i=>{this.showLogCheckedFlag=!0,this.testPackageList$.next(i),this.gridOptions.showAddButton=!1,this.gridOptions.showEditButton=!1,this.gridOptions.showActivateDeactivateButton=!1,this.gridOptions.columns.push({name:"auditAction",label:"Audit Action",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1})}).catch(i=>{this.testPackageList$.next([]),this.toastrService.show({type:"error",text:i})}):(this.showLogCheckedFlag=!1,this.ngOnInit())}initiateAddTestPackage(t){this.dialog.open(B.s,{disableClose:!0,data:{header:"Test Package Form",buttonLabel:"Submit",records:{selectedItem:t,uniqueItemList:this.testPackageList$.getValue().map(n=>({entityBusinessID:n.entityBusinessID,entityBusinessName:n.entityBusinessName,entityBusinessShortCode:n.entityBusinessShortCode}))},component:re},animation:{to:"right"},position:{top:"50vh",left:"50vw"},panelClass:"lms-dialog-box-center"}).afterClosed().subscribe(n=>{if(null!==n){let a=this.testPackageList$.getValue();a.unshift(n[0].modifiedObject),this.testPackageList$.next(a),this.toastrService.show({type:"success",text:n[0].modifiedObject.entityBusinessName+" Created!"})}})}initiateUpdateTestPackage(t){this.dialog.open(B.s,{disableClose:!0,data:{header:"Test Package Form",buttonLabel:"Update",records:{selectedItem:t,uniqueItemList:this.testPackageList$.getValue().map(n=>({entityBusinessID:n.entityBusinessID,entityBusinessName:n.entityBusinessName,entityBusinessShortCode:n.entityBusinessShortCode}))},component:re},animation:{to:"right"},position:{top:"50vh",left:"50vw"},panelClass:"lms-dialog-box-center"}).afterClosed().subscribe(n=>{if(null!==n){let a=this.testPackageList$.getValue(),s=a.findIndex(u=>u.entityBusinessID==n[0].modifiedObject.entityBusinessID);a[s]=n[0].modifiedObject,this.testPackageList$.next(a),this.toastrService.show({type:"success",text:n[0].modifiedObject.entityBusinessName+" Updated!"})}})}activateTestPackage(t){this.masterService.requestActionRestAPI(t,{testPackageRequestEntity:{entityID:t.entityID,entityBusinessID:t.entityBusinessID,auditAction:"A",companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W"}},"testpackageservice/activateEntity","Activating ").then(n=>{this.changeDetection.next({originalObject:t,modifiedObject:n}),this.toastrService.show({type:"success",text:t.entityBusinessName+" Activated!"})}).catch(n=>{this.toastrService.show({type:"error",text:n})})}deactivateTestPackage(t){this.masterService.requestActionRestAPI(t,{testPackageRequestEntity:{entityID:t.entityID,entityBusinessID:t.entityBusinessID,auditAction:"D",companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W"}},"testpackageservice/deactivateEntity","Deactivating ").then(n=>{this.changeDetection.next({originalObject:t,modifiedObject:n}),this.toastrService.show({type:"success",text:t.entityBusinessName+" Deactivated!"})}).catch(n=>{this.toastrService.show({type:"error",text:n})})}}return(r=l).\u0275fac=function(t){return new(t||r)(e.Y36(b.D),e.Y36(f.k),e.Y36(v.c),e.Y36(N.u),e.Y36(C.$),e.Y36(q.Y))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-test-package-master"]],decls:16,vars:3,consts:[[1,"test-package-container"],[1,"test-package-table"],[1,"container-fluid"],[1,"row"],["childLink","General Master","subchildLink","Test Package Master"],[1,"mat-elevation-z12","lms-master-card"],[1,"lms-matcardtitlegroup"],["mat-icon-button","",3,"disableRipple","click"],["aria-label","excel",1,"lms-excel-icon"],["aria-label","csv",1,"lms-csv-icon"],[1,"remaining-space"],["color","primary",1,"lms-matslidetoggle",3,"checked","change"]],template:function(t,i){1&t&&(e._UZ(0,"app-header"),e.TgZ(1,"div",0)(2,"div",1)(3,"div",2)(4,"div",3),e._UZ(5,"app-breadcrumb",4),e.qZA(),e.TgZ(6,"div",3)(7,"mat-card",5)(8,"mat-card-title-group",6)(9,"button",7),e.NdJ("click",function(){return i.exportData("xlsx")}),e._UZ(10,"div",8),e.qZA(),e.TgZ(11,"button",7),e.NdJ("click",function(){return i.exportData("csv")}),e._UZ(12,"div",9),e.qZA(),e._UZ(13,"span",10),e.TgZ(14,"mat-slide-toggle",11),e.NdJ("change",function(a){return i.showLog(a.checked)}),e._uU(15," Show Logs "),e.qZA()()()()()()()),2&t&&(e.xp6(9),e.Q6J("disableRipple",!0),e.xp6(2),e.Q6J("disableRipple",!0),e.xp6(3),e.Q6J("checked",i.showLogCheckedFlag))},dependencies:[S.G,_.RK,d.a8,d.C1,w.Rr,I.L],styles:[".test-package-container[_ngcontent-%COMP%]{position:relative}.test-package-table[_ngcontent-%COMP%]{position:absolute}.test-package-form[_ngcontent-%COMP%]{z-index:999;height:auto;background:#f5f5f5;cursor:pointer}.hidden[_ngcontent-%COMP%]{height:0px;width:100vw;opacity:0;transition:height,.5s linear}.hidden.open[_ngcontent-%COMP%]{opacity:1;z-index:999;height:auto;width:100vw;transition:height,.5s linear}"]}),l})();function yn(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Template Name is required field. "),e.qZA())}function gn(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Please match the requested format. "),e.qZA())}function bn(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Template Name is already taken. "),e.qZA())}function fn(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Please match the requested format. "),e.qZA())}function vn(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Abbreviation is already taken. "),e.qZA())}let oe=(()=>{var r;class l{constructor(t,i,n,a,s){this.loader=t,this.masterService=i,this.authService=n,this.fb=a,this.toastrService=s,this.selectedMasterData={},this.masterList=[],this.submitButtonLabel="Submit",this.departmentList$=new p.X([]),this.subdepartmentList$=new p.X([]),this.testList$=new p.X([]),this.designationList$=new p.X([]),this.fetchDataOnCloseDialog$=new p.X([])}ngOnInit(){if(this.testTemplateForm=this.fb.group({entitySuperParentBusinessID:new o.NI(null,[o.kI.required]),entityParentBusinessID:new o.NI(null,[o.kI.required]),entityTestID:new o.NI(null,[o.kI.required]),entityBusinessName:new o.NI(null,[o.kI.required]),entityBusinessShortCode:new o.NI(null),entityTemplateContent:new o.NI(null,[o.kI.required])}),null!==this.selectedMasterData){this.getDepartmentList().then(i=>{this.departmentList$.next(i),this.getSubdepartmentList(this.selectedMasterData.entitySuperParentBusinessID).then(n=>{this.subdepartmentList$.next(n),this.getTestList(this.selectedMasterData.entityParentBusinessID).then(a=>{this.testList$.next(a)}).catch(a=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}).catch(n=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}).catch(i=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})});const t=Object.entries(this.testTemplateForm.value).reduce((i,[n,a])=>(i[n]=this.selectedMasterData[n],i),{});this.testTemplateForm.patchValue(t)}else this.getDepartmentList().then(t=>{this.departmentList$.next(t)}).catch(t=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}getDepartmentList(){return new Promise((t,i)=>{this.loader.showSpinner("Loading..."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,entityBusinessID:null,mode:"W",detailFlag:null!==this.selectedMasterData,dropDown:!0}},"departmentservice/getAllDepartment").subscribe(a=>{this.loader.hideSpinner(),"200"===a.statusCode||"300"===a.statusCode?(a.responseList=null==a.responseList?[]:a.responseList,t(a.responseList)):i(a.errorMessage)},a=>{this.loader.hideSpinner(),i("Either Internet is not working or facing internal server issue")})})}getSubdepartmentList(t){return new Promise((i,n)=>{this.loader.showSpinner("Loading..."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,entityBusinessID:t,mode:"W",detailFlag:null!==this.selectedMasterData,dropDown:!0}},"subdepartmentservice/getAllSubDepartment/").subscribe(s=>{this.loader.hideSpinner(),"200"===s.statusCode||"300"===s.statusCode?(s.responseList=null==s.responseList?[]:s.responseList,i(s.responseList)):n(s.errorMessage)},s=>{this.loader.hideSpinner(),n("Either Internet is not working or facing internal server issue")})})}getTestList(t){return new Promise((i,n)=>{this.loader.showSpinner("Loading..."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,entityBusinessID:t,mode:"W",detailFlag:null!==this.selectedMasterData,dropDown:!0}},"testservice/getAllTest/").subscribe(s=>{this.loader.hideSpinner(),"200"===s.statusCode||"300"===s.statusCode?(s.responseList=null==s.responseList?[]:s.responseList,i(s.responseList)):n(s.errorMessage)},s=>{this.loader.hideSpinner(),n("Either Internet is not working or facing internal server issue")})})}keytab(t,i,n){if(13===t.keyCode){var a=t.srcElement.id.split("-").reduce((s,u)=>(Number(u)&&(u=Number(u)+1),s+"-"+u));document.getElementById(a).focus()}else this._uniqueColumnValidator(t.target.value,i,n)}_uniqueColumnValidator(t,i,n){if(n){const a=null===this.selectedMasterData?{entityBusinessID:null}:this.selectedMasterData;null!=this.masterList.find(u=>null!==u[i]&&u[i].toString().trim().toLowerCase()===t.trim().toLowerCase()&&u.entityBusinessID!=a.entityBusinessID)&&this.testTemplateForm.controls[i].setErrors({mustBeUnique:!0})}}onChangeOfDropdown(t){switch(t.type){case"Department":this.getSubdepartmentList(t.value).then(i=>{this.subdepartmentList$.next(i)}).catch(i=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})});break;case"Subdepartment":this.getTestList(t.value).then(i=>{this.testList$.next(i)}).catch(i=>{this.toastrService.show({type:"error",text:this.authService.randomErrorForAPIFallback})})}}updatetestTemplateForm(){null===this.selectedMasterData?this.addNewTestTemplate(this.testTemplateForm.value):this.updateTestTemplate(this.selectedMasterData,this.testTemplateForm.value)}addNewTestTemplate(t){this.masterService.requestActionRestAPI(t,{testTemplateRequestEntity:{entityBusinessName:t.entityBusinessName,entityBusinessShortCode:t.entityBusinessShortCode,entitySuperParentBusinessID:t.entitySuperParentBusinessID,entityParentBusinessID:t.entityParentBusinessID,entityTestID:t.entityTestID,entityTemplateContent:t.entityTemplateContent,companyID:this.authService.companyID,createdBy:this.authService.employeeID,auditAction:"C",mode:"W"}},"testtemplateservice/createTestTemplate/","Adding ").then(n=>{this.fetchDataOnCloseDialog$.next([{modifiedObject:n}])}).catch(n=>{this.toastrService.show({type:"error",text:n})})}updateTestTemplate(t,i){this.masterService.requestActionRestAPI(i,{testTemplateRequestEntity:{entityID:t.entityID,entityBusinessID:t.entityBusinessID,entityBusinessName:i.entityBusinessName,entityBusinessShortCode:i.entityBusinessShortCode,entitySuperParentBusinessID:i.entitySuperParentBusinessID,entityParentBusinessID:i.entityParentBusinessID,entityTestID:i.entityTestID,entityTemplateContent:i.entityTemplateContent,companyID:this.authService.companyID,createdBy:this.authService.employeeID,auditAction:"U",mode:"W"}},"testtemplateservice/updateTestTemplate/","Updating ").then(a=>{this.fetchDataOnCloseDialog$.next([{modifiedObject:a}])}).catch(a=>{this.toastrService.show({type:"error",text:a})})}ngOnDestroy(){this.fetchDataOnCloseDialog$&&(this.fetchDataOnCloseDialog$.unsubscribe(),this.departmentList$.unsubscribe(),this.subdepartmentList$.unsubscribe(),this.testList$.unsubscribe(),this.designationList$.unsubscribe())}}return(r=l).\u0275fac=function(t){return new(t||r)(e.Y36(b.D),e.Y36(v.c),e.Y36(C.$),e.Y36(o.qu),e.Y36(f.k))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-test-template-form"]],inputs:{selectedMasterData:"selectedMasterData",masterList:"masterList",submitButtonLabel:"submitButtonLabel"},decls:28,vars:27,consts:[["autocomplete","off",3,"formGroup"],[1,"container-fluid","test-template-container"],[1,"row"],[1,"col-12","col-md-6","col-lg-4"],[3,"dropdownFor","isRequired","records","formControlsName","idForSelect","dropdownChangeEvent"],["appearance","outline",1,"lms-mat-form-field"],["matInput","","placeholder","Template Name*","formControlName","entityBusinessName","minLength","1","maxLength","100","required","","id","test-template-4",3,"pattern","keyup"],[4,"ngIf"],["matInput","","placeholder","Abbreviation","formControlName","entityBusinessShortCode","minLength","1","maxLength","10","id","test-template-5",3,"pattern","keyup"],[1,"col-12","col-md-12","col-lg-12"],["editorHeight","280px",3,"editorControl","requiredFlag"],[1,"btn","btn-primary","lms-submit-button",3,"disabled","click","keydown.enter"]],template:function(t,i){1&t&&(e.TgZ(0,"form",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"app-lms-select",4),e.NdJ("dropdownChangeEvent",function(a){return i.onChangeOfDropdown(a)}),e.qZA()(),e.TgZ(5,"div",3)(6,"app-lms-select",4),e.NdJ("dropdownChangeEvent",function(a){return i.onChangeOfDropdown(a)}),e.qZA()(),e.TgZ(7,"div",3)(8,"app-lms-select",4),e.NdJ("dropdownChangeEvent",function(a){return i.onChangeOfDropdown(a)}),e.qZA()(),e.TgZ(9,"div",3)(10,"mat-form-field",5)(11,"mat-label"),e._uU(12,"Template Name"),e.qZA(),e.TgZ(13,"input",6),e.NdJ("keyup",function(a){return i.keytab(a,"entityBusinessName",!0)}),e.qZA(),e.YNc(14,yn,2,0,"mat-error",7),e.YNc(15,gn,2,0,"mat-error",7),e.YNc(16,bn,2,0,"mat-error",7),e.qZA()(),e.TgZ(17,"div",3)(18,"mat-form-field",5)(19,"mat-label"),e._uU(20,"Abbreviation"),e.qZA(),e.TgZ(21,"input",8),e.NdJ("keyup",function(a){return i.keytab(a,"entityBusinessShortCode",!0)}),e.qZA(),e.YNc(22,fn,2,0,"mat-error",7),e.YNc(23,vn,2,0,"mat-error",7),e.qZA()(),e.TgZ(24,"div",9),e._UZ(25,"app-editor",10),e.qZA()()(),e.TgZ(26,"button",11),e.NdJ("click",function(){return i.updatetestTemplateForm()})("keydown.enter",function(a){return a.preventDefault()}),e._uU(27),e.qZA()()),2&t&&(e.Q6J("formGroup",i.testTemplateForm),e.xp6(4),e.Q6J("dropdownFor","Department")("isRequired",!0)("records",i.departmentList$)("formControlsName",i.testTemplateForm.controls.entitySuperParentBusinessID)("idForSelect","test-template-1"),e.xp6(2),e.Q6J("dropdownFor","Subdepartment")("isRequired",!0)("records",i.subdepartmentList$)("formControlsName",i.testTemplateForm.controls.entityParentBusinessID)("idForSelect","test-template-2"),e.xp6(2),e.Q6J("dropdownFor","Test")("isRequired",!0)("records",i.testList$)("formControlsName",i.testTemplateForm.controls.entityTestID)("idForSelect","test-template-3"),e.xp6(5),e.Q6J("pattern","[^]*"),e.xp6(1),e.Q6J("ngIf",null==i.testTemplateForm.controls.entityBusinessName||null==i.testTemplateForm.controls.entityBusinessName.errors?null:i.testTemplateForm.controls.entityBusinessName.errors.required),e.xp6(1),e.Q6J("ngIf",null==i.testTemplateForm.controls.entityBusinessName||null==i.testTemplateForm.controls.entityBusinessName.errors?null:i.testTemplateForm.controls.entityBusinessName.errors.pattern),e.xp6(1),e.Q6J("ngIf",null==i.testTemplateForm.controls.entityBusinessName||null==i.testTemplateForm.controls.entityBusinessName.errors?null:i.testTemplateForm.controls.entityBusinessName.errors.mustBeUnique),e.xp6(5),e.Q6J("pattern","[^]*"),e.xp6(1),e.Q6J("ngIf",null==i.testTemplateForm.controls.entityBusinessShortCode||null==i.testTemplateForm.controls.entityBusinessShortCode.errors?null:i.testTemplateForm.controls.entityBusinessShortCode.errors.pattern),e.xp6(1),e.Q6J("ngIf",null==i.testTemplateForm.controls.entityBusinessShortCode||null==i.testTemplateForm.controls.entityBusinessShortCode.errors?null:i.testTemplateForm.controls.entityBusinessShortCode.errors.mustBeUnique),e.xp6(2),e.Q6J("editorControl",i.testTemplateForm.controls.entityTemplateContent)("requiredFlag",!0),e.xp6(1),e.Q6J("disabled",i.testTemplateForm.invalid),e.xp6(1),e.hij(" ",i.submitButtonLabel," "))},dependencies:[D.O5,o._Y,o.Fj,o.JJ,o.JL,o.Q7,o.c5,o.sg,o.u,k.P,ae.P,x.Nt,y.KE,y.hX,y.TO],styles:[".test-template-container[_ngcontent-%COMP%]{margin-top:12px}"]}),l})();const Cn=[{path:"country",component:Xe},{path:"state",component:$i},{path:"city",component:he},{path:"department",component:Ve},{path:"subdepartment",component:Qi},{path:"role",component:Ui},{path:"designation",component:Ke},{path:"salutation",component:Ji},{path:"bloodgroup",component:de},{path:"referralmaster",component:Ri},{path:"insurancemaster",component:Kt},{path:"corporatemaster",component:ze},{path:"testcomponent",component:Wi},{path:"testpackagemaster",component:hn},{path:"unitmeasurement",component:(()=>{var r;class l{constructor(t,i,n,a,s){this.loader=t,this.masterService=i,this.exportService=n,this.authService=a,this.toastrService=s,this.unitMeasurementList$=new p.X([]),this.inlineEditFlag=!0,this.showLogCheckedFlag=!1,this.gridOptions=new F.s8,this.changeDetection=new A.x,this.disableToggleFlag=!1}ngOnInit(){this.getUnitMeasurementList(!1).then(t=>{this.unitMeasurementList$.next(t)}).catch(t=>{this.unitMeasurementList$.next([]),this.toastrService.show({type:"error",text:t})}),this.gridOptions={searchPlaceholder:"Search Unit",pageSize:this.authService.pageSize,dateFormat:"yyyy-MM-dd",keyCodeForNextCell:13,showInlineEdit:this.inlineEditFlag,titleForMobileView:"entityBusinessName",pageSizeArray:[5,10,20],showDeleteButton:!1,showAddButton:!0,showEditButton:!0,showActivateDeactivateButton:!0,showSearchInput:!0,activateDeactivateCondition:{conditionalProperty:"activeFlag",valueForActivation:"1",valueForDeactivation:"0"},columns:[{name:"entityBusinessName",label:"Unit Name",enable:!0,searchable:!0,sortable:!0,type:"text",editable:!0,isRequired:!0,shouldBeUnique:!0,min:1,max:100,pattern:"[^]*",columnPlaceholder:"Unit Name",requiredLabel:"Please enter unit name",patternLabel:"Please match the requested format."},{name:"entityBusinessShortCode",label:"Abbreviation",enable:!0,searchable:!0,sortable:!0,type:"text",editable:!0,isRequired:!0,shouldBeUnique:!0,min:1,max:100,pattern:"[^]*",columnPlaceholder:"Abbreviation",requiredLabel:"Please enter abbreviation",patternLabel:"Please match the requested format."},{name:"classificationType",label:"Classification Type",enable:!0,sortable:!1,searchable:!0,type:"text",editable:!0,isRequired:!1,min:1,max:100,pattern:"[^]*",columnPlaceholder:"Classification Type",patternLabel:"Please match the requested format."},{name:"createdByUser",label:"Last Updated By",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"effectiveDateFrom",label:"Created On",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"activeFlag",label:"",enable:!1,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"entityID",label:"",enable:!1,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"entityBusinessID",label:"",enable:!1,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1}]}}getUnitMeasurementList(t){return new Promise((i,n)=>{this.loader.showSpinner("Unit list on the way."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W",detailFlag:t,dropDown:!1}},"unitmeasurementservice/getAllUnitMeasurement/").subscribe(s=>{this.loader.hideSpinner(),"200"===s.statusCode||"300"===s.statusCode?(s.responseList=null==s.responseList?[]:s.responseList,i(s.responseList)):n(s.errorMessage)},s=>{this.loader.hideSpinner(),n("Either Internet is not working or facing internal server issue")})})}exportData(t){const i=[{property:"entityBusinessName",label:"Unit Name"},{property:"entityBusinessShortCode",label:"Abbreviation"},{property:"classificationType",label:"Classification Type"},{property:"createdByUser",label:"Last Updated By"},{property:"effectiveDateFrom",label:"Created On"}];this.showLogCheckedFlag&&i.push({property:"auditAction",label:"Audit Action"}),this.exportService.generateFile(this.unitMeasurementList$.getValue(),"Unit Measurement List."+t,i)}showLog(t){this.unitMeasurementList$.next([]),t?this.getUnitMeasurementList(!0).then(i=>{this.showLogCheckedFlag=!0,this.unitMeasurementList$.next(i),this.gridOptions.showAddButton=!1,this.gridOptions.showEditButton=!1,this.gridOptions.showActivateDeactivateButton=!1,this.gridOptions.columns.push({name:"auditAction",label:"Audit Action",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1})}).catch(i=>{this.unitMeasurementList$.next([]),this.toastrService.show({type:"error",text:i})}):(this.showLogCheckedFlag=!1,this.ngOnInit())}addNewUnit(t){this.masterService.requestActionRestAPI(t,{unitMeasurementRequest:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,entityBusinessName:t.entityBusinessName,entityBusinessShortCode:t.entityBusinessShortCode,classificationType:t.classificationType,auditAction:"C",mode:"W"}},"unitmeasurementservice/createUnitMeasurement/","Adding ").then(n=>{this.changeDetection.next({originalObject:t,modifiedObject:n}),this.toastrService.show({type:"success",text:t.entityBusinessName+" Added!"}),this.disableToggleFlag=!1,this.gridOptions.showActivateDeactivateButton=!0}).catch(n=>{this.changeDetection.next({originalObject:t,modifiedObject:void 0}),this.disableToggleFlag=!0,this.gridOptions.showActivateDeactivateButton=!1,this.toastrService.show({type:"error",text:n})})}updateUnit(t){this.masterService.requestActionRestAPI(t,{unitMeasurementRequest:{entityID:t.entityID,entityBusinessID:t.entityBusinessID,entityBusinessName:t.entityBusinessName,entityBusinessShortCode:t.entityBusinessShortCode,classificationType:t.classificationType,auditAction:"U",companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W"}},"unitmeasurementservice/updateUnitMeasurement/","Updating ").then(n=>{this.changeDetection.next({originalObject:t,modifiedObject:n}),this.toastrService.show({type:"success",text:t.entityBusinessName+" Updated!"}),this.disableToggleFlag=!1,this.gridOptions.showActivateDeactivateButton=!0}).catch(n=>{this.changeDetection.next({originalObject:t,modifiedObject:void 0}),this.disableToggleFlag=!0,this.gridOptions.showActivateDeactivateButton=!1,this.toastrService.show({type:"error",text:n})})}actionButtonClickEvent(t,i){switch(i){case"add":case"update":this.disableToggleFlag=!0,this.gridOptions.showActivateDeactivateButton=!1;break;case"cancel":this.disableToggleFlag=!1,this.gridOptions.showActivateDeactivateButton=!0}}activateUnit(t){this.masterService.requestActionRestAPI(t,{unitMeasurementRequest:{entityID:t.entityID,entityBusinessID:t.entityBusinessID,entityBusinessName:t.entityBusinessName,entityBusinessShortCode:t.entityBusinessShortCode,classificationType:t.classificationType,auditAction:"A",companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W"}},"unitmeasurementservice/activateUnitMeasurement","Activating ").then(n=>{this.changeDetection.next({originalObject:t,modifiedObject:n}),this.toastrService.show({type:"success",text:t.entityBusinessName+" Activated!"})}).catch(n=>{this.changeDetection.next({originalObject:t,modifiedObject:void 0}),this.toastrService.show({type:"error",text:n})})}deactivateUnit(t){this.masterService.requestActionRestAPI(t,{unitMeasurementRequest:{entityID:t.entityID,entityBusinessID:t.entityBusinessID,entityBusinessName:t.entityBusinessName,entityBusinessShortCode:t.entityBusinessShortCode,classificationType:t.classificationType,auditAction:"D",companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W"}},"unitmeasurementservice/deactivateUnitMeasurement","Deactivating ").then(n=>{this.changeDetection.next({originalObject:t,modifiedObject:n}),this.toastrService.show({type:"success",text:t.entityBusinessName+" Deactivated!"})}).catch(n=>{this.changeDetection.next({originalObject:t,modifiedObject:void 0}),this.toastrService.show({type:"error",text:n})})}}return(r=l).\u0275fac=function(t){return new(t||r)(e.Y36(b.D),e.Y36(v.c),e.Y36(N.u),e.Y36(C.$),e.Y36(f.k))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-unit-measurement"]],decls:14,vars:4,consts:[[1,"container-fluid"],[1,"row"],["childLink","General Master","subchildLink","Unit Measurement"],[1,"mat-elevation-z12","lms-master-card"],[1,"lms-matcardtitlegroup"],["mat-icon-button","",3,"disableRipple","click"],["aria-label","excel",1,"lms-excel-icon"],["aria-label","csv",1,"lms-csv-icon"],[1,"remaining-space"],["color","primary",1,"lms-matslidetoggle",3,"checked","disabled","change"]],template:function(t,i){1&t&&(e._UZ(0,"app-header"),e.TgZ(1,"div",0)(2,"div",1),e._UZ(3,"app-breadcrumb",2),e.qZA(),e.TgZ(4,"div",1)(5,"mat-card",3)(6,"mat-card-title-group",4)(7,"button",5),e.NdJ("click",function(){return i.exportData("xlsx")}),e._UZ(8,"div",6),e.qZA(),e.TgZ(9,"button",5),e.NdJ("click",function(){return i.exportData("csv")}),e._UZ(10,"div",7),e.qZA(),e._UZ(11,"span",8),e.TgZ(12,"mat-slide-toggle",9),e.NdJ("change",function(a){return i.showLog(a.checked)}),e._uU(13," Show Logs "),e.qZA()()()()()),2&t&&(e.xp6(7),e.Q6J("disableRipple",!0),e.xp6(2),e.Q6J("disableRipple",!0),e.xp6(3),e.Q6J("checked",i.showLogCheckedFlag)("disabled",i.disableToggleFlag))},dependencies:[S.G,_.RK,d.a8,d.C1,w.Rr,I.L]}),l})()},{path:"employee",component:xt},{path:"patient",component:Di},{path:"testmaster",component:an},{path:"category",component:me},{path:"clubmember",component:ye},{path:"testcomponentmapping",component:ji},{path:"company",component:Ze},{path:"test-template-master",component:(()=>{var r;class l{constructor(t,i,n,a,s,u){this.loader=t,this.toastrService=i,this.masterService=n,this.exportService=a,this.authService=s,this.dialog=u,this.testTemplateList$=new p.X([]),this.inlineEditFlag=!1,this.showLogCheckedFlag=!1,this.gridOptions=new F.s8,this.changeDetection=new A.x}ngOnInit(){this.getTestTemplateList(!1).then(t=>{this.testTemplateList$.next(t)}).catch(t=>{this.testTemplateList$.next([]),this.toastrService.show({type:"error",text:t})}),this.gridOptions={searchPlaceholder:"Search Test Template",pageSize:this.authService.pageSize,dateFormat:"yyyy-MM-dd",keyCodeForNextCell:13,showInlineEdit:this.inlineEditFlag,titleForMobileView:"entityBusinessName",pageSizeArray:[5,10,20],showDeleteButton:!1,showAddButton:!0,showEditButton:!0,showActivateDeactivateButton:!0,showSearchInput:!0,activateDeactivateCondition:{conditionalProperty:"activeFlag",valueForActivation:"1",valueForDeactivation:"0"},columns:[{name:"entitySuperParentBusinessName",label:"Department",enable:!0,searchable:!0,sortable:!0,type:"text"},{name:"entityParentBusinessName",label:"Sub Department",enable:!0,searchable:!0,sortable:!0,type:"text"},{name:"entityTestName",label:"Test",enable:!0,searchable:!0,sortable:!0,type:"text"},{name:"entityBusinessName",label:"Test Template",enable:!0,searchable:!0,sortable:!0,type:"text"},{name:"entityBusinessShortCode",label:"Abbreviation",enable:!0,searchable:!0,sortable:!0,type:"text",editable:!1},{name:"createdByUser",label:"Last Updated By",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"effectiveDateFrom",label:"Last Modified on",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"activeFlag",label:"",enable:!1,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"entityID",label:"",enable:!1,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"entityBusinessID",label:"",enable:!1,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1}]}}getTestTemplateList(t){return new Promise((i,n)=>{this.loader.showSpinner("Test Template list on the way!"),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W",detailFlag:t,dropDown:!1}},"testtemplateservice/getAllTestTemplate/").subscribe(s=>{this.loader.hideSpinner(),"200"===s.statusCode||"300"===s.statusCode?(s.responseList=null==s.responseList?[]:s.responseList,i(s.responseList)):n(s.errorMessage)},s=>{this.loader.hideSpinner(),n("Either Internet is not working or facing internal server issue")})})}exportData(t){const i=[{property:"entitySuperParentBusinessName",label:"Department"},{property:"entityParentBusinessName",label:"Sub Department"},{property:"entityTestName",label:"Test"},{property:"entityBusinessName",label:"Test Template"},{property:"entityBusinessShortCode",label:"Abbreviation"},{property:"createdByUser",label:"Last Updated By"},{property:"effectiveDateFrom",label:"Last Modified on"}];this.showLogCheckedFlag&&i.push({property:"auditAction",label:"Audit Action"}),this.exportService.generateFile(this.testTemplateList$.getValue(),"Test Template List."+t,i)}showLog(t){this.testTemplateList$.next([]),t?this.getTestTemplateList(!0).then(i=>{this.showLogCheckedFlag=!0,this.testTemplateList$.next(i),this.gridOptions.showAddButton=!1,this.gridOptions.showEditButton=!1,this.gridOptions.showActivateDeactivateButton=!1,this.gridOptions.columns.push({name:"auditAction",label:"Audit Action",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1})}).catch(i=>{this.testTemplateList$.next([]),this.toastrService.show({type:"error",text:i})}):(this.showLogCheckedFlag=!1,this.ngOnInit())}initiateAddTestTemplate(t){this.dialog.open(B.s,{disableClose:!0,data:{header:"Test Template Form",buttonLabel:"Submit",records:{selectedItem:t,uniqueItemList:this.testTemplateList$.getValue().map(n=>({entityBusinessID:n.entityBusinessID,entityBusinessName:n.entityBusinessName,entityBusinessShortCode:n.entityBusinessShortCode}))},component:oe},animation:{to:"right"},position:{top:"50vh",left:"50vw"},panelClass:"lms-dialog-box-center"}).afterClosed().subscribe(n=>{if(null!==n){let a=this.testTemplateList$.getValue();a.unshift(n[0].modifiedObject),this.testTemplateList$.next(a),this.toastrService.show({type:"success",text:n[0].modifiedObject.entityBusinessName+" Created!"})}})}initiateUpdateTestTemplate(t){this.dialog.open(B.s,{disableClose:!0,data:{header:"Test Template Form",buttonLabel:"Update",records:{selectedItem:t,uniqueItemList:this.testTemplateList$.getValue().map(n=>({entityBusinessID:n.entityBusinessID,entityBusinessName:n.entityBusinessName,entityBusinessShortCode:n.entityBusinessShortCode}))},component:oe},animation:{to:"right"},position:{top:"50vh",left:"50vw"},panelClass:"lms-dialog-box-center"}).afterClosed().subscribe(n=>{if(null!==n){let a=this.testTemplateList$.getValue(),s=a.findIndex(u=>u.entityBusinessID==n[0].modifiedObject.entityBusinessID);a[s]=n[0].modifiedObject,this.testTemplateList$.next(a),this.toastrService.show({type:"success",text:n[0].modifiedObject.entityBusinessName+" Updated!"})}})}activateTestTemplate(t){this.masterService.requestActionRestAPI(t,{testTemplateRequestEntity:{entityID:t.entityID,entityBusinessID:t.entityBusinessID,entityBusinessName:t.entityBusinessName,entityBusinessShortCode:t.entityBusinessShortCode,entitySuperParentBusinessID:t.entitySuperParentBusinessID,entityParentBusinessID:t.entityParentBusinessID,entityTestID:t.entityTestID,entityTemplateContent:t.entityTemplateContent,auditAction:"A",companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W"}},"testtemplateservice/activateTestTemplate","Activating ").then(n=>{this.changeDetection.next({originalObject:t,modifiedObject:n}),this.toastrService.show({type:"success",text:t.entityBusinessName+" Activated!"})}).catch(n=>{this.toastrService.show({type:"error",text:n})})}deactivateTestTemplate(t){this.masterService.requestActionRestAPI(t,{testTemplateRequestEntity:{entityID:t.entityID,entityBusinessID:t.entityBusinessID,entityBusinessName:t.entityBusinessName,entityBusinessShortCode:t.entityBusinessShortCode,entitySuperParentBusinessID:t.entitySuperParentBusinessID,entityParentBusinessID:t.entityParentBusinessID,entityTestID:t.entityTestID,entityTemplateContent:t.entityTemplateContent,auditAction:"D",companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W"}},"testtemplateservice/deactivateTestTemplate","Deactivating ").then(n=>{this.changeDetection.next({originalObject:t,modifiedObject:n}),this.toastrService.show({type:"success",text:t.entityBusinessName+" Deactivated!"})}).catch(n=>{this.toastrService.show({type:"error",text:n})})}}return(r=l).\u0275fac=function(t){return new(t||r)(e.Y36(b.D),e.Y36(f.k),e.Y36(v.c),e.Y36(N.u),e.Y36(C.$),e.Y36(q.Y))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-test-template-master"]],decls:14,vars:3,consts:[[1,"container-fluid"],[1,"row"],["childLink","General Master","subchildLink","Test Template Master"],[1,"mat-elevation-z12","lms-master-card"],[1,"lms-matcardtitlegroup"],["mat-icon-button","",3,"disableRipple","click"],["aria-label","excel",1,"lms-excel-icon"],["aria-label","csv",1,"lms-csv-icon"],[1,"remaining-space"],["color","primary",1,"lms-matslidetoggle",3,"checked","change"]],template:function(t,i){1&t&&(e._UZ(0,"app-header"),e.TgZ(1,"div",0)(2,"div",1),e._UZ(3,"app-breadcrumb",2),e.qZA(),e.TgZ(4,"div",1)(5,"mat-card",3)(6,"mat-card-title-group",4)(7,"button",5),e.NdJ("click",function(){return i.exportData("xlsx")}),e._UZ(8,"div",6),e.qZA(),e.TgZ(9,"button",5),e.NdJ("click",function(){return i.exportData("csv")}),e._UZ(10,"div",7),e.qZA(),e._UZ(11,"span",8),e.TgZ(12,"mat-slide-toggle",9),e.NdJ("change",function(a){return i.showLog(a.checked)}),e._uU(13," Show Logs "),e.qZA()()()()()),2&t&&(e.xp6(7),e.Q6J("disableRipple",!0),e.xp6(2),e.Q6J("disableRipple",!0),e.xp6(3),e.Q6J("checked",i.showLogCheckedFlag))},dependencies:[S.G,_.RK,d.a8,d.C1,w.Rr,I.L]}),l})()},{path:"referralchargemapping",component:Ni},{path:"usertestgroupmapping",component:pe},{path:"",pathMatch:"full",redirectTo:"country"}];let Dn=(()=>{var r;class l{}return(r=l).\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[W.Bz.forChild(Cn),W.Bz]}),l})();var _n=h(9820),Sn=h(6611);let In=(()=>{var r;class l{}return(r=l).\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[D.ez,Dn,_n.m,Sn.q,o.u5,o.UX]}),l})()}}]);