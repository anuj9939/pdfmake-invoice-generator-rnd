"use strict";(self.webpackChunklms_web_app=self.webpackChunklms_web_app||[]).push([[338],{1338:(gg,Pi,E)=>{E.r(Pi),E.d(Pi,{ReportsModule:()=>mg});var gr=E(6814),Bi=E(1896),G=E(5861),Le=E(8),j=E(5619),Ie=E(8645),Pe=E(7328),ee=E(9773),i=E(5879),Be=E(8586),ze=E(8394),Ze=E(9250),$e=E(3493),Ue=E(8738),rt=E(2198),it=E(1786),qe=E(2242),R=E(6223),te=E(2296),ne=E(5195),N=E(8034),He=E(2032),z=E(5683),Ge=E(3424);const zi=()=>document.createElement("a");function ds(e,t){let n=e;if("string"==typeof e){const r=e.split(";base64,"),a=r[0],o=atob(r[1]),l=new Uint8Array(o.length);for(let s=0;s<o.length;s++)l[s]=o.charCodeAt(s);n=new Blob([l.buffer],{type:a})}navigator.msSaveBlob(n,t)}function fs(e,t){let n=e;window.Blob&&e instanceof Blob&&(n=URL.createObjectURL(e));const r=zi();r.download=t,r.href=n;const a=document.createEvent("MouseEvents");a.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),r.dispatchEvent(a),setTimeout(()=>URL.revokeObjectURL(n))}function hs(e,t,n){if(!n.proxyURL)return;const r=document.createElement("form");r.setAttribute("action",n.proxyURL),r.setAttribute("method","POST"),r.setAttribute("target",n.proxyTarget||"_self");const a=n.proxyData||{};a.fileName=t;const o=e.split(";base64,");a.contentType=o[0].replace("data:",""),a.base64=o[1];for(let l in a)if(a.hasOwnProperty(l)){const s=document.createElement("input");s.setAttribute("type","hidden"),s.setAttribute("name",l),s.setAttribute("value",a[l]),r.appendChild(s)}document.body.appendChild(r),r.submit(),document.body.removeChild(r)}let Zi={toString:e=>e};const $i=class ms{static register(t){Zi=t}static toString(t,n){return Zi.toString(t,n)}};let Ui={compile:function(e){return e}};const _n=class gs{static register(t){Ui=t}static compile(t){return Ui.compile(t)}},xs=/\[(?:(\d+)|['"](.*?)['"])\]|((?:(?!\[.*?\]|\.).)+)/g,Ft={},qi="undefined";function Hi(e){if(Ft[e])return Ft[e];const t=[];return e.replace(xs,function(n,r,a,o){t.push(typeof r!==qi?r:a||o)}),Ft[e]=function(n){let r=n;for(let a=0;a<t.length&&r;a++)r=r[t[a]];return r},Ft[e]}function Ce(e,t){return e.reduce((n,r,a)=>{const o=t(r,a);return null!=o&&n.push(o),n},[])}function _s(e){return`${e.title}: ${e.value}`}function xr(e,t){const n=[];for(let r=0;r<e;r++)n.push(t(r));return n}function bs(e){return e.id}Ft[qi]=function(e){return e};var Yi=4,Vi=0,Qi=1,ji=2;function Os(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Wi(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var n=t.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(var r in n)Os(n,r)&&(e[r]=n[r])}}return e}function wn(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)}var Lt={arraySet:function(e,t,n,r,a){if(t.subarray&&e.subarray)e.set(t.subarray(n,n+r),a);else for(var o=0;o<r;o++)e[a+o]=t[n+o]},flattenChunks:function(e){var t,n,r,a,o,l;for(r=0,t=0,n=e.length;t<n;t++)r+=e[t].length;for(l=new Uint8Array(r),a=0,t=0,n=e.length;t<n;t++)l.set(o=e[t],a),a+=o.length;return l},Buf8:function(e){return new Uint8Array(e)},Buf16:function(e){return new Uint16Array(e)},Buf32:function(e){return new Int32Array(e)}},It={arraySet:function(e,t,n,r,a){for(var o=0;o<r;o++)e[a+o]=t[n+o]},flattenChunks:function(e){return[].concat.apply([],e)},Buf8:function(e){return new Array(e)},Buf16:function(e){return new Array(e)},Buf32:function(e){return new Array(e)}};let _t=()=>{const e=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";return _t=()=>e,e},se=(e,t,n,r,a)=>(se=_t()?Lt.arraySet:It.arraySet,se(e,t,n,r,a)),Cn=e=>(Cn=_t()?Lt.flattenChunks:It.flattenChunks,Cn(e)),ke=e=>(ke=_t()?Lt.Buf8:It.Buf8,ke(e)),oe=e=>(oe=_t()?Lt.Buf16:It.Buf16,oe(e)),bt=e=>(bt=_t()?Lt.Buf32:It.Buf32,bt(e)),Xi=function(){let e=!0;try{String.fromCharCode.apply(null,[0])}catch{e=!1}return Xi=()=>e,e},Ki=function(){let e=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{e=!1}return Ki=()=>e,e},_r=function(e){for(var t=ke(256),n=0;n<256;n++)t[n]=n>=252?6:n>=248?5:n>=240?4:n>=224?3:n>=192?2:1;return t[254]=t[254]=1,_r=r=>t[r],t[e]};function Sn(e){var t,n,r,a,o,l=e.length,s=0;for(a=0;a<l;a++)55296==(64512&(n=e.charCodeAt(a)))&&a+1<l&&56320==(64512&(r=e.charCodeAt(a+1)))&&(n=65536+(n-55296<<10)+(r-56320),a++),s+=n<128?1:n<2048?2:n<65536?3:4;for(t=new Uint8Array(s),o=0,a=0;o<s;a++)55296==(64512&(n=e.charCodeAt(a)))&&a+1<l&&56320==(64512&(r=e.charCodeAt(a+1)))&&(n=65536+(n-55296<<10)+(r-56320),a++),n<128?t[o++]=n:n<2048?(t[o++]=192|n>>>6,t[o++]=128|63&n):n<65536?(t[o++]=224|n>>>12,t[o++]=128|n>>>6&63,t[o++]=128|63&n):(t[o++]=240|n>>>18,t[o++]=128|n>>>12&63,t[o++]=128|n>>>6&63,t[o++]=128|63&n);return t}function ea(e,t){if(t<65534&&(e.subarray&&Ki()||!e.subarray&&Xi()))return String.fromCharCode.apply(null,wn(e,t));for(var n="",r=0;r<t;r++)n+=String.fromCharCode(e[r]);return n}function Es(e,t){var n,r,a,o,l=t||e.length,s=new Array(2*l);for(r=0,n=0;n<l;)if((a=e[n++])<128)s[r++]=a;else if((o=_r(a))>4)s[r++]=65533,n+=o-1;else{for(a&=2===o?31:3===o?15:7;o>1&&n<l;)a=a<<6|63&e[n++],o--;o>1?s[r++]=65533:a<65536?s[r++]=a:(s[r++]=55296|(a-=65536)>>10&1023,s[r++]=56320|1023&a)}return ea(s,r)}function Ns(e,t){var n;for((t=t||e.length)>e.length&&(t=e.length),n=t-1;n>=0&&128==(192&e[n]);)n--;return n<0||0===n?t:n+_r(e[n])>t?n:t}function Pt(e,t,n,r){for(var a=65535&e|0,o=e>>>16&65535|0,l=0;0!==n;){n-=l=n>2e3?2e3:n;do{o=o+(a=a+t[r++]|0)|0}while(--l);a%=65521,o%=65521}return a|o<<16|0}let ta=function(){const e=function Fs(){for(var e,t=[],n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}();return ta=()=>e,e};function V(e,t,n,r){var a=ta(),o=r+n;e^=-1;for(var l=r;l<o;l++)e=e>>>8^a[255&(e^t[l])];return-1^e}var kn=30,Ls=12;function Is(e,t){var n,r,a,o,l,s,c,u,d,m,f,p,_,k,v,D,x,C,b,g,w,y,M,A,S;A=e.input,a=(r=e.next_in)+(e.avail_in-5),S=e.output,l=(o=e.next_out)-(t-e.avail_out),s=o+(e.avail_out-257),c=(n=e.state).dmax,u=n.wsize,d=n.whave,m=n.wnext,f=n.window,p=n.hold,_=n.bits,k=n.lencode,v=n.distcode,D=(1<<n.lenbits)-1,x=(1<<n.distbits)-1;e:do{_<15&&(p+=A[r++]<<_,p+=A[r++]<<(_+=8),_+=8),C=k[p&D];t:for(;;){if(p>>>=b=C>>>24,_-=b,0==(b=C>>>16&255))S[o++]=65535&C;else{if(!(16&b)){if(64&b){if(32&b){n.mode=Ls;break e}e.msg="invalid literal/length code",n.mode=kn;break e}C=k[(65535&C)+(p&(1<<b)-1)];continue t}for(g=65535&C,(b&=15)&&(_<b&&(p+=A[r++]<<_,_+=8),g+=p&(1<<b)-1,p>>>=b,_-=b),_<15&&(p+=A[r++]<<_,p+=A[r++]<<(_+=8),_+=8),C=v[p&x];;){if(p>>>=b=C>>>24,_-=b,16&(b=C>>>16&255)){if(w=65535&C,_<(b&=15)&&(p+=A[r++]<<_,(_+=8)<b&&(p+=A[r++]<<_,_+=8)),(w+=p&(1<<b)-1)>c){e.msg="invalid distance too far back",n.mode=kn;break e}if(p>>>=b,_-=b,w>(b=o-l)){if((b=w-b)>d&&n.sane){e.msg="invalid distance too far back",n.mode=kn;break e}if(y=0,M=f,0===m){if(y+=u-b,b<g){g-=b;do{S[o++]=f[y++]}while(--b);y=o-w,M=S}}else if(m<b){if(y+=u+m-b,(b-=m)<g){g-=b;do{S[o++]=f[y++]}while(--b);if(y=0,m<g){g-=b=m;do{S[o++]=f[y++]}while(--b);y=o-w,M=S}}}else if(y+=m-b,b<g){g-=b;do{S[o++]=f[y++]}while(--b);y=o-w,M=S}for(;g>2;)S[o++]=M[y++],S[o++]=M[y++],S[o++]=M[y++],g-=3;g&&(S[o++]=M[y++],g>1&&(S[o++]=M[y++]))}else{y=o-w;do{S[o++]=S[y++],S[o++]=S[y++],S[o++]=S[y++],g-=3}while(g>2);g&&(S[o++]=S[y++],g>1&&(S[o++]=S[y++]))}break}if(64&b){e.msg="invalid distance code",n.mode=kn;break e}C=v[(65535&C)+(p&(1<<b)-1)]}}break}}while(r<a&&o<s);p&=(1<<(_-=(g=_>>3)<<3))-1,e.next_in=r-=g,e.next_out=o,e.avail_in=r<a?a-r+5:5-(r-a),e.avail_out=o<s?s-o+257:257-(o-s),n.hold=p,n.bits=_}var yt=15,na=852,ra=592,ia=0,br=1,aa=2,Ps=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],Bs=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],zs=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],Zs=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];function Bt(e,t,n,r,a,o,l,s){var C,b,g,w,y,S,ss,pr,mr,c=s.bits,u=0,d=0,m=0,f=0,p=0,_=0,k=0,v=0,D=0,x=0,M=null,A=0,O=oe(yt+1),K=oe(yt+1),ue=null,ls=0;for(u=0;u<=yt;u++)O[u]=0;for(d=0;d<r;d++)O[t[n+d]]++;for(p=c,f=yt;f>=1&&0===O[f];f--);if(p>f&&(p=f),0===f)return a[o++]=20971520,a[o++]=20971520,s.bits=1,0;for(m=1;m<f&&0===O[m];m++);for(p<m&&(p=m),v=1,u=1;u<=yt;u++)if(v<<=1,(v-=O[u])<0)return-1;if(v>0&&(e===ia||1!==f))return-1;for(K[1]=0,u=1;u<yt;u++)K[u+1]=K[u]+O[u];for(d=0;d<r;d++)0!==t[n+d]&&(l[K[t[n+d]]++]=d);if(e===ia?(M=ue=l,S=19):e===br?(M=Ps,A-=257,ue=Bs,ls-=257,S=256):(M=zs,ue=Zs,S=-1),x=0,d=0,u=m,y=o,_=p,k=0,g=-1,w=(D=1<<p)-1,e===br&&D>na||e===aa&&D>ra)return 1;for(;;){ss=u-k,l[d]<S?(pr=0,mr=l[d]):l[d]>S?(pr=ue[ls+l[d]],mr=M[A+l[d]]):(pr=96,mr=0),C=1<<u-k,m=b=1<<_;do{a[y+(x>>k)+(b-=C)]=ss<<24|pr<<16|mr|0}while(0!==b);for(C=1<<u-1;x&C;)C>>=1;if(0!==C?(x&=C-1,x+=C):x=0,d++,0==--O[u]){if(u===f)break;u=t[n+l[d]]}if(u>p&&(x&w)!==g){for(0===k&&(k=p),y+=m,v=1<<(_=u-k);_+k<f&&!((v-=O[_+k])<=0);)_++,v<<=1;if(D+=1<<_,e===br&&D>na||e===aa&&D>ra)return 1;a[g=x&w]=p<<24|_<<16|y-o|0}}return 0!==x&&(a[y+x]=u-k<<24|64<<16|0),s.bits=p,0}var oa=1,la=2,at=0,fe=-2,fa=1,Z=30,Ys=852,Vs=592;function La(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function Qs(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=oe(320),this.work=oe(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function Ks(e,t){var n,r;return e?(r=new Qs,e.state=r,r.window=null,n=function Xs(e,t){var n,r;return!e||!e.state||(r=e.state,t<0?(n=0,t=-t):(n=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15))?fe:(null!==r.window&&r.wbits!==t&&(r.window=null),r.wrap=n,r.wbits=t,function Ws(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,function js(e){var t;return e&&e.state?(e.total_in=e.total_out=(t=e.state).total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=fa,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=bt(Ys),t.distcode=t.distdyn=bt(Vs),t.sane=1,t.back=-1,at):fe}(e)):fe}(e))}(e,t),n!==at&&(e.state=null),n):fe}var wr,Cr,Ia=!0;function ec(e){if(Ia){var t;for(wr=bt(512),Cr=bt(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(Bt(oa,e.lens,0,288,wr,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;Bt(la,e.lens,0,32,Cr,0,e.work,{bits:5}),Ia=!1}e.lencode=wr,e.lenbits=9,e.distcode=Cr,e.distbits=5}function Pa(e,t,n,r){var a,o=e.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=ke(o.wsize)),r>=o.wsize?(se(o.window,t,n-o.wsize,o.wsize,0),o.wnext=0,o.whave=o.wsize):((a=o.wsize-o.wnext)>r&&(a=r),se(o.window,t,n-r,a,o.wnext),(r-=a)?(se(o.window,t,n-r,r,0),o.wnext=r,o.whave=o.wsize):(o.wnext+=a,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=a))),0}function tc(e,t){var n,r,a,o,l,s,c,u,d,m,f,p,_,k,D,x,C,b,g,w,y,M,S,O,v=0,A=ke(4),K=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return fe;12===(n=e.state).mode&&(n.mode=13),l=e.next_out,a=e.output,o=e.next_in,r=e.input,u=n.hold,d=n.bits,m=s=e.avail_in,f=c=e.avail_out,M=at;e:for(;;)switch(n.mode){case fa:if(0===n.wrap){n.mode=13;break}for(;d<16;){if(0===s)break e;s--,u+=r[o++]<<d,d+=8}if(2&n.wrap&&35615===u){n.check=0,A[0]=255&u,A[1]=u>>>8&255,n.check=V(n.check,A,2,0),u=0,d=0,n.mode=2;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&u)<<8)+(u>>8))%31){e.msg="incorrect header check",n.mode=Z;break}if(8!=(15&u)){e.msg="unknown compression method",n.mode=Z;break}if(d-=4,y=8+(15&(u>>>=4)),0===n.wbits)n.wbits=y;else if(y>n.wbits){e.msg="invalid window size",n.mode=Z;break}n.dmax=1<<y,e.adler=n.check=1,n.mode=512&u?10:12,u=0,d=0;break;case 2:for(;d<16;){if(0===s)break e;s--,u+=r[o++]<<d,d+=8}if(n.flags=u,8!=(255&n.flags)){e.msg="unknown compression method",n.mode=Z;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=Z;break}n.head&&(n.head.text=u>>8&1),512&n.flags&&(A[0]=255&u,A[1]=u>>>8&255,n.check=V(n.check,A,2,0)),u=0,d=0,n.mode=3;case 3:for(;d<32;){if(0===s)break e;s--,u+=r[o++]<<d,d+=8}n.head&&(n.head.time=u),512&n.flags&&(A[0]=255&u,A[1]=u>>>8&255,A[2]=u>>>16&255,A[3]=u>>>24&255,n.check=V(n.check,A,4,0)),u=0,d=0,n.mode=4;case 4:for(;d<16;){if(0===s)break e;s--,u+=r[o++]<<d,d+=8}n.head&&(n.head.xflags=255&u,n.head.os=u>>8),512&n.flags&&(A[0]=255&u,A[1]=u>>>8&255,n.check=V(n.check,A,2,0)),u=0,d=0,n.mode=5;case 5:if(1024&n.flags){for(;d<16;){if(0===s)break e;s--,u+=r[o++]<<d,d+=8}n.length=u,n.head&&(n.head.extra_len=u),512&n.flags&&(A[0]=255&u,A[1]=u>>>8&255,n.check=V(n.check,A,2,0)),u=0,d=0}else n.head&&(n.head.extra=null);n.mode=6;case 6:if(1024&n.flags&&((p=n.length)>s&&(p=s),p&&(n.head&&(y=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),se(n.head.extra,r,o,p,y)),512&n.flags&&(n.check=V(n.check,r,p,o)),s-=p,o+=p,n.length-=p),n.length))break e;n.length=0,n.mode=7;case 7:if(2048&n.flags){if(0===s)break e;p=0;do{y=r[o+p++],n.head&&y&&n.length<65536&&(n.head.name+=String.fromCharCode(y))}while(y&&p<s);if(512&n.flags&&(n.check=V(n.check,r,p,o)),s-=p,o+=p,y)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=8;case 8:if(4096&n.flags){if(0===s)break e;p=0;do{y=r[o+p++],n.head&&y&&n.length<65536&&(n.head.comment+=String.fromCharCode(y))}while(y&&p<s);if(512&n.flags&&(n.check=V(n.check,r,p,o)),s-=p,o+=p,y)break e}else n.head&&(n.head.comment=null);n.mode=9;case 9:if(512&n.flags){for(;d<16;){if(0===s)break e;s--,u+=r[o++]<<d,d+=8}if(u!==(65535&n.check)){e.msg="header crc mismatch",n.mode=Z;break}u=0,d=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=12;break;case 10:for(;d<32;){if(0===s)break e;s--,u+=r[o++]<<d,d+=8}e.adler=n.check=La(u),u=0,d=0,n.mode=11;case 11:if(0===n.havedict)return e.next_out=l,e.avail_out=c,e.next_in=o,e.avail_in=s,n.hold=u,n.bits=d,2;e.adler=n.check=1,n.mode=12;case 12:if(5===t||6===t)break e;case 13:if(n.last){u>>>=7&d,d-=7&d,n.mode=27;break}for(;d<3;){if(0===s)break e;s--,u+=r[o++]<<d,d+=8}switch(n.last=1&u,d-=1,3&(u>>>=1)){case 0:n.mode=14;break;case 1:if(ec(n),n.mode=20,6===t){u>>>=2,d-=2;break e}break;case 2:n.mode=17;break;case 3:e.msg="invalid block type",n.mode=Z}u>>>=2,d-=2;break;case 14:for(u>>>=7&d,d-=7&d;d<32;){if(0===s)break e;s--,u+=r[o++]<<d,d+=8}if((65535&u)!=(u>>>16^65535)){e.msg="invalid stored block lengths",n.mode=Z;break}if(n.length=65535&u,u=0,d=0,n.mode=15,6===t)break e;case 15:n.mode=16;case 16:if(p=n.length){if(p>s&&(p=s),p>c&&(p=c),0===p)break e;se(a,r,o,p,l),s-=p,o+=p,c-=p,l+=p,n.length-=p;break}n.mode=12;break;case 17:for(;d<14;){if(0===s)break e;s--,u+=r[o++]<<d,d+=8}if(n.nlen=257+(31&u),d-=5,n.ndist=1+(31&(u>>>=5)),d-=5,n.ncode=4+(15&(u>>>=5)),u>>>=4,d-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=Z;break}n.have=0,n.mode=18;case 18:for(;n.have<n.ncode;){for(;d<3;){if(0===s)break e;s--,u+=r[o++]<<d,d+=8}n.lens[K[n.have++]]=7&u,u>>>=3,d-=3}for(;n.have<19;)n.lens[K[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,M=Bt(0,n.lens,0,19,n.lencode,0,n.work,S={bits:n.lenbits}),n.lenbits=S.bits,M){e.msg="invalid code lengths set",n.mode=Z;break}n.have=0,n.mode=19;case 19:for(;n.have<n.nlen+n.ndist;){for(;x=(v=n.lencode[u&(1<<n.lenbits)-1])>>>16&255,C=65535&v,!((D=v>>>24)<=d);){if(0===s)break e;s--,u+=r[o++]<<d,d+=8}if(C<16)u>>>=D,d-=D,n.lens[n.have++]=C;else{if(16===C){for(O=D+2;d<O;){if(0===s)break e;s--,u+=r[o++]<<d,d+=8}if(u>>>=D,d-=D,0===n.have){e.msg="invalid bit length repeat",n.mode=Z;break}y=n.lens[n.have-1],p=3+(3&u),u>>>=2,d-=2}else if(17===C){for(O=D+3;d<O;){if(0===s)break e;s--,u+=r[o++]<<d,d+=8}d-=D,y=0,p=3+(7&(u>>>=D)),u>>>=3,d-=3}else{for(O=D+7;d<O;){if(0===s)break e;s--,u+=r[o++]<<d,d+=8}d-=D,y=0,p=11+(127&(u>>>=D)),u>>>=7,d-=7}if(n.have+p>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=Z;break}for(;p--;)n.lens[n.have++]=y}}if(n.mode===Z)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=Z;break}if(n.lenbits=9,M=Bt(oa,n.lens,0,n.nlen,n.lencode,0,n.work,S={bits:n.lenbits}),n.lenbits=S.bits,M){e.msg="invalid literal/lengths set",n.mode=Z;break}if(n.distbits=6,n.distcode=n.distdyn,M=Bt(la,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,S={bits:n.distbits}),n.distbits=S.bits,M){e.msg="invalid distances set",n.mode=Z;break}if(n.mode=20,6===t)break e;case 20:n.mode=21;case 21:if(s>=6&&c>=258){e.next_out=l,e.avail_out=c,e.next_in=o,e.avail_in=s,n.hold=u,n.bits=d,Is(e,f),l=e.next_out,a=e.output,c=e.avail_out,o=e.next_in,r=e.input,s=e.avail_in,u=n.hold,d=n.bits,12===n.mode&&(n.back=-1);break}for(n.back=0;x=(v=n.lencode[u&(1<<n.lenbits)-1])>>>16&255,C=65535&v,!((D=v>>>24)<=d);){if(0===s)break e;s--,u+=r[o++]<<d,d+=8}if(x&&!(240&x)){for(b=D,g=x,w=C;x=(v=n.lencode[w+((u&(1<<b+g)-1)>>b)])>>>16&255,C=65535&v,!(b+(D=v>>>24)<=d);){if(0===s)break e;s--,u+=r[o++]<<d,d+=8}u>>>=b,d-=b,n.back+=b}if(u>>>=D,d-=D,n.back+=D,n.length=C,0===x){n.mode=26;break}if(32&x){n.back=-1,n.mode=12;break}if(64&x){e.msg="invalid literal/length code",n.mode=Z;break}n.extra=15&x,n.mode=22;case 22:if(n.extra){for(O=n.extra;d<O;){if(0===s)break e;s--,u+=r[o++]<<d,d+=8}n.length+=u&(1<<n.extra)-1,u>>>=n.extra,d-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=23;case 23:for(;x=(v=n.distcode[u&(1<<n.distbits)-1])>>>16&255,C=65535&v,!((D=v>>>24)<=d);){if(0===s)break e;s--,u+=r[o++]<<d,d+=8}if(!(240&x)){for(b=D,g=x,w=C;x=(v=n.distcode[w+((u&(1<<b+g)-1)>>b)])>>>16&255,C=65535&v,!(b+(D=v>>>24)<=d);){if(0===s)break e;s--,u+=r[o++]<<d,d+=8}u>>>=b,d-=b,n.back+=b}if(u>>>=D,d-=D,n.back+=D,64&x){e.msg="invalid distance code",n.mode=Z;break}n.offset=C,n.extra=15&x,n.mode=24;case 24:if(n.extra){for(O=n.extra;d<O;){if(0===s)break e;s--,u+=r[o++]<<d,d+=8}n.offset+=u&(1<<n.extra)-1,u>>>=n.extra,d-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=Z;break}n.mode=25;case 25:if(0===c)break e;if(n.offset>(p=f-c)){if((p=n.offset-p)>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=Z;break}_=p>n.wnext?n.wsize-(p-=n.wnext):n.wnext-p,p>n.length&&(p=n.length),k=n.window}else k=a,_=l-n.offset,p=n.length;p>c&&(p=c),c-=p,n.length-=p;do{a[l++]=k[_++]}while(--p);0===n.length&&(n.mode=21);break;case 26:if(0===c)break e;a[l++]=n.length,c--,n.mode=21;break;case 27:if(n.wrap){for(;d<32;){if(0===s)break e;s--,u|=r[o++]<<d,d+=8}if(e.total_out+=f-=c,n.total+=f,f&&(e.adler=n.check=n.flags?V(n.check,a,f,l-f):Pt(n.check,a,f,l-f)),f=c,(n.flags?u:La(u))!==n.check){e.msg="incorrect data check",n.mode=Z;break}u=0,d=0}n.mode=28;case 28:if(n.wrap&&n.flags){for(;d<32;){if(0===s)break e;s--,u+=r[o++]<<d,d+=8}if(u!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=Z;break}u=0,d=0}n.mode=29;case 29:M=1;break e;case Z:M=-3;break e;case 31:return-4;default:return fe}return e.next_out=l,e.avail_out=c,e.next_in=o,e.avail_in=s,n.hold=u,n.bits=d,(n.wsize||f!==e.avail_out&&n.mode<Z&&(n.mode<27||4!==t))&&Pa(e,e.output,e.next_out,f-e.avail_out),f-=e.avail_out,e.total_in+=m-=e.avail_in,e.total_out+=f,n.total+=f,n.wrap&&f&&(e.adler=n.check=n.flags?V(n.check,a,f,e.next_out-f):Pt(n.check,a,f,e.next_out-f)),e.data_type=n.bits+(n.last?64:0)+(12===n.mode?128:0)+(20===n.mode||15===n.mode?256:0),(0===m&&0===f||4===t)&&M===at&&(M=-5),M}function Ba(e,t){var r,n=t.length;return e&&e.state&&(0===(r=e.state).wrap||11===r.mode)?11===r.mode&&Pt(1,t,n,0)!==r.check?-3:Pa(e,t,n,n)?(r.mode=31,-4):(r.havedict=1,at):fe}var ot={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"};function za(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}function ic(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var Sr=Object.prototype.toString;class zt{constructor(t){if(!(this instanceof zt))return new zt(t);this.options=Wi({chunkSize:16384,windowBits:0,to:""},t||{});var n=this.options;n.raw&&n.windowBits>=0&&n.windowBits<16&&(n.windowBits=-n.windowBits,0===n.windowBits&&(n.windowBits=-15)),n.windowBits>=0&&n.windowBits<16&&!(t&&t.windowBits)&&(n.windowBits+=32),n.windowBits>15&&n.windowBits<48&&(15&n.windowBits||(n.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new za,this.strm.avail_out=0;var r=Ks(this.strm,n.windowBits);if(0!==r)throw new Error(ot[r]);if(this.header=new ic,function rc(e,t){var n;e&&e.state&&2&(n=e.state).wrap&&(n.head=t,t.done=!1)}(this.strm,this.header),n.dictionary&&("string"==typeof n.dictionary?n.dictionary=Sn(n.dictionary):"[object ArrayBuffer]"===Sr.call(n.dictionary)&&(n.dictionary=new Uint8Array(n.dictionary)),n.raw&&0!==(r=Ba(this.strm,n.dictionary))))throw new Error(ot[r])}push(t,n){var l,s,c,u,d,m,r=this.strm,a=this.options.chunkSize,o=this.options.dictionary,f=!1;if(this.ended)return!1;s=n===~~n?n:!0===n?4:0,r.input="string"==typeof t?function Ts(e){for(var t=new Uint8Array(e.length),n=0,r=t.length;n<r;n++)t[n]=e.charCodeAt(n);return t}(t):"[object ArrayBuffer]"===Sr.call(t)?new Uint8Array(t):t,r.next_in=0,r.avail_in=r.input.length;do{if(0===r.avail_out&&(r.output=ke(a),r.next_out=0,r.avail_out=a),2===(l=tc(r,0))&&o&&(m="string"==typeof o?Sn(o):"[object ArrayBuffer]"===Sr.call(o)?new Uint8Array(o):o,l=Ba(this.strm,m)),-5===l&&!0===f&&(l=0,f=!1),1!==l&&0!==l)return this.onEnd(l),this.ended=!0,!1;r.next_out&&(0===r.avail_out||1===l||0===r.avail_in&&(4===s||2===s))&&("string"===this.options.to?(c=Ns(r.output,r.next_out),u=r.next_out-c,d=Es(r.output,c),r.next_out=u,r.avail_out=a-u,u&&se(r.output,r.output,c,u,0),this.onData(d)):this.onData(wn(r.output,r.next_out))),0===r.avail_in&&0===r.avail_out&&(f=!0)}while((r.avail_in>0||0===r.avail_out)&&1!==l);return 1===l&&(s=4),4===s?(l=function nc(e){if(!e||!e.state)return fe;var t=e.state;return t.window&&(t.window=null),e.state=null,at}(this.strm),this.onEnd(l),this.ended=!0,0===l):(2===s&&(this.onEnd(0),r.avail_out=0),!0)}onData(t){this.chunks.push(t)}onEnd(t){0===t&&(this.result="string"===this.options.to?this.chunks.join(""):Cn(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg}}function vt(e){for(var t=e.length;--t>=0;)e[t]=0}var Ae,wt,Ct,St,En,Ut,Ja,Ya,Va,oc=0,Za=1,lc=2,sc=3,cc=258,kr=29,Zt=256,$t=Zt+1+kr,Dt=30,Ar=19,$a=2*$t+1,lt=15,Mr=16,uc=7,Or=256,Ua=16,qa=17,Ha=18,Rr=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],Tn=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],dc=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],Ga=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],fc=512;function Tr(e,t,n,r,a){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=r,this.max_length=a,this.has_stree=e&&e.length}function Er(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function Qa(e){return e<256?Ct[e]:Ct[256+(e>>>7)]}function qt(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function le(e,t,n){e.bi_valid>Mr-n?(e.bi_buf|=t<<e.bi_valid&65535,qt(e,e.bi_buf),e.bi_buf=t>>Mr-e.bi_valid,e.bi_valid+=n-Mr):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)}function Me(e,t,n){le(e,n[2*t],n[2*t+1])}function ja(e,t){var n=0;do{n|=1&e,e>>>=1,n<<=1}while(--t>0);return n>>>1}function Wa(e,t,n){var o,l,r=new Array(lt+1),a=0;for(o=1;o<=lt;o++)r[o]=a=a+n[o-1]<<1;for(l=0;l<=t;l++){var s=e[2*l+1];0!==s&&(e[2*l]=ja(r[s]++,s))}}function Xa(e){var t;for(t=0;t<$t;t++)e.dyn_ltree[2*t]=0;for(t=0;t<Dt;t++)e.dyn_dtree[2*t]=0;for(t=0;t<Ar;t++)e.bl_tree[2*t]=0;e.dyn_ltree[2*Or]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function Ka(e){e.bi_valid>8?qt(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function eo(e,t,n,r){var a=2*t,o=2*n;return e[a]<e[o]||e[a]===e[o]&&r[t]<=r[n]}function Nr(e,t,n){for(var r=e.heap[n],a=n<<1;a<=e.heap_len&&(a<e.heap_len&&eo(t,e.heap[a+1],e.heap[a],e.depth)&&a++,!eo(t,r,e.heap[a],e.depth));)e.heap[n]=e.heap[a],n=a,a<<=1;e.heap[n]=r}function to(e,t,n){var r,a,l,s,o=0;if(0!==e.last_lit)do{r=e.pending_buf[e.d_buf+2*o]<<8|e.pending_buf[e.d_buf+2*o+1],a=e.pending_buf[e.l_buf+o],o++,0===r?Me(e,a,t):(Me(e,(l=St[a])+Zt+1,t),0!==(s=Rr[l])&&le(e,a-=En[l],s),Me(e,l=Qa(--r),n),0!==(s=Tn[l])&&le(e,r-=Ut[l],s))}while(o<e.last_lit);Me(e,Or,t)}function Fr(e,t){var l,s,u,n=t.dyn_tree,r=t.stat_desc.static_tree,a=t.stat_desc.has_stree,o=t.stat_desc.elems,c=-1;for(e.heap_len=0,e.heap_max=$a,l=0;l<o;l++)0!==n[2*l]?(e.heap[++e.heap_len]=c=l,e.depth[l]=0):n[2*l+1]=0;for(;e.heap_len<2;)n[2*(u=e.heap[++e.heap_len]=c<2?++c:0)]=1,e.depth[u]=0,e.opt_len--,a&&(e.static_len-=r[2*u+1]);for(t.max_code=c,l=e.heap_len>>1;l>=1;l--)Nr(e,n,l);u=o;do{l=e.heap[1],e.heap[1]=e.heap[e.heap_len--],Nr(e,n,1),s=e.heap[1],e.heap[--e.heap_max]=l,e.heap[--e.heap_max]=s,n[2*u]=n[2*l]+n[2*s],e.depth[u]=(e.depth[l]>=e.depth[s]?e.depth[l]:e.depth[s])+1,n[2*l+1]=n[2*s+1]=u,e.heap[1]=u++,Nr(e,n,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],function pc(e,t){var u,d,m,f,p,_,n=t.dyn_tree,r=t.max_code,a=t.stat_desc.static_tree,o=t.stat_desc.has_stree,l=t.stat_desc.extra_bits,s=t.stat_desc.extra_base,c=t.stat_desc.max_length,k=0;for(f=0;f<=lt;f++)e.bl_count[f]=0;for(n[2*e.heap[e.heap_max]+1]=0,u=e.heap_max+1;u<$a;u++)(f=n[2*n[2*(d=e.heap[u])+1]+1]+1)>c&&(f=c,k++),n[2*d+1]=f,!(d>r)&&(e.bl_count[f]++,p=0,d>=s&&(p=l[d-s]),e.opt_len+=(_=n[2*d])*(f+p),o&&(e.static_len+=_*(a[2*d+1]+p)));if(0!==k){do{for(f=c-1;0===e.bl_count[f];)f--;e.bl_count[f]--,e.bl_count[f+1]+=2,e.bl_count[c]--,k-=2}while(k>0);for(f=c;0!==f;f--)for(d=e.bl_count[f];0!==d;)!((m=e.heap[--u])>r)&&(n[2*m+1]!==f&&(e.opt_len+=(f-n[2*m+1])*n[2*m],n[2*m+1]=f),d--)}}(e,t),Wa(n,c,e.bl_count)}function no(e,t,n){var r,o,a=-1,l=t[1],s=0,c=7,u=4;for(0===l&&(c=138,u=3),t[2*(n+1)+1]=65535,r=0;r<=n;r++)o=l,l=t[2*(r+1)+1],!(++s<c&&o===l)&&(s<u?e.bl_tree[2*o]+=s:0!==o?(o!==a&&e.bl_tree[2*o]++,e.bl_tree[2*Ua]++):s<=10?e.bl_tree[2*qa]++:e.bl_tree[2*Ha]++,s=0,a=o,0===l?(c=138,u=3):o===l?(c=6,u=3):(c=7,u=4))}function ro(e,t,n){var r,o,a=-1,l=t[1],s=0,c=7,u=4;for(0===l&&(c=138,u=3),r=0;r<=n;r++)if(o=l,l=t[2*(r+1)+1],!(++s<c&&o===l)){if(s<u)do{Me(e,o,e.bl_tree)}while(0!=--s);else 0!==o?(o!==a&&(Me(e,o,e.bl_tree),s--),Me(e,Ua,e.bl_tree),le(e,s-3,2)):s<=10?(Me(e,qa,e.bl_tree),le(e,s-3,3)):(Me(e,Ha,e.bl_tree),le(e,s-11,7));s=0,a=o,0===l?(c=138,u=3):o===l?(c=6,u=3):(c=7,u=4)}}var io=!1;function ao(e,t,n,r){le(e,(oc<<1)+(r?1:0),3),function gc(e,t,n,r){Ka(e),r&&(qt(e,n),qt(e,~n)),se(e.pending_buf,e.window,t,n,e.pending),e.pending+=n}(e,t,n,!0)}function Ye(e,t,n){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&n,e.last_lit++,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(St[n]+Zt+1)]++,e.dyn_dtree[2*Qa(t)]++),e.last_lit===e.lit_bufsize-1}var T=3,Ve=258,_e=Ve+T+1;function Qe(e,t){return e.msg=ot[t],t}function oo(e){return(e<<1)-(e>4?9:0)}function je(e){for(var t=e.length;--t>=0;)e[t]=0}function We(e){var t=e.state,n=t.pending;n>e.avail_out&&(n=e.avail_out),0!==n&&(se(e.output,t.pending_buf,t.pending_out,n,e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0))}function W(e,t){(function Dc(e,t,n,r){var a,o,l=0;e.level>0?(e.strm.data_type===ji&&(e.strm.data_type=function bc(e){var n,t=4093624447;for(n=0;n<=31;n++,t>>>=1)if(1&t&&0!==e.dyn_ltree[2*n])return Vi;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return Qi;for(n=32;n<Zt;n++)if(0!==e.dyn_ltree[2*n])return Qi;return Vi}(e)),Fr(e,e.l_desc),Fr(e,e.d_desc),l=function xc(e){var t;for(no(e,e.dyn_ltree,e.l_desc.max_code),no(e,e.dyn_dtree,e.d_desc.max_code),Fr(e,e.bl_desc),t=Ar-1;t>=3&&0===e.bl_tree[2*Ga[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),(o=e.static_len+3+7>>>3)<=(a=e.opt_len+3+7>>>3)&&(a=o)):a=o=n+5,n+4<=a&&-1!==t?ao(e,t,n,r):e.strategy===Yi||o===a?(le(e,(Za<<1)+(r?1:0),3),to(e,Ae,wt)):(le(e,(lc<<1)+(r?1:0),3),function _c(e,t,n,r){var a;for(le(e,t-257,5),le(e,n-1,5),le(e,r-4,4),a=0;a<r;a++)le(e,e.bl_tree[2*Ga[a]+1],3);ro(e,e.dyn_ltree,t-1),ro(e,e.dyn_dtree,n-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,l+1),to(e,e.dyn_ltree,e.dyn_dtree)),Xa(e),r&&Ka(e)})(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,We(e.strm)}function F(e,t){e.pending_buf[e.pending++]=t}function Jt(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function Ec(e,t,n,r){var a=e.avail_in;return a>r&&(a=r),0===a?0:(e.avail_in-=a,se(t,e.input,e.next_in,a,n),1===e.state.wrap?e.adler=Pt(e.adler,t,a,n):2===e.state.wrap&&(e.adler=V(e.adler,t,a,n)),e.next_in+=a,e.total_in+=a,a)}function lo(e,t){var a,o,n=e.max_chain_length,r=e.strstart,l=e.prev_length,s=e.nice_match,c=e.strstart>e.w_size-_e?e.strstart-(e.w_size-_e):0,u=e.window,d=e.w_mask,m=e.prev,f=e.strstart+Ve,p=u[r+l-1],_=u[r+l];e.prev_length>=e.good_match&&(n>>=2),s>e.lookahead&&(s=e.lookahead);do{if(u[(a=t)+l]===_&&u[a+l-1]===p&&u[a]===u[r]&&u[++a]===u[r+1]){r+=2,a++;do{}while(u[++r]===u[++a]&&u[++r]===u[++a]&&u[++r]===u[++a]&&u[++r]===u[++a]&&u[++r]===u[++a]&&u[++r]===u[++a]&&u[++r]===u[++a]&&u[++r]===u[++a]&&r<f);if(o=Ve-(f-r),r=f-Ve,o>l){if(e.match_start=t,l=o,o>=s)break;p=u[r+l-1],_=u[r+l]}}}while((t=m[t&d])>c&&0!=--n);return l<=e.lookahead?l:e.lookahead}function ut(e){var n,r,a,o,l,t=e.w_size;do{if(o=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-_e)){se(e.window,e.window,t,t,0),e.match_start-=t,e.strstart-=t,e.block_start-=t,n=r=e.hash_size;do{a=e.head[--n],e.head[n]=a>=t?a-t:0}while(--r);n=r=t;do{a=e.prev[--n],e.prev[n]=a>=t?a-t:0}while(--r);o+=t}if(0===e.strm.avail_in)break;if(r=Ec(e.strm,e.window,e.strstart+e.lookahead,o),e.lookahead+=r,e.lookahead+e.insert>=T)for(e.ins_h=e.window[l=e.strstart-e.insert],e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+T-1])&e.hash_mask,e.prev[l&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=l,l++,e.insert--,!(e.lookahead+e.insert<T)););}while(e.lookahead<_e&&0!==e.strm.avail_in)}function Nc(e,t){var n=65535;for(n>e.pending_buf_size-5&&(n=e.pending_buf_size-5);;){if(e.lookahead<=1){if(ut(e),0===e.lookahead&&0===t)return 1;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var r=e.block_start+n;if((0===e.strstart||e.strstart>=r)&&(e.lookahead=e.strstart-r,e.strstart=r,W(e,!1),0===e.strm.avail_out)||e.strstart-e.block_start>=e.w_size-_e&&(W(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(W(e,!0),0===e.strm.avail_out?3:4):(e.strstart>e.block_start&&W(e,!1),1)}function Pr(e,t){for(var n,r;;){if(e.lookahead<_e){if(ut(e),e.lookahead<_e&&0===t)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=T&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+T-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-_e&&(e.match_length=lo(e,n)),e.match_length>=T)if(r=Ye(e,e.strstart-e.match_start,e.match_length-T),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=T){e.match_length--;do{e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+T-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else r=Ye(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(r&&(W(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<T-1?e.strstart:T-1,4===t?(W(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(W(e,!1),0===e.strm.avail_out)?1:2}function At(e,t){for(var n,r,a;;){if(e.lookahead<_e){if(ut(e),e.lookahead<_e&&0===t)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=T&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+T-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=T-1,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-_e&&(e.match_length=lo(e,n),e.match_length<=5&&(1===e.strategy||e.match_length===T&&e.strstart-e.match_start>4096)&&(e.match_length=T-1)),e.prev_length>=T&&e.match_length<=e.prev_length){a=e.strstart+e.lookahead-T,r=Ye(e,e.strstart-1-e.prev_match,e.prev_length-T),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=a&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+T-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=T-1,e.strstart++,r&&(W(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if((r=Ye(e,0,e.window[e.strstart-1]))&&W(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(r=Ye(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<T-1?e.strstart:T-1,4===t?(W(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(W(e,!1),0===e.strm.avail_out)?1:2}function Oe(e,t,n,r,a){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=r,this.func=a}let Br=function(){const e=[new Oe(0,0,0,0,Nc),new Oe(4,4,8,4,Pr),new Oe(4,5,16,8,Pr),new Oe(4,6,32,32,Pr),new Oe(4,4,16,16,At),new Oe(8,16,32,32,At),new Oe(8,16,128,128,At),new Oe(8,32,128,256,At),new Oe(32,128,258,1024,At),new Oe(32,258,258,4096,At)];return Br=()=>e,e};function Pc(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=oe(1146),this.dyn_dtree=oe(122),this.bl_tree=oe(78),je(this.dyn_ltree),je(this.dyn_dtree),je(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=oe(16),this.heap=oe(573),je(this.heap),this.heap_len=0,this.heap_max=0,this.depth=oe(573),je(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function zc(e){var t=function Bc(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=ji,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?42:113,e.adler=2===t.wrap?0:1,t.last_flush=0,function yc(e){io||(function mc(){var e,t,n,r,a,o=new Array(lt+1);for(vt(Ae=new Array(2*($t+2))),vt(wt=new Array(2*Dt)),vt(Ct=new Array(fc)),vt(St=new Array(cc-sc+1)),vt(En=new Array(kr)),vt(Ut=new Array(Dt)),n=0,r=0;r<kr-1;r++)for(En[r]=n,e=0;e<1<<Rr[r];e++)St[n++]=r;for(St[n-1]=r,a=0,r=0;r<16;r++)for(Ut[r]=a,e=0;e<1<<Tn[r];e++)Ct[a++]=r;for(a>>=7;r<Dt;r++)for(Ut[r]=a<<7,e=0;e<1<<Tn[r]-7;e++)Ct[256+a++]=r;for(t=0;t<=lt;t++)o[t]=0;for(e=0;e<=143;)Ae[2*e+1]=8,e++,o[8]++;for(;e<=255;)Ae[2*e+1]=9,e++,o[9]++;for(;e<=279;)Ae[2*e+1]=7,e++,o[7]++;for(;e<=287;)Ae[2*e+1]=8,e++,o[8]++;for(Wa(Ae,$t+1,o),e=0;e<Dt;e++)wt[2*e+1]=5,wt[2*e]=ja(e,5);Ja=new Tr(Ae,Rr,Zt+1,$t,lt),Ya=new Tr(wt,Tn,0,Dt,lt),Va=new Tr(new Array(0),dc,0,Ar,uc)}(),io=!0),e.l_desc=new Er(e.dyn_ltree,Ja),e.d_desc=new Er(e.dyn_dtree,Ya),e.bl_desc=new Er(e.bl_tree,Va),e.bi_buf=0,e.bi_valid=0,Xa(e)}(t),0):Qe(e,-2)}(e);return 0===t&&function Ic(e){e.window_size=2*e.w_size,je(e.head);const t=Br();e.max_lazy_match=t[e.level].max_lazy,e.good_match=t[e.level].good_length,e.nice_match=t[e.level].nice_length,e.max_chain_length=t[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=T-1,e.match_available=0,e.ins_h=0}(e.state),t}function Uc(e,t){var n,r,a,o;if(!e||!e.state||t>5||t<0)return e?Qe(e,-2):-2;if(r=e.state,!e.output||!e.input&&0!==e.avail_in||666===r.status&&4!==t)return Qe(e,0===e.avail_out?-5:-2);if(r.strm=e,n=r.last_flush,r.last_flush=t,42===r.status)if(2===r.wrap)e.adler=0,F(r,31),F(r,139),F(r,8),r.gzhead?(F(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),F(r,255&r.gzhead.time),F(r,r.gzhead.time>>8&255),F(r,r.gzhead.time>>16&255),F(r,r.gzhead.time>>24&255),F(r,9===r.level?2:r.strategy>=2||r.level<2?4:0),F(r,255&r.gzhead.os),r.gzhead.extra&&r.gzhead.extra.length&&(F(r,255&r.gzhead.extra.length),F(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(e.adler=V(e.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=69):(F(r,0),F(r,0),F(r,0),F(r,0),F(r,0),F(r,9===r.level?2:r.strategy>=2||r.level<2?4:0),F(r,3),r.status=113);else{var l=8+(r.w_bits-8<<4)<<8;l|=(r.strategy>=2||r.level<2?0:r.level<6?1:6===r.level?2:3)<<6,0!==r.strstart&&(l|=32),l+=31-l%31,r.status=113,Jt(r,l),0!==r.strstart&&(Jt(r,e.adler>>>16),Jt(r,65535&e.adler)),e.adler=1}if(69===r.status)if(r.gzhead.extra){for(a=r.pending;r.gzindex<(65535&r.gzhead.extra.length)&&(r.pending!==r.pending_buf_size||(r.gzhead.hcrc&&r.pending>a&&(e.adler=V(e.adler,r.pending_buf,r.pending-a,a)),We(e),a=r.pending,r.pending!==r.pending_buf_size));)F(r,255&r.gzhead.extra[r.gzindex]),r.gzindex++;r.gzhead.hcrc&&r.pending>a&&(e.adler=V(e.adler,r.pending_buf,r.pending-a,a)),r.gzindex===r.gzhead.extra.length&&(r.gzindex=0,r.status=73)}else r.status=73;if(73===r.status)if(r.gzhead.name){a=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>a&&(e.adler=V(e.adler,r.pending_buf,r.pending-a,a)),We(e),a=r.pending,r.pending===r.pending_buf_size)){o=1;break}o=r.gzindex<r.gzhead.name.length?255&r.gzhead.name.charCodeAt(r.gzindex++):0,F(r,o)}while(0!==o);r.gzhead.hcrc&&r.pending>a&&(e.adler=V(e.adler,r.pending_buf,r.pending-a,a)),0===o&&(r.gzindex=0,r.status=91)}else r.status=91;if(91===r.status)if(r.gzhead.comment){a=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>a&&(e.adler=V(e.adler,r.pending_buf,r.pending-a,a)),We(e),a=r.pending,r.pending===r.pending_buf_size)){o=1;break}o=r.gzindex<r.gzhead.comment.length?255&r.gzhead.comment.charCodeAt(r.gzindex++):0,F(r,o)}while(0!==o);r.gzhead.hcrc&&r.pending>a&&(e.adler=V(e.adler,r.pending_buf,r.pending-a,a)),0===o&&(r.status=103)}else r.status=103;if(103===r.status&&(r.gzhead.hcrc?(r.pending+2>r.pending_buf_size&&We(e),r.pending+2<=r.pending_buf_size&&(F(r,255&e.adler),F(r,e.adler>>8&255),e.adler=0,r.status=113)):r.status=113),0!==r.pending){if(We(e),0===e.avail_out)return r.last_flush=-1,0}else if(0===e.avail_in&&oo(t)<=oo(n)&&4!==t)return Qe(e,-5);if(666===r.status&&0!==e.avail_in)return Qe(e,-5);if(0!==e.avail_in||0!==r.lookahead||0!==t&&666!==r.status){var c=2===r.strategy?function Lc(e,t){for(var n;;){if(0===e.lookahead&&(ut(e),0===e.lookahead)){if(0===t)return 1;break}if(e.match_length=0,n=Ye(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(W(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(W(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(W(e,!1),0===e.strm.avail_out)?1:2}(r,t):3===r.strategy?function Fc(e,t){for(var n,r,a,o,l=e.window;;){if(e.lookahead<=Ve){if(ut(e),e.lookahead<=Ve&&0===t)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=T&&e.strstart>0&&(r=l[a=e.strstart-1])===l[++a]&&r===l[++a]&&r===l[++a]){o=e.strstart+Ve;do{}while(r===l[++a]&&r===l[++a]&&r===l[++a]&&r===l[++a]&&r===l[++a]&&r===l[++a]&&r===l[++a]&&r===l[++a]&&a<o);e.match_length=Ve-(o-a),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=T?(n=Ye(e,1,e.match_length-T),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=Ye(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(W(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(W(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(W(e,!1),0===e.strm.avail_out)?1:2}(r,t):Br()[r.level].func(r,t);if((3===c||4===c)&&(r.status=666),1===c||3===c)return 0===e.avail_out&&(r.last_flush=-1),0;if(2===c&&(1===t?function vc(e){le(e,Za<<1,3),Me(e,Or,Ae),function hc(e){16===e.bi_valid?(qt(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}(e)}(r):5!==t&&(ao(r,0,0,!1),3===t&&(je(r.head),0===r.lookahead&&(r.strstart=0,r.block_start=0,r.insert=0))),We(e),0===e.avail_out))return r.last_flush=-1,0}return 4!==t?0:r.wrap<=0?1:(2===r.wrap?(F(r,255&e.adler),F(r,e.adler>>8&255),F(r,e.adler>>16&255),F(r,e.adler>>24&255),F(r,255&e.total_in),F(r,e.total_in>>8&255),F(r,e.total_in>>16&255),F(r,e.total_in>>24&255)):(Jt(r,e.adler>>>16),Jt(r,65535&e.adler)),We(e),r.wrap>0&&(r.wrap=-r.wrap),0!==r.pending?0:1)}var so=Object.prototype.toString;class co{constructor(t){this.options=Wi({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},t||{});var n=this.options;n.raw&&n.windowBits>0?n.windowBits=-n.windowBits:n.gzip&&n.windowBits>0&&n.windowBits<16&&(n.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new za,this.strm.avail_out=0;var r=function $c(e,t,n,r,a,o){if(!e)return-2;var l=1;if(-1===t&&(t=6),r<0?(l=0,r=-r):r>15&&(l=2,r-=16),a<1||a>9||8!==n||r<8||r>15||t<0||t>9||o<0||o>Yi)return Qe(e,-2);8===r&&(r=9);var s=new Pc;return e.state=s,s.strm=e,s.wrap=l,s.gzhead=null,s.w_bits=r,s.w_size=1<<s.w_bits,s.w_mask=s.w_size-1,s.hash_bits=a+7,s.hash_size=1<<s.hash_bits,s.hash_mask=s.hash_size-1,s.hash_shift=~~((s.hash_bits+T-1)/T),s.window=ke(2*s.w_size),s.head=oe(s.hash_size),s.prev=oe(s.w_size),s.lit_bufsize=1<<a+6,s.pending_buf_size=4*s.lit_bufsize,s.pending_buf=ke(s.pending_buf_size),s.d_buf=1*s.lit_bufsize,s.l_buf=3*s.lit_bufsize,s.level=t,s.strategy=o,s.method=n,zc(e)}(this.strm,n.level,n.method,n.windowBits,n.memLevel,n.strategy);if(0!==r)throw new Error(ot[r]);if(n.header&&function Zc(e,t){e&&e.state&&2===e.state.wrap&&(e.state.gzhead=t)}(this.strm,n.header),n.dictionary){var a;if(a="string"==typeof n.dictionary?Sn(n.dictionary):"[object ArrayBuffer]"===so.call(n.dictionary)?new Uint8Array(n.dictionary):n.dictionary,r=function Hc(e,t){var r,a,o,l,s,c,u,d,n=t.length;if(!e||!e.state||2===(l=(r=e.state).wrap)||1===l&&42!==r.status||r.lookahead)return-2;for(1===l&&(e.adler=Pt(e.adler,t,n,0)),r.wrap=0,n>=r.w_size&&(0===l&&(je(r.head),r.strstart=0,r.block_start=0,r.insert=0),d=ke(r.w_size),se(d,t,n-r.w_size,r.w_size,0),t=d,n=r.w_size),s=e.avail_in,c=e.next_in,u=e.input,e.avail_in=n,e.next_in=0,e.input=t,ut(r);r.lookahead>=T;){a=r.strstart,o=r.lookahead-(T-1);do{r.ins_h=(r.ins_h<<r.hash_shift^r.window[a+T-1])&r.hash_mask,r.prev[a&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=a,a++}while(--o);r.strstart=a,r.lookahead=T-1,ut(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=T-1,r.match_available=0,e.next_in=c,e.input=u,e.avail_in=s,r.wrap=l,0}(this.strm,a),0!==r)throw new Error(ot[r]);this._dict_set=!0}}push(t,n){var o,l,e,r=this.strm,a=this.options.chunkSize;if(this.ended)return!1;l=n===~~n?n:!0===n?4:0,r.input="string"==typeof t?Sn(t):"[object ArrayBuffer]"===so.call(t)?new Uint8Array(t):t,r.next_in=0,r.avail_in=r.input.length;do{if(0===r.avail_out&&(r.output=ke(a),r.next_out=0,r.avail_out=a),1!==(o=Uc(r,l))&&0!==o)return this.onEnd(o),this.ended=!0,!1;(0===r.avail_out||0===r.avail_in&&(4===l||2===l))&&this.onData("string"===this.options.to?ea(e=wn(r.output,r.next_out),e.length):wn(r.output,r.next_out))}while((r.avail_in>0||0===r.avail_out)&&1!==o);return 4===l?(o=function qc(e){var t;return e&&e.state?42!==(t=e.state.status)&&69!==t&&73!==t&&91!==t&&103!==t&&113!==t&&666!==t?Qe(e,-2):(e.state=null,113===t?Qe(e,-3):0):-2}(this.strm),this.onEnd(o),this.ended=!0,0===o):(2===l&&(this.onEnd(0),r.avail_out=0),!0)}onData(t){this.chunks.push(t)}onEnd(t){0===t&&(this.result="string"===this.options.to?this.chunks.join(""):Cn(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg}}var Re={Promise};const X={base64:!0,array:!0,string:!0,nodebuffer:!1,nodestream:!1,get arraybuffer(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"},get uint8array(){return typeof Uint8Array<"u"},get blob(){return fo()}};let fo=function(){let e;if(typeof ArrayBuffer>"u")e=!1;else{const t=new ArrayBuffer(0);try{e=0===new Blob([t],{type:"application/zip"}).size}catch{e=!1}}return fo=()=>e,e};const Te="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Pn(e){return e}function zr(e,t){for(var n=0;n<e.length;++n)t[n]=255&e.charCodeAt(n);return t}function Qc(e,t,n){var r=[],a=0,o=e.length;if(o<=n)return String.fromCharCode.apply(null,e);for(;a<o;)r.push(String.fromCharCode.apply(null,"array"===t?e.slice(a,Math.min(a+n,o)):e.subarray(a,Math.min(a+n,o)))),a+=n;return r.join("")}let ho=()=>{let e;try{e=X.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch{e=!1}return ho=()=>e,e};function Bn(e){var t=65536,n=dt(e),r=!0;if("uint8array"===n&&(r=ho()),r)for(;t>1;)try{return Qc(e,n,t)}catch{t=Math.floor(t/2)}return function jc(e){for(var t="",n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t}(e)}const Wc=Bn;function po(e,t){for(var n=0;n<e.length;n++)t[n]=e[n];return t}var mo={string:{string:Pn,array:function(e){return zr(e,new Array(e.length))},arraybuffer:function(e){return mo.string.uint8array(e).buffer},uint8array:function(e){return zr(e,new Uint8Array(e.length))}},array:{string:Bn,array:Pn,arraybuffer:function(e){return new Uint8Array(e).buffer},uint8array:function(e){return new Uint8Array(e)}},arraybuffer:{string:function(e){return Bn(new Uint8Array(e))},array:function(e){return po(new Uint8Array(e),new Array(e.byteLength))},arraybuffer:Pn,uint8array:function(e){return new Uint8Array(e)}},uint8array:{string:Bn,array:function(e){return po(e,new Array(e.length))},arraybuffer:function(e){return e.buffer},uint8array:Pn}};const Y=function(e,t){if(t||(t=""),!e)return t;Yt(e);var n=dt(t);return mo[n][e](t)},dt=function(e){return"string"==typeof e?"string":"[object Array]"===Object.prototype.toString.call(e)?"array":X.uint8array&&e instanceof Uint8Array?"uint8array":X.arraybuffer&&e instanceof ArrayBuffer?"arraybuffer":void 0},Yt=function(e){if(!X[e.toLowerCase()])throw new Error(e+" is not supported by this platform")},zn=65535,Zr=function(e){var n,r,t="";for(r=0;r<(e||"").length;r++)t+="\\x"+((n=e.charCodeAt(r))<16?"0":"")+n.toString(16).toUpperCase();return t},Zn=function(e,t,n){setTimeout(function(){e.apply(n||null,t||[])},0)},$r=function(){var t,n,e={};for(t=0;t<arguments.length;t++)for(n in arguments[t])Object.hasOwnProperty.call(arguments[t],n)&&typeof e[n]>"u"&&(e[n]=arguments[t][n]);return e},go=function(e,t,n,r,a){return Re.Promise.resolve(t).then(function(l){return X.blob&&(l instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(l)))&&typeof FileReader<"u"?new Re.Promise(function(c,u){var d=new FileReader;d.onload=function(m){c(m.target.result)},d.onerror=function(m){u(m.target.error)},d.readAsArrayBuffer(l)}):l}).then(function(l){var s=dt(l);return s?("arraybuffer"===s?l=Y("uint8array",l):"string"===s&&(a?l=function(e){let t,n,r,a,o,l,s,c=0,u=0;if("data:"===e.substr(0,5))throw new Error("Invalid base64 input, it looks like a data url.");let f,m=3*(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"")).length/4;if(e.charAt(e.length-1)===Te.charAt(64)&&m--,e.charAt(e.length-2)===Te.charAt(64)&&m--,m%1!=0)throw new Error("Invalid base64 input, bad content length.");for(f=X.uint8array?new Uint8Array(0|m):new Array(0|m);c<e.length;)a=Te.indexOf(e.charAt(c++)),o=Te.indexOf(e.charAt(c++)),l=Te.indexOf(e.charAt(c++)),s=Te.indexOf(e.charAt(c++)),t=a<<2|o>>4,n=(15&o)<<4|l>>2,r=(3&l)<<6|s,f[u++]=t,64!==l&&(f[u++]=n),64!==s&&(f[u++]=r);return f}(l):n&&!0!==r&&(l=function Yc(e){return zr(e,X.uint8array?new Uint8Array(e.length):new Array(e.length))}(l))),l):Re.Promise.reject(new Error("Can't read the data of '"+e+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})};class ie{constructor(t){this.name=t||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}push(t){this.emit("data",t)}end(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(t){this.emit("error",t)}return!0}error(t){return!this.isFinished&&(this.isPaused?this.generatedError=t:(this.isFinished=!0,this.emit("error",t),this.previous&&this.previous.error(t),this.cleanUp()),!0)}on(t,n){return this._listeners[t].push(n),this}cleanUp(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]}emit(t,n){if(this._listeners[t])for(var r=0;r<this._listeners[t].length;r++)this._listeners[t][r].call(this,n)}pipe(t){return t.registerPrevious(this)}registerPrevious(t){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=t.streamInfo,this.mergeStreamInfo(),this.previous=t;var n=this;return t.on("data",function(r){n.processChunk(r)}),t.on("end",function(){n.end()}),t.on("error",function(r){n.error(r)}),this}pause(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)}resume(){if(!this.isPaused||this.isFinished)return!1;this.isPaused=!1;var t=!1;return this.generatedError&&(this.error(this.generatedError),t=!0),this.previous&&this.previous.resume(),!t}flush(){}processChunk(t){this.push(t)}withStreamInfo(t,n){return this.extraStreamInfo[t]=n,this.mergeStreamInfo(),this}mergeStreamInfo(){for(var t in this.extraStreamInfo)this.extraStreamInfo.hasOwnProperty(t)&&(this.streamInfo[t]=this.extraStreamInfo[t])}lock(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()}toString(){var t="Worker "+this.name;return this.previous?this.previous+" -> "+t:t}}let Ur=function(e){const t=new Array(256);for(let n=0;n<256;n++)t[n]=n>=252?6:n>=248?5:n>=240?4:n>=224?3:n>=192?2:1;return t[254]=t[254]=1,Ur=function(n){return t[n]},t[e]};const Vt=function(t){return function(e){var t,n,r,a,o,l=e.length,s=0;for(a=0;a<l;a++)55296==(64512&(n=e.charCodeAt(a)))&&a+1<l&&56320==(64512&(r=e.charCodeAt(a+1)))&&(n=65536+(n-55296<<10)+(r-56320),a++),s+=n<128?1:n<2048?2:n<65536?3:4;for(t=X.uint8array?new Uint8Array(s):new Array(s),o=0,a=0;o<s;a++)55296==(64512&(n=e.charCodeAt(a)))&&a+1<l&&56320==(64512&(r=e.charCodeAt(a+1)))&&(n=65536+(n-55296<<10)+(r-56320),a++),n<128?t[o++]=n:n<2048?(t[o++]=192|n>>>6,t[o++]=128|63&n):n<65536?(t[o++]=224|n>>>12,t[o++]=128|n>>>6&63,t[o++]=128|63&n):(t[o++]=240|n>>>18,t[o++]=128|n>>>12&63,t[o++]=128|n>>>6&63,t[o++]=128|63&n);return t}(t)},ft=function(t){return function(e){var t,n,r,a,o=e.length,l=new Array(2*o);for(n=0,t=0;t<o;)if((r=e[t++])<128)l[n++]=r;else if((a=Ur(r))>4)l[n++]=65533,t+=a-1;else{for(r&=2===a?31:3===a?15:7;a>1&&t<o;)r=r<<6|63&e[t++],a--;a>1?l[n++]=65533:r<65536?l[n++]=r:(l[n++]=55296|(r-=65536)>>10&1023,l[n++]=56320|1023&r)}return l.length!==n&&(l.subarray?l=l.subarray(0,n):l.length=n),Wc(l)}(t=Y(X.uint8array?"uint8array":"array",t))};class tu extends ie{constructor(){super("utf-8 decode"),this.leftOver=null}processChunk(t){var n=Y(X.uint8array?"uint8array":"array",t.data);if(this.leftOver&&this.leftOver.length){if(X.uint8array){var r=n;(n=new Uint8Array(r.length+this.leftOver.length)).set(this.leftOver,0),n.set(r,this.leftOver.length)}else n=this.leftOver.concat(n);this.leftOver=null}var a=function(e,t){var n;for((t=t||e.length)>e.length&&(t=e.length),n=t-1;n>=0&&128==(192&e[n]);)n--;return n<0||0===n?t:n+Ur(e[n])>t?n:t}(n),o=n;a!==n.length&&(X.uint8array?(o=n.subarray(0,a),this.leftOver=n.subarray(a,n.length)):(o=n.slice(0,a),this.leftOver=n.slice(a,n.length))),this.push({data:ft(o),meta:t.meta})}flush(){this.leftOver&&this.leftOver.length&&(this.push({data:ft(this.leftOver),meta:{}}),this.leftOver=null)}}class xo extends ie{constructor(){super("utf-8 encode")}processChunk(t){this.push({data:Vt(t.data),meta:t.meta})}}class nu extends ie{constructor(t){super("ConvertWorker to "+t),this.destType=t}processChunk(t){this.push({data:Y(this.destType,t.data),meta:t.meta})}}function au(e,t){return new Re.Promise(function(n,r){var a=[],o=e._internalType,l=e._outputType,s=e._mimeType;e.on("data",function(c,u){a.push(c),t&&t(u)}).on("error",function(c){a=[],r(c)}).on("end",function(){try{var c=function ru(e,t,n){switch(e){case"blob":return function(e,t){return Yt("blob"),new Blob([e],{type:t})}(Y("arraybuffer",t),n);case"base64":return function(e){let n,r,a,o,l,s,c,t=[],u=0,d=e.length,m=d,f="string"!=typeof e;for(;u<e.length;)m=d-u,f?(n=e[u++],r=u<d?e[u++]:0,a=u<d?e[u++]:0):(n=e.charCodeAt(u++),r=u<d?e.charCodeAt(u++):0,a=u<d?e.charCodeAt(u++):0),o=n>>2,l=(3&n)<<4|r>>4,s=m>1?(15&r)<<2|a>>6:64,c=m>2?63&a:64,t.push(Te.charAt(o)+Te.charAt(l)+Te.charAt(s)+Te.charAt(c));return t.join("")}(t);default:return Y(e,t)}}(l,function iu(e,t){var n,r=0,a=null,o=0;for(n=0;n<t.length;n++)o+=t[n].length;switch(e){case"string":return t.join("");case"array":return Array.prototype.concat.apply([],t);case"uint8array":for(a=new Uint8Array(o),n=0;n<t.length;n++)a.set(t[n],r),r+=t[n].length;return a;default:throw new Error("concat : unsupported type '"+e+"'")}}(o,a),s);n(c)}catch(u){r(u)}a=[]}).resume()})}class _o{constructor(t,n,r){var a=n;switch(n){case"blob":case"arraybuffer":a="uint8array";break;case"base64":a="string"}try{this._internalType=a,this._outputType=n,this._mimeType=r,Yt(a),this._worker=t.pipe(new nu(a)),t.lock()}catch(o){this._worker=new ie("error"),this._worker.error(o)}}accumulate(t){return au(this,t)}on(t,n){var r=this;return this._worker.on(t,"data"===t?function(a){n.call(r,a.data,a.meta)}:function(){Zn(n,arguments,r)}),this}resume(){return Zn(this._worker.resume,[],this._worker),this}pause(){return this._worker.pause(),this}}var yo=Object.freeze({__proto__:null,base64:!1,binary:!1,dir:!1,createFolders:!0,date:null,compression:null,compressionOptions:null,comment:null,unixPermissions:null,dosPermissions:null});class qr extends ie{constructor(t){super("DataWorker");var n=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,t.then(function(r){n.dataIsReady=!0,n.data=r,n.max=r&&r.length||0,n.type=dt(r),n.isPaused||n._tickAndRepeat()},function(r){n.error(r)})}cleanUp(){super.cleanUp(),this.data=null}resume(){return!!super.resume()&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,Zn(this._tickAndRepeat,[],this)),!0)}_tickAndRepeat(){this._tickScheduled=!1,!this.isPaused&&!this.isFinished&&(this._tick(),this.isFinished||(Zn(this._tickAndRepeat,[],this),this._tickScheduled=!0))}_tick(){if(this.isPaused||this.isFinished)return!1;var n=null,r=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":n=this.data.substring(this.index,r);break;case"uint8array":n=this.data.subarray(this.index,r);break;case"array":n=this.data.slice(this.index,r)}return this.index=r,this.push({data:n,meta:{percent:this.max?this.index/this.max*100:0}})}}class Hr extends ie{constructor(t){super("DataLengthProbe for "+t),this.propName=t,this.withStreamInfo(t,0)}processChunk(t){t&&(this.streamInfo[this.propName]=(this.streamInfo[this.propName]||0)+t.data.length),super.processChunk(t)}}let Gr=function(){const e=[];for(let t=0;t<256;t++){let n=t;for(let r=0;r<8;r++)n=1&n?3988292384^n>>>1:n>>>1;e[t]=n}return Gr=function(){return e},e};function Qt(e,t){return typeof e>"u"||!e.length?0:"string"!==dt(e)?function uu(e,t,n,r){const a=Gr();let o=r+n;e^=-1;for(let l=r;l<o;l++)e=e>>>8^a[255&(e^t[l])];return-1^e}(0|t,e,e.length,0):function du(e,t,n,r){const a=Gr();let o=r+n;e^=-1;for(let l=r;l<o;l++)e=e>>>8^a[255&(e^t.charCodeAt(l))];return-1^e}(0|t,e,e.length,0)}class vo extends ie{constructor(){super("Crc32Probe"),this.withStreamInfo("crc32",0)}processChunk(t){this.streamInfo.crc32=Qt(t.data,this.streamInfo.crc32||0),this.push(t)}}class Ot{constructor(t,n,r,a,o){this.compressedSize=t,this.uncompressedSize=n,this.crc32=r,this.compression=a,this.compressedContent=o}getContentWorker(){var t=new qr(Re.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new Hr("data_length")),n=this;return t.on("end",function(){if(this.streamInfo.data_length!==n.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),t}getCompressedWorker(){return new qr(Re.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}static createWorkerFrom(t,n,r){return t.pipe(new vo).pipe(new Hr("uncompressedSize")).pipe(n.compressWorker(r)).pipe(new Hr("compressedSize")).withStreamInfo("compression",n)}}class fu{constructor(t,n,r){this.name=t,this.dir=r.dir,this.date=r.date,this.comment=r.comment,this.unixPermissions=r.unixPermissions,this.dosPermissions=r.dosPermissions,this._data=n,this._dataBinary=r.binary,this.options={compression:r.compression,compressionOptions:r.compressionOptions}}internalStream(t){var n=null,r="string";try{if(!t)throw new Error("No output type specified.");var a="string"===(r=t.toLowerCase())||"text"===r;("binarystring"===r||"text"===r)&&(r="string"),n=this._decompressWorker();var o=!this._dataBinary;o&&!a&&(n=n.pipe(new xo)),!o&&a&&(n=n.pipe(new tu))}catch(l){(n=new ie("error")).error(l)}return new _o(n,r,"")}async(t,n){return this.internalStream(t).accumulate(n)}_compressWorker(t,n){if(this._data instanceof Ot&&this._data.compression.magic===t.magic)return this._data.getCompressedWorker();var r=this._decompressWorker();return this._dataBinary||(r=r.pipe(new xo)),Ot.createWorkerFrom(r,t,n)}_decompressWorker(){return this._data instanceof Ot?this._data.getContentWorker():this._data instanceof ie?this._data:new qr(this._data)}}let Do=function(){const t=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u"?"uint8array":"array";Do=function(){return t}};class wo extends ie{constructor(t,n){super("FlateWorker/"+t),this._pako=null,this._pakoAction=t,this._pakoOptions=n,this.meta={}}processChunk(t){this.meta=t.meta,null===this._pako&&this._createPako(),this._pako.push(Y(Do(),t.data),!1)}flush(){super.flush(),null===this._pako&&this._createPako(),this._pako.push([],!0)}cleanUp(){super.cleanUp(),this._pako=null}_createPako(){const t={raw:!0,level:this._pakoOptions.level||-1};this._pako="Deflate"===this._pakoAction?new co(t):new zt(t),this._pako.onData=n=>{this.push({data:n,meta:this.meta})}}}var hu={magic:"\b\0",compressWorker:function(e){return new wo("Deflate",e)},uncompressWorker:function(){return new wo("Inflate",{})}},jt={STORE:{magic:"\0\0",compressWorker:function(){return new ie("STORE compression")},uncompressWorker:function(){return new ie("STORE decompression")}},DEFLATE:hu};const Jr="PK\x03\x04",Yr="PK\x01\x02",Vr="PK\x05\x06",Qr="PK\x06\x06";var I=function(e,t){var r,n="";for(r=0;r<t;r++)n+=String.fromCharCode(255&e),e>>>=8;return n},So=function(e,t,n,r,a,o){var v,D,l=e.file,s=e.compression,c=o!==Vt,u=Y("string",o(l.name)),d=Y("string",Vt(l.name)),m=l.comment,f=Y("string",o(m)),p=Y("string",Vt(m)),_=d.length!==l.name.length,k=p.length!==m.length,x="",C="",b="",g=l.dir,w=l.date,y={crc32:0,compressedSize:0,uncompressedSize:0};(!t||n)&&(y.crc32=e.crc32,y.compressedSize=e.compressedSize,y.uncompressedSize=e.uncompressedSize);var M=0;t&&(M|=8),!c&&(_||k)&&(M|=2048);var A=0,S=0;g&&(A|=16),"UNIX"===a?(S=798,A|=function(e,t){var n=e;return e||(n=t?16893:33204),(65535&n)<<16}(l.unixPermissions,g)):(S=20,A|=function(e,t){return 63&(e||0)}(l.dosPermissions)),v=w.getUTCHours(),v<<=6,v|=w.getUTCMinutes(),v<<=5,v|=w.getUTCSeconds()/2,D=w.getUTCFullYear()-1980,D<<=4,D|=w.getUTCMonth()+1,D<<=5,D|=w.getUTCDate(),_&&(C=I(1,1)+I(Qt(u),4)+d,x+="up"+I(C.length,2)+C),k&&(b=I(1,1)+I(Qt(f),4)+p,x+="uc"+I(b.length,2)+b);var O="";return O+="\n\0",O+=I(M,2),O+=s.magic,O+=I(v,2),O+=I(D,2),O+=I(y.crc32,4),O+=I(y.compressedSize,4),O+=I(y.uncompressedSize,4),O+=I(u.length,2),O+=I(x.length,2),{fileRecord:Jr+O+u+x,dirRecord:Yr+I(S,2)+O+I(f.length,2)+"\0\0\0\0"+I(A,4)+I(r,4)+u+x+f}};class bu extends ie{constructor(t,n,r,a){super("ZipFileWorker"),this.bytesWritten=0,this.zipComment=n,this.zipPlatform=r,this.encodeFileName=a,this.streamFiles=t,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}push(t){var n=t.meta.percent||0,r=this.entriesCount,a=this._sources.length;this.accumulate?this.contentBuffer.push(t):(this.bytesWritten+=t.data.length,super.push({data:t.data,meta:{currentFile:this.currentFile,percent:r?(n+100*(r-a-1))/r:100}}))}openedSource(t){this.currentSourceOffset=this.bytesWritten,this.currentFile=t.file.name;var n=this.streamFiles&&!t.file.dir;if(n){var r=So(t,n,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:r.fileRecord,meta:{percent:0}})}else this.accumulate=!0}closedSource(t){this.accumulate=!1;var e,n=this.streamFiles&&!t.file.dir,r=So(t,n,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(r.dirRecord),n)this.push({data:(e=t,"PK\x07\b"+I(e.crc32,4)+I(e.compressedSize,4)+I(e.uncompressedSize,4)),meta:{percent:100}});else for(this.push({data:r.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null}flush(){for(var t=this.bytesWritten,n=0;n<this.dirRecords.length;n++)this.push({data:this.dirRecords[n],meta:{percent:100}});var a=function(e,t,n,r,a){var l=Y("string",a(r));return Vr+"\0\0\0\0"+I(e,2)+I(e,2)+I(t,4)+I(n,4)+I(l.length,2)+l}(this.dirRecords.length,this.bytesWritten-t,t,this.zipComment,this.encodeFileName);this.push({data:a,meta:{percent:100}})}prepareNextSource(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()}registerPrevious(t){this._sources.push(t);var n=this;return t.on("data",function(r){n.processChunk(r)}),t.on("end",function(){n.closedSource(n.previous.streamInfo),n._sources.length?n.prepareNextSource():n.end()}),t.on("error",function(r){n.error(r)}),this}resume(){return!!super.resume()&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))}error(t){var n=this._sources;if(!super.error(t))return!1;for(var r=0;r<n.length;r++)try{n[r].error(t)}catch{}return!0}lock(){super.lock();for(var t=this._sources,n=0;n<t.length;n++)t[n].lock()}}class ko{constructor(t){this.data=t,this.length=t.length,this.index=0,this.zero=0}checkOffset(t){this.checkIndex(this.index+t)}checkIndex(t){if(this.length<this.zero+t||t<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+t+"). Corrupted zip ?")}setIndex(t){this.checkIndex(t),this.index=t}skip(t){this.setIndex(this.index+t)}byteAt(t){}readInt(t){var r,n=0;for(this.checkOffset(t),r=this.index+t-1;r>=this.index;r--)n=(n<<8)+this.byteAt(r);return this.index+=t,n}readString(t){return Y("string",this.readData(t))}readData(t){}lastIndexOfSignature(t){}readAndCheckSignature(t){}readDate(){var t=this.readInt(4);return new Date(Date.UTC(1980+(t>>25&127),(t>>21&15)-1,t>>16&31,t>>11&31,t>>5&63,(31&t)<<1))}}class Ao extends ko{constructor(t){super(t);for(var n=0;n<this.data.length;n++)t[n]=255&t[n]}byteAt(t){return this.data[this.zero+t]}lastIndexOfSignature(t){for(var n=t.charCodeAt(0),r=t.charCodeAt(1),a=t.charCodeAt(2),o=t.charCodeAt(3),l=this.length-4;l>=0;--l)if(this.data[l]===n&&this.data[l+1]===r&&this.data[l+2]===a&&this.data[l+3]===o)return l-this.zero;return-1}readAndCheckSignature(t){var n=t.charCodeAt(0),r=t.charCodeAt(1),a=t.charCodeAt(2),o=t.charCodeAt(3),l=this.readData(4);return n===l[0]&&r===l[1]&&a===l[2]&&o===l[3]}readData(t){if(this.checkOffset(t),0===t)return[];var n=this.data.slice(this.zero+this.index,this.zero+this.index+t);return this.index+=t,n}}class Du extends ko{constructor(t){super(t)}byteAt(t){return this.data.charCodeAt(this.zero+t)}lastIndexOfSignature(t){return this.data.lastIndexOf(t)-this.zero}readAndCheckSignature(t){return t===this.readData(4)}readData(t){this.checkOffset(t);const n=this.data.slice(this.zero+this.index,this.zero+this.index+t);return this.index+=t,n}}class wu extends Ao{constructor(t){super(t)}readData(t){if(this.checkOffset(t),0===t)return new Uint8Array(0);var n=this.data.subarray(this.zero+this.index,this.zero+this.index+t);return this.index+=t,n}}function $n(e){const t=dt(e);return Yt(t),"string"!==t||X.uint8array?X.uint8array?new wu(Y("uint8array",e)):new Ao(Y("array",e)):new Du(e)}class Au{constructor(t,n){this.options=t,this.loadOptions=n}isEncrypted(){return 1==(1&this.bitFlag)}useUTF8(){return 2048==(2048&this.bitFlag)}readLocalPart(t){var n,r;if(t.skip(22),this.fileNameLength=t.readInt(2),r=t.readInt(2),this.fileName=t.readData(this.fileNameLength),t.skip(r),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(n=function(e){for(var t in jt)if(jt.hasOwnProperty(t)&&jt[t].magic===e)return jt[t];return null}(this.compressionMethod),null===n)throw new Error("Corrupted zip : compression "+Zr(this.compressionMethod)+" unknown (inner file : "+Y("string",this.fileName)+")");this.decompressed=new Ot(this.compressedSize,this.uncompressedSize,this.crc32,n,t.readData(this.compressedSize))}readCentralPart(t){this.versionMadeBy=t.readInt(2),t.skip(2),this.bitFlag=t.readInt(2),this.compressionMethod=t.readString(2),this.date=t.readDate(),this.crc32=t.readInt(4),this.compressedSize=t.readInt(4),this.uncompressedSize=t.readInt(4);var n=t.readInt(2);if(this.extraFieldsLength=t.readInt(2),this.fileCommentLength=t.readInt(2),this.diskNumberStart=t.readInt(2),this.internalFileAttributes=t.readInt(2),this.externalFileAttributes=t.readInt(4),this.localHeaderOffset=t.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");t.skip(n),this.readExtraFields(t),this.parseZIP64ExtraField(t),this.fileComment=t.readData(this.fileCommentLength)}processAttributes(){this.unixPermissions=null,this.dosPermissions=null;var t=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0===t&&(this.dosPermissions=63&this.externalFileAttributes),3===t&&(this.unixPermissions=this.externalFileAttributes>>16&65535),!this.dir&&"/"===this.fileNameStr.slice(-1)&&(this.dir=!0)}parseZIP64ExtraField(t){if(this.extraFields[1]){var n=$n(this.extraFields[1].value);-1===this.uncompressedSize&&(this.uncompressedSize=n.readInt(8)),-1===this.compressedSize&&(this.compressedSize=n.readInt(8)),-1===this.localHeaderOffset&&(this.localHeaderOffset=n.readInt(8)),-1===this.diskNumberStart&&(this.diskNumberStart=n.readInt(4))}}readExtraFields(t){var r,a,o,n=t.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});t.index<n;)r=t.readInt(2),a=t.readInt(2),o=t.readData(a),this.extraFields[r]={id:r,length:a,value:o}}handleUTF8(){var t=X.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=ft(this.fileName),this.fileCommentStr=ft(this.fileComment);else{var n=this.findExtraFieldUnicodePath();if(null!==n)this.fileNameStr=n;else{var r=Y(t,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(r)}var a=this.findExtraFieldUnicodeComment();if(null!==a)this.fileCommentStr=a;else{var o=Y(t,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(o)}}}findExtraFieldUnicodePath(){var t=this.extraFields[28789];if(t){var n=$n(t.value);return 1!==n.readInt(1)||Qt(this.fileName)!==n.readInt(4)?null:ft(n.readData(t.length-5))}return null}findExtraFieldUnicodeComment(){var t=this.extraFields[25461];if(t){var n=$n(t.value);return 1!==n.readInt(1)||Qt(this.fileComment)!==n.readInt(4)?null:ft(n.readData(t.length-5))}return null}}class Mu{constructor(t){this.files=[],this.loadOptions=t}checkSignature(t){if(!this.reader.readAndCheckSignature(t)){this.reader.index-=4;var n=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+Zr(n)+", expected "+Zr(t)+")")}}isSignature(t,n){var r=this.reader.index;this.reader.setIndex(t);var o=this.reader.readString(4)===n;return this.reader.setIndex(r),o}readBlockEndOfCentral(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var t=this.reader.readData(this.zipCommentLength),r=Y(X.uint8array?"uint8array":"array",t);this.zipComment=this.loadOptions.decodeFileName(r)}readBlockZip64EndOfCentral(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var r,a,o,t=this.zip64EndOfCentralSize-44;0<t;)r=this.reader.readInt(2),a=this.reader.readInt(4),o=this.reader.readData(a),this.zip64ExtensibleData[r]={id:r,length:a,value:o}}readBlockZip64EndOfCentralLocator(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw new Error("Multi-volumes zip are not supported")}readLocalFiles(){var t,n;for(t=0;t<this.files.length;t++)this.reader.setIndex((n=this.files[t]).localHeaderOffset),this.checkSignature(Jr),n.readLocalPart(this.reader),n.handleUTF8(),n.processAttributes()}readCentralDir(){var t;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(Yr);)(t=new Au({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(t);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)}readEndOfCentral(){var t=this.reader.lastIndexOfSignature(Vr);if(t<0)throw this.isSignature(0,Jr)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(t);var r=t;if(this.checkSignature(Vr),this.readBlockEndOfCentral(),this.diskNumber===zn||this.diskWithCentralDirStart===zn||this.centralDirRecordsOnThisDisk===zn||this.centralDirRecords===zn||-1===this.centralDirSize||-1===this.centralDirOffset){if(this.zip64=!0,(t=this.reader.lastIndexOfSignature("PK\x06\x07"))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(t),this.checkSignature("PK\x06\x07"),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,Qr)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(Qr),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(Qr),this.readBlockZip64EndOfCentral()}var a=this.centralDirOffset+this.centralDirSize;this.zip64&&(a+=20,a+=12+this.zip64EndOfCentralSize);var o=r-a;if(o>0)this.isSignature(r,Yr)||(this.reader.zero=o);else if(o<0)throw new Error("Corrupted zip: missing "+Math.abs(o)+" bytes.")}prepareReader(t){this.reader=$n(t)}load(t){this.prepareReader(t),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}}function Ou(e){return new Re.Promise(function(t,n){var r=e.decompressed.getContentWorker().pipe(new vo);r.on("error",function(a){n(a)}).on("end",function(){r.streamInfo.crc32!==e.decompressed.crc32?n(new Error("Corrupted zip : CRC32 mismatch")):t()}).resume()})}function Ru(e,t){var n=this;return t=$r(t||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:ft}),go("the loaded zip file",e,!0,t.optimizedBinaryString,t.base64).then(function(r){var a=new Mu(t);return a.load(r),a}).then(function(a){var o=[Re.Promise.resolve(a)],l=a.files;if(t.checkCRC32)for(var s=0;s<l.length;s++)o.push(Ou(l[s]));return Re.Promise.all(o)}).then(function(a){for(var o=a.shift(),l=o.files,s=0;s<l.length;s++){var c=l[s];n.file(c.fileNameStr,c.decompressed,{binary:!0,optimizedBinaryString:!0,date:c.date,dir:c.dir,comment:c.fileCommentStr.length?c.fileCommentStr:null,unixPermissions:c.unixPermissions,dosPermissions:c.dosPermissions,createFolders:t.createFolders})}return o.zipComment.length&&(n.comment=o.zipComment),n})}var Mo=function(e,t,n){var a,r=dt(t),o=$r(n||{},yo);o.date=o.date||new Date,null!==o.compression&&(o.compression=o.compression.toUpperCase()),"string"==typeof o.unixPermissions&&(o.unixPermissions=parseInt(o.unixPermissions,8)),o.unixPermissions&&16384&o.unixPermissions&&(o.dir=!0),o.dosPermissions&&16&o.dosPermissions&&(o.dir=!0),o.dir&&(e=Oo(e)),o.createFolders&&(a=Tu(e))&&Ro.call(this,a,!0),(!n||typeof n.binary>"u")&&(o.binary=!("string"===r&&!1===o.binary&&!1===o.base64)),(t instanceof Ot&&0===t.uncompressedSize||o.dir||!t||0===t.length)&&(o.base64=!1,o.binary=!0,t="",o.compression="STORE",r="string");var c;c=t instanceof Ot||t instanceof ie?t:go(e,t,o.binary,o.optimizedBinaryString,o.base64);var u=new fu(e,c,o);this.files[e]=u},Tu=function(e){"/"===e.slice(-1)&&(e=e.substring(0,e.length-1));var t=e.lastIndexOf("/");return t>0?e.substring(0,t):""},Oo=function(e){return"/"!==e.slice(-1)&&(e+="/"),e},Ro=function(e,t){return t=!(typeof t<"u")||t,e=Oo(e),this.files[e]||Mo.call(this,e,null,{dir:!0,createFolders:t}),this.files[e]};function To(e){return"[object RegExp]"===Object.prototype.toString.call(e)}class Un{constructor(){if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){const t=new Un;for(const n in this)"function"!=typeof this[n]&&(t[n]=this[n]);return t}}load(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")}forEach(t){var n,r,a;for(n in this.files)a=this.files[n],(r=n.slice(this.root.length,n.length))&&n.slice(0,this.root.length)===this.root&&t(r,a)}filter(t){var n=[];return this.forEach(function(r,a){t(r,a)&&n.push(a)}),n}file(t,n,r){if(1===arguments.length){if(To(t)){var a=t;return this.filter(function(l,s){return!s.dir&&a.test(l)})}var o=this.files[this.root+t];return o&&!o.dir?o:null}return Mo.call(this,t=this.root+t,n,r),this}folder(t){if(!t)return this;if(To(t))return this.filter(function(o,l){return l.dir&&t.test(o)});var r=Ro.call(this,this.root+t),a=this.clone();return a.root=r.name,a}remove(t){var n=this.files[t=this.root+t];if(n||("/"!==t.slice(-1)&&(t+="/"),n=this.files[t]),n&&!n.dir)delete this.files[t];else for(var r=this.filter(function(o,l){return l.name.slice(0,t.length)===t}),a=0;a<r.length;a++)delete this.files[r[a].name];return this}generate(t){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")}generateInternalStream(t){var n,r={};try{if((r=$r(t||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:Vt})).type=r.type.toLowerCase(),r.compression=r.compression.toUpperCase(),"binarystring"===r.type&&(r.type="string"),!r.type)throw new Error("No output type specified.");Yt(r.type),("darwin"===r.platform||"freebsd"===r.platform||"linux"===r.platform||"sunos"===r.platform)&&(r.platform="UNIX"),"win32"===r.platform&&(r.platform="DOS"),n=function(e,t,n){var r=new bu(t.streamFiles,n,t.platform,t.encodeFileName),a=0;try{e.forEach(function(o,l){a++;var s=function(e,t){var n=e||t,r=jt[n];if(!r)throw new Error(n+" is not a valid compression method !");return r}(l.options.compression,t.compression),u=l.dir,d=l.date;l._compressWorker(s,l.options.compressionOptions||t.compressionOptions||{}).withStreamInfo("file",{name:o,dir:u,date:d,comment:l.comment||"",unixPermissions:l.unixPermissions,dosPermissions:l.dosPermissions}).pipe(r)}),r.entriesCount=a}catch(o){r.error(o)}return r}(this,r,r.comment||this.comment||"")}catch(o){(n=new ie("error")).error(o)}return new _o(n,r.type||"string",r.mimeType)}generateAsync(t,n){return this.generateInternalStream(t).accumulate(n)}loadAsync(t,n){return Ru.apply(this,[t,n])}static loadAsync(t,n){return(new Un).loadAsync(t,n)}static get support(){return X}static get defaults(){return yo}static get version(){return"3.2.2-esm"}static get external(){return Re}}function Eo(e,t,n){return(1461*(e+4800+((t-13)/12|0))/4|0)+(367*(t-1-12*((t-13)/12|0))/12|0)-(3*((e+4900+((t-13)/12|0))/100|0)/4|0)+n-32075}const Nu=Eo(1900,0,-1);const No="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",Pu=`data:${No};base64,`,Fo={compression:"DEFLATE",type:"base64"},Bu={compression:"DEFLATE",type:"blob"},zu={compression:"DEFLATE",type:"arraybuffer"};function Lo(e){return Pu+e}function Wt(e,t){return t.indexOf(e)}const Io=JSON.parse.bind(JSON);function L(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\"/g,"&quot;").replace(/\'/g,"&#39;")}function Po(e,t){let n="";for(let r=0;r<e;++r)n+=t(r);return n}function P(e,t){let n="";if(null!=e)if(Array.isArray(e))for(let r=0;r<e.length;++r)n+=t(e[r],r);else"object"==typeof e&&Object.keys(e).forEach((r,a)=>{n+=t(e[r],r,a)});return n}const ce='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r',Zu=`${ce}\n            <Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">\n               <Relationship Id="rId3" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties" Target="docProps/app.xml"/>\n               <Relationship Id="rId2" Type="http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties" Target="docProps/core.xml"/>\n               <Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" Target="xl/workbook.xml"/>\n            </Relationships>`,Wu=e=>`${ce}\n<Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">\n  ${P(e,t=>`\n    <Relationship Id="${t.rId}" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/image" Target="${t.target}"/>`)}\n</Relationships>`;function jr(e){const t=Math.floor(e/26)-1;return(t>=0?jr(t):"")+String.fromCharCode(65+e%26)}function Rt(e,t){return jr(t)+(e+1)}function qn(e,t){return"$"+jr(t)+"$"+(e+1)}function Hn(e){return(e.frozenRows||(e.freezePane||{}).rowSplit||1)-1}function Wr(e){return e/7-Math.floor(128/7)/256}class rd{constructor(t,n,r,a){this.options=t,this._strings=n,this._styles=r,this._borders=a,this._validations={},this._comments=[],this._drawings=t.drawings||[],this._hyperlinks=(this.options.hyperlinks||[]).map((o,l)=>Object.assign({},o,{rId:`link${l}`}))}relsToXML(){const t=this._hyperlinks,n=this._comments,r=this._drawings;if(t.length||n.length||r.length)return(({hyperlinks:e,comments:t,sheetIndex:n,drawings:r})=>`${ce}\n<Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">\n  ${P(e,a=>`\n    <Relationship Id="${a.rId}" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink" Target="${L(a.target)}" TargetMode="External" />`)}\n  ${t.length?`\n    <Relationship Id="comment${n}" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments" Target="../comments${n}.xml"/>\n    <Relationship Id="vml${n}" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing" Target="../drawings/vmlDrawing${n}.vml"/>`:""}\n  ${r.length?`\n    <Relationship Id="drw${n}" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing" Target="../drawings/drawing${n}.xml"/>`:""}\n</Relationships>`)({hyperlinks:t,comments:n,sheetIndex:this.options.sheetIndex,drawings:r})}toXML(t){const n=this.options.mergedCells||[],a=function ud(e,t){const n=[],r=[];!function dd(e,t){for(let n=0;n<e.length;n++){const r=e[n];if(!r)continue;let a=r.index;"number"!=typeof a&&(a=n),t(r,a)}}(e,function(l,s){const c={_source:l,index:s,height:l.height,level:l.level,cells:[]};n.push(c),r[s]=c});const a=Zo(n).slice(0),o={rowData:n,rowsByIndex:r,mergedCells:t};for(let l=0;l<a.length;l++)pd(a[l],o),delete a[l]._source;return Zo(n)}(this.options.rows||[],n);this._readCells(a);let l,o=this.options.filter;o&&"number"==typeof o.from&&"number"==typeof o.to?o={from:Rt(Hn(this.options),o.from),to:Rt(Hn(this.options),o.to)}:o&&o.ref&&o.columns&&(l=o,o=null);const s=[];for(let p in this._validations)Object.prototype.hasOwnProperty.call(this._validations,p)&&s.push(this._validations[p]);let c=null;this.options.defaultCellStyle&&(c=this._lookupStyle(this.options.defaultCellStyle));const u=this.options.freezePane||{},d=this.options.defaults||{},m=this.options.rows?this._getLastRow():1,f=this.options.rows?this._getLastCol():1;return(({frozenColumns:e,frozenRows:t,columns:n,defaults:r,data:a,index:o,mergeCells:l,autoFilter:s,filter:c,showGridLines:u,hyperlinks:d,validations:m,defaultCellStyleId:f,rtl:p,legacyDrawing:_,drawing:k,lastRow:v,lastCol:D})=>`${ce}\n<worksheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac" mc:Ignorable="x14ac">\n   ${v&&D?`<dimension ref="A1:${Rt(v-1,D-1)}" />`:""}\n\n   <sheetViews>\n     <sheetView ${p?'rightToLeft="1"':""} ${0===o?'tabSelected="1"':""} workbookViewId="0" ${!1===u?'showGridLines="0"':""}>\n     ${t||e?`\n       <pane state="frozen"\n         ${e?`xSplit="${e}"`:""}\n         ${t?`ySplit="${t}"`:""}\n         topLeftCell="${String.fromCharCode(65+(e||0))+((t||0)+1)}"\n       />`:""}\n     </sheetView>\n   </sheetViews>\n\n   <sheetFormatPr x14ac:dyDescent="0.25" ${r.skipCustomHeight?"":'customHeight="1"'} defaultRowHeight="${r.rowHeight?.75*r.rowHeight:15}"\n     ${r.columnWidth?`defaultColWidth="${Wr(r.columnWidth)}"`:""} />\n\n   ${null!=f||n&&n.length>0?`\n     <cols>\n       ${n&&n.length?"":`\n         <col min="1" max="16384" style="${f}"\n              ${r.columnWidth?`width="${Wr(r.columnWidth)}"`:""} /> `}\n       ${P(n,(x,C)=>{const b="number"==typeof x.index?x.index+1:C+1;return 0===x.width?`<col ${null!=f?`style="${f}"`:""}\n                        min="${b}" max="${b}" hidden="1" customWidth="1" />`:`<col ${null!=f?`style="${f}"`:""}\n                      min="${b}" max="${b}" customWidth="1"\n                      ${x.autoWidth?`width="${(7*x.width+5)/7*256/256}" bestFit="1"`:`width="${Wr(x.width)}"`} />`})}\n     </cols>`:""}\n\n   <sheetData>\n     ${P(a,(x,C)=>`\n         <row r="${"number"==typeof x.index?x.index+1:C+1}" x14ac:dyDescent="0.25"\n              ${x.level?`outlineLevel="${x.level}"`:""}\n              ${0===x.height?'hidden="1"':x.height?`ht="${function td(e){return.75*e}(x.height)}" customHeight="1"`:""}>\n           ${P(x.data,g=>`\n             <c r="${g.ref}" ${g.style?`s="${g.style}"`:""} ${g.type?`t="${g.type}"`:""}>\n               ${null!=g.formula?function ed(e){return"string"==typeof e?`<f>${L(e)}</f>`:`<f t="array" ref="${e.ref}">${L(e.src)}</f>`}(g.formula):""}\n               ${null!=g.value?`<v>${L(g.value)}</v>`:""}\n             </c>`)}\n         </row>\n       `)}\n   </sheetData>\n\n   ${s?`<autoFilter ref="${s.from}:${s.to}"/>`:c?ht(c):""}\n\n   ${l.length?`\n     <mergeCells count="${l.length}">\n       ${P(l,x=>`<mergeCell ref="${x}"/>`)}\n     </mergeCells>`:""}\n\n   ${m.length?`\n     <dataValidations>\n       ${P(m,x=>`\n         <dataValidation sqref="${x.sqref.join(" ")}"\n                         showErrorMessage="${x.showErrorMessage}"\n                         type="${L(x.type)}"\n                         ${"list"!==x.type?`operator="${L(x.operator)}"`:""}\n                         allowBlank="${x.allowBlank}"\n                         showDropDown="${x.showDropDown}"\n                         ${x.error?`error="${L(x.error)}"`:""}\n                         ${x.errorTitle?`errorTitle="${L(x.errorTitle)}"`:""}>\n           ${x.formula1?`<formula1>${L(x.formula1)}</formula1>`:""}\n           ${x.formula2?`<formula2>${L(x.formula2)}</formula2>`:""}\n         </dataValidation>`)}\n     </dataValidations>`:""}\n\n   ${d.length?`\n     <hyperlinks>\n       ${P(d,x=>`\n         <hyperlink ref="${x.ref}" r:id="${x.rId}"/>`)}\n     </hyperlinks>`:""}\n\n   <pageMargins left="0.7" right="0.7" top="0.75" bottom="0.75" header="0.3" footer="0.3" />\n   ${k?`<drawing r:id="${k}"/>`:""}\n   ${_?`<legacyDrawing r:id="${_}"/>`:""}\n</worksheet>`)({frozenColumns:this.options.frozenColumns||u.colSplit,frozenRows:this.options.frozenRows||u.rowSplit,columns:this.options.columns,defaults:d,data:a,index:t,mergeCells:n,autoFilter:o,filter:l,showGridLines:this.options.showGridLines,hyperlinks:this._hyperlinks,validations:s,defaultCellStyleId:c,rtl:void 0!==this.options.rtl?this.options.rtl:d.rtl,legacyDrawing:this._comments.length?`vml${this.options.sheetIndex}`:null,drawing:this._drawings.length?`drw${this.options.sheetIndex}`:null,lastRow:m,lastCol:f})}commentsXML(){if(this._comments.length)return(({comments:e})=>`${ce}\n<comments xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main">\n  <authors>\n    <author></author>\n  </authors>\n  <commentList>\n    ${P(e,t=>`\n      <comment ref="${t.ref}" authorId="0">\n        <text>\n          <r>\n            <rPr>\n              <sz val="8"/>\n              <color indexed="81"/>\n              <rFont val="Tahoma"/>\n              <charset val="1"/>\n            </rPr>\n            <t>${L(t.text)}</t>\n          </r>\n        </text>\n      </comment>`)}\n  </commentList>\n</comments>`)({comments:this._comments})}drawingsXML(t){if(this._drawings.length){let n={};return{main:(e=this._drawings.map(a=>{let o=Kt(a.topLeftCell),l=n[a.image];return l||(l=n[a.image]={rId:`img${a.image}`,target:t[a.image].target}),{col:o.col,colOffset:Gn(a.offsetX),row:o.row,rowOffset:Gn(a.offsetY),width:Gn(a.width),height:Gn(a.height),imageId:l.rId}}),`${ce}\n<xdr:wsDr xmlns:xdr="http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing"\n          xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main"\n          xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships">\n  ${P(e,(t,n)=>`\n    <xdr:oneCellAnchor editAs="oneCell">\n      <xdr:from>\n        <xdr:col>${t.col}</xdr:col>\n        <xdr:colOff>${t.colOffset}</xdr:colOff>\n        <xdr:row>${t.row}</xdr:row>\n        <xdr:rowOff>${t.rowOffset}</xdr:rowOff>\n      </xdr:from>\n      <xdr:ext cx="${t.width}" cy="${t.height}" />\n      <xdr:pic>\n        <xdr:nvPicPr>\n          <xdr:cNvPr id="${n+1}" name="Picture ${n+1}"/>\n          <xdr:cNvPicPr/>\n        </xdr:nvPicPr>\n        <xdr:blipFill>\n          <a:blip r:embed="${t.imageId}"/>\n          <a:stretch>\n            <a:fillRect/>\n          </a:stretch>\n        </xdr:blipFill>\n        <xdr:spPr>\n          <a:prstGeom prst="rect">\n            <a:avLst/>\n          </a:prstGeom>\n        </xdr:spPr>\n      </xdr:pic>\n      <xdr:clientData/>\n    </xdr:oneCellAnchor>`)}\n</xdr:wsDr>`),rels:Wu(n)}}var e}legacyDrawing(){if(this._comments.length)return(({comments:e})=>`<xml xmlns:v="urn:schemas-microsoft-com:vml"\n     xmlns:o="urn:schemas-microsoft-com:office:office"\n     xmlns:x="urn:schemas-microsoft-com:office:excel">\n  <v:shapetype coordsize="21600,21600" id="_x0000_t202" path="m,l,21600r21600,l21600,xe">\n    <v:stroke joinstyle="miter"/>\n    <v:path gradientshapeok="t" o:connecttype="rect"/>\n  </v:shapetype>\n  ${P(e,t=>`\n    <v:shape type="#_x0000_t202" style="visibility: hidden" fillcolor="#ffffe1" o:insetmode="auto">\n      <v:shadow on="t" color="black" obscured="t"/>\n      <x:ClientData ObjectType="Note">\n        <x:MoveWithCells/>\n        <x:SizeWithCells/>\n        <x:Anchor>${t.anchor}</x:Anchor>\n        <x:AutoFill>False</x:AutoFill>\n        <x:Row>${t.row}</x:Row>\n        <x:Column>${t.col}</x:Column>\n      </x:ClientData>\n    </v:shape>`)}\n</xml>`)({comments:this._comments})}_lookupString(t){const n="$"+t,r=this._strings.indexes[n];let a;return void 0!==r?a=r:(a=this._strings.indexes[n]=this._strings.uniqueCount,this._strings.uniqueCount++),this._strings.count++,a}_lookupStyle(t){const n=JSON.stringify(t);if("{}"===n)return 0;let r=Wt(n,this._styles);return r<0&&(r=this._styles.push(n)-1),r+1}_lookupBorder(t){const n=JSON.stringify(t);if("{}"===n)return;let r=Wt(n,this._borders);return r<0&&(r=this._borders.push(n)-1),r+1}_readCells(t){for(let n=0;n<t.length;n++){const r=t[n],a=r.cells;r.data=[];for(let o=0;o<a.length;o++){const l=this._cell(a[o],r.index,o);l&&r.data.push(l)}}}_cell(t,n,r){if(!t||t===zo)return null;let a=t.value,o={};t.borderLeft&&(o.left=t.borderLeft),t.borderRight&&(o.right=t.borderRight),t.borderTop&&(o.top=t.borderTop),t.borderBottom&&(o.bottom=t.borderBottom),t.dBorders&&(o.diagonal=t.dBorders),o=this._lookupBorder(o);const l=this.options.defaultCellStyle||{};let s={borderId:o};var f;(f=function(f,p){let _=t[f];if(void 0===_&&(_=l[f]),void 0!==_)return s[p||f]=_,!0})("color"),f("background"),f("bold"),f("italic"),f("underline"),f("fontFamily")||f("fontName","fontFamily"),f("fontSize"),f("format"),f("textAlign")||f("hAlign","textAlign"),f("verticalAlign")||f("vAlign","verticalAlign"),f("wrap"),f("indent");const u=(this.options.columns||[])[r];let d=typeof a;if(u&&u.autoWidth&&(!t.colSpan||1===t.colSpan)){let f=a;"number"===d&&(f=$i.toString(a,t.format)),u.width=Math.max(u.width||0,String(f).length)}"string"===d?(a=function nd(e){return String(e).replace(/[\x00-\x09\x0B\x0C\x0E-\x1F]/g,"").replace(/\r?\n/g,"\r\n")}(a),a=this._lookupString(a),d="s"):"number"===d?d="n":"boolean"===d?(d="b",a=Number(a)):a&&a.getTime?(d=null,a=function Iu(e){const t=function Lu(e,t,n,r){return(e+(t+(n+r/1e3)/60)/60)/24}(e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()),n=function Fu(e,t,n){return Eo(e,t,n)-Nu}(e.getFullYear(),e.getMonth(),e.getDate());return n<0?n-1+t:n+t}(a),s.format||(s.format="mm-dd-yy")):(d=null,a=null),s=this._lookupStyle(s);const m=Rt(n,r);return t.validation&&this._addValidation(t.validation,m),t.comment&&this._comments.push({ref:m,text:t.comment,row:n,col:r,anchor:[r+1,15,n,10,r+3,15,n+3,4].join(", ")}),{value:a,formula:t.formula,type:d,style:s,ref:m}}_addValidation(t,n){const r={showErrorMessage:"reject"===t.type?1:0,formula1:t.from,formula2:t.to,type:ad[t.dataType]||t.dataType,operator:id[t.comparerType]||t.comparerType,allowBlank:t.allowNulls?1:0,showDropDown:t.showButton?0:1,error:t.messageTemplate,errorTitle:t.titleTemplate},a=JSON.stringify(r);this._validations[a]||(this._validations[a]=r,r.sqref=[]),this._validations[a].sqref.push(n)}_getLastRow(){return Bo(this.options.rows)}_getLastCol(){let t=0;return this.options.rows.forEach(function(n){n.cells&&(t=Math.max(t,Bo(n.cells)))}),t}}function Bo(e){let t=e.length;return e.forEach(function(n){n.index&&n.index>=t&&(t=n.index+1)}),t}const id={greaterThanOrEqualTo:"greaterThanOrEqual",lessThanOrEqualTo:"lessThanOrEqual"},ad={number:"decimal"},Xr={General:0,0:1,"0.00":2,"#,##0":3,"#,##0.00":4,"0%":9,"0.00%":10,"0.00E+00":11,"# ?/?":12,"# ??/??":13,"mm-dd-yy":14,"d-mmm-yy":15,"d-mmm":16,"mmm-yy":17,"h:mm AM/PM":18,"h:mm:ss AM/PM":19,"h:mm":20,"h:mm:ss":21,"m/d/yy h:mm":22,"#,##0 ;(#,##0)":37,"#,##0 ;[Red](#,##0)":38,"#,##0.00;(#,##0.00)":39,"#,##0.00;[Red](#,##0.00)":40,"mm:ss":45,"[h]:mm:ss":46,"mmss.0":47,"##0.0E+0":48,"@":49,"[$-404]e/m/d":27,"m/d/yy":30,t0:59,"t0.00":60,"t#,##0":61,"t#,##0.00":62,"t0%":67,"t0.00%":68,"t# ?/?":69,"t# ??/??":70};function Kr(e){let t=function od(e){function t(r){let a=parseInt(r,10).toString(16);return a.length<2?"0"+a:a}let n=/^rgba?\((\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*([0-9.]+)\s*)?\)/i.exec(e.trim());return n?"#"+t(255*(n[4]?parseFloat(n[4]):1)|0)+t(n[1])+t(n[2])+t(n[3]):e}(e);return t.length<6&&(t=t.replace(/(\w)/g,function(n,r){return r+r})),t=t.substring(1).toUpperCase(),t.length<8&&(t="FF"+t),t}class ld{constructor(t){this.options=t||{},this._strings={indexes:{},count:0,uniqueCount:0},this._styles=[],this._borders=[],this._images=this.options.images,this._imgId=0,this._sheets=Ce(this.options.sheets||[],(n,r)=>(n.defaults=this.options,n.sheetIndex=r+1,new rd(n,this._strings,this._styles,this._borders)))}imageFilename(t){const n=++this._imgId;switch(t){case"image/jpg":case"image/jpeg":return`image${n}.jpg`;case"image/png":return`image${n}.png`;case"image/gif":return`image${n}.gif`;default:return`image${n}.bin`}}toZIP(){const t=function Eu(){return new Un}(),n=t.folder("docProps");n.file("core.xml",(({creator:e,lastModifiedBy:t,created:n,modified:r})=>`${ce}\n <cp:coreProperties xmlns:cp="http://schemas.openxmlformats.org/package/2006/metadata/core-properties"\n   xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/"\n   xmlns:dcmitype="http://purl.org/dc/dcmitype/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">\n   <dc:creator>${L(e)}</dc:creator>\n   <cp:lastModifiedBy>${L(t)}</cp:lastModifiedBy>\n   <dcterms:created xsi:type="dcterms:W3CDTF">${L(n)}</dcterms:created>\n   <dcterms:modified xsi:type="dcterms:W3CDTF">${L(r)}</dcterms:modified>\n</cp:coreProperties>`)({creator:this.options.creator||"Kendo UI",lastModifiedBy:this.options.creator||"Kendo UI",created:this.options.date||(new Date).toJSON(),modified:this.options.date||(new Date).toJSON()}));const r=this._sheets.length;n.file("app.xml",(({sheets:e})=>`${ce}\n<Properties xmlns="http://schemas.openxmlformats.org/officeDocument/2006/extended-properties" xmlns:vt="http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes">\n  <Application>Microsoft Excel</Application>\n  <DocSecurity>0</DocSecurity>\n  <ScaleCrop>false</ScaleCrop>\n  <HeadingPairs>\n    <vt:vector size="2" baseType="variant">\n      <vt:variant>\n        <vt:lpstr>Worksheets</vt:lpstr>\n      </vt:variant>\n      <vt:variant>\n        <vt:i4>${e.length}</vt:i4>\n      </vt:variant>\n    </vt:vector>\n  </HeadingPairs>\n  <TitlesOfParts>\n    <vt:vector size="${e.length}" baseType="lpstr">${P(e,(t,n)=>t.options.title?`<vt:lpstr>${L(t.options.title)}</vt:lpstr>`:`<vt:lpstr>Sheet${n+1}</vt:lpstr>`)}</vt:vector>\n  </TitlesOfParts>\n  <LinksUpToDate>false</LinksUpToDate>\n  <SharedDoc>false</SharedDoc>\n  <HyperlinksChanged>false</HyperlinksChanged>\n  <AppVersion>14.0300</AppVersion>\n</Properties>`)({sheets:this._sheets})),t.folder("_rels").file(".rels",Zu);const o=t.folder("xl");if(o.folder("_rels").file("workbook.xml.rels",(({count:e})=>`${ce}\n<Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">\n  ${Po(e,t=>`\n    <Relationship Id="rId${t+1}" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet" Target="worksheets/sheet${t+1}.xml" />`)}\n  <Relationship Id="rId${e+1}" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles" Target="styles.xml" />\n  <Relationship Id="rId${e+2}" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings" Target="sharedStrings.xml" />\n</Relationships>`)({count:r})),this._images){const g=o.folder("media");Object.keys(this._images).forEach(w=>{const y=this._images[w],M=this.imageFilename(y.type);g.file(M,y.data),y.target=`../media/${M}`})}const s={};o.file("workbook.xml",(({sheets:e,filterNames:t,userNames:n})=>`${ce}\n<workbook xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships">\n  <fileVersion appName="xl" lastEdited="5" lowestEdited="5" rupBuild="9303" />\n  <workbookPr defaultThemeVersion="124226" />\n  <bookViews>\n    <workbookView xWindow="240" yWindow="45" windowWidth="18195" windowHeight="7995" />\n  </bookViews>\n  <sheets>\n  ${P(e,({options:r},a)=>`<sheet name="${L(r.name||r.title||`Sheet${a+1}`)}" sheetId="${a+1}" r:id="rId${a+1}" />`)}\n  </sheets>\n  ${t.length||n.length?`\n    <definedNames>\n      ${P(t,r=>`\n         <definedName name="_xlnm._FilterDatabase" hidden="1" localSheetId="${r.localSheetId}">${L(function Dd(e){return/^\'/.test(e)||/^[a-z_][a-z0-9_]*$/i.test(e)?e:"'"+e.replace(/\x27/g,"\\'")+"'"}(r.name))}!${L(r.from)}:${L(r.to)}</definedName>`)}\n      ${P(n,r=>`\n         <definedName name="${r.name}" hidden="${r.hidden?1:0}" ${null!=r.localSheetId?`localSheetId="${r.localSheetId}"`:""}>${L(r.value)}</definedName>`)}\n    </definedNames>`:""}\n  <calcPr fullCalcOnLoad="1" calcId="145621" />\n</workbook>`)({sheets:this._sheets,filterNames:Ce(this._sheets,function(g,w){const y=g.options,M=y.name||y.title||"Sheet"+(w+1);s[M.toLowerCase()]=w;const A=y.filter;if(A){if(A.ref){let S=A.ref.split(":"),O=Kt(S[0]),K=Kt(S[1]);return{localSheetId:w,name:M,from:qn(O.row,O.col),to:qn(K.row,K.col)}}if(typeof A.from<"u"&&typeof A.to<"u")return{localSheetId:w,name:M,from:qn(Hn(y),A.from),to:qn(Hn(y),A.to)}}}),userNames:Ce(this.options.names||[],function(g){return{name:g.localName,localSheetId:g.sheet?s[g.sheet.toLowerCase()]:null,value:g.value,hidden:g.hidden}})}));const c=o.folder("worksheets"),u=o.folder("drawings"),d=u.folder("_rels"),m=c.folder("_rels"),f=[],p=[];for(let g=0;g<r;g++){const w=this._sheets[g],y=`sheet${g+1}.xml`,M=w.toXML(g),A=w.relsToXML(),S=w.commentsXML(),O=w.legacyDrawing(),K=w.drawingsXML(this._images);if(A&&m.file(y+".rels",A),S){let ue=`comments${w.options.sheetIndex}.xml`;o.file(ue,S),f.push(ue)}if(O&&u.file(`vmlDrawing${w.options.sheetIndex}.vml`,O),K){let ue=`drawing${w.options.sheetIndex}.xml`;u.file(ue,K.main),d.file(`${ue}.rels`,K.rels),p.push(ue)}c.file(y,M)}const _=Ce(this._borders,Io),k=Ce(this._styles,Io),v=function(g){return g.underline||g.bold||g.italic||g.color||g.fontFamily||g.fontSize},x=Ce(k,function(g){if(g.fontSize&&(g.fontSize=function(g){let y,w=Number(g);return w&&(y=3*w/4),y}(g.fontSize)),g.color&&(g.color=Kr(g.color)),v(g))return g}),C=Ce(k,function(g){if(g.format&&void 0===Xr[g.format])return g}),b=Ce(k,function(g){if(g.background)return g.background=Kr(g.background),g});return o.file("styles.xml",(({formats:e,fonts:t,fills:n,borders:r,styles:a})=>`${ce}\n<styleSheet\n    xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main"\n    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"\n    mc:Ignorable="x14ac"\n    xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac">\n  <numFmts count="${e.length}">\n  ${P(e,(o,l)=>`\n    <numFmt formatCode="${L(o.format)}" numFmtId="${165+l}" />`)}\n  </numFmts>\n  <fonts count="${t.length+1}" x14ac:knownFonts="1">\n    <font>\n       <sz val="11" />\n       <color theme="1" />\n       <name val="Calibri" />\n       <family val="2" />\n       <scheme val="minor" />\n    </font>\n    ${P(t,o=>`\n    <font>\n      ${o.bold?"<b/>":""}\n      ${o.italic?"<i/>":""}\n      ${o.underline?"<u/>":""}\n      <sz val="${o.fontSize||11}" />\n      ${o.color?`<color rgb="${L(o.color)}" />`:'<color theme="1" />'}\n      ${o.fontFamily?`\n        <name val="${L(o.fontFamily)}" />\n        <family val="2" />\n      `:'\n        <name val="Calibri" />\n        <family val="2" />\n        <scheme val="minor" />\n      '}\n    </font>`)}\n  </fonts>\n  <fills count="${n.length+2}">\n      <fill><patternFill patternType="none"/></fill>\n      <fill><patternFill patternType="gray125"/></fill>\n    ${P(n,o=>"\n      "+(o.background?`\n        <fill>\n          <patternFill patternType="solid">\n              <fgColor rgb="${L(o.background)}"/>\n          </patternFill>\n        </fill>\n      `:""))}\n  </fills>\n  <borders count="${r.length+1}">\n    <border><left/><right/><top/><bottom/><diagonal/></border>\n    ${P(r,cd)}\n  </borders>\n  <cellStyleXfs count="1">\n    <xf borderId="0" fillId="0" fontId="0" />\n  </cellStyleXfs>\n  <cellXfs count="${a.length+1}">\n    <xf numFmtId="0" fontId="0" fillId="0" borderId="0" xfId="0" />\n    ${P(a,o=>`\n      <xf xfId="0"\n          ${o.fontId?`fontId="${o.fontId}" applyFont="1"`:""}\n          ${o.fillId?`fillId="${o.fillId}" applyFill="1"`:""}\n          ${o.numFmtId?`numFmtId="${o.numFmtId}" applyNumberFormat="1"`:""}\n          ${o.textAlign||o.verticalAlign||o.wrap?'applyAlignment="1"':""}\n          ${o.borderId?`borderId="${o.borderId}" applyBorder="1"`:""}>\n        ${o.textAlign||o.verticalAlign||o.wrap?`\n        <alignment\n          ${o.textAlign?`horizontal="${L(o.textAlign)}"`:""}\n          ${o.verticalAlign?`vertical="${L(o.verticalAlign)}"`:""}\n          ${o.indent?`indent="${L(o.indent)}"`:""}\n          ${o.wrap?'wrapText="1"':""} />\n        `:""}\n      </xf>\n    `)}\n  </cellXfs>\n  <cellStyles count="1">\n    <cellStyle name="Normal" xfId="0" builtinId="0"/>\n  </cellStyles>\n  <dxfs count="0" />\n  <tableStyles count="0" defaultTableStyle="TableStyleMedium2" defaultPivotStyle="PivotStyleMedium9" />\n</styleSheet>`)({fonts:x,fills:b,formats:C,borders:_,styles:Ce(k,function(g){const w={};return v(g)&&(w.fontId=Wt(g,x)+1),g.background&&(w.fillId=Wt(g,b)+2),w.textAlign=g.textAlign,w.indent=g.indent,w.verticalAlign=g.verticalAlign,w.wrap=g.wrap,w.borderId=g.borderId,g.format&&(w.numFmtId=void 0!==Xr[g.format]?Xr[g.format]:165+Wt(g,C)),w})})),o.file("sharedStrings.xml",(({count:e,uniqueCount:t,indexes:n})=>`${ce}\n<sst xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" count="${e}" uniqueCount="${t}">\n  ${P(Object.keys(n),r=>`\n    <si><t xml:space="preserve">${L(r.substring(1))}</t></si>`)}\n</sst>`)(this._strings)),t.file("[Content_Types].xml",(({sheetCount:e,commentFiles:t,drawingFiles:n})=>`${ce}\n<Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types">\n  <Default Extension="png" ContentType="image/png"/>\n  <Default Extension="gif" ContentType="image/gif"/>\n  <Default Extension="jpg" ContentType="image/jpeg"/>\n  <Default Extension="rels" ContentType="application/vnd.openxmlformats-package.relationships+xml" />\n  <Default Extension="xml" ContentType="application/xml" />\n  <Default Extension="vml" ContentType="application/vnd.openxmlformats-officedocument.vmlDrawing"/>\n  <Override PartName="/xl/workbook.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml" />\n  <Override PartName="/xl/styles.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml"/>\n  <Override PartName="/xl/sharedStrings.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml"/>\n  ${Po(e,r=>`<Override PartName="/xl/worksheets/sheet${r+1}.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml" />`)}\n  ${P(t,r=>`<Override PartName="/xl/${r}" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml"/>`)}\n  ${P(n,r=>`<Override PartName="/xl/drawings/${r}" ContentType="application/vnd.openxmlformats-officedocument.drawing+xml"/>`)}\n  <Override PartName="/docProps/core.xml" ContentType="application/vnd.openxmlformats-package.core-properties+xml" />\n  <Override PartName="/docProps/app.xml" ContentType="application/vnd.openxmlformats-officedocument.extended-properties+xml" />\n</Types>`)({sheetCount:r,commentFiles:f,drawingFiles:p})),t}toDataURL(){const t=this.toZIP();return t.generateAsync?t.generateAsync(Fo).then(Lo):Lo(t.generate(Fo))}toBlob(){const t=this.toZIP();return t.generateAsync?t.generateAsync(Bu):new Blob([t.generate(zu)],{type:No})}}function Xt(e,t){let n="";return t&&(n+="<"+e+' style="'+function sd(e){let t="thin";return 2===e?t="medium":3===e&&(t="thick"),t}(t.size)+'">',t.color&&(n+='<color rgb="'+Kr(t.color)+'"/>'),n+="</"+e+">"),n}function cd(e){let t=e.diagonal?e.diagonal.type:0;return`<border ${2&t?'diagonalUp="true"':""} ${1&t?'diagonalDown="true"':""}>\n      ${Xt("left",e.left)}\n      ${Xt("right",e.right)}\n      ${Xt("top",e.top)}\n      ${Xt("bottom",e.bottom)}\n      ${Xt("diagonal",e.diagonal)}\n    </border>`}const zo={};function Zo(e){return e.sort(function(t,n){return t.index-n.index})}function fd(e,t){e.indexOf(t)<0&&e.push(t)}function hd(e,t){for(let n=0;n<e.length;++n){const a=e[n].split(":");let o=a[0];if(o===t){let l=a[1];return o=Kt(o),l=Kt(l),{rowSpan:l.row-o.row+1,colSpan:l.col-o.col+1}}}}function Kt(e){const r=/^([a-z]+)(\d+)$/i.exec(e);return{row:function n(a){return parseInt(a,10)-1}(r[2]),col:function t(a){let o=a.toUpperCase(),l=0;for(let s=0;s<o.length;++s)l=26*l+o.charCodeAt(s)-64;return l-1}(r[1])}}function Gn(e){return Math.round(9525*e)}function pd(e,t){const r=e.index,a=e._source.cells,o=e.cells;if(a)for(let l=0;l<a.length;l++){const s=a[l]||zo;let c=s.rowSpan||1,u=s.colSpan||1;const d=md(o,s),m=Rt(r,d);if(1===c&&1===u){const f=hd(t.mergedCells,m);f&&(u=f.colSpan,c=f.rowSpan)}if(Uo(s,o,d,u),(c>1||u>1)&&fd(t.mergedCells,m+":"+Rt(r+c-1,d+u-1)),c>1)for(let f=r+1;f<r+c;f++){let p=t.rowsByIndex[f];p||(p=t.rowsByIndex[f]={index:f,cells:[]},t.rowData.push(p)),Uo(s,p.cells,d-1,u+1)}}}function md(e,t){let n;return"number"==typeof t.index?(n=t.index,$o(e,t,t.index)):n=function gd(e,t){let n=e.length;for(let r=0;r<e.length+1;r++)if(!e[r]){e[r]=t,n=r;break}return n}(e,t),n}function $o(e,t,n){e[n]=t}function Uo(e,t,n,r){for(let a=1;a<r;a++)$o(t,{borderTop:e.borderTop,borderRight:e.borderRight,borderBottom:e.borderBottom,borderLeft:e.borderLeft},n+a)}const xd=({ref:e,columns:t,generators:n})=>`\n<autoFilter ref="${e}">\n  ${P(t,r=>`\n    <filterColumn colId="${r.index}">\n      ${n[r.filter](r)}\n    </filterColumn>\n  `)}\n</autoFilter>`,_d=({logic:e,criteria:t})=>`\n<customFilters ${"and"===e?'and="1"':""}>\n${P(t,n=>{let r=ht.customOperator(n);return`<customFilter ${r?`operator="${r}"`:""} val="${ht.customValue(n)}"/>`})}\n</customFilters>`,bd=({type:e})=>`<dynamicFilter type="${ht.dynamicFilterType(e)}" />`,yd=({type:e,value:t})=>`<top10 percent="${/percent$/i.test(e)?1:0}"\n       top="${/^top/i.test(e)?1:0}"\n       val="${t}" />`,vd=({blanks:e,values:t})=>`<filters ${e?'blank="1"':""}>\n    ${P(t,n=>`\n      <filter val="${n}" />`)}\n  </filters>`;function ht(e){return xd({ref:e.ref,columns:e.columns,generators:{custom:_d,dynamic:bd,top:yd,value:vd}})}function ei(e){return"string"==typeof e}ht.customOperator=function(e){return{eq:"equal",gt:"greaterThan",gte:"greaterThanOrEqual",lt:"lessThan",lte:"lessThanOrEqual",ne:"notEqual",doesnotstartwith:"notEqual",doesnotendwith:"notEqual",doesnotcontain:"notEqual",doesnotmatch:"notEqual"}[e.operator.toLowerCase()]},ht.customValue=function(e){function t(n){return n.replace(/([*?])/g,"~$1")}switch(e.operator.toLowerCase()){case"startswith":case"doesnotstartwith":return t(e.value)+"*";case"endswith":case"doesnotendwith":return"*"+t(e.value);case"contains":case"doesnotcontain":return"*"+t(e.value)+"*";default:return e.value}},ht.dynamicFilterType=function(e){return{quarter1:"Q1",quarter2:"Q2",quarter3:"Q3",quarter4:"Q4",january:"M1",february:"M2",march:"M3",april:"M4",may:"M5",june:"M6",july:"M7",august:"M8",september:"M9",october:"M10",november:"M11",december:"M12"}[e.toLowerCase()]||e};const Sd=/\{(\d+)}?\}/g;class kd{constructor({name:t,message:n}){if(!t||!n)throw new Error("{ name: string, message: string } object is required!");this.name=t,this.message=n}formatMessage(...t){const n=Ad(t),r=this.message.replace(Sd,function(a,o){return n[parseInt(o,10)]});return`${this.name}: ${r}`}error(...t){return new Error(this.formatMessage(t))}}const Ad=function(e){return e.reduce((t,n)=>t.concat(n),[])},en=(e={NoLocale:"Missing locale info for '{0}'",NoCurrency:"Cannot determine currency information. Please load the locale currencies data.",NoSupplementalCurrency:"Cannot determine currency. Please load the supplemental currencyData.",NoCurrencyRegion:"No currency data for region '{0}'",NoCurrencyDisplay:"Cannot determine currency display information. Please load the locale currencies data. The default culture does not include the all currencies data.",NoGMTInfo:"Cannot determine locale GMT format. Please load the locale timeZoneNames data.",NoWeekData:"Cannot determine locale first day of week. Please load the supplemental weekData.",NoFirstDay:"Cannot determine locale first day of week. Please load the supplemental weekData. The default culture includes only the 'en-US' first day info.",NoValidCurrency:"Cannot determine a default currency for the {0} locale. Please specify explicitly the currency with the format options.",NoDateFieldNames:"Cannot determine the locale date field names. Please load the locale dateFields data."},Object.keys(e).reduce(function(n,r){return n[r]=new kd({name:r,message:e[r]}),n},{}));var e;const he={en:{name:"en",identity:{version:{_unicodeVersion:"14.0.0",_cldrVersion:"41"},language:"en"},territory:"US",numbers:{symbols:{decimal:".",group:",",list:";",percentSign:"%",plusSign:"+",minusSign:"-",exponential:"E",superscriptingExponent:"\xd7",perMille:"\u2030",infinity:"\u221e",nan:"NaN",timeSeparator:":",approximatelySign:"~"},decimal:{patterns:["n"],groupSize:[3]},scientific:{patterns:["nEn"],groupSize:[]},percent:{patterns:["n%"],groupSize:[3]},currency:{patterns:["$n"],groupSize:[3],"unitPattern-count-one":"n $","unitPattern-count-other":"n $"},currencies:{BGN:{displayName:"Bulgarian Lev","displayName-count-one":"Bulgarian lev","displayName-count-other":"Bulgarian leva",symbol:"BGN"},EUR:{displayName:"Euro","displayName-count-one":"euro","displayName-count-other":"euros",symbol:"\u20ac","symbol-alt-narrow":"\u20ac"},USD:{displayName:"US Dollar","displayName-count-one":"US dollar","displayName-count-other":"US dollars",symbol:"$","symbol-alt-narrow":"$"}},localeCurrency:"USD",accounting:{patterns:["$n","($n)"],groupSize:[3]}},calendar:{gmtFormat:"GMT{0}",gmtZeroFormat:"GMT",patterns:{d:"M/d/y",D:"EEEE, MMMM d, y",m:"MMM d",M:"MMMM d",y:"MMM y",Y:"MMMM y",F:"EEEE, MMMM d, y h:mm:ss a",g:"M/d/y h:mm a",G:"M/d/y h:mm:ss a",t:"h:mm a",T:"h:mm:ss a",s:"yyyy'-'MM'-'dd'T'HH':'mm':'ss",u:"yyyy'-'MM'-'dd HH':'mm':'ss'Z'"},dateTimeFormats:{full:"{1} 'at' {0}",long:"{1} 'at' {0}",medium:"{1}, {0}",short:"{1}, {0}",availableFormats:{Bh:"h B",Bhm:"h:mm B",Bhms:"h:mm:ss B",d:"d",E:"ccc",EBhm:"E h:mm B",EBhms:"E h:mm:ss B",Ed:"d E",Ehm:"E h:mm a",EHm:"E HH:mm",Ehms:"E h:mm:ss a",EHms:"E HH:mm:ss",Gy:"y G",GyMd:"M/d/y GGGGG",GyMMM:"MMM y G",GyMMMd:"MMM d, y G",GyMMMEd:"E, MMM d, y G",h:"h a",H:"HH",hm:"h:mm a",Hm:"HH:mm",hms:"h:mm:ss a",Hms:"HH:mm:ss",hmsv:"h:mm:ss a v",Hmsv:"HH:mm:ss v",hmv:"h:mm a v",Hmv:"HH:mm v",M:"L",Md:"M/d",MEd:"E, M/d",MMM:"LLL",MMMd:"MMM d",MMMEd:"E, MMM d",MMMMd:"MMMM d","MMMMW-count-one":"'week' W 'of' MMMM","MMMMW-count-other":"'week' W 'of' MMMM",ms:"mm:ss",y:"y",yM:"M/y",yMd:"M/d/y",yMEd:"E, M/d/y",yMMM:"MMM y",yMMMd:"MMM d, y",yMMMEd:"E, MMM d, y",yMMMM:"MMMM y",yQQQ:"QQQ y",yQQQQ:"QQQQ y","yw-count-one":"'week' w 'of' Y","yw-count-other":"'week' w 'of' Y"}},timeFormats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},dateFormats:{full:"EEEE, MMMM d, y",long:"MMMM d, y",medium:"MMM d, y",short:"M/d/yy"},days:{format:{abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},"stand-alone":{abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]}},months:{format:{abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},"stand-alone":{abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]}},quarters:{format:{abbreviated:["Q1","Q2","Q3","Q4"],narrow:["1","2","3","4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},"stand-alone":{abbreviated:["Q1","Q2","Q3","Q4"],narrow:["1","2","3","4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]}},dayPeriods:{format:{abbreviated:{midnight:"midnight",am:"AM","am-alt-variant":"am",noon:"noon",pm:"PM","pm-alt-variant":"pm",morning1:"in the morning",afternoon1:"in the afternoon",evening1:"in the evening",night1:"at night"},narrow:{midnight:"mi",am:"a","am-alt-variant":"am",noon:"n",pm:"p","pm-alt-variant":"pm",morning1:"in the morning",afternoon1:"in the afternoon",evening1:"in the evening",night1:"at night"},wide:{midnight:"midnight",am:"AM","am-alt-variant":"am",noon:"noon",pm:"PM","pm-alt-variant":"pm",morning1:"in the morning",afternoon1:"in the afternoon",evening1:"in the evening",night1:"at night"}},"stand-alone":{abbreviated:{midnight:"midnight",am:"AM","am-alt-variant":"am",noon:"noon",pm:"PM","pm-alt-variant":"pm",morning1:"morning",afternoon1:"afternoon",evening1:"evening",night1:"night"},narrow:{midnight:"midnight",am:"AM","am-alt-variant":"am",noon:"noon",pm:"PM","pm-alt-variant":"pm",morning1:"morning",afternoon1:"afternoon",evening1:"evening",night1:"night"},wide:{midnight:"midnight",am:"AM","am-alt-variant":"am",noon:"noon",pm:"PM","pm-alt-variant":"pm",morning1:"morning",afternoon1:"afternoon",evening1:"evening",night1:"night"}}},eras:{format:{wide:{0:"Before Christ",1:"Anno Domini","0-alt-variant":"Before Common Era","1-alt-variant":"Common Era"},abbreviated:{0:"BC",1:"AD","0-alt-variant":"BCE","1-alt-variant":"CE"},narrow:{0:"B",1:"A","0-alt-variant":"BCE","1-alt-variant":"CE"}}},dateFields:{era:{wide:"era",short:"era",narrow:"era"},year:{wide:"year",short:"yr.",narrow:"yr."},quarter:{wide:"quarter",short:"qtr.",narrow:"qtr."},month:{wide:"month",short:"mo.",narrow:"mo."},week:{wide:"week",short:"wk.",narrow:"wk."},weekOfMonth:{wide:"week of month",short:"wk. of mo.",narrow:"wk. of mo."},day:{wide:"day",short:"day",narrow:"day"},dayOfYear:{wide:"day of year",short:"day of yr.",narrow:"day of yr."},weekday:{wide:"day of the week",short:"day of wk.",narrow:"day of wk."},weekdayOfMonth:{wide:"weekday of the month",short:"wkday. of mo.",narrow:"wkday. of mo."},dayperiod:{short:"AM/PM",wide:"AM/PM",narrow:"AM/PM"},hour:{wide:"hour",short:"hr.",narrow:"hr."},minute:{wide:"minute",short:"min.",narrow:"min."},second:{wide:"second",short:"sec.",narrow:"sec."},zone:{wide:"time zone",short:"zone",narrow:"zone"},millisecond:{narrow:"ms",short:"ms",wide:"millisecond"}}}},supplemental:{likelySubtags:{en:"en-Latn-US"},currencyData:{region:{US:[{USD:{_from:"1792-01-01"}}]}},weekData:{firstDay:{US:"sun"},weekendStart:{"001":"sat"},weekendEnd:{"001":"sun"}}}};function Jn(e){let t;return t=ei(e)?ti(e):e,t}function ti(e){if(he[e])return he[e];if(he.supplemental.likelySubtags){const n=e.split("-"),r=n[0],a=n.slice(1),o=function Od(e,t){const n=he.supplemental.likelySubtags;for(let r=0;r<t.length;r++){let a=n[e+"-"+t[r]];if(a)return a}if(n[e])return n[e]}(r,a),l=o?function Md(e,t){const n=e.split("-"),r=n[0],a=n[1],o=n[2];return he[e]||-1!==t.indexOf(o)&&he[r+"-"+o]||-1!==t.indexOf(a)&&he[r+"-"+a]||he[r]}(o,a):null;if(l)return l}throw en.NoLocale.error(e)}function Vo(e){if(e.territory)return e.territory;const n=e.identity;let r;return r=n&&n.territory?n.territory:function Zd(e,t){const n=he.supplemental.likelySubtags;let r=e.split("-");if(n){const o=n[e]||n[r[0]];o&&(r=o.split("-"))}if(t)for(let o=r.length-1;o>=1;o--){const l=r[o];(l===t.variant||l===t.script)&&r.splice(o,1)}const a=r.length;if(a>1)return r[a-1].toUpperCase()}(e.name,n),e.territory=r,r}const Qo="decimal",Qn="currency",jo="accounting",tn="percent",Wo="scientific",ri="$",ii="%",nn="n",Ud=";",qd=",",rn=".",U="";function ai(e){const t=e.split("-"),n=parseInt(t[0],10),r=parseInt(t[1],10)-1,a=parseInt(t[2],10);return new Date(n,r,a)}const{NoCurrency:Vd,NoCurrencyDisplay:Qd,NoSupplementalCurrency:jd,NoCurrencyRegion:Wd,NoValidCurrency:Xd}=en,Ko=2,oi="symbol",Kd="XXX",el={"001":"USD",150:"EUR"};const lf=["sun","mon","tue","wed","thu","fri","sat"],sf="001",{NoWeekData:cf,NoFirstDay:uf}=en;function nl(e){return 1/e==-1/0}function rl(e,t={}){return t.currency||(t.currency=function of(e,t){const n=Jn(e),r=n.numbers;if(!r.localeCurrency){const a=function af(e,t=!0){if(el[e])return el[e];const n=he.supplemental.currencyData;if(!n){if(t)throw jd.error();return}const r=n.region[e];if(r)return function tf(e){let t,n,r,a;for(let o=0;o<e.length;o++){const l=e[o],s=Object.keys(l)[0],c=l[s];if(s!==Kd&&"false"!==c._tender&&c._from)if(c._to){if(!r){const u=ai(c._from),d=ai(c._to);(!n||n.to<d||n.from<u)&&(t=s,n={from:u,to:d})}}else{const u=ai(c._from);(!a||a<u)&&(r=s,a=u)}}return r||t}(r);if(t)throw Wd.error(e)}(Vo(n),t);if(!a&&t)throw Xd.error(n.name);r.localeCurrency=a}return r.localeCurrency}(e,!0)),function nf(e,t){const{value:n,currency:r,currencyDisplay:a=oi}=t;if("code"===a)return r;const o=function tl(e,t,n){const a=Jn(e).numbers.currencies;if(!a){if(n)throw Vd.error();return}const o=a[t];if(o)return o;if(n)throw Qd.error()}(e,r,!0);let l;return l=a===oi?o["symbol-alt-narrow"]||o[oi]:typeof n>"u"||1!==n?o["displayName-count-other"]:o["displayName-count-one"],l}(e,t)}function il(e,t,n,r,a){const o=a.numbers.symbols,l=e.indexOf(o.decimal),s=r.groupSize.slice();let c=s.shift(),u=-1!==l?l:n+1,d=e.substring(t,u),m=e;const f=d.length;if(f>=c){let p=f,_=[];for(;p>-1;){let k=d.substring(p-c,p);k&&_.push(k),p-=c;let v=s.shift();if(c=void 0!==v?v:c,0===c){k=d.substring(0,p),k&&_.push(k);break}}d=_.reverse().join(o.group),m=e.substring(0,t)+d+e.substring(u)}return m}function al(e){return e===Qn||e===jo}function ae(e,t=2,n=!1){const r=t-String(e).length;let a=e;if(r>0){const o=new Array(r+1).join("0");a=n?e+o:o+e}return a}const hf=20;function an(e,t){let n=e,r=t||0;return n=n.toString().split("e"),n=Math.round(+(n[0]+"e"+(n[1]?Number(n[1])+r:r))),n=n.toString().split("e"),n=+(n[0]+"e"+(n[1]?Number(n[1])-r:-r)),n.toFixed(Math.min(r,hf))}const pf=3,mf=0,gf=/0+$/;function yf(e,t,n){const r=n.numbers.symbols,{style:a}=t,o=al(a);if(a===Wo)return(void 0!==t.minimumFractionDigits?e.toExponential(t.minimumFractionDigits):e.toExponential()).replace(rn,r.decimal);let s,l=e;o&&(t.value=l,s=rl(n,t)),a===tn&&(l*=100,s=r.percentSign);const{minimumFractionDigits:c,maximumFractionDigits:u}=function xf(e){let{minimumFractionDigits:t,maximumFractionDigits:n,style:r}=e;const a=al(r);let o;return a&&(o=function rf(e){let t=Ko,n=Ko;const r=((he.supplemental.currencyData||{}).fractions||{})[e];return r&&r._digits&&(n=t=parseInt(r._digits,10)),{minimumFractionDigits:t,maximumFractionDigits:n}}(e.currency)),void 0===t&&(t=a?o.minimumFractionDigits:0),void 0===n&&(n=r===tn?Math.max(t,mf):a?Math.max(t,o.maximumFractionDigits):Math.max(t,pf)),{minimumFractionDigits:t,maximumFractionDigits:n}}(t);l=an(l,u);const d=l<0,m=nl(e),f=l.split(rn);let p=f[0],_=ae(f[1]?f[1].replace(gf,U):U,c,!0);d&&(p=p.substring(1)),t.minimumIntegerDigits&&(p=ae(p,t.minimumIntegerDigits));let v,k=!1!==t.useGrouping?il(p,0,p.length,t,n):p;if(_&&(k+=r.decimal+_),o&&"name"===t.currencyDisplay)v=function bf(e,t){const n=e.numbers.currency;let r=1!==t?n["unitPattern-count-other"]:n["unitPattern-count-one"];return t<0&&(r=r.replace(nn,`-${nn}`)),r}(n,e);else{const x=t.patterns;v=d||m?x[1]||"-"+x[0]:x[0]}return v!==nn||d?function _f(e,t,n){let r=U;for(let a=0,o=t.length;a<o;a++){let l=t.charAt(a);r+=l===nn?e:l===ri||l===ii?n:l}return r}(k,v,s):k}const vf=/(\\.)|(['][^']*[']?)|(["][^"]*["]?)/g,ol="__??__",on="#",ln="0",Sf=/(\.(?:[0-9]*[1-9])?)0+$/g,kf=/\.$/,Af=/,/g;function ll(e,t,n){let r;return r=-1===e&&-1!==t?t:-1!==e&&-1===t?e:n?Math.min(e,t):Math.max(e,t),r}function Pf(e,t,n){const r={negative:e<0,number:Math.abs(e),negativeZero:nl(e),format:t};return function Tf(e){let{number:t,format:n}=e;if(n=n.split(Ud),(e.negative||e.negativeZero)&&n[1])n=n[1],e.hasNegativeFormat=!0;else if(0===t){const r=n[2];n=r||n[0],r&&function Rf(e){return-1===e.indexOf(on)&&-1===e.indexOf(ln)}(r)&&(e.constant=r)}else n=n[0];e.format=n}(r),r.constant?r.constant:(function wf(e){let t=e.format;if(t.indexOf("'")>-1||t.indexOf('"')>-1||t.indexOf("\\")>-1){const n=e.literals=[];e.format=t.replace(vf,function(r){const a=r.charAt(0).replace("\\",U),o=r.slice(1).replace(a,U);return n.push(o),ol})}}(r),function Df(e,t){const n=e.format;-1!==n.indexOf(ii)&&(e.style=tn,e.symbol=t.numbers.symbols.percentSign,e.number*=100),-1!==n.indexOf(ri)&&(e.style=Qn,e.symbol=rl(t))}(r,n),function Ef(e){e.hasGroup=e.format.indexOf(qd)>-1,e.hasGroup&&(e.format=e.format.replace(Af,U))}(r),function Of(e){let{number:t,format:n}=e,r=n.indexOf(rn);if(-1!==r){const a=n.lastIndexOf(ln)-r,o=n.lastIndexOf(on)-r,l=a>-1,s=o>-1;let c=t.toString().split("e");c=c[1]?an(t,Math.abs(c[1])):c[0],c=c.split(rn)[1]||U;let u=c.length,d=-1;l||s?l&&a>o?u=a:o>a&&(s&&u>o?u=o:l&&u<a&&(u=a),d=l?a:0):(e.format=n.substring(0,r)+n.substring(r+1),r=-1,u=0),u>-1&&(t=an(t,u),d>-1&&(t=function Mf(e,t){let n;return n=0===t?Sf:new RegExp(`(\\.[0-9]{${t}}[1-9]*)0+$`,"g"),e.replace(n,"$1").replace(kf,U)}(t,d)))}else t=an(t);e.negative&&-1*t>=0&&!e.negativeZero&&(e.negative=!1),e.number=t,e.decimalIndex=r}(r),function Nf(e){const t=e.format;let n=t.indexOf(on),r=t.indexOf(ln),a=ll(n,r,!0);n=t.lastIndexOf(on),r=t.lastIndexOf(ln);let o=ll(n,r);a===t.length&&(o=a),e.start=a,e.end=o,e.lastZeroIndex=r}(r),function If(e,t){let n=e.number;return-1!==e.start&&(n=function Lf(e,t){const{start:n,end:r,negative:a,negativeZero:o,format:l,decimalIndex:s,lastZeroIndex:c,hasNegativeFormat:u,hasGroup:d}=e;let m=e.number;const f=m.toString().split(rn),p=l.length,_=f[0],k=f[1]||U,v=_.length;let D=U;m=l.substring(0,n),(a||o)&&!u&&(m+="-");for(let x=n;x<p;x++){let C=l.charAt(x);if(-1===s){if(r-x<v){m+=_;break}}else if(-1!==c&&c<x&&(D=U),s-x<=v&&s-x>-1&&(m+=_,x=s),s===x){m+=(k?t.numbers.symbols.decimal:U)+k,x+=r-s+1;continue}C===ln?(m+=C,D=C):C===on&&(m+=D)}return d&&(m=il(m,n+(a&&!u?1:0),Math.max(r,v+n),t.numbers.decimal,t)),r>=n&&(m+=l.substring(r+1)),m}(e,t),n=function Ff(e,t,n){let r=e;if(t===Qn||t===tn){r=U;for(let a=0,o=e.length;a<o;a++){let l=e.charAt(a);r+=l===ri||l===ii?n:l}}return r}(n,e.style,e.symbol),n=function Cf(e,t){let n=e;if(t){const r=t.length;for(let a=0;a<r;a++)n=n.replace(ol,t[a])}return n}(n,e.literals)),n}(r,n))}const Bf=/^(n|c|p|e|a)(\d*)$/i;const Jf=/\{(\d+)}/g;function li(e){const t=arguments;return e.replace(Jf,(n,r)=>t[parseInt(r,10)+1])}const Yf=120,Vf=20,ul=[2,1,5,3,4],Kf={[(-2).toString()]:8,[(-1).toString()]:6,[2..toString()]:6,[1..toString()]:3},eh={numeric:1,"2-digit":2,short:3,long:4,narrow:5},th=/[hHmsSzZoOvVxX]/,dl=[{key:"era",specifier:"G"},{key:"year",specifier:"y"},{key:"month",specifier:"M"},{key:"day",specifier:"d"},{key:"weekday",specifier:"E"},{key:"hour",getSpecifier:function nh(e){return e.hour12?"h":"H"}},{key:"minute",specifier:"m"},{key:"second",specifier:"s"},{key:"timeZoneName",specifier:"z"}],fl={e:"c",E:"c",M:"L",Q:"q"},si={},Tt={};function ci(e){return si[e]||(si[e]=new RegExp(e+"+")),si[e]}function jn(e){const t=[];let n=e.charAt(0),r=n;for(let a=1;a<e.length;a++){let o=e.charAt(a);o===r?n+=o:(t.push(n),n=r=o)}return t.push(n),t}function ui(e,t){const n=e.length;let a,o,r=-Number.MAX_VALUE;for(let l in t){const s=[];let c=l.replace("v","z"),u=0;for(let d=0;d<n;d++){const m=e[d];let p=(ci(m[0]).exec(c)||[])[0];if(p){if(c=c.replace(p,U),p.length!==m.length){let _=Math.max(Math.min(ul[p.length]-ul[m.length],2),-2);u-=Kf[_]}}else u-=Yf;if(s.push(p),u<r)break}c.length&&(u-=jn(c).length*Vf),u>r&&(r=u,a=s,o=t[l])}o=o.replace("v","z");for(let l=0;l<n;l++){const s=a[l];if(s&&s!==e[l]){const c=a[l][0];o=o.replace(ci(c),e[l]),fl[c]&&(o=o.replace(ci(fl[c]),e[l]))}}return o}function oh(e,t){const n=t.calendar;let r;if(ei(e))r=n.patterns[e]?n.patterns[e]:e;else if(e){if(e.pattern)return e.pattern;let a=e.skeleton;a||(e.datetime?r=li(n.dateTimeFormats[e.datetime],n.timeFormats[e.datetime],n.dateFormats[e.datetime]):e.date?r=n.dateFormats[e.date]:e.time?r=n.timeFormats[e.time]:a=function ah(e){let t=[];for(let n=0;n<dl.length;n++){let r=dl[n],o=e[r.key];if(o){let l=r.specifier||r.getSpecifier(e);t.push(l.repeat(eh[o]))}}return t.join(U)}(e)),a&&(r=function ih(e,t){const n=t.calendar.dateTimeFormats.availableFormats;if(n[e])return n[e];if(Tt[t.name]&&Tt[t.name][e])return Tt[t.name][e];const r=e.search(th);let a;if(r>0){const o=e.substr(0,r),l=e.substr(r);a=li(t.calendar.dateTimeFormats.short,n[l]||ui(jn(l),n),n[o]||ui(jn(o),n))}else a=ui(jn(e),n);return function rh(e,t,n){Tt[n]||(Tt[n]={}),Tt[n][e]=t}(e,a,t.name),a}(a,t))}return r||(r=n.patterns.d),r}function lh(e){let t;return e<=3?t="abbreviated":4===e?t="wide":5===e?t="narrow":6===e&&(t="short"),t}function be(e,t,n,r,a){return function Yd(e,t){const{type:n,nameType:r,standAlone:a,lower:o}=t,l=Jn(e),c=(o?"lower-":U)+r,u=l.calendar[n][a?"stand-alone":"format"];let d=u[c];return!d&&o&&(d=u[c]=function Jd(e){return Array.isArray(e)?function Hd(e){const t=[];for(let n=0;n<e.length;n++)t.push(e[n].toLowerCase());return t}(e):function Gd(e){const t={};for(let n in e)t[n]=e[n].toLowerCase();return t}(e)}(u[r])),d}(e,{type:t,nameType:lh(n),standAlone:r,lower:a})}function hl(e){return"function"==typeof e}function pl(e){return!!e&&hl(e.getTime)&&hl(e.getMonth)}const sh=/d{1,2}|E{1,6}|e{1,6}|c{3,6}|c{1}|M{1,5}|L{1,5}|y{1,4}|H{1,2}|h{1,2}|k{1,2}|K{1,2}|m{1,2}|a{1,5}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|x{1,5}|X{1,5}|G{1,5}|q{1,5}|Q{1,5}|"[^"]*"|'[^']*'/g;function xl(e,t,n,r){return t<=2?ae(e+1,t):be(n,"months",t,r)[e]}function _l(e,t,n,r){const a=Math.floor(e.getMonth()/3);return t<3?a+1:be(n,"quarters",t,r)[a]}function Kn(e,t,n){const{shortHours:r,optionalMinutes:a,separator:o,localizedName:l,zZeroOffset:s}=n,c=e.getTimezoneOffset()/60;if(0===c&&s)return"Z";const u=c<=0?"+":"-",d=Math.abs(c).toString().split("."),m=d[1]||0;let f=u+(r?d[0]:ae(d[0],2));return(m||!a)&&(f+=(o?":":U)+ae(m,2)),l&&(f=li(0===c?t.calendar.gmtZeroFormat:t.calendar.gmtFormat,f)),f}function bl(e,t,n,r){let a;return a=t<3?function ch(e,t,n){const r=function df(e){const t=Jn(e);if(!isNaN(t.firstDay))return t.firstDay;const n=he.supplemental.weekData;if(!n)throw cf.error();const r=n.firstDay[Vo(t)]||n.firstDay[sf];if(!r)throw uf.error();return t.firstDay=lf.indexOf(r),t.firstDay}(n);let a;return a=e<r?7-r+e:e-r,a+1}(e.getDay(),0,n):be(n,"days",t,r)[e.getDay()],a}const q={d:function(e,t){return ae(e.getDate(),t)},E:function(e,t,n){return be(n,"days",t)[e.getDay()]},M:function(e,t,n){return xl(e.getMonth(),t,n,!1)},L:function(e,t,n){return xl(e.getMonth(),t,n,!0)},y:function(e,t){let n=e.getFullYear();return 2===t&&(n%=100),ae(n,t)},h:function(e,t){return ae(e.getHours()%12||12,t)},H:function(e,t){return ae(e.getHours(),t)},k:function(e,t){return ae(e.getHours()||24,t)},K:function(e,t){return ae(e.getHours()%12,t)},m:function(e,t){return ae(e.getMinutes(),t)},s:function(e,t){return ae(e.getSeconds(),t)},S:function(e,t){const n=e.getMilliseconds();let r;return r=0!==n?ae(String(n/1e3).split(".")[1].substr(0,t),t,!0):ae(U,t),r},a:function(e,t,n){return be(n,"dayPeriods",t)[e.getHours()<12?"am":"pm"]},z:function(e,t,n){return Kn(e,n,{shortHours:t<4,optionalMinutes:t<4,separator:!0,localizedName:!0})},Z:function(e,t,n){return Kn(e,n,{separator:t>3,localizedName:4===t,zZeroOffset:5===t})},x:function(e,t,n){return Kn(e,n,{optionalMinutes:1===t,separator:3===t||5===t})},X:function(e,t,n){return Kn(e,n,{optionalMinutes:1===t,separator:3===t||5===t,zZeroOffset:!0})},G:function(e,t,n){let r=e.getFullYear()>=0?1:0;return be(n,"eras",t)[r]}};q.e=bl,q.c=function(e,t,n){return bl(e,t,n,!0)},q.q=function(e,t,n){return _l(e,t,n,!0)},q.Q=_l;const dh=/([+|-]\d{1,2})(:?)(\d{2})?/,ph={2:/^\d{1,2}/,3:/^\d{1,3}/,4:/^\d{4}/},mh=/\d+/;function pe(e,t,n){return!(e>=t&&e<=n)}function Q(e,t){let{format:n,idx:r}=t,a=0;for(;n[r]===e;)a++,r++;return a>0&&(r-=1),t.idx=r,a}function Ee(e,t){let n=e?ph[e]||new RegExp("^\\d{1,"+e+"}"):mh,r=t.value.substr(t.valueIdx,e).match(n);return r?(r=r[0],t.valueIdx+=r.length,parseInt(r,10)):null}function pt(e,t,n){let o,l,u,r=0,a=e.length,s=0,c=0;for(;r<a;r++)o=e[r],l=o.length,u=t.value.substr(t.valueIdx,l),n&&(u=u.toLowerCase()),u===o&&l>s&&(s=l,c=r);return s?(t.valueIdx+=s,c+1):null}function er(e,t,n){const{shortHours:r,noSeparator:a,optionalMinutes:o,localizedName:l,zLiteral:s}=n;if(e.UTC=!0,s&&"Z"===e.value.charAt(e.valueIdx))return e.valueIdx++,!1;if(l&&!pt(function yh(e){const{gmtFormat:t,gmtZeroFormat:n}=e;if(!t)throw en.NoGMTInfo.error();return[t.replace("{0}",U).toLowerCase(),n.replace("{0}",U).toLowerCase()]}(t.calendar),e,!0))return!0;const c=dh.exec(e.value.substr(e.valueIdx,6));if(!c)return!l;const u=c[1],d=c[3],m=parseInt(u,10),f=c[2];let p=parseInt(d,10);if(isNaN(m)||!r&&3!==u.length||!o&&isNaN(p)||a&&f||(isNaN(p)&&(p=null),pe(m,-12,13)||p&&pe(p,0,59)))return!0;e.valueIdx+=c[0].length,e.hoursOffset=m,e.minutesOffset=p}function Dl(e,t,n){const r=Q(e,t),a=be(n,"months",r,"L"===e,!0),o=r<3?Ee(2,t):pt(a,t,!0);if(null===o||pe(o,1,12))return!0;t.month=o-1}function wl(e,t,n){const r=Q(e,t),a=be(n,"days",r,"c"===e,!0);let o=r<3?Ee(1,t):pt(a,t,!0);if(!o&&0!==o||pe(o,1,7))return!0}const H={};H.d=function(e){Q("d",e);const t=Ee(2,e);if(null===t||pe(t,1,31))return!0;null===e.day&&(e.day=t)},H.E=function(e,t){if(null===pt(be(t,"days",Q("E",e),!1,!0),e,!0))return!0},H.M=function(e,t){return Dl("M",e,t)},H.L=function(e,t){return Dl("L",e,t)},H.y=function(e){const t=Q("y",e);let n=Ee(1===t?void 0:t,e);if(null===n)return!0;if(2===t){const r=(new Date).getFullYear();n=r-r%100+n,n>2029&&(n-=100)}e.year=n},H.h=function(e){Q("h",e);let t=Ee(2,e);if(12===t&&(t=0),null===t||pe(t,0,11))return!0;e.hours=t},H.K=function(e){Q("K",e);let t=Ee(2,e);if(null===t||pe(t,0,11))return!0;e.hours=t},H.a=function(e,t){let r=be(t,"dayPeriods",Q("a",e),!1,!0);const a=pt([r.pm],e,!0);if(!a&&!pt([r.am],e,!0))return!0;e.pmHour=a},H.H=function(e){Q("H",e);const t=Ee(2,e);if(null===t||pe(t,0,23))return!0;e.hours=t},H.k=function(e){Q("k",e);let t=Ee(2,e);if(null===t||pe(t,1,24))return!0;e.hours=24===t?0:t},H.m=function(e){Q("m",e);const t=Ee(2,e);if(null===t||pe(t,0,59))return!0;e.minutes=t},H.s=function(e){Q("s",e);const t=Ee(2,e);if(null===t||pe(t,0,59))return!0;e.seconds=t},H.S=function(e){const t=Q("S",e),n=e.value.substr(e.valueIdx,t);let r=null;if(isNaN(parseInt(n,10))||(r=parseFloat("0."+n,10),r=an(r,3),r*=1e3,e.valueIdx+=t),null===r||pe(r,0,999))return!0;e.milliseconds=r},H.z=function(e,t){const r=Q("z",e)<4,a=er(e,t,{shortHours:r,optionalMinutes:r,localizedName:!0});if(a)return a},H.Z=function(e,t){const n=Q("Z",e),r=er(e,t,{noSeparator:n<4,zLiteral:5===n,localizedName:4===n});if(r)return r},H.x=function(e,t){const n=Q("x",e),r=er(e,t,{noSeparator:3!==n&&5!==n,optionalMinutes:1===n});if(r)return r},H.X=function(e,t){const n=Q("X",e),r=er(e,t,{noSeparator:3!==n&&5!==n,optionalMinutes:1===n,zLiteral:!0});if(r)return r},H.G=function(e,t){const r=be(t,"eras",Q("G",e),!1,!0);if(null===pt([r[0],r[1]],e,!0))return!0},H.e=function(e,t){return wl("e",e,t)},H.c=function(e,t){return wl("c",e,t)};var Th=E(7398),Eh=E(9397);let Nh=(()=>{class e{constructor(){this.changes=new j.X({rtl:void 0})}notify(n){this.changes.next({rtl:n})}get(n){}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=i.Yz7({token:e,factory:e.\u0275fac}),e})();const Fh=new i.OlP("Kendo UI Right-to-Left token"),kl=new i.OlP("Localization key prefix");let Al=(()=>{class e{constructor(n,r,a){this.prefix=n,this.messageService=r,this._rtl=a,this.changes=new j.X({rtl:this._rtl}),this.dictionary={},r&&(this.subscription=r.changes.pipe((0,Th.U)(({rtl:o})=>void 0!==o?o:this._rtl),(0,Eh.b)(o=>this._rtl=o)).subscribe(o=>{this.dictionary={},this.changes.next({rtl:o})}))}get rtl(){return this._rtl}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}get(n){const r=this.key(n);return this.dictionary[r]}register(n,r,a=!1){const o=this.key(n);let l=r;if(!a){if(Object.hasOwnProperty.call(this.dictionary,o))return;l=this.defaultValue(o,r)}this.dictionary[o]=l}notifyChanges(){this.changes.next({rtl:this.rtl})}key(n){return this.prefix+"."+n}defaultValue(n,r){if(!this.messageService)return r;const a=this.messageService.get(n);return void 0===a?r:a}}return e.\u0275fac=function(n){return new(n||e)(i.LFG(kl),i.LFG(Nh,8),i.LFG(Fh,8))},e.\u0275prov=i.Yz7({token:e,factory:e.\u0275fac}),e})();var Ml=["zNvUy3rPB24=","zg9JC1vYBa==","ALDfBgG=","BgvUz3rO","wfbyuLC=","s1fTqKS=","D2fYBG==","igzVCIbTB3jLigLUzM9YBwf0Aw9UlGO=","sLzNBK8=","u2vLia==","EMfuDMe=","DhLWzq==","ChjVzhvJDenVzgvZ","C2v0","uhjVz3jLC3mG","y29Uy2f0","ww91CIbSAwnLBNnLigv4CgLYzwqGB24G","BgLJzw5ZAw5Nrg9JC1vYBa==","z2v0vgLTzq==","DMvYC2LVBG==","z2v0rNvSBfLLyxi=","y29Kzq==","C29YDa==","z3jVDxbfBMq=","tgLJzw5ZzsbHy3rPDMf0Aw9UigzHAwXLzcbMB3iG","AuTpqve=","qKPbuMq=","DNngBNm=","EuHftLC=","CwPStuK=","zgf0yq==","q2HruKO=","DhjPywW=","C2nYAxb0s2v5","s0PWuhm=","ChjVzhvJDhm=","z2v0rgf0zq==","ChvIBgLZAerHDgu=","Dg9mB2nHBgvtDhjPBMC=","zMLUza==","D1LXALm=","ChjVzhvJDe5HBwu=","BvDiBhe=","CgfYC2u=","BMfTzq==","vgHLihbYB2r1y3qGAxmGBM90igLUy2X1zgvKigLUihrOzsbSAwnLBNnLlGO=","zxHWAxj5rgf0zq==","C1jWruu=","tM8GBgLJzw5ZzsbMB3vUzc4k","rNPWy20=","zurxrey=","ugrPzgO=","lcb0AguGCgfJA2fNzsb3yxmGChvIBgLZAgvKig9Uia==","Dw5KzwzPBMvK","BgLJzw5Zzuv4CgLYyxrPB25eyxrL","wfbiz0e=","t29bvMq=","CxH4zeu=","DgLTzxn0yw1W","rLLprKG=","ww91CIb0CMLHBcbSAwnLBNnLigv4CgLYzwqGB24G","B2jQzwn0","z2v0tw9UDgG=","AgfZ","uxz0Dfe=","wwT6EMO=","CgfJA2fNzu5HBwu=","A21TqLu=","z3jVDxa=","sg1gshy=","uKTIAuO=","r0fHquq=","z2v0"];!function(e,t){!function(r){for(;--r;)e.push(e.shift())}(++t)}(Ml,307);var h=function(e,t){var n=Ml[e-=0];void 0===h.CpLMJN&&(h.aqOTsF=function(o){for(var l=function(o){for(var d,m,s=String(o).replace(/=+$/,""),c="",u=0,f=0;m=s.charAt(f++);~m&&(d=u%4?64*d+m:m,u++%4)?c+=String.fromCharCode(255&d>>(-2*u&6)):0)m="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(m);return c}(o),s=[],c=0,u=l.length;c<u;c++)s+="%"+("00"+l.charCodeAt(c).toString(16)).slice(-2);return decodeURIComponent(s)},h.aXxOXI={},h.CpLMJN=!0);var a=h.aXxOXI[e];return void 0===a?(n=h.aqOTsF(n),h.aXxOXI[e]=n):n=a,n},Lh={data:"  {}  "},pi=new Map;function tr(e){return new Date(1e3*e)}function Ol(e,t){var n=tr(t);return e>new Date(n[h("0x5")](),n[h("0x2f")](),n[h("0x15")]()+1)[h("0x3")]()/1e3}const nr=(e,t,n)=>{let r=e.createEmbeddedView(t);const a=o=>(n(t,o),r.detectChanges(),r.rootNodes.reduce((l,s)=>l+s.textContent,"").trim());return a.destroy=()=>{r.destroy(),r=null},a},Rl=(e,t)=>{e.$implicit=e.group=t,e.field=t.field,e.value=t.value,e.aggregates=t.aggregates},Zh=(e,t)=>{e.group=t.group,e.$implicit=e.aggregates=t},$h=(e,t)=>{e.aggregates=t.aggregates},Tl=e=>{e&&e.forEach(t=>{t.destroy()})};class qh{constructor(t,n){this.title=t.title,this.field=t.field,this.hidden=t.hidden,this.locked=t.locked,this.width=t.width,this.headerCellOptions=t.headerCellOptions,this.cellOptions=t.cellOptions,this.groupHeaderCellOptions=t.groupHeaderCellOptions,this.groupFooterCellOptions=t.groupFooterCellOptions,this.footerCellOptions=t.footerCellOptions,t.footerTemplate&&(this.footerTemplate=nr(t.footerTemplate.templateRef,{$implicit:t,column:t,columnIndex:n},$h)),t.groupFooterTemplate&&(this.groupFooterTemplate=nr(t.groupFooterTemplate.templateRef,{column:t,field:t.field},Zh)),t.groupHeaderTemplate&&(this.groupHeaderTemplate=nr(t.groupHeaderTemplate.templateRef,{},Rl)),t.groupHeaderColumnTemplate&&(this.groupHeaderColumnTemplate=nr(t.groupHeaderColumnTemplate.templateRef,{},Rl))}destroy(){this.footerTemplate&&this.footerTemplate.destroy(),this.groupFooterTemplate&&this.groupFooterTemplate.destroy(),this.groupHeaderTemplate&&this.groupHeaderTemplate.destroy(),this.groupHeaderColumnTemplate&&this.groupHeaderColumnTemplate.destroy(),Tl(this.columns)}}$i.register({toString:function Sl(e,t,n){if(t){if(pl(e))return function uh(e,t,n="en"){if(!pl(e))return e??U;const r=ti(n);return oh(t,r).replace(sh,function(o){let s,l=o.length;return s=o.includes("'")||o.includes('"')?o.slice(1,l-1):q[o[0]](e,l,r),s})}(e,t,n);if(function Oh(e){return"number"==typeof e}(e))return function $f(e,t=nn,n="en"){if(null==e)return U;if(!isFinite(e))return String(e);const r=ti(n),a=function Zf(e){let t;return t=ei(e)?function zf(e){const t=Bf.exec(e);if(t){const n={style:Qo};let r=t[1].toLowerCase();return"c"===r?n.style=Qn:"a"===r?n.style=jo:"p"===r?n.style=tn:"e"===r&&(n.style=Wo),t[2]&&(n.minimumFractionDigits=n.maximumFractionDigits=parseInt(t[2],10)),n}}(e):e,t}(t);let o;return o=a?yf(e,Object.assign({},r.numbers[a.style||Qo],a),r):Pf(e,t,r),o}(e,t,n)}return e??U}});const Hh=e=>{const t=(e=>{const t=[];let n=0;const r=(a,o,l)=>{a.forEach(s=>{if(s.level===l){const c=new qh(s,n);if(o.push(c),s.children&&s.children.some(u=>u!==s)){const u=c.columns=[];r(s.children,u,l+1)}else n++}})};return r(e,t,0),t})(e.columns),r=new class ys{constructor(t){t.columns=this._trimColumns(t.columns||[]),this.allColumns=Ce(this._leafColumns(t.columns||[]),this._prepareColumn),this.columns=this._visibleColumns(this.allColumns),this.options=t,this.data=t.data||[],this.aggregates=t.aggregates||{},this.groups=[].concat(t.groups||[]),this.hasGroups=this.groups.length>0,this.hierarchy=t.hierarchy,this.hasGroupHeaderColumn=this.columns.some(n=>n.groupHeaderColumnTemplate),this.collapsible=this.options.collapsible}workbook(){return{sheets:[{columns:this._columns(),rows:this.hierarchy?this._hierarchyRows():this._rows(),freezePane:this._freezePane(),filter:this._filter()}]}}_trimColumns(t){return t.filter(n=>{let r=!!n.field;return!r&&n.columns&&(r=this._trimColumns(n.columns).length>0),r})}_leafColumns(t){let n=[];for(let r=0;r<t.length;r++)t[r].columns?n=n.concat(this._leafColumns(t[r].columns)):n.push(t[r]);return n}_prepareColumn(t){if(!t.field)return null;let n=function(a){return Hi(t.field)(a)},r=null;return t.values&&(r={},t.values.forEach(function(a){r[a.value]=a.text}),n=function(a){return r[Hi(t.field)(a)]}),Object.assign({},t,{value:n,values:r,groupHeaderTemplate:t.groupHeaderTemplate?_n.compile(t.groupHeaderTemplate):_s,groupHeaderColumnTemplate:t.groupHeaderColumnTemplate?_n.compile(t.groupHeaderColumnTemplate):null,groupFooterTemplate:t.groupFooterTemplate?_n.compile(t.groupFooterTemplate):null,footerTemplate:t.footerTemplate?_n.compile(t.footerTemplate):null})}_filter(){if(!this.options.filterable)return null;const t=this._depth();return{from:t,to:t+this.columns.length-1}}_createPaddingCells(t){return xr(t,()=>Object.assign({background:"#dfdfdf",color:"#333"},this.options.paddingCellOptions))}_dataRow(t,n,r){let a=this._createPaddingCells(n);if(this.hasGroups&&r&&t.items){a=a.concat(this._groupHeaderCells(t,n,r));const l=this._dataRows(t.items,n+1);return l.unshift({type:"group-header",cells:a,level:this.collapsible?n:null}),l.concat(this._footer(t,n))}const o=[];for(let l=0;l<this.columns.length;l++)o[l]=this._cell(t,this.columns[l]);return this.hierarchy&&(o[0].colSpan=r-n+1),[{type:"data",cells:a.concat(o),level:this.collapsible?n:null}]}_groupHeaderCells(t,n,r){const a=[],o=this.allColumns.filter(function(d){return d.field===t.field})[0]||{},l=o&&o.title?o.title:t.field,s=o?o.groupHeaderTemplate||o.groupHeaderColumnTemplate:null,c=Object.assign({title:l,field:t.field,value:o&&o.values?o.values[t.value]:t.value,aggregates:t.aggregates,items:t.items},t.aggregates[t.field]),u=s?s(c):`${l}: ${t.value}`;return a.push(Object.assign({value:u,background:"#dfdfdf",color:"#333",colSpan:(this.hasGroupHeaderColumn?1:this.columns.length)+r-n},o.groupHeaderCellOptions)),this.hasGroupHeaderColumn&&this.columns.forEach(function(d,m){m>0&&a.push(Object.assign({background:"#dfdfdf",color:"#333",value:d.groupHeaderColumnTemplate?d.groupHeaderColumnTemplate(Object.assign({group:c},c,t.aggregates[d.field])):void 0},d.groupHeaderCellOptions))}),a}_dataRows(t,n){const r=this._depth(),a=[];for(let o=0;o<t.length;o++)a.push.apply(a,this._dataRow(t[o],n,r));return a}_hierarchyRows(){const t=this._depth(),n=this.data,r=this.hierarchy.itemLevel,a=this.hierarchy.itemId||bs,o=this._hasFooterTemplate(),l=[],s=[];let u,c=0;o||(this.collapsible=!1);for(let d=0;d<n.length;d++){const m=n[d],f=r(m,d);o&&(f>c?s.push({id:u,level:c}):f<c&&l.push.apply(l,this._hierarchyFooterRows(s,f,t)),c=f,u=a(m,d)),l.push.apply(l,this._dataRow(m,f+1,t))}return o&&(l.push.apply(l,this._hierarchyFooterRows(s,0,t)),l.push(this._hierarchyFooter(n.length?this.aggregates[n[0].parentId]:{},0,t))),this._prependHeaderRows(l),l}_hierarchyFooterRows(t,n,r){const a=[];for(;t.length&&t[t.length-1].level>=n;){const o=t.pop();a.push(this._hierarchyFooter(this.aggregates[o.id],o.level+1,r))}return a}_hasFooterTemplate(){const t=this.columns;for(let n=0;n<t.length;n++)if(t[n].footerTemplate)return!0}_hierarchyFooter(t,n,r){const a=this.columns.map(function(o,l){const s=l?1:r-n+1;return Object.assign(o.footerTemplate?{background:"#dfdfdf",color:"#333",colSpan:s,value:o.footerTemplate(Object.assign({aggregates:t},(t||{})[o.field]))}:{background:"#dfdfdf",color:"#333",colSpan:s},o.footerCellOptions)});return{type:"footer",cells:this._createPaddingCells(n).concat(a),level:this.collapsible?n:null}}_footer(t,n){const r=[],a=this.columns.some(c=>c.groupFooterTemplate);let o,l;a&&(l={group:{items:t.items,field:t.field,value:t.value}},o={},Object.keys(t.aggregates).forEach(c=>{o[c]=Object.assign({},t.aggregates[c],l)}));const s=this.columns.map(c=>{if(c.groupFooterTemplate){let u=Object.assign({},o,t.aggregates[c.field],l);return Object.assign({background:"#dfdfdf",color:"#333",value:c.groupFooterTemplate(u)},c.groupFooterCellOptions)}return Object.assign({background:"#dfdfdf",color:"#333"},c.groupFooterCellOptions)});return a&&r.push({type:"group-footer",cells:this._createPaddingCells(this.groups.length).concat(s),level:this.collapsible?n:null}),r}_isColumnVisible(t){return this._visibleColumns([t]).length>0&&(t.field||t.columns)}_visibleColumns(t){return t.filter(n=>{let r=n.exportable;"object"==typeof r&&(r=n.exportable.excel);let l=!n.hidden&&!1!==r||n.hidden&&!0===r;return l&&n.columns&&(l=this._visibleColumns(n.columns).length>0),l})}_headerRow(t,n){const r=t.cells.map(function(a){return Object.assign(a,{colSpan:a.colSpan>1?a.colSpan:1,rowSpan:t.rowSpan>1&&!a.colSpan?t.rowSpan:1})});return this.hierarchy&&r[0].firstCell&&(r[0].colSpan+=this._depth()),{type:"header",cells:xr(n.length,()=>Object.assign({background:"#7a7a7a",color:"#fff"},this.options.headerPaddingCellOptions)).concat(r)}}_prependHeaderRows(t){const n=this.groups,r=[{rowSpan:1,cells:[],index:0}];this._prepareHeaderRows(r,this.options.columns);for(let a=r.length-1;a>=0;a--)t.unshift(this._headerRow(r[a],n))}_prepareHeaderRows(t,n,r,a){const o=a||t[t.length-1];let l=t[o.index+1],s=0;for(let c=0;c<n.length;c++){const u=n[c];if(this._isColumnVisible(u)){const d=Object.assign({background:"#7a7a7a",color:"#fff",value:u.title||u.field,colSpan:0,firstCell:0===c&&(!r||r.firstCell)},u.headerCellOptions);o.cells.push(d),u.columns&&u.columns.length&&(l||(l={rowSpan:0,cells:[],index:t.length},t.push(l)),d.colSpan=this._trimColumns(this._visibleColumns(u.columns)).length,this._prepareHeaderRows(t,u.columns,d,l),s+=d.colSpan-1,o.rowSpan=t.length-o.index)}}r&&(r.colSpan+=s)}_rows(){const t=this._dataRows(this.data,0);if(this.columns.length){this._prependHeaderRows(t);let n=!1;const r=this.columns.map(a=>a.footerTemplate?(n=!0,Object.assign({background:"#dfdfdf",color:"#333",value:a.footerTemplate(Object.assign({},this.aggregates,this.aggregates[a.field]))},a.footerCellOptions)):Object.assign({background:"#dfdfdf",color:"#333"},a.footerCellOptions));n&&t.push({type:"footer",cells:this._createPaddingCells(this.groups.length).concat(r)})}return t}_headerDepth(t){let r=0;for(let a=0;a<t.length;a++)if(t[a].columns){const o=this._headerDepth(t[a].columns);o>r&&(r=o)}return 1+r}_freezePane(){const t=this._visibleColumns(this.options.columns||[]),n=this._visibleColumns(this._trimColumns(this._leafColumns(t.filter(function(r){return r.locked})))).length;return{rowSplit:this._headerDepth(t),colSplit:n?n+this.groups.length:0}}_cell(t,n){return Object.assign({value:n.value(t)},n.cellOptions)}_depth(){let t=0;return t=this.hierarchy?this.hierarchy.depth:this.groups.length,t}_columns(){return xr(this._depth(),()=>({width:20})).concat(this.columns.map(function(r){return{width:parseInt(r.width,10),autoWidth:!r.width}}))}}({columns:t,data:e.data,filterable:e.filterable,groups:e.group,paddingCellOptions:e.paddingCellOptions,headerPaddingCellOptions:e.headerPaddingCellOptions,collapsible:e.collapsible,hierarchy:e.hierarchy,aggregates:e.aggregates}).workbook();return r.creator=e.creator,r.date=e.date,r.rtl=e.rtl,Tl(t),r};let mt=(()=>{class e{constructor(n){this.parent=n}get level(){return this.parent?this.parent.level+1:0}}return e.\u0275fac=function(n){return new(n||e)(i.Y36(e))},e.\u0275cmp=i.Xpm({type:e,selectors:[["ng-component"]],contentQueries:function(n,r,a){if(1&n&&i.Suo(a,e,4),2&n){let o;i.iGM(o=i.CRH())&&(r.children=o)}},inputs:{title:"title",width:"width",locked:"locked",hidden:"hidden",headerCellOptions:"headerCellOptions"},decls:0,vars:0,template:function(n,r){},encapsulation:2}),e})();const Yh={name:"@progress/kendo-angular-excel-export",productName:"Kendo UI for Angular",productCodes:["KENDOUIANGULAR","KENDOUICOMPLETE"],publishDate:1694532862,version:"13.5.0",licensingDocsUrl:"https://www.telerik.com/kendo-angular-ui/my-license/"};let Xe=(()=>{class e{constructor(n,r){this.localization=n,this.zone=r,this.fileName="Export.xlsx",this.columns=new i.n_E,function Ih(e){if(pi[h("0x30")](e[h("0x1d")])&&h("0xa")!==h("0x23"))return pi[h("0x39")](e[h("0x1d")]);var s,t=e[h("0x4")]?" v"+e[h("0x4")]:"",n=e[h("0x1d")]+t,r=JSON[h("0x1c")](Lh[h("0xf")]),a=!r[h("0x12")]&&!r[h("0x2b")],o=r[h("0x12")]&&typeof KendoLicensing===h("0x26"),l=function Bh(e,t){var n=e[h("0x14")];if(!(n&&n[h("0x3d")]||h("0x29")!=h("0x29")))return null;var r=new Set(t);return n[h("0x7")](function(a,o){if(h("0x36")==h("0x36"))return o[h("0x27")]-a[h("0x27")]})[h("0x18")](function(a){if(h("0xc")==h("0xc"))return r[h("0x30")](a[h("0x6")])})}(r,e[h("0x46")]);if(a||o?h("0x32")!==h("0x1b")&&(s={type:0,packageName:n,docsUrl:e[h("0x2")]}):h("0x3e")===h("0x42")||(l?!0===l[h("0x11")]&&Ol(function zh(){return(new Date)[h("0x3")]()/1e3}(),l[h("0x27")])?h("0xb")===h("0x34")||(s={type:3,packageName:n,expiryDate:tr(l[h("0x27")]),docsUrl:e[h("0x2")]}):Ol(e[h("0x16")],l[h("0x27")])&&(h("0x44")===h("0x19")||(s={type:2,packageName:n,publishDate:tr(e[h("0x16")]),expiryDate:tr(l[h("0x27")]),docsUrl:e[h("0x2")]})):h("0x22")===h("0x2c")||(s={type:1,packageName:n,docsUrl:e[h("0x2")]})),s&&typeof console===h("0x2e"))if(h("0x3c")!=h("0x3c"));else{var c=h("0x48")[h("0x0")](e[h("0x1a")]),u=typeof console[h("0x35")]===h("0x3a");u?h("0x2a")!=h("0x2a")||console[h("0x35")](c):h("0xe")===h("0x3f")||console[h("0x40")](c),console[h("0x40")](function Ph(e){var t=h("0x9")[h("0x0")](e[h("0x33")],"\n");return 2===e[h("0x45")]&&h("0x28")!==h("0x37")&&(t+=h("0x1")[h("0x0")](e[h("0x1f")][h("0x17")](),h("0x25"))[h("0x0")](e[h("0x16")][h("0x17")](),".\n")),3===e[h("0x45")]?h("0x13")===h("0x38")||(t+=h("0x2d")[h("0x0")](e[h("0x1f")][h("0x17")](),".\n")):0===e[h("0x45")]?h("0x31")!==h("0x20")&&(t+=h("0x21")):1===e[h("0x45")]&&(h("0x10")===h("0x24")||(t+=h("0x1e"))),t+h("0x43")[h("0x0")](e[h("0x3b")],h("0x41"))}(s)),u&&h("0xd")==h("0xd")&&console[h("0x8")]()}var d=!s;return pi[h("0x47")](e[h("0x1d")],d),d}(Yh),this.saveFile=this.saveFile.bind(this)}save(n){this.toDataURL(n).then(this.saveFile)}workbookOptions(n){const r=this.getExportData(n);return Hh({columns:this.columns,data:r.data,group:r.group,filterable:this.filterable,creator:this.creator,date:this.date,rtl:this.localization.rtl,paddingCellOptions:this.paddingCellOptions,headerPaddingCellOptions:this.headerPaddingCellOptions,collapsible:this.collapsible})}toDataURL(n){const r=(e=>e&&e.sheets)(n)?n:this.workbookOptions(n);return this.zone.runOutsideAngular(()=>(e=>new ld(e).toDataURL())(r))}getExportData(n){let r;return r=n?Array.isArray(n)?{data:n}:n:{data:this.data,group:this.group},r}saveFile(n){!function cs(e,t,n={}){let r=hs;if(n.forceProxy&&!n.proxyURL)throw new Error("No proxyURL is set, but forceProxy is true");n.forceProxy||("download"in zi()&&(r=fs),navigator.msSaveBlob&&(r=ds)),r(e,t,n)}(n,this.fileName,{forceProxy:this.forceProxy,proxyURL:this.proxyURL})}}return e.\u0275fac=function(n){return new(n||e)(i.Y36(Al),i.Y36(i.R0b))},e.\u0275cmp=i.Xpm({type:e,selectors:[["kendo-excelexport"]],contentQueries:function(n,r,a){if(1&n&&i.Suo(a,mt,5),2&n){let o;i.iGM(o=i.CRH())&&(r.columns=o)}},inputs:{fileName:"fileName",filterable:"filterable",collapsible:"collapsible",creator:"creator",date:"date",forceProxy:"forceProxy",proxyURL:"proxyURL",data:"data",group:"group",paddingCellOptions:"paddingCellOptions",headerPaddingCellOptions:"headerPaddingCellOptions"},exportAs:["kendoExcelExport"],features:[i._Bn([Al,{provide:kl,useValue:"kendo.excelexport"}])],decls:0,vars:0,template:function(n,r){},encapsulation:2}),e})(),mi=(()=>{class e{constructor(n){this.templateRef=n}}return e.\u0275fac=function(n){return new(n||e)(i.Y36(i.Rgc,8))},e.\u0275dir=i.lG2({type:e,selectors:[["","kendoExcelExportGroupHeaderTemplate",""]]}),e})(),El=(()=>{class e{constructor(n){this.templateRef=n}}return e.\u0275fac=function(n){return new(n||e)(i.Y36(i.Rgc,8))},e.\u0275dir=i.lG2({type:e,selectors:[["","kendoExcelExportGroupHeaderColumnTemplate",""]]}),e})(),gi=(()=>{class e{constructor(n){this.templateRef=n}}return e.\u0275fac=function(n){return new(n||e)(i.Y36(i.Rgc,8))},e.\u0275dir=i.lG2({type:e,selectors:[["","kendoExcelExportGroupFooterTemplate",""]]}),e})(),Ke=(()=>{class e{constructor(n){this.templateRef=n}}return e.\u0275fac=function(n){return new(n||e)(i.Y36(i.Rgc,8))},e.\u0275dir=i.lG2({type:e,selectors:[["","kendoExcelExportFooterTemplate",""]]}),e})(),et=(()=>{class e extends mt{constructor(n){super(n)}}return e.\u0275fac=function(n){return new(n||e)(i.Y36(mt,13))},e.\u0275cmp=i.Xpm({type:e,selectors:[["kendo-excelexport-column"]],contentQueries:function(n,r,a){if(1&n&&(i.Suo(a,mi,5),i.Suo(a,El,5),i.Suo(a,gi,5),i.Suo(a,Ke,5)),2&n){let o;i.iGM(o=i.CRH())&&(r.groupHeaderTemplate=o.first),i.iGM(o=i.CRH())&&(r.groupHeaderColumnTemplate=o.first),i.iGM(o=i.CRH())&&(r.groupFooterTemplate=o.first),i.iGM(o=i.CRH())&&(r.footerTemplate=o.first)}},inputs:{field:"field",cellOptions:"cellOptions",groupHeaderCellOptions:"groupHeaderCellOptions",groupFooterCellOptions:"groupFooterCellOptions",footerCellOptions:"footerCellOptions"},features:[i._Bn([{provide:mt,useExisting:(0,i.Gpc)(()=>e)}]),i.qOj],decls:0,vars:0,template:function(n,r){},encapsulation:2}),e})(),tt=(()=>{class e extends mt{constructor(n){super(n),this.parent=n}}return e.\u0275fac=function(n){return new(n||e)(i.Y36(mt,13))},e.\u0275cmp=i.Xpm({type:e,selectors:[["kendo-excelexport-column-group"]],features:[i._Bn([{provide:mt,useExisting:(0,i.Gpc)(()=>e)}]),i.qOj],decls:0,vars:0,template:function(n,r){},encapsulation:2}),e})(),Vh=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=i.oAB({type:e}),e.\u0275inj=i.cJS({}),e})();function Qh(e,t){if(1&e&&i._uU(0),2&e){const n=i.oxw();i.hij(" ",n.totalAmount," ")}}function jh(e,t){if(1&e&&i._uU(0),2&e){const n=i.oxw();i.hij(" ",n.totalDiscountAmount," ")}}function Wh(e,t){if(1&e&&i._uU(0),2&e){const n=i.oxw();i.hij(" ",n.totalDuesAmount," ")}}function Xh(e,t){if(1&e&&i._uU(0),2&e){const n=i.oxw();i.hij(" ",n.totalRecievedAmount," ")}}const Kh=function(){return{textAlign:"center",fontSize:16,bold:!0}},rr=function(){return{textAlign:"center",fontSize:13}},ye=function(){return{textAlign:"center",fontSize:14,bold:!0}},xi=function(){return{textAlign:"left",fontSize:13}},ir=function(){return{textAlign:"right",fontSize:13}},ar=function(){return{textAlign:"right"}};let ep=(()=>{var e;class t{constructor(r,a,o,l,s,c,u){this.authService=r,this.toastrService=a,this.loader=o,this.masterService=l,this.commonService=s,this.winRef=c,this.env=u,this.cancelledBillList$=new j.X([]),this.inlineEditFlag=!1,this.showLogCheckedFlag=!1,this.gridOptions=new Le.s8,this.changeDetection=new Ie.x,this.destroySubscription$=new Pe.t(1),this.currentDate=new Date,this.selectedStartDate=new Date,this.selectedEndDate=new Date,this.selectedBillDetails={},this.screenWidth=screen.width,this.exportedFileName=(new Date).toISOString(),this.totalAmount=0,this.totalDiscountAmount=0,this.totalRecievedAmount=0,this.totalDuesAmount=0}ngOnInit(){this.setCancelledBillTableList(),this.gridOptions={searchPlaceholder:"Search Bill",pageSize:this.authService.pageSize,dateFormat:"yyyy-MM-dd",keyCodeForNextCell:13,showInlineEdit:this.inlineEditFlag,titleForMobileView:"entityPatientName",pageSizeArray:[5,10,20],showDeleteButton:!1,showAddButton:!1,showEditButton:!1,showActivateDeactivateButton:!1,showSearchInput:!0,activateDeactivateCondition:{conditionalProperty:"activeFlag",valueForActivation:"1",valueForDeactivation:"0"},columns:[{name:"billDisplayID",label:"Bill ID",enable:!0,searchable:!0,sortable:!0,type:"text",editable:!1,isRequired:!1,footerValue:0},{name:"entityPatientName",label:"Patient Name",enable:!0,searchable:!1,sortable:!0,type:"text",editable:!1,isRequired:!1},{name:"entityPatientAge",label:"Patient Age",enable:!0,searchable:!1,sortable:!0,type:"text",editable:!1,isRequired:!1},{name:"entityPatientGender",label:"Gender",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"billingDate",label:"Bill Date",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"referralName",label:"Referral Name",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"amount",label:"Amount",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1,footerValue:0},{name:"discountAmount",label:"Discount Amount",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1,footerValue:0},{name:"recivedAmount",label:"Recieved Amount",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1,footerValue:0},{name:"duesAmount",label:"Dues Amount",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1,footerValue:0},{name:"amountRecievedBy",label:"Cancelled By",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"remarks",label:"Cancellation reason",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1}]}}setFooterValue(r){this.gridOptions.columns.find(a=>"billDisplayID"==a.name).footerValue=r.length||0,this.totalAmount=r.reduce((a,o)=>a+o.amount,0),this.totalDiscountAmount=r.reduce((a,o)=>a+o.discountAmount,0),this.totalRecievedAmount=r.reduce((a,o)=>a+o.recivedAmount,0),this.totalDuesAmount=r.reduce((a,o)=>a+o.duesAmount,0),this.gridOptions.columns.find(a=>"amount"==a.name).footerValue=this.totalAmount||0,this.gridOptions.columns.find(a=>"discountAmount"==a.name).footerValue=this.totalDiscountAmount||0,this.gridOptions.columns.find(a=>"recivedAmount"==a.name).footerValue=this.totalRecievedAmount||0,this.gridOptions.columns.find(a=>"duesAmount"==a.name).footerValue=this.totalDuesAmount||0}exportData(){0==this.cancelledBillList$.getValue().length?this.toastrService.show({type:"error",text:"List should not empty!"}):this.exportToPdf()}getCancelledBillList(){var r=this;return new Promise((a,o)=>{this.loader.showSpinner("Cancelled Bill List on the way!");const l={reportSearchDTO:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W",checkFlag:1,dropDown:!1,fromDate:this.commonService.parseDate(this.selectedStartDate,"yyyy-MM-dd"),toDate:this.commonService.parseDate(this.selectedEndDate,"yyyy-MM-dd")}};this.masterService.requestApiForGeneralMaster(l,"reportservice/getBillReport").pipe((0,ee.R)(this.destroySubscription$)).subscribe(function(){var s=(0,G.Z)(function*(c){r.loader.hideSpinner(),"200"===c.statusCode?(c.responseList=yield r.extractPatientDetails(c.responseList),a(c.responseList)):o(c.errorMessage)});return function(c){return s.apply(this,arguments)}}(),s=>{this.loader.hideSpinner(),o("Either Internet is not working or some internal server issue")})})}extractPatientDetails(r){var a=this;return(0,G.Z)(function*(){const o=(new Date).toISOString().slice(0,10);return r=yield r.map(l=>{let s=null===l.patitentName?["",o,""]:l.patitentName.split(",");const c=a.commonService.convertDate(l.billingDate);let u=s[0],d=a.commonService.findValuesOfYearMonthAndDays(s[1],c),m=s[2];return{...l,entityPatientName:u,entityPatientAge:0==d.years?d.months+" M , "+d.days+" D":d.years+" Y",entityPatientGender:m}}).sort((l,s)=>Date.parse(l.billingDate)>Date.parse(s.billingDate)?-1:0)})()}ngOnDestroy(){this.destroySubscription$.next(null),this.destroySubscription$.complete()}setCancelledBillTableList(){this.getCancelledBillList().then(r=>{this.cancelledBillList$.next(r),this.setFooterValue(r)}).catch(r=>{this.cancelledBillList$.next([]),this.toastrService.show({type:"error",text:r})})}searchCancelledBillForSelectedDate(){this.setCancelledBillTableList()}resetDateFilter(){this.selectedStartDate=new Date,this.selectedEndDate=new Date,this.setCancelledBillTableList()}exportToPdf(){const r=this.cancelledBillList$.getValue();var a={info:{title:"Cancelled Bill Report"},pageSize:"a4",pageMargins:[15,60,15,20],header:function(){return{text:"Bill Cancelled Report",fontSize:"28",alignment:"center",decoration:"underline",margin:[0,15,0,0]}},footer:function(c){return[{text:"Page: "+c,alignment:"center",fontSize:"8",bold:!0,margin:[1,1,1,1]}]},pageOrientation:"landscape",content:[{margin:[0,0,0,0],border:[!1,!1,!1,!1],table:{widths:[50,80,90,55,35,90,50,50,40,40,40,80],body:[[{text:"Bill ID",style:"subHeader"},{text:"Bill Date",style:"subHeader"},{text:"Patient Name",style:"subHeader"},{text:"Patient Age",style:"subHeader"},{text:"Gender",style:"subHeader"},{text:"Referral Name",style:"subHeader"},{text:"Amount",style:"subHeader"},{text:"Discount Amount",style:"subHeader"},{text:"Recieved Amount",style:"subHeader"},{text:"Dues Amount",style:"subHeader"},{text:"Payment Method",style:"subHeader"},{text:"Cancelled By",style:"subHeader"}],r,[{text:"",border:[!1,!0,!1,!1]},{text:"",border:[!1,!0,!1,!1]},{text:"",border:[!1,!0,!1,!1]},{text:"",border:[!1,!0,!1,!1]},{text:"",border:[!1,!0,!1,!1]},{text:"Total",border:[!0,!0,!0,!0],style:["value"]},{text:"",border:[!1,!0,!1,!1]},{text:"",border:[!1,!0,!1,!1]},{text:"",border:[!1,!0,!1,!1]},{text:"",border:[!1,!0,!1,!1]},{text:"",border:[!1,!0,!1,!1]},{text:"",border:[!1,!0,!1,!1]}]]}}],styles:{subHeader:{bold:!0,fontSize:10,color:"white",fillColor:"#80b3ff",alignment:"center"},tableHeader:{bold:!0,fontSize:14,fillColor:"Red"},value:{fontSize:8.5,alignment:"center",border:[!1,!0,!1,!1]},value2:{alignment:"right"}}};let o=a.content[0].table.body[2],l=a.content[0].table.body,s=0;for(let c=0;c<r.length;c++)s++,l[s]=[{text:r[c].billDisplayID,style:"value"},{text:r[c].billingDate,style:"value"},{text:r[c].entityPatientName,fontSize:8.5,border:[!1,!0,!1,!1]},{text:r[c].entityPatientAge,style:"value"},{text:r[c].entityPatientGender,style:"value"},{text:r[c].referralName,fontSize:8.5,border:[!1,!0,!1,!1]},{text:r[c].amount,style:["value","value2"]},{text:r[c].discountAmount,style:["value","value2"]},{text:r[c].recivedAmount,style:["value","value2"]},{text:r[c].duesAmount,style:["value","value2"]},{text:r[c].paymentType,style:"value"},{text:r[c].amountRecievedBy,style:"value",alignment:"left"}];o[6]={text:this.totalAmount,style:["value","value2"]},o[7]={text:this.totalDiscountAmount,style:["value","value2"]},o[8]={text:this.totalRecievedAmount,style:["value","value2"]},o[9]={text:this.totalDuesAmount,style:["value","value2"]},l[s+1]=o,this.winRef.nativeWindow.pdfMake.createPdf(a).open()}}return(e=t).\u0275fac=function(r){return new(r||e)(i.Y36(Be.$),i.Y36(ze.k),i.Y36(Ze.D),i.Y36($e.c),i.Y36(Ue.v),i.Y36(rt.f),i.Y36(it.D))},e.\u0275cmp=i.Xpm({type:e,selectors:[["app-bill-cancelled-report"]],decls:54,vars:80,consts:[[1,"container-fluid"],[1,"row"],[1,"col-lg-5","col-md-5","col-sm-12"],["childLink","Reports","subchildLink","Bill Cancelled"],[1,"col-lg-2","col-md-2","col-sm-12","bill-search-parameter"],["appearance","outline",2,"width","100%"],["matInput","","placeholder","Start Date","id","start-date-block","readonly","",3,"matDatepicker","ngModel","max","ngModelChange","click"],["matSuffix","",3,"for"],["aria-label","calendar-icon","matDatepickerToggleIcon","",1,"lms-calendar-icon"],["startDatePicker",""],["matInput","","placeholder","End Date","id","end-date-block","readonly","",3,"matDatepicker","ngModel","max","min","ngModelChange","click"],["endDatePicker",""],[1,"col-lg-3","col-md-3","col-sm-12","bill-search-parameter"],["mat-raised-button","","color","warn",1,"warn-action-btn",3,"click"],["mat-raised-button","","color","primary",1,"primary-action-btn",3,"click"],[1,"mat-elevation-z12","lms-master-card"],[1,"lms-matcardtitlegroup"],["mat-icon-button","",1,"excel-icon-button",3,"disableRipple","disabled","click"],["aria-label","excel",1,"lms-excel-icon"],["mat-icon-button","",3,"disableRipple","click"],["aria-label","pdf",1,"lms-pdf-icon"],[1,"remaining-space"],[3,"data","creator","fileName"],["excelexport",""],["title","Bill Cancelled Report",3,"headerCellOptions"],["field","billDisplayID","title","Bill Display ID",3,"width","cellOptions","headerCellOptions"],["field","billingDate","title","Billing Date",3,"width","cellOptions","headerCellOptions"],["field","entityPatientName","title","Patient Name",3,"width","headerCellOptions","cellOptions"],["field","entityPatientAge","title","Patient Age",3,"width","headerCellOptions","cellOptions"],["field","entityPatientGender","title","Gender",3,"width","headerCellOptions","cellOptions"],["field","referralName","title","Referral Name",3,"width","headerCellOptions","cellOptions"],["field","amount","title","Amount",3,"width","headerCellOptions","cellOptions","footerCellOptions"],["kendoExcelExportFooterTemplate",""],["field","discountAmount","title","Discount Amount",3,"width","headerCellOptions","cellOptions","footerCellOptions"],["field","duesAmount","title","Dues Amount",3,"width","headerCellOptions","cellOptions","footerCellOptions"],["field","recivedAmount","title","Recieved Amount",3,"width","headerCellOptions","cellOptions","footerCellOptions"],["field","amountRecievedBy","title","Cancelled By",3,"width","headerCellOptions","cellOptions"]],template:function(r,a){if(1&r){const o=i.EpF();i._UZ(0,"app-header"),i.TgZ(1,"div",0)(2,"div",1)(3,"div",2),i._UZ(4,"app-breadcrumb",3),i.qZA(),i.TgZ(5,"div",4)(6,"mat-form-field",5)(7,"mat-label"),i._uU(8,"Start Date"),i.qZA(),i.TgZ(9,"input",6),i.NdJ("ngModelChange",function(s){return a.selectedStartDate=s})("click",function(){i.CHM(o);const s=i.MAs(13);return i.KtG(s.open())}),i.qZA(),i.TgZ(10,"mat-datepicker-toggle",7),i._UZ(11,"div",8),i.qZA(),i._UZ(12,"mat-datepicker",null,9),i.qZA()(),i.TgZ(14,"div",4)(15,"mat-form-field",5)(16,"mat-label"),i._uU(17,"End Date"),i.qZA(),i.TgZ(18,"input",10),i.NdJ("ngModelChange",function(s){return a.selectedEndDate=s})("click",function(){i.CHM(o);const s=i.MAs(22);return i.KtG(s.open())}),i.qZA(),i.TgZ(19,"mat-datepicker-toggle",7),i._UZ(20,"div",8),i.qZA(),i._UZ(21,"mat-datepicker",null,11),i.qZA()(),i.TgZ(23,"div",12)(24,"button",13),i.NdJ("click",function(){return a.resetDateFilter()}),i._uU(25," Reset "),i.qZA(),i.TgZ(26,"button",14),i.NdJ("click",function(){return a.searchCancelledBillForSelectedDate()}),i._uU(27," Search "),i.qZA()()(),i.TgZ(28,"div",1)(29,"mat-card",15)(30,"mat-card-title-group",16)(31,"button",17),i.NdJ("click",function(){i.CHM(o);const s=i.MAs(37);return i.KtG(s.save())}),i._UZ(32,"div",18),i.qZA(),i.TgZ(33,"button",19),i.NdJ("click",function(){return a.exportData()}),i._UZ(34,"div",20),i.qZA(),i._UZ(35,"span",21),i.qZA()()(),i.TgZ(36,"kendo-excelexport",22,23)(38,"kendo-excelexport-column-group",24),i._UZ(39,"kendo-excelexport-column",25)(40,"kendo-excelexport-column",26)(41,"kendo-excelexport-column",27)(42,"kendo-excelexport-column",28)(43,"kendo-excelexport-column",29)(44,"kendo-excelexport-column",30),i.TgZ(45,"kendo-excelexport-column",31),i.YNc(46,Qh,1,1,"ng-template",32),i.qZA(),i.TgZ(47,"kendo-excelexport-column",33),i.YNc(48,jh,1,1,"ng-template",32),i.qZA(),i.TgZ(49,"kendo-excelexport-column",34),i.YNc(50,Wh,1,1,"ng-template",32),i.qZA(),i.TgZ(51,"kendo-excelexport-column",35),i.YNc(52,Xh,1,1,"ng-template",32),i.qZA(),i._UZ(53,"kendo-excelexport-column",36),i.qZA()()()}if(2&r){const o=i.MAs(13),l=i.MAs(22);i.xp6(9),i.Q6J("matDatepicker",o)("ngModel",a.selectedStartDate)("max",a.currentDate),i.xp6(1),i.Q6J("for",o),i.xp6(8),i.Q6J("matDatepicker",l)("ngModel",a.selectedEndDate)("max",a.currentDate)("min",a.selectedStartDate),i.xp6(1),i.Q6J("for",l),i.xp6(12),i.Q6J("disableRipple",!0)("disabled",0==a.cancelledBillList$.getValue().length),i.xp6(2),i.Q6J("disableRipple",!0),i.xp6(3),i.MGl("fileName","Bill Cancelled Report_",a.exportedFileName,".xlsx"),i.Q6J("data",a.cancelledBillList$.getValue())("creator",a.env.excelAuthorName),i.xp6(2),i.Q6J("headerCellOptions",i.DdM(53,Kh)),i.xp6(1),i.Q6J("width",120)("cellOptions",i.DdM(54,rr))("headerCellOptions",i.DdM(55,ye)),i.xp6(1),i.Q6J("width",150)("cellOptions",i.DdM(56,rr))("headerCellOptions",i.DdM(57,ye)),i.xp6(1),i.Q6J("width",200)("headerCellOptions",i.DdM(58,ye))("cellOptions",i.DdM(59,xi)),i.xp6(1),i.Q6J("width",200)("headerCellOptions",i.DdM(60,ye))("cellOptions",i.DdM(61,rr)),i.xp6(1),i.Q6J("width",80)("headerCellOptions",i.DdM(62,ye))("cellOptions",i.DdM(63,rr)),i.xp6(1),i.Q6J("width",200)("headerCellOptions",i.DdM(64,ye))("cellOptions",i.DdM(65,xi)),i.xp6(1),i.Q6J("width",120)("headerCellOptions",i.DdM(66,ye))("cellOptions",i.DdM(67,ir))("footerCellOptions",i.DdM(68,ar)),i.xp6(2),i.Q6J("width",150)("headerCellOptions",i.DdM(69,ye))("cellOptions",i.DdM(70,ir))("footerCellOptions",i.DdM(71,ar)),i.xp6(2),i.Q6J("width",150)("headerCellOptions",i.DdM(72,ye))("cellOptions",i.DdM(73,ir))("footerCellOptions",i.DdM(74,ar)),i.xp6(2),i.Q6J("width",150)("headerCellOptions",i.DdM(75,ye))("cellOptions",i.DdM(76,ir))("footerCellOptions",i.DdM(77,ar)),i.xp6(2),i.Q6J("width",200)("headerCellOptions",i.DdM(78,ye))("cellOptions",i.DdM(79,xi))}},dependencies:[qe.G,R.Fj,R.JJ,R.On,te.lW,te.RK,ne.a8,ne.C1,N.Mq,N.hl,N.nW,N.Q0,He.Nt,z.KE,z.hX,z.R9,Ge.L,Xe,et,tt,Ke],styles:[".bill-search-parameter[_ngcontent-%COMP%]{margin-top:11px}.warn-action-btn[_ngcontent-%COMP%]{float:right;margin-top:5px}.primary-action-btn[_ngcontent-%COMP%]{float:right;margin-right:10px;margin-top:5px}.excel-icon-button[_ngcontent-%COMP%]:disabled{opacity:.4}"]}),t})();function tp(e,t){if(1&e&&i._uU(0),2&e){const n=i.oxw();i.hij(" ",n.totalAmount," ")}}function np(e,t){if(1&e&&i._uU(0),2&e){const n=i.oxw();i.hij(" ",n.totalDiscountAmount," ")}}function rp(e,t){if(1&e&&i._uU(0),2&e){const n=i.oxw();i.hij(" ",n.totalRecievedAmount," ")}}const ip=function(){return{textAlign:"center",fontSize:16,bold:!0}},or=function(){return{textAlign:"center",fontSize:13}},me=function(){return{textAlign:"center",fontSize:14,bold:!0}},sn=function(){return{textAlign:"left",fontSize:13}},_i=function(){return{textAlign:"right",fontSize:13}},bi=function(){return{textAlign:"right"}};let ap=(()=>{var e;class t{constructor(r,a,o,l,s,c,u){this.authService=r,this.toastrService=a,this.loader=o,this.masterService=l,this.commonService=s,this.winRef=c,this.env=u,this.billDetailTestList$=new j.X([]),this.inlineEditFlag=!1,this.showLogCheckedFlag=!1,this.gridOptions=new Le.s8,this.changeDetection=new Ie.x,this.destroySubscription$=new Pe.t(1),this.currentDate=new Date,this.selectedStartDate=new Date,this.selectedEndDate=new Date,this.selectedBillDetails={},this.screenWidth=screen.width,this.exportedFileName=(new Date).toISOString(),this.totalAmount=0,this.totalDiscountAmount=0,this.totalRecievedAmount=0}ngOnInit(){this.setBillDetailTestList(),this.gridOptions={searchPlaceholder:"Search Bill",pageSize:this.authService.pageSize,dateFormat:"yyyy-MM-dd",keyCodeForNextCell:13,showInlineEdit:this.inlineEditFlag,titleForMobileView:"entityPatientName",pageSizeArray:[5,10,20],showDeleteButton:!1,showAddButton:!1,showEditButton:!1,showActivateDeactivateButton:!1,showSearchInput:!0,activateDeactivateCondition:{conditionalProperty:"activeFlag",valueForActivation:"1",valueForDeactivation:"0"},columns:[{name:"billDisplayID",label:"Bill ID",enable:!0,searchable:!0,sortable:!0,type:"text",editable:!1,isRequired:!1,footerValue:0},{name:"entityPatientName",label:"Patient Name",enable:!0,searchable:!1,sortable:!0,type:"text",editable:!1,isRequired:!1},{name:"entityPatientAge",label:"Patient Age",enable:!0,searchable:!1,sortable:!0,type:"text",editable:!1,isRequired:!1},{name:"entityPatientGender",label:"Gender",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"billingDate",label:"Bill Date",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"referralName",label:"Referral Name",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"testName",label:"Test Name",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"departmentName",label:"Department Name",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"subDepartmentName",label:"Subdepartment Name",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"amount",label:"Rate",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1,footerValue:0},{name:"discountAmount",label:"Discount Amount",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1,footerValue:0},{name:"recivedAmount",label:"Final Amount",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1,footerValue:0}]}}setFooterValue(r){this.gridOptions.columns.find(a=>"billDisplayID"==a.name).footerValue=r.length||0,this.totalAmount=r.reduce((a,o)=>a+o.amount,0),this.totalDiscountAmount=r.reduce((a,o)=>a+o.discountAmount,0),this.totalRecievedAmount=r.reduce((a,o)=>a+o.recivedAmount,0),this.gridOptions.columns.find(a=>"amount"==a.name).footerValue=this.totalAmount||0,this.gridOptions.columns.find(a=>"discountAmount"==a.name).footerValue=this.totalDiscountAmount||0,this.gridOptions.columns.find(a=>"recivedAmount"==a.name).footerValue=this.totalRecievedAmount||0}exportData(){0==this.billDetailTestList$.getValue().length?this.toastrService.show({type:"error",text:"List should not empty!"}):this.exportToPdf()}getBillDetailsList(){var r=this;return new Promise((a,o)=>{this.loader.showSpinner("Bill Details List on the way!");const l={reportSearchDTO:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W",dropDown:!1,fromDate:this.commonService.parseDate(this.selectedStartDate,"yyyy-MM-dd"),toDate:this.commonService.parseDate(this.selectedEndDate,"yyyy-MM-dd")}};this.masterService.requestApiForGeneralMaster(l,"reportservice/getBillDetailReport").pipe((0,ee.R)(this.destroySubscription$)).subscribe(function(){var s=(0,G.Z)(function*(c){r.loader.hideSpinner(),"200"===c.statusCode?(c.responseList=yield r.extractPatientDetails(c.responseList),a(c.responseList)):o(c.errorMessage)});return function(c){return s.apply(this,arguments)}}(),s=>{this.loader.hideSpinner(),o("Either Internet is not working or some internal server issue")})})}extractPatientDetails(r){var a=this;return(0,G.Z)(function*(){const o=(new Date).toISOString().slice(0,10);return r=yield r.map(l=>{let s=null===l.patitentName?["",o,""]:l.patitentName.split(",");const c=a.commonService.convertDate(l.billingDate);let u=s[0],d=a.commonService.findValuesOfYearMonthAndDays(s[1],c),m=s[2];return{...l,entityPatientName:u,entityPatientAge:0==d.years?d.months+" M , "+d.days+" D":d.years+" Y",entityPatientGender:m}}).sort((l,s)=>Date.parse(l.billingDate)>Date.parse(s.billingDate)?-1:0)})()}ngOnDestroy(){this.destroySubscription$.next(null),this.destroySubscription$.complete()}setBillDetailTestList(){this.getBillDetailsList().then(r=>{this.billDetailTestList$.next(r),this.setFooterValue(r)}).catch(r=>{this.billDetailTestList$.next([]),this.toastrService.show({type:"error",text:r})})}searchBillTestListForSelectedDate(){this.setBillDetailTestList()}resetDateFilter(){this.selectedStartDate=new Date,this.selectedEndDate=new Date,this.setBillDetailTestList()}exportToPdf(){const r=this.billDetailTestList$.getValue();var a={info:{title:"Bill detail test list report"},pageSize:"a4",pageMargins:[15,60,15,20],header:function(){return{text:"Bill Detail Test List Report",fontSize:"28",alignment:"center",decoration:"underline",margin:[0,15,0,0]}},footer:function(c){return[{text:"Page: "+c,alignment:"center",fontSize:"8",bold:!0,margin:[1,1,1,1]}]},pageOrientation:"landscape",content:[{margin:[0,0,0,0],border:[!1,!1,!1,!1],table:{widths:[50,80,90,35,35,90,50,70,80,40,40,40],body:[[{text:"Bill ID",style:"subHeader"},{text:"Bill Date",style:"subHeader"},{text:"Patient Name",style:"subHeader"},{text:"Patient Age",style:"subHeader"},{text:"Gender",style:"subHeader"},{text:"Test Name",style:"subHeader"},{text:"Department Name",style:"subHeader"},{text:"Subdepartment Name",style:"subHeader"},{text:"Referral Name",style:"subHeader"},{text:"Rate",style:"subHeader"},{text:"Discount Amount",style:"subHeader"},{text:"Final Amount",style:"subHeader"}],r,[{text:"",border:[!1,!0,!1,!1]},{text:"",border:[!1,!0,!1,!1]},{text:"",border:[!1,!0,!1,!1]},{text:"",border:[!1,!0,!1,!1]},{text:"",border:[!1,!0,!1,!1]},{text:"",border:[!1,!0,!1,!1]},{text:"",border:[!1,!0,!1,!1]},{text:"",border:[!1,!0,!1,!1]},{text:"Total",border:[!0,!0,!0,!0],style:["value"]},{text:"",border:[!1,!0,!1,!1]},{text:"",border:[!1,!0,!1,!1]},{text:"",border:[!1,!0,!1,!1]}]]}}],styles:{subHeader:{bold:!0,fontSize:10,color:"white",fillColor:"#80b3ff",alignment:"center"},tableHeader:{bold:!0,fontSize:14,fillColor:"Red"},value:{fontSize:8.5,alignment:"center",border:[!1,!0,!1,!1]},value2:{alignment:"right"}}};let o=a.content[0].table.body[2],l=a.content[0].table.body,s=0;for(let c=0;c<r.length;c++)s++,l[s]=[{text:r[c].billDisplayID,style:"value"},{text:r[c].billingDate,style:"value"},{text:r[c].entityPatientName,fontSize:8.5,border:[!1,!0,!1,!1]},{text:r[c].entityPatientAge,style:"value"},{text:r[c].entityPatientGender,style:"value"},{text:r[c].testName,style:["value","value2"]},{text:r[c].departmentName,style:"value"},{text:r[c].subDepartmentName,style:"value"},{text:r[c].referralName,fontSize:8.5,border:[!1,!0,!1,!1]},{text:r[c].amount,style:["value","value2"]},{text:r[c].discountAmount,style:["value","value2"]},{text:r[c].recivedAmount,style:["value","value2"]}];o[9]={text:this.totalAmount,style:["value","value2"]},o[10]={text:this.totalDiscountAmount,style:["value","value2"]},o[11]={text:this.totalRecievedAmount,style:["value","value2"]},l[s+1]=o,this.winRef.nativeWindow.pdfMake.createPdf(a).open()}}return(e=t).\u0275fac=function(r){return new(r||e)(i.Y36(Be.$),i.Y36(ze.k),i.Y36(Ze.D),i.Y36($e.c),i.Y36(Ue.v),i.Y36(rt.f),i.Y36(it.D))},e.\u0275cmp=i.Xpm({type:e,selectors:[["app-bill-detail-test-list"]],decls:55,vars:83,consts:[[1,"container-fluid"],[1,"row"],[1,"col-lg-5","col-md-5","col-sm-12"],["childLink","Reports","subchildLink","Bill Detail Test List"],[1,"col-lg-2","col-md-2","col-sm-12","bill-search-parameter"],["appearance","outline",2,"width","100%"],["matInput","","placeholder","Start Date","id","start-date-block","readonly","",3,"matDatepicker","ngModel","max","ngModelChange","click"],["matSuffix","",3,"for"],["aria-label","calendar-icon","matDatepickerToggleIcon","",1,"lms-calendar-icon"],["startDatePicker",""],["matInput","","placeholder","End Date","id","end-date-block","readonly","",3,"matDatepicker","ngModel","max","min","ngModelChange","click"],["endDatePicker",""],[1,"col-lg-3","col-md-3","col-sm-12","bill-search-parameter"],["mat-raised-button","","color","warn",1,"warn-action-btn",3,"click"],["mat-raised-button","","color","primary",1,"primary-action-btn",3,"click"],[1,"mat-elevation-z12","lms-master-card"],[1,"lms-matcardtitlegroup"],["mat-icon-button","",1,"excel-icon-button",3,"disableRipple","disabled","click"],["aria-label","excel",1,"lms-excel-icon"],["mat-icon-button","",3,"disableRipple","click"],["aria-label","pdf",1,"lms-pdf-icon"],[1,"remaining-space"],[3,"data","creator","fileName"],["excelexport",""],["title","Bill Detail Test List Report",3,"headerCellOptions"],["field","billDisplayID","title","Bill Display ID",3,"width","cellOptions","headerCellOptions"],["field","billingDate","title","Billing Date",3,"width","cellOptions","headerCellOptions"],["field","entityPatientName","title","Patient Name",3,"width","headerCellOptions","cellOptions"],["field","entityPatientAge","title","Patient Age",3,"width","headerCellOptions","cellOptions"],["field","entityPatientGender","title","Gender",3,"width","headerCellOptions","cellOptions"],["field","referralName","title","Referral Name",3,"width","headerCellOptions","cellOptions"],["field","testName","title","Test Name",3,"width","headerCellOptions","cellOptions"],["field","departmentName","title","Department Name",3,"width","headerCellOptions","cellOptions"],["field","subDepartmentName","title","Subdepartment Name",3,"width","headerCellOptions","cellOptions"],["field","amount","title","Amount",3,"width","headerCellOptions","cellOptions","footerCellOptions"],["kendoExcelExportFooterTemplate",""],["field","discountAmount","title","Discount Amount",3,"width","headerCellOptions","cellOptions","footerCellOptions"],["field","recivedAmount","title","Final Amount",3,"width","headerCellOptions","cellOptions","footerCellOptions"]],template:function(r,a){if(1&r){const o=i.EpF();i._UZ(0,"app-header"),i.TgZ(1,"div",0)(2,"div",1)(3,"div",2),i._UZ(4,"app-breadcrumb",3),i.qZA(),i.TgZ(5,"div",4)(6,"mat-form-field",5)(7,"mat-label"),i._uU(8,"Start Date"),i.qZA(),i.TgZ(9,"input",6),i.NdJ("ngModelChange",function(s){return a.selectedStartDate=s})("click",function(){i.CHM(o);const s=i.MAs(13);return i.KtG(s.open())}),i.qZA(),i.TgZ(10,"mat-datepicker-toggle",7),i._UZ(11,"div",8),i.qZA(),i._UZ(12,"mat-datepicker",null,9),i.qZA()(),i.TgZ(14,"div",4)(15,"mat-form-field",5)(16,"mat-label"),i._uU(17,"End Date"),i.qZA(),i.TgZ(18,"input",10),i.NdJ("ngModelChange",function(s){return a.selectedEndDate=s})("click",function(){i.CHM(o);const s=i.MAs(22);return i.KtG(s.open())}),i.qZA(),i.TgZ(19,"mat-datepicker-toggle",7),i._UZ(20,"div",8),i.qZA(),i._UZ(21,"mat-datepicker",null,11),i.qZA()(),i.TgZ(23,"div",12)(24,"button",13),i.NdJ("click",function(){return a.resetDateFilter()}),i._uU(25," Reset "),i.qZA(),i.TgZ(26,"button",14),i.NdJ("click",function(){return a.searchBillTestListForSelectedDate()}),i._uU(27," Search "),i.qZA()()(),i.TgZ(28,"div",1)(29,"mat-card",15)(30,"mat-card-title-group",16)(31,"button",17),i.NdJ("click",function(){i.CHM(o);const s=i.MAs(37);return i.KtG(s.save())}),i._UZ(32,"div",18),i.qZA(),i.TgZ(33,"button",19),i.NdJ("click",function(){return a.exportData()}),i._UZ(34,"div",20),i.qZA(),i._UZ(35,"span",21),i.qZA()()(),i.TgZ(36,"kendo-excelexport",22,23)(38,"kendo-excelexport-column-group",24),i._uU(39,"fontSize: 13 "),i._UZ(40,"kendo-excelexport-column",25)(41,"kendo-excelexport-column",26)(42,"kendo-excelexport-column",27)(43,"kendo-excelexport-column",28)(44,"kendo-excelexport-column",29)(45,"kendo-excelexport-column",30)(46,"kendo-excelexport-column",31)(47,"kendo-excelexport-column",32)(48,"kendo-excelexport-column",33),i.TgZ(49,"kendo-excelexport-column",34),i.YNc(50,tp,1,1,"ng-template",35),i.qZA(),i.TgZ(51,"kendo-excelexport-column",36),i.YNc(52,np,1,1,"ng-template",35),i.qZA(),i.TgZ(53,"kendo-excelexport-column",37),i.YNc(54,rp,1,1,"ng-template",35),i.qZA()()()()}if(2&r){const o=i.MAs(13),l=i.MAs(22);i.xp6(9),i.Q6J("matDatepicker",o)("ngModel",a.selectedStartDate)("max",a.currentDate),i.xp6(1),i.Q6J("for",o),i.xp6(8),i.Q6J("matDatepicker",l)("ngModel",a.selectedEndDate)("max",a.currentDate)("min",a.selectedStartDate),i.xp6(1),i.Q6J("for",l),i.xp6(12),i.Q6J("disableRipple",!0)("disabled",0==a.billDetailTestList$.getValue().length),i.xp6(2),i.Q6J("disableRipple",!0),i.xp6(3),i.MGl("fileName","Bill Detail Test List Report_",a.exportedFileName,".xlsx"),i.Q6J("data",a.billDetailTestList$.getValue())("creator",a.env.excelAuthorName),i.xp6(2),i.Q6J("headerCellOptions",i.DdM(55,ip)),i.xp6(2),i.Q6J("width",120)("cellOptions",i.DdM(56,or))("headerCellOptions",i.DdM(57,me)),i.xp6(1),i.Q6J("width",150)("cellOptions",i.DdM(58,or))("headerCellOptions",i.DdM(59,me)),i.xp6(1),i.Q6J("width",200)("headerCellOptions",i.DdM(60,me))("cellOptions",i.DdM(61,sn)),i.xp6(1),i.Q6J("width",200)("headerCellOptions",i.DdM(62,me))("cellOptions",i.DdM(63,or)),i.xp6(1),i.Q6J("width",80)("headerCellOptions",i.DdM(64,me))("cellOptions",i.DdM(65,or)),i.xp6(1),i.Q6J("width",200)("headerCellOptions",i.DdM(66,me))("cellOptions",i.DdM(67,sn)),i.xp6(1),i.Q6J("width",120)("headerCellOptions",i.DdM(68,me))("cellOptions",i.DdM(69,sn)),i.xp6(1),i.Q6J("width",120)("headerCellOptions",i.DdM(70,me))("cellOptions",i.DdM(71,sn)),i.xp6(1),i.Q6J("width",120)("headerCellOptions",i.DdM(72,me))("cellOptions",i.DdM(73,sn)),i.xp6(1),i.Q6J("width",120)("headerCellOptions",i.DdM(74,me))("cellOptions",i.DdM(75,_i))("footerCellOptions",i.DdM(76,bi)),i.xp6(2),i.Q6J("width",150)("headerCellOptions",i.DdM(77,me))("cellOptions",i.DdM(78,_i))("footerCellOptions",i.DdM(79,bi)),i.xp6(2),i.Q6J("width",150)("headerCellOptions",i.DdM(80,me))("cellOptions",i.DdM(81,_i))("footerCellOptions",i.DdM(82,bi))}},dependencies:[qe.G,R.Fj,R.JJ,R.On,te.lW,te.RK,ne.a8,ne.C1,N.Mq,N.hl,N.nW,N.Q0,He.Nt,z.KE,z.hX,z.R9,Ge.L,Xe,et,tt,Ke],styles:[".bill-search-parameter[_ngcontent-%COMP%]{margin-top:11px}.warn-action-btn[_ngcontent-%COMP%]{float:right;margin-top:5px}.primary-action-btn[_ngcontent-%COMP%]{float:right;margin-right:10px;margin-top:5px}.excel-icon-button[_ngcontent-%COMP%]:disabled{opacity:.4}"]}),t})();function op(e,t){if(1&e&&i._uU(0),2&e){const n=i.oxw();i.hij(" ",n.totalBillAmount," ")}}function lp(e,t){if(1&e&&i._uU(0),2&e){const n=i.oxw();i.hij(" ",n.totalDuesAmount," ")}}function sp(e,t){if(1&e&&i._uU(0),2&e){const n=i.oxw();i.hij(" ",n.totalDiscountAmount," ")}}const cp=function(){return{textAlign:"center",fontSize:16,bold:!0}},lr=function(){return{textAlign:"center",fontSize:13}},ve=function(){return{textAlign:"center",fontSize:14,bold:!0}},sr=function(){return{textAlign:"left",fontSize:13}},yi=function(){return{textAlign:"right",fontSize:13}},vi=function(){return{textAlign:"right"}};let up=(()=>{var e;class t{constructor(r,a,o,l,s,c,u){this.authService=r,this.toastrService=a,this.loader=o,this.masterService=l,this.commonService=s,this.winRef=c,this.env=u,this.billDuesList$=new j.X([]),this.inlineEditFlag=!1,this.showLogCheckedFlag=!1,this.gridOptions=new Le.s8,this.changeDetection=new Ie.x,this.destroySubscription$=new Pe.t(1),this.currentDate=new Date,this.selectedStartDate=new Date,this.selectedEndDate=new Date,this.selectedBillDetails={},this.screenWidth=screen.width,this.exportedFileName=(new Date).toISOString(),this.totalBillAmount=0,this.totalDuesAmount=0,this.totalDiscountAmount=0}ngOnInit(){this.setBillDuesList(),this.gridOptions={searchPlaceholder:"Search Bill",pageSize:this.authService.pageSize,dateFormat:"yyyy-MM-dd",keyCodeForNextCell:13,showInlineEdit:this.inlineEditFlag,titleForMobileView:"entityPatientName",pageSizeArray:[5,10,20],showDeleteButton:!1,showAddButton:!1,showEditButton:!1,showActivateDeactivateButton:!1,showSearchInput:!0,activateDeactivateCondition:{conditionalProperty:"activeFlag",valueForActivation:"1",valueForDeactivation:"0"},columns:[{name:"entityBusinessShortCode",label:"Bill ID",enable:!0,searchable:!0,sortable:!0,type:"text",editable:!1,isRequired:!1,footerValue:0},{name:"effectiveDateFrom",label:"Bill Date",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"entityPatientName",label:"Patient Name",enable:!0,searchable:!1,sortable:!0,type:"text",editable:!1,isRequired:!1},{name:"entityPatientAge",label:"Patient Age",enable:!0,searchable:!1,sortable:!0,type:"text",editable:!1,isRequired:!1},{name:"entityPatientGender",label:"Gender",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"referralName",label:"Referral Name",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"totalBillAmount",label:"Bill Amount",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1,footerValue:0},{name:"totalDuesAmount",label:"Dues Amount",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1,footerValue:0},{name:"totalDiscountAmount",label:"Discount on dues",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1,footerValue:0},{name:"discountRemarks",label:"Discount Reason",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"entityBusinessName",label:"Received By",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1}]}}setFooterValue(r){this.gridOptions.columns.find(a=>"entityBusinessShortCode"==a.name).footerValue=r.length||0,this.totalBillAmount=r.reduce((a,o)=>a+o.totalBillAmount,0),this.totalDuesAmount=r.reduce((a,o)=>a+o.totalDuesAmount,0),this.totalDiscountAmount=r.reduce((a,o)=>a+o.totalDiscountAmount,0),this.gridOptions.columns.find(a=>"totalBillAmount"==a.name).footerValue=this.totalBillAmount||0,this.gridOptions.columns.find(a=>"totalDuesAmount"==a.name).footerValue=this.totalDuesAmount||0,this.gridOptions.columns.find(a=>"totalDiscountAmount"==a.name).footerValue=this.totalDiscountAmount||0}exportData(){0==this.billDuesList$.getValue().length?this.toastrService.show({type:"error",text:"List should not empty!"}):this.exportToPdf()}getBillDuesList(){var r=this;return new Promise((a,o)=>{this.loader.showSpinner("Bill Dues List on the way!");const l={reportSearchDTO:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W",dropDown:!1,fromDate:this.commonService.parseDate(this.selectedStartDate,"yyyy-MM-dd"),toDate:this.commonService.parseDate(this.selectedEndDate,"yyyy-MM-dd")}};this.masterService.requestApiForGeneralMaster(l,"reportservice/getBillDues").pipe((0,ee.R)(this.destroySubscription$)).subscribe(function(){var s=(0,G.Z)(function*(c){r.loader.hideSpinner(),"200"===c.statusCode?(c.responseList=yield r.extractPatientDetails(c.responseList),a(c.responseList)):o(c.errorMessage)});return function(c){return s.apply(this,arguments)}}(),s=>{this.loader.hideSpinner(),o("Either Internet is not working or some internal server issue")})})}extractPatientDetails(r){var a=this;return(0,G.Z)(function*(){const o=(new Date).toISOString().slice(0,10);return r=yield r.map(l=>{let s=null===l.patitentName?["",o,""]:l.patitentName.split(","),c=s[0],u=a.commonService.findValuesOfYearMonthAndDays(s[1],l.effectiveDateFrom),d=s[2];return{...l,entityPatientName:c,entityPatientAge:0==u.years?u.months+" M , "+u.days+" D":u.years+" Y",entityPatientGender:d,totalDiscountAmount:null==l.totalDiscountAmount?0:l.totalDiscountAmount}}).sort((l,s)=>Date.parse(l.effectiveDateFrom)>Date.parse(s.effectiveDateFrom)?-1:0)})()}ngOnDestroy(){this.destroySubscription$.next(null),this.destroySubscription$.complete()}setBillDuesList(){this.getBillDuesList().then(r=>{this.billDuesList$.next(r),this.setFooterValue(r)}).catch(r=>{this.billDuesList$.next([]),this.toastrService.show({type:"error",text:r})})}searchBillDuesForSelectedDate(){this.setBillDuesList()}resetDateFilter(){this.selectedStartDate=new Date,this.selectedEndDate=new Date,this.setBillDuesList()}exportToPdf(){const r=this.billDuesList$.getValue();var a={info:{title:"Bill dues report"},pageSize:"a4",pageMargins:[15,60,15,20],header:function(){return{text:"Bill Dues Report",fontSize:"28",alignment:"center",decoration:"underline",margin:[0,15,0,0]}},footer:function(c){return[{text:"Page: "+c,alignment:"center",fontSize:"8",bold:!0,margin:[1,1,1,1]}]},pageOrientation:"landscape",content:[{margin:[0,0,0,0],border:[!1,!1,!1,!1],table:{widths:[50,80,90,35,35,120,70,70,50,50,50],body:[[{text:"Bill ID",style:"subHeader"},{text:"Bill Date",style:"subHeader"},{text:"Patient Name",style:"subHeader"},{text:"Patient Age",style:"subHeader"},{text:"Gender",style:"subHeader"},{text:"Discount Remarks",style:"subHeader"},{text:"Amount Recieved By",style:"subHeader"},{text:"Referral Name",style:"subHeader"},{text:"Total Bill Amount",style:"subHeader"},{text:"Dues Amount",style:"subHeader"},{text:"Discount Amount",style:"subHeader"}],r,[{text:"",border:[!1,!0,!1,!1]},{text:"",border:[!1,!0,!1,!1]},{text:"",border:[!1,!0,!1,!1]},{text:"",border:[!1,!0,!1,!1]},{text:"",border:[!1,!0,!1,!1]},{text:"",border:[!1,!0,!1,!1]},{text:"",border:[!1,!0,!1,!1]},{text:"Total",border:[!0,!0,!0,!0],style:["value"]},{text:"",border:[!1,!0,!1,!1]},{text:"",border:[!1,!0,!1,!1]},{text:"",border:[!1,!0,!1,!1]}]]}}],styles:{subHeader:{bold:!0,fontSize:10,color:"white",fillColor:"#80b3ff",alignment:"center"},tableHeader:{bold:!0,fontSize:14,fillColor:"Red"},value:{fontSize:8.5,alignment:"center",border:[!1,!0,!1,!1]},value2:{alignment:"right"}}};let o=a.content[0].table.body[2],l=a.content[0].table.body,s=0;for(let c=0;c<r.length;c++)s++,l[s]=[{text:r[c].entityBusinessShortCode,style:"value"},{text:r[c].effectiveDateFrom,style:"value"},{text:r[c].entityPatientName,fontSize:8.5,border:[!1,!0,!1,!1]},{text:r[c].entityPatientAge,style:"value"},{text:r[c].entityPatientGender,style:"value"},{text:r[c].discountRemarks,style:["value","value2"]},{text:r[c].entityBusinessName,style:"value"},{text:r[c].referralName,fontSize:8.5,border:[!1,!0,!1,!1]},{text:r[c].totalBillAmount,style:["value","value2"]},{text:r[c].totalDuesAmount,style:["value","value2"]},{text:r[c].totalDiscountAmount,style:["value","value2"]}];o[8]={text:this.totalBillAmount,style:["value","value2"]},o[9]={text:this.totalDuesAmount,style:["value","value2"]},o[10]={text:this.totalDiscountAmount,style:["value","value2"]},l[s+1]=o,this.winRef.nativeWindow.pdfMake.createPdf(a).open()}}return(e=t).\u0275fac=function(r){return new(r||e)(i.Y36(Be.$),i.Y36(ze.k),i.Y36(Ze.D),i.Y36($e.c),i.Y36(Ue.v),i.Y36(rt.f),i.Y36(it.D))},e.\u0275cmp=i.Xpm({type:e,selectors:[["app-bill-dues-report"]],decls:53,vars:78,consts:[[1,"container-fluid"],[1,"row"],[1,"col-lg-5","col-md-5","col-sm-12"],["childLink","Reports","subchildLink","Bill Dues"],[1,"col-lg-2","col-md-2","col-sm-12","bill-search-parameter"],["appearance","outline",2,"width","100%"],["matInput","","placeholder","Start Date","id","start-date-block","readonly","",3,"matDatepicker","ngModel","max","ngModelChange","click"],["matSuffix","",3,"for"],["aria-label","calendar-icon","matDatepickerToggleIcon","",1,"lms-calendar-icon"],["startDatePicker",""],["matInput","","placeholder","End Date","id","end-date-block","readonly","",3,"matDatepicker","ngModel","max","min","ngModelChange","click"],["endDatePicker",""],[1,"col-lg-3","col-md-3","col-sm-12","bill-search-parameter"],["mat-raised-button","","color","warn",1,"warn-action-btn",3,"click"],["mat-raised-button","","color","primary",1,"primary-action-btn",3,"click"],[1,"mat-elevation-z12","lms-master-card"],[1,"lms-matcardtitlegroup"],["mat-icon-button","",1,"excel-icon-button",3,"disableRipple","disabled","click"],["aria-label","excel",1,"lms-excel-icon"],["mat-icon-button","",3,"disableRipple","click"],["aria-label","pdf",1,"lms-pdf-icon"],[1,"remaining-space"],[3,"data","creator","fileName"],["excelexport",""],["title","Bill Detail Test List Report",3,"headerCellOptions"],["field","entityBusinessShortCode","title","Bill ID",3,"width","cellOptions","headerCellOptions"],["field","effectiveDateFrom","title","Billing Date",3,"width","cellOptions","headerCellOptions"],["field","entityPatientName","title","Patient Name",3,"width","headerCellOptions","cellOptions"],["field","entityPatientAge","title","Patient Age",3,"width","headerCellOptions","cellOptions"],["field","entityPatientGender","title","Gender",3,"width","headerCellOptions","cellOptions"],["field","discountRemarks","title","Discount Reason",3,"width","headerCellOptions","cellOptions"],["field","entityBusinessName","title","Amount Recieved By",3,"width","headerCellOptions","cellOptions"],["field","referralName","title","Referral Name",3,"width","headerCellOptions","cellOptions"],["field","totalBillAmount","title","Bill Amount",3,"width","headerCellOptions","cellOptions","footerCellOptions"],["kendoExcelExportFooterTemplate",""],["field","totalDuesAmount","title","Dues Amount",3,"width","headerCellOptions","cellOptions","footerCellOptions"],["field","totalDiscountAmount","title","Discount Amount",3,"width","headerCellOptions","cellOptions","footerCellOptions"]],template:function(r,a){if(1&r){const o=i.EpF();i._UZ(0,"app-header"),i.TgZ(1,"div",0)(2,"div",1)(3,"div",2),i._UZ(4,"app-breadcrumb",3),i.qZA(),i.TgZ(5,"div",4)(6,"mat-form-field",5)(7,"mat-label"),i._uU(8,"Start Date"),i.qZA(),i.TgZ(9,"input",6),i.NdJ("ngModelChange",function(s){return a.selectedStartDate=s})("click",function(){i.CHM(o);const s=i.MAs(13);return i.KtG(s.open())}),i.qZA(),i.TgZ(10,"mat-datepicker-toggle",7),i._UZ(11,"div",8),i.qZA(),i._UZ(12,"mat-datepicker",null,9),i.qZA()(),i.TgZ(14,"div",4)(15,"mat-form-field",5)(16,"mat-label"),i._uU(17,"End Date"),i.qZA(),i.TgZ(18,"input",10),i.NdJ("ngModelChange",function(s){return a.selectedEndDate=s})("click",function(){i.CHM(o);const s=i.MAs(22);return i.KtG(s.open())}),i.qZA(),i.TgZ(19,"mat-datepicker-toggle",7),i._UZ(20,"div",8),i.qZA(),i._UZ(21,"mat-datepicker",null,11),i.qZA()(),i.TgZ(23,"div",12)(24,"button",13),i.NdJ("click",function(){return a.resetDateFilter()}),i._uU(25," Reset "),i.qZA(),i.TgZ(26,"button",14),i.NdJ("click",function(){return a.searchBillDuesForSelectedDate()}),i._uU(27," Search "),i.qZA()()(),i.TgZ(28,"div",1)(29,"mat-card",15)(30,"mat-card-title-group",16)(31,"button",17),i.NdJ("click",function(){i.CHM(o);const s=i.MAs(37);return i.KtG(s.save())}),i._UZ(32,"div",18),i.qZA(),i.TgZ(33,"button",19),i.NdJ("click",function(){return a.exportData()}),i._UZ(34,"div",20),i.qZA(),i._UZ(35,"span",21),i.qZA()()(),i.TgZ(36,"kendo-excelexport",22,23)(38,"kendo-excelexport-column-group",24),i._UZ(39,"kendo-excelexport-column",25)(40,"kendo-excelexport-column",26)(41,"kendo-excelexport-column",27)(42,"kendo-excelexport-column",28)(43,"kendo-excelexport-column",29)(44,"kendo-excelexport-column",30)(45,"kendo-excelexport-column",31)(46,"kendo-excelexport-column",32),i.TgZ(47,"kendo-excelexport-column",33),i.YNc(48,op,1,1,"ng-template",34),i.qZA(),i.TgZ(49,"kendo-excelexport-column",35),i.YNc(50,lp,1,1,"ng-template",34),i.qZA(),i.TgZ(51,"kendo-excelexport-column",36),i.YNc(52,sp,1,1,"ng-template",34),i.qZA()()()()}if(2&r){const o=i.MAs(13),l=i.MAs(22);i.xp6(9),i.Q6J("matDatepicker",o)("ngModel",a.selectedStartDate)("max",a.currentDate),i.xp6(1),i.Q6J("for",o),i.xp6(8),i.Q6J("matDatepicker",l)("ngModel",a.selectedEndDate)("max",a.currentDate)("min",a.selectedStartDate),i.xp6(1),i.Q6J("for",l),i.xp6(12),i.Q6J("disableRipple",!0)("disabled",0==a.billDuesList$.getValue().length),i.xp6(2),i.Q6J("disableRipple",!0),i.xp6(3),i.MGl("fileName","Bill Dues Report_",a.exportedFileName,".xlsx"),i.Q6J("data",a.billDuesList$.getValue())("creator",a.env.excelAuthorName),i.xp6(2),i.Q6J("headerCellOptions",i.DdM(52,cp)),i.xp6(1),i.Q6J("width",120)("cellOptions",i.DdM(53,lr))("headerCellOptions",i.DdM(54,ve)),i.xp6(1),i.Q6J("width",150)("cellOptions",i.DdM(55,lr))("headerCellOptions",i.DdM(56,ve)),i.xp6(1),i.Q6J("width",200)("headerCellOptions",i.DdM(57,ve))("cellOptions",i.DdM(58,sr)),i.xp6(1),i.Q6J("width",200)("headerCellOptions",i.DdM(59,ve))("cellOptions",i.DdM(60,lr)),i.xp6(1),i.Q6J("width",80)("headerCellOptions",i.DdM(61,ve))("cellOptions",i.DdM(62,lr)),i.xp6(1),i.Q6J("width",120)("headerCellOptions",i.DdM(63,ve))("cellOptions",i.DdM(64,sr)),i.xp6(1),i.Q6J("width",120)("headerCellOptions",i.DdM(65,ve))("cellOptions",i.DdM(66,sr)),i.xp6(1),i.Q6J("width",200)("headerCellOptions",i.DdM(67,ve))("cellOptions",i.DdM(68,sr)),i.xp6(1),i.Q6J("width",120)("headerCellOptions",i.DdM(69,ve))("cellOptions",i.DdM(70,yi))("footerCellOptions",i.DdM(71,vi)),i.xp6(2),i.Q6J("width",150)("headerCellOptions",i.DdM(72,ve))("cellOptions",i.DdM(73,yi))("footerCellOptions",i.DdM(74,vi)),i.xp6(2),i.Q6J("width",150)("headerCellOptions",i.DdM(75,ve))("cellOptions",i.DdM(76,yi))("footerCellOptions",i.DdM(77,vi))}},dependencies:[qe.G,R.Fj,R.JJ,R.On,te.lW,te.RK,ne.a8,ne.C1,N.Mq,N.hl,N.nW,N.Q0,He.Nt,z.KE,z.hX,z.R9,Ge.L,Xe,et,tt,Ke],styles:[".bill-search-parameter[_ngcontent-%COMP%]{margin-top:11px}.warn-action-btn[_ngcontent-%COMP%]{float:right;margin-top:5px}.primary-action-btn[_ngcontent-%COMP%]{float:right;margin-right:10px;margin-top:5px}.excel-icon-button[_ngcontent-%COMP%]:disabled{opacity:.4}"]}),t})();function dp(e,t){if(1&e&&i._uU(0),2&e){const n=i.oxw();i.hij(" ",n.totalPaidAmount," ")}}function fp(e,t){if(1&e&&i._uU(0),2&e){const n=i.oxw();i.hij(" ",n.totalRefundAmount," ")}}function hp(e,t){if(1&e&&i._uU(0),2&e){const n=i.oxw();i.hij(" ",n.totalCollectedAmount," ")}}const pp=function(){return{textAlign:"center",fontSize:16,bold:!0}},Et=function(){return{textAlign:"center",fontSize:13}},ge=function(){return{textAlign:"center",fontSize:14,bold:!0}},Di=function(){return{textAlign:"left",fontSize:13}},wi=function(){return{textAlign:"right",fontSize:13}},Ci=function(){return{textAlign:"right"}};let mp=(()=>{var e;class t{constructor(r,a,o,l,s,c,u){this.authService=r,this.toastrService=a,this.loader=o,this.masterService=l,this.commonService=s,this.winRef=c,this.env=u,this.billRefundList$=new j.X([]),this.inlineEditFlag=!1,this.showLogCheckedFlag=!1,this.gridOptions=new Le.s8,this.changeDetection=new Ie.x,this.destroySubscription$=new Pe.t(1),this.currentDate=new Date,this.selectedStartDate=new Date,this.selectedEndDate=new Date,this.selectedBillDetails={},this.screenWidth=screen.width,this.exportedFileName=(new Date).toISOString(),this.totalPaidAmount=0,this.totalRefundAmount=0,this.totalCollectedAmount=0}ngOnInit(){this.setBillRefundList(),this.gridOptions={searchPlaceholder:"Search Bill",pageSize:this.authService.pageSize,dateFormat:"yyyy-MM-dd",keyCodeForNextCell:13,showInlineEdit:this.inlineEditFlag,titleForMobileView:"entityPatientName",pageSizeArray:[5,10,20],showDeleteButton:!1,showAddButton:!1,showEditButton:!1,showActivateDeactivateButton:!1,showSearchInput:!0,activateDeactivateCondition:{conditionalProperty:"activeFlag",valueForActivation:"1",valueForDeactivation:"0"},columns:[{name:"entityParentBusinessName",label:"Old Bill No.",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"effectiveDateTo",label:"Old Bill Date",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"entityBusinessShortCode",label:"New Bill ID",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1,footerValue:0},{name:"effectiveDateFrom",label:"New Bill Date",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"entityPatientName",label:"Patient Name",enable:!0,searchable:!0,sortable:!0,type:"text",editable:!1,isRequired:!1},{name:"entityPatientAge",label:"Patient Age",enable:!0,searchable:!1,sortable:!0,type:"text",editable:!1,isRequired:!1},{name:"entityPatientGender",label:"Gender",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"amountPaidInLastBill",label:"Paid Amount",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1,footerValue:0},{name:"refundAmount",label:"Refunded Amount",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1,footerValue:0},{name:"entityCollectedAmount",label:"Collected Amount",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1,footerValue:0},{name:"createdByName",label:"Refunded By",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"refundTestsName",label:"Refund Test Name",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1}]}}setFooterValue(r){this.gridOptions.columns.find(a=>"entityBusinessShortCode"==a.name).footerValue=r.length||0,this.totalPaidAmount=r.reduce((a,o)=>a+o.amountPaidInLastBill,0),this.totalRefundAmount=r.reduce((a,o)=>a+o.refundAmount,0),this.totalCollectedAmount=r.reduce((a,o)=>a+o.entityCollectedAmount,0),this.gridOptions.columns.find(a=>"amountPaidInLastBill"==a.name).footerValue=this.totalPaidAmount||0,this.gridOptions.columns.find(a=>"refundAmount"==a.name).footerValue=this.totalRefundAmount||0,this.gridOptions.columns.find(a=>"entityCollectedAmount"==a.name).footerValue=this.totalCollectedAmount||0}exportData(){0==this.billRefundList$.getValue().length?this.toastrService.show({type:"error",text:"List should not empty!"}):this.exportToPdf()}getBillRefundList(){var r=this;return new Promise((a,o)=>{this.loader.showSpinner("Bill Dues List on the way!");const l={genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W",dropDown:!1,detailFlag:!1,fromDate:this.commonService.parseDate(this.selectedStartDate,"yyyy-MM-dd"),toDate:this.commonService.parseDate(this.selectedEndDate,"yyyy-MM-dd")}};this.masterService.requestApiForGeneralMaster(l,"billservice/getAllBillRefundEntity").pipe((0,ee.R)(this.destroySubscription$)).subscribe(function(){var s=(0,G.Z)(function*(c){r.loader.hideSpinner(),"200"===c.statusCode?(c.responseList=yield r.extractPatientDetails(c.responseList[0]),a(c.responseList)):o(c.errorMessage)});return function(c){return s.apply(this,arguments)}}(),s=>{this.loader.hideSpinner(),o("Either Internet is not working or some internal server issue")})})}extractPatientDetails(r){var a=this;return(0,G.Z)(function*(){const o=(new Date).toISOString().slice(0,10);return r=yield r.map(l=>{let s=null===l.patitentName?["",o,""]:l.patitentName.split(","),c=s[0],u=a.commonService.findValuesOfYearMonthAndDays(s[1],l.effectiveDateFrom),d=s[2];return{...l,entityPatientName:c,entityPatientAge:0==u.years?u.months+" M , "+u.days+" D":u.years+" Y",entityPatientGender:d,totalDiscountAmount:null==l.totalDiscountAmount?0:l.totalDiscountAmount,entityCollectedAmount:l.amountPaidInLastBill-l.refundAmount,entityTotalDuesAmount:1==l.paymentStatus?0:l.entityTotalDuesAmount,entityRefundStatus:1===l.refundStatus?"Yes":"No",entityFinalAmount:l.totalDuesAmount-(null==l.totalDiscountAmount?0:l.totalDiscountAmount)}}).sort((l,s)=>Date.parse(l.effectiveDateFrom)>Date.parse(s.effectiveDateFrom)?-1:0)})()}ngOnDestroy(){this.destroySubscription$.next(null),this.destroySubscription$.complete()}setBillRefundList(){this.getBillRefundList().then(r=>{this.billRefundList$.next(r),this.setFooterValue(r)}).catch(r=>{this.billRefundList$.next([]),this.toastrService.show({type:"error",text:r})})}searchBillRefundForSelectedDate(){this.setBillRefundList()}resetDateFilter(){this.selectedStartDate=new Date,this.selectedEndDate=new Date,this.setBillRefundList()}exportToPdf(){const r=this.billRefundList$.getValue();var a={info:{title:"Bill refund report"},pageSize:"a4",pageMargins:[15,60,15,20],header:function(){return{text:"Bill Refund Report",fontSize:"28",alignment:"center",decoration:"underline",margin:[0,15,0,0]}},footer:function(c){return[{text:"Page: "+c,alignment:"center",fontSize:"8",bold:!0,margin:[1,1,1,1]}]},pageOrientation:"landscape",content:[{margin:[0,0,0,0],border:[!1,!1,!1,!1],table:{widths:[50,50,50,50,80,35,35,140,60,50,50,50],body:[[{text:"Old Bill ID",style:"subHeader"},{text:"Old Bill Date",style:"subHeader"},{text:"New Bill ID",style:"subHeader"},{text:"New Bill Date",style:"subHeader"},{text:"Patient Name",style:"subHeader"},{text:"Patient Age",style:"subHeader"},{text:"Gender",style:"subHeader"},{text:"Refund Test Name",style:"subHeader"},{text:"Refunded By",style:"subHeader"},{text:"Paid Amount",style:"subHeader"},{text:"Refunded Amount",style:"subHeader"},{text:"Collected Amount",style:"subHeader"}],r,[{text:"",border:[!1,!0,!1,!1]},{text:"",border:[!1,!0,!1,!1]},{text:"",border:[!1,!0,!1,!1]},{text:"",border:[!1,!0,!1,!1]},{text:"",border:[!1,!0,!1,!1]},{text:"",border:[!1,!0,!1,!1]},{text:"",border:[!1,!0,!1,!1]},{text:"",border:[!1,!0,!1,!1]},{text:"Total",border:[!0,!0,!0,!0],style:["value"]},{text:"",border:[!1,!0,!1,!1]},{text:"",border:[!1,!0,!1,!1]},{text:"",border:[!1,!0,!1,!1]}]]}}],styles:{subHeader:{bold:!0,fontSize:10,color:"white",fillColor:"#80b3ff",alignment:"center"},tableHeader:{bold:!0,fontSize:14,fillColor:"Red"},value:{fontSize:8.5,alignment:"center",border:[!1,!0,!1,!1]},value2:{alignment:"right"}}};let o=a.content[0].table.body[2],l=a.content[0].table.body,s=0;for(let c=0;c<r.length;c++)s++,l[s]=[{text:r[c].entityParentBusinessName,style:"value"},{text:r[c].effectiveDateTo,style:"value"},{text:r[c].entityBusinessShortCode,style:"value"},{text:r[c].effectiveDateFrom,style:"value"},{text:r[c].entityPatientName,fontSize:8.5,border:[!1,!0,!1,!1]},{text:r[c].entityPatientAge,style:"value"},{text:r[c].entityPatientGender,style:"value"},{text:r[c].refundTestsName,style:["value","value2"]},{text:r[c].createdByName,fontSize:8.5,border:[!1,!0,!1,!1]},{text:r[c].amountPaidInLastBill,style:["value","value2"]},{text:r[c].refundAmount,style:["value","value2"]},{text:r[c].entityCollectedAmount,style:["value","value2"]}];o[9]={text:this.totalPaidAmount,style:["value","value2"]},o[10]={text:this.totalRefundAmount,style:["value","value2"]},o[11]={text:this.totalCollectedAmount,style:["value","value2"]},l[s+1]=o,this.winRef.nativeWindow.pdfMake.createPdf(a).open()}}return(e=t).\u0275fac=function(r){return new(r||e)(i.Y36(Be.$),i.Y36(ze.k),i.Y36(Ze.D),i.Y36($e.c),i.Y36(Ue.v),i.Y36(rt.f),i.Y36(it.D))},e.\u0275cmp=i.Xpm({type:e,selectors:[["app-bill-refund-report"]],decls:54,vars:83,consts:[[1,"container-fluid"],[1,"row"],[1,"col-lg-5","col-md-5","col-sm-12"],["childLink","Reports","subchildLink","Bill Refund"],[1,"col-lg-2","col-md-2","col-sm-12","bill-search-parameter"],["appearance","outline",2,"width","100%"],["matInput","","placeholder","Start Date","id","start-date-block","readonly","",3,"matDatepicker","ngModel","max","ngModelChange","click"],["matSuffix","",3,"for"],["aria-label","calendar-icon","matDatepickerToggleIcon","",1,"lms-calendar-icon"],["startDatePicker",""],["matInput","","placeholder","End Date","id","end-date-block","readonly","",3,"matDatepicker","ngModel","max","min","ngModelChange","click"],["endDatePicker",""],[1,"col-lg-3","col-md-3","col-sm-12","bill-search-parameter"],["mat-raised-button","","color","warn",1,"warn-action-btn",3,"click"],["mat-raised-button","","color","primary",1,"primary-action-btn",3,"click"],[1,"mat-elevation-z12","lms-master-card"],[1,"lms-matcardtitlegroup"],["mat-icon-button","",1,"excel-icon-button",3,"disableRipple","disabled","click"],["aria-label","excel",1,"lms-excel-icon"],["mat-icon-button","",3,"disableRipple","click"],["aria-label","pdf",1,"lms-pdf-icon"],[1,"remaining-space"],[3,"data","creator","fileName"],["excelexport",""],["title","Bill Refund Report",3,"headerCellOptions"],["field","entityParentBusinessName","title","Old Bill ID",3,"width","cellOptions","headerCellOptions"],["field","effectiveDateTo","title","Old Bill Date",3,"width","cellOptions","headerCellOptions"],["field","entityBusinessShortCode","title","New Bill ID",3,"width","cellOptions","headerCellOptions"],["field","effectiveDateFrom","title","New Bill Date",3,"width","cellOptions","headerCellOptions"],["field","entityPatientName","title","Patient Name",3,"width","headerCellOptions","cellOptions"],["field","entityPatientAge","title","Patient Age",3,"width","headerCellOptions","cellOptions"],["field","entityPatientGender","title","Gender",3,"width","headerCellOptions","cellOptions"],["field","refundTestsName","title","Refund Test Name",3,"width","headerCellOptions","cellOptions"],["field","createdByName","title","Refunded By",3,"width","headerCellOptions","cellOptions"],["field","amountPaidInLastBill","title","Paid Amount",3,"width","headerCellOptions","cellOptions","footerCellOptions"],["kendoExcelExportFooterTemplate",""],["field","refundAmount","title","Refunded Amount",3,"width","headerCellOptions","cellOptions","footerCellOptions"],["field","entityCollectedAmount","title","Collected Amount",3,"width","headerCellOptions","cellOptions","footerCellOptions"]],template:function(r,a){if(1&r){const o=i.EpF();i._UZ(0,"app-header"),i.TgZ(1,"div",0)(2,"div",1)(3,"div",2),i._UZ(4,"app-breadcrumb",3),i.qZA(),i.TgZ(5,"div",4)(6,"mat-form-field",5)(7,"mat-label"),i._uU(8,"Start Date"),i.qZA(),i.TgZ(9,"input",6),i.NdJ("ngModelChange",function(s){return a.selectedStartDate=s})("click",function(){i.CHM(o);const s=i.MAs(13);return i.KtG(s.open())}),i.qZA(),i.TgZ(10,"mat-datepicker-toggle",7),i._UZ(11,"div",8),i.qZA(),i._UZ(12,"mat-datepicker",null,9),i.qZA()(),i.TgZ(14,"div",4)(15,"mat-form-field",5)(16,"mat-label"),i._uU(17,"End Date"),i.qZA(),i.TgZ(18,"input",10),i.NdJ("ngModelChange",function(s){return a.selectedEndDate=s})("click",function(){i.CHM(o);const s=i.MAs(22);return i.KtG(s.open())}),i.qZA(),i.TgZ(19,"mat-datepicker-toggle",7),i._UZ(20,"div",8),i.qZA(),i._UZ(21,"mat-datepicker",null,11),i.qZA()(),i.TgZ(23,"div",12)(24,"button",13),i.NdJ("click",function(){return a.resetDateFilter()}),i._uU(25," Reset "),i.qZA(),i.TgZ(26,"button",14),i.NdJ("click",function(){return a.searchBillRefundForSelectedDate()}),i._uU(27," Search "),i.qZA()()(),i.TgZ(28,"div",1)(29,"mat-card",15)(30,"mat-card-title-group",16)(31,"button",17),i.NdJ("click",function(){i.CHM(o);const s=i.MAs(37);return i.KtG(s.save())}),i._UZ(32,"div",18),i.qZA(),i.TgZ(33,"button",19),i.NdJ("click",function(){return a.exportData()}),i._UZ(34,"div",20),i.qZA(),i._UZ(35,"span",21),i.qZA()()(),i.TgZ(36,"kendo-excelexport",22,23)(38,"kendo-excelexport-column-group",24),i._UZ(39,"kendo-excelexport-column",25)(40,"kendo-excelexport-column",26)(41,"kendo-excelexport-column",27)(42,"kendo-excelexport-column",28)(43,"kendo-excelexport-column",29)(44,"kendo-excelexport-column",30)(45,"kendo-excelexport-column",31)(46,"kendo-excelexport-column",32)(47,"kendo-excelexport-column",33),i.TgZ(48,"kendo-excelexport-column",34),i.YNc(49,dp,1,1,"ng-template",35),i.qZA(),i.TgZ(50,"kendo-excelexport-column",36),i.YNc(51,fp,1,1,"ng-template",35),i.qZA(),i.TgZ(52,"kendo-excelexport-column",37),i.YNc(53,hp,1,1,"ng-template",35),i.qZA()()()()}if(2&r){const o=i.MAs(13),l=i.MAs(22);i.xp6(9),i.Q6J("matDatepicker",o)("ngModel",a.selectedStartDate)("max",a.currentDate),i.xp6(1),i.Q6J("for",o),i.xp6(8),i.Q6J("matDatepicker",l)("ngModel",a.selectedEndDate)("max",a.currentDate)("min",a.selectedStartDate),i.xp6(1),i.Q6J("for",l),i.xp6(12),i.Q6J("disableRipple",!0)("disabled",0==a.billRefundList$.getValue().length),i.xp6(2),i.Q6J("disableRipple",!0),i.xp6(3),i.MGl("fileName","Bill Refund Report_",a.exportedFileName,".xlsx"),i.Q6J("data",a.billRefundList$.getValue())("creator",a.env.excelAuthorName),i.xp6(2),i.Q6J("headerCellOptions",i.DdM(55,pp)),i.xp6(1),i.Q6J("width",120)("cellOptions",i.DdM(56,Et))("headerCellOptions",i.DdM(57,ge)),i.xp6(1),i.Q6J("width",150)("cellOptions",i.DdM(58,Et))("headerCellOptions",i.DdM(59,ge)),i.xp6(1),i.Q6J("width",120)("cellOptions",i.DdM(60,Et))("headerCellOptions",i.DdM(61,ge)),i.xp6(1),i.Q6J("width",150)("cellOptions",i.DdM(62,Et))("headerCellOptions",i.DdM(63,ge)),i.xp6(1),i.Q6J("width",200)("headerCellOptions",i.DdM(64,ge))("cellOptions",i.DdM(65,Di)),i.xp6(1),i.Q6J("width",200)("headerCellOptions",i.DdM(66,ge))("cellOptions",i.DdM(67,Et)),i.xp6(1),i.Q6J("width",80)("headerCellOptions",i.DdM(68,ge))("cellOptions",i.DdM(69,Et)),i.xp6(1),i.Q6J("width",120)("headerCellOptions",i.DdM(70,ge))("cellOptions",i.DdM(71,Di)),i.xp6(1),i.Q6J("width",120)("headerCellOptions",i.DdM(72,ge))("cellOptions",i.DdM(73,Di)),i.xp6(1),i.Q6J("width",120)("headerCellOptions",i.DdM(74,ge))("cellOptions",i.DdM(75,wi))("footerCellOptions",i.DdM(76,Ci)),i.xp6(2),i.Q6J("width",150)("headerCellOptions",i.DdM(77,ge))("cellOptions",i.DdM(78,wi))("footerCellOptions",i.DdM(79,Ci)),i.xp6(2),i.Q6J("width",150)("headerCellOptions",i.DdM(80,ge))("cellOptions",i.DdM(81,wi))("footerCellOptions",i.DdM(82,Ci))}},dependencies:[qe.G,R.Fj,R.JJ,R.On,te.lW,te.RK,ne.a8,ne.C1,N.Mq,N.hl,N.nW,N.Q0,He.Nt,z.KE,z.hX,z.R9,Ge.L,Xe,et,tt,Ke],styles:[".bill-search-parameter[_ngcontent-%COMP%]{margin-top:11px}.warn-action-btn[_ngcontent-%COMP%]{float:right;margin-top:5px}.primary-action-btn[_ngcontent-%COMP%]{float:right;margin-right:10px;margin-top:5px}.excel-icon-button[_ngcontent-%COMP%]:disabled{opacity:.4}"]}),t})();var gp=E(9098);let xp=(()=>{var e;class t{constructor(){}ngOnInit(){}}return(e=t).\u0275fac=function(r){return new(r||e)},e.\u0275cmp=i.Xpm({type:e,selectors:[["app-bill-report-log"]],decls:1,vars:0,consts:[["childLinkLabel","Reports","subchildLinkLabel","Bill Report Log"]],template:function(r,a){1&r&&i._UZ(0,"app-under-maintenance",0)},dependencies:[gp.g]}),t})();function _p(e,t){if(1&e&&i._uU(0),2&e){const n=i.oxw();i.hij(" ",n.totalAmount," ")}}function bp(e,t){if(1&e&&i._uU(0),2&e){const n=i.oxw();i.hij(" ",n.totalDiscountAmount," ")}}function yp(e,t){if(1&e&&i._uU(0),2&e){const n=i.oxw();i.hij(" ",n.totalPayableAmount," ")}}function vp(e,t){if(1&e&&i._uU(0),2&e){const n=i.oxw();i.hij(" ",n.totalReceivedAmount," ")}}function Dp(e,t){if(1&e&&i._uU(0),2&e){const n=i.oxw();i.hij(" ",n.totalDuesAmount," ")}}const wp=function(){return{textAlign:"center",fontSize:16,bold:!0}},cr=function(){return{textAlign:"center",fontSize:13}},xe=function(){return{textAlign:"center",fontSize:14,bold:!0}},Si=function(){return{textAlign:"left",fontSize:13}},cn=function(){return{textAlign:"right",fontSize:13}},un=function(){return{textAlign:"right"}};let Cp=(()=>{var e;class t{constructor(r,a,o,l,s,c,u){this.authService=r,this.toastrService=a,this.loader=o,this.masterService=l,this.commonService=s,this.winRef=c,this.env=u,this.billList$=new j.X([]),this.inlineEditFlag=!1,this.showLogCheckedFlag=!1,this.gridOptions=new Le.s8,this.changeDetection=new Ie.x,this.destroySubscription$=new Pe.t(1),this.currentDate=new Date,this.selectedStartDate=new Date,this.selectedEndDate=new Date,this.selectedBillDetails={},this.screenWidth=screen.width,this.exportedFileName=(new Date).toISOString(),this.totalAmount=0,this.totalDiscountAmount=0,this.totalPayableAmount=0,this.totalReceivedAmount=0,this.totalDuesAmount=0}ngOnInit(){this.setBillList(),this.gridOptions={searchPlaceholder:"Search Bill",pageSize:this.authService.pageSize,dateFormat:"yyyy-MM-dd",keyCodeForNextCell:13,showInlineEdit:this.inlineEditFlag,titleForMobileView:"entityPatientName",pageSizeArray:[5,10,20],showDeleteButton:!1,showAddButton:!1,showEditButton:!1,showActivateDeactivateButton:!1,showSearchInput:!0,activateDeactivateCondition:{conditionalProperty:"activeFlag",valueForActivation:"1",valueForDeactivation:"0"},columns:[{name:"billDisplayID",label:"Bill ID",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1,footerValue:0},{name:"billingDate",label:"Bill Date",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"entityPatientName",label:"Patient Name",enable:!0,searchable:!0,sortable:!0,type:"text",editable:!1,isRequired:!1},{name:"entityPatientAge",label:"Patient Age",enable:!0,searchable:!1,sortable:!0,type:"text",editable:!1,isRequired:!1},{name:"entityPatientGender",label:"Gender",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"referralName",label:"Referral Name",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"amount",label:"Amount/Balance",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1,footerValue:0},{name:"discountAmount",label:"Discount Amount",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1,footerValue:0},{name:"entityPayableAmount",label:"Payable Amount",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1,footerValue:0},{name:"recivedAmount",label:"Recieved Amount",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1,footerValue:0},{name:"duesAmount",label:"Dues Amount",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1,footerValue:0},{name:"paymentType",label:"Payment Type",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"remarks",label:"Discount Reason",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"duesDiscountRemark",label:"Dues Discount Reason",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"amountRecievedBy",label:"Recieved By",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1}]}}setFooterValue(r){this.gridOptions.columns.find(a=>"billDisplayID"==a.name).footerValue=r.length||0,this.totalAmount=r.reduce((a,o)=>a+o.amount,0),this.totalDiscountAmount=r.reduce((a,o)=>a+o.discountAmount,0),this.totalPayableAmount=r.reduce((a,o)=>a+o.entityPayableAmount,0),this.totalReceivedAmount=r.reduce((a,o)=>a+o.recivedAmount,0),this.totalDuesAmount=r.reduce((a,o)=>a+o.duesAmount,0),this.gridOptions.columns.find(a=>"amount"==a.name).footerValue=this.totalAmount||0,this.gridOptions.columns.find(a=>"discountAmount"==a.name).footerValue=this.totalDiscountAmount||0,this.gridOptions.columns.find(a=>"entityPayableAmount"==a.name).footerValue=this.totalPayableAmount||0,this.gridOptions.columns.find(a=>"recivedAmount"==a.name).footerValue=this.totalReceivedAmount||0,this.gridOptions.columns.find(a=>"duesAmount"==a.name).footerValue=this.totalDuesAmount||0}exportData(){0==this.billList$.getValue().length?this.toastrService.show({type:"error",text:"List should not empty!"}):this.exportToPdf()}getBillList(){var r=this;return new Promise((a,o)=>{this.loader.showSpinner("Bill List on the way!");const l={reportSearchDTO:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W",dropDown:!1,checkFlag:null,fromDate:this.commonService.parseDate(this.selectedStartDate,"yyyy-MM-dd"),toDate:this.commonService.parseDate(this.selectedEndDate,"yyyy-MM-dd")}};this.masterService.requestApiForGeneralMaster(l,"reportservice/getBillReport").pipe((0,ee.R)(this.destroySubscription$)).subscribe(function(){var s=(0,G.Z)(function*(c){r.loader.hideSpinner(),"200"===c.statusCode?(c.responseList=yield r.extractPatientDetails(c.responseList),a(c.responseList)):o(c.errorMessage)});return function(c){return s.apply(this,arguments)}}(),s=>{this.loader.hideSpinner(),o("Either Internet is not working or some internal server issue")})})}extractPatientDetails(r){var a=this;return(0,G.Z)(function*(){const o=(new Date).toISOString().slice(0,10);return r=yield r.map(l=>{let s=null===l.patitentName?["",o,""]:l.patitentName.split(","),c=s[0],u=a.commonService.findValuesOfYearMonthAndDays(s[1],l.effectiveDateFrom),d=s[2];return{...l,entityPatientName:c,entityPatientAge:0==u.years?u.months+" M , "+u.days+" D":u.years+" Y",entityPatientGender:d,entityPayableAmount:l.amount-l.discountAmount}}).sort((l,s)=>Date.parse(l.effectiveDateFrom)>Date.parse(s.effectiveDateFrom)?-1:0)})()}ngOnDestroy(){this.destroySubscription$.next(null),this.destroySubscription$.complete()}setBillList(){this.getBillList().then(r=>{this.billList$.next(r),this.setFooterValue(r)}).catch(r=>{this.billList$.next([]),this.toastrService.show({type:"error",text:r})})}searchBillForSelectedDate(){this.setBillList()}resetDateFilter(){this.selectedStartDate=new Date,this.selectedEndDate=new Date,this.setBillList()}exportToPdf(){const r=this.billList$.getValue();var a={info:{title:"Bill report"},pageSize:"a4",pageMargins:[15,60,15,20],header:function(){return{text:"Bill Report",fontSize:"28",alignment:"center",decoration:"underline",margin:[0,15,0,0]}},footer:function(c){return[{text:"Page: "+c,alignment:"center",fontSize:"8",bold:!0,margin:[1,1,1,1]}]},pageOrientation:"landscape",content:[{margin:[0,0,0,0],border:[!1,!1,!1,!1],table:{widths:[50,90,100,50,35,65,70,50,50,50,50,50],body:[[{text:"Bill ID",style:"subHeader"},{text:"Bill Date",style:"subHeader"},{text:"Patient Name",style:"subHeader"},{text:"Patient Age",style:"subHeader"},{text:"Gender",style:"subHeader"},{text:"Recieved By",style:"subHeader"},{text:"Referral Name",style:"subHeader"},{text:"Amount/Balance",style:"subHeader"},{text:"Discount Amount",style:"subHeader"},{text:"Payable Amount",style:"subHeader"},{text:"Recieved Amount",style:"subHeader"},{text:"Dues Amount",style:"subHeader"}],r,[{text:"",border:[!1,!0,!1,!1]},{text:"",border:[!1,!0,!1,!1]},{text:"",border:[!1,!0,!1,!1]},{text:"",border:[!1,!0,!1,!1]},{text:"",border:[!1,!0,!1,!1]},{text:"",border:[!1,!0,!1,!1]},{text:"Total",border:[!0,!0,!0,!0],style:["value"]},{text:"",border:[!1,!0,!1,!1]},{text:"",border:[!1,!0,!1,!1]},{text:"",border:[!1,!0,!1,!1]},{text:"",border:[!1,!0,!1,!1]},{text:"",border:[!1,!0,!1,!1]}]]}}],styles:{subHeader:{bold:!0,fontSize:10,color:"white",fillColor:"#80b3ff",alignment:"center"},tableHeader:{bold:!0,fontSize:14,fillColor:"Red"},value:{fontSize:8.5,alignment:"center",border:[!1,!0,!1,!1]},value2:{alignment:"right"}}};let o=a.content[0].table.body[2],l=a.content[0].table.body,s=0;for(let c=0;c<r.length;c++)s++,l[s]=[{text:r[c].billDisplayID,style:"value"},{text:r[c].billingDate,style:"value"},{text:r[c].entityPatientName,fontSize:8.5,border:[!1,!0,!1,!1]},{text:r[c].entityPatientAge,style:"value"},{text:r[c].entityPatientGender,style:"value"},{text:r[c].amountRecievedBy,style:["value","value2"]},{text:r[c].referralName,fontSize:8.5,border:[!1,!0,!1,!1]},{text:r[c].amount,style:["value","value2"]},{text:r[c].discountAmount,style:["value","value2"]},{text:r[c].entityPayableAmount,style:["value","value2"]},{text:r[c].recivedAmount,style:["value","value2"]},{text:r[c].duesAmount,style:["value","value2"]}];o[7]={text:this.totalAmount,style:["value","value2"]},o[8]={text:this.totalDiscountAmount,style:["value","value2"]},o[9]={text:this.totalPayableAmount,style:["value","value2"]},o[10]={text:this.totalReceivedAmount,style:["value","value2"]},o[11]={text:this.totalDuesAmount,style:["value","value2"]},l[s+1]=o,this.winRef.nativeWindow.pdfMake.createPdf(a).open()}}return(e=t).\u0275fac=function(r){return new(r||e)(i.Y36(Be.$),i.Y36(ze.k),i.Y36(Ze.D),i.Y36($e.c),i.Y36(Ue.v),i.Y36(rt.f),i.Y36(it.D))},e.\u0275cmp=i.Xpm({type:e,selectors:[["app-bill-report"]],decls:56,vars:87,consts:[[1,"container-fluid"],[1,"row"],[1,"col-lg-5","col-md-5","col-sm-12"],["childLink","Reports","subchildLink","Bill Report"],[1,"col-lg-2","col-md-2","col-sm-12","bill-search-parameter"],["appearance","outline",2,"width","100%"],["matInput","","placeholder","Start Date","id","start-date-block","readonly","",3,"matDatepicker","ngModel","max","ngModelChange","click"],["matSuffix","",3,"for"],["aria-label","calendar-icon","matDatepickerToggleIcon","",1,"lms-calendar-icon"],["startDatePicker",""],["matInput","","placeholder","End Date","id","end-date-block","readonly","",3,"matDatepicker","ngModel","max","min","ngModelChange","click"],["endDatePicker",""],[1,"col-lg-3","col-md-3","col-sm-12","bill-search-parameter"],["mat-raised-button","","color","warn",1,"warn-action-btn",3,"click"],["mat-raised-button","","color","primary",1,"primary-action-btn",3,"click"],[1,"mat-elevation-z12","lms-master-card"],[1,"lms-matcardtitlegroup"],["mat-icon-button","",1,"excel-icon-button",3,"disableRipple","disabled","click"],["aria-label","excel",1,"lms-excel-icon"],["mat-icon-button","",3,"disableRipple","click"],["aria-label","pdf",1,"lms-pdf-icon"],[1,"remaining-space"],[3,"data","creator","fileName"],["excelexport",""],["title","Bill Report",3,"headerCellOptions"],["field","billDisplayID","title","Bill ID",3,"width","cellOptions","headerCellOptions"],["field","billingDate","title","Bill Date",3,"width","cellOptions","headerCellOptions"],["field","entityPatientName","title","Patient Name",3,"width","headerCellOptions","cellOptions"],["field","entityPatientAge","title","Patient Age",3,"width","headerCellOptions","cellOptions"],["field","entityPatientGender","title","Gender",3,"width","headerCellOptions","cellOptions"],["field","amountRecievedBy","title","Recieved By",3,"width","headerCellOptions","cellOptions"],["field","referralName","title","Referral Name",3,"width","headerCellOptions","cellOptions"],["field","amount","title","Amount/Balance",3,"width","headerCellOptions","cellOptions","footerCellOptions"],["kendoExcelExportFooterTemplate",""],["field","discountAmount","title","Discount Amount",3,"width","headerCellOptions","cellOptions","footerCellOptions"],["field","entityPayableAmount","title","Payable Amount",3,"width","headerCellOptions","cellOptions","footerCellOptions"],["field","recivedAmount","title","Recieved Amount",3,"width","headerCellOptions","cellOptions","footerCellOptions"],["field","duesAmount","title","Dues Amount",3,"width","headerCellOptions","cellOptions","footerCellOptions"]],template:function(r,a){if(1&r){const o=i.EpF();i._UZ(0,"app-header"),i.TgZ(1,"div",0)(2,"div",1)(3,"div",2),i._UZ(4,"app-breadcrumb",3),i.qZA(),i.TgZ(5,"div",4)(6,"mat-form-field",5)(7,"mat-label"),i._uU(8,"Start Date"),i.qZA(),i.TgZ(9,"input",6),i.NdJ("ngModelChange",function(s){return a.selectedStartDate=s})("click",function(){i.CHM(o);const s=i.MAs(13);return i.KtG(s.open())}),i.qZA(),i.TgZ(10,"mat-datepicker-toggle",7),i._UZ(11,"div",8),i.qZA(),i._UZ(12,"mat-datepicker",null,9),i.qZA()(),i.TgZ(14,"div",4)(15,"mat-form-field",5)(16,"mat-label"),i._uU(17,"End Date"),i.qZA(),i.TgZ(18,"input",10),i.NdJ("ngModelChange",function(s){return a.selectedEndDate=s})("click",function(){i.CHM(o);const s=i.MAs(22);return i.KtG(s.open())}),i.qZA(),i.TgZ(19,"mat-datepicker-toggle",7),i._UZ(20,"div",8),i.qZA(),i._UZ(21,"mat-datepicker",null,11),i.qZA()(),i.TgZ(23,"div",12)(24,"button",13),i.NdJ("click",function(){return a.resetDateFilter()}),i._uU(25," Reset "),i.qZA(),i.TgZ(26,"button",14),i.NdJ("click",function(){return a.searchBillForSelectedDate()}),i._uU(27," Search "),i.qZA()()(),i.TgZ(28,"div",1)(29,"mat-card",15)(30,"mat-card-title-group",16)(31,"button",17),i.NdJ("click",function(){i.CHM(o);const s=i.MAs(37);return i.KtG(s.save())}),i._UZ(32,"div",18),i.qZA(),i.TgZ(33,"button",19),i.NdJ("click",function(){return a.exportData()}),i._UZ(34,"div",20),i.qZA(),i._UZ(35,"span",21),i.qZA()()(),i.TgZ(36,"kendo-excelexport",22,23)(38,"kendo-excelexport-column-group",24),i._UZ(39,"kendo-excelexport-column",25)(40,"kendo-excelexport-column",26)(41,"kendo-excelexport-column",27)(42,"kendo-excelexport-column",28)(43,"kendo-excelexport-column",29)(44,"kendo-excelexport-column",30)(45,"kendo-excelexport-column",31),i.TgZ(46,"kendo-excelexport-column",32),i.YNc(47,_p,1,1,"ng-template",33),i.qZA(),i.TgZ(48,"kendo-excelexport-column",34),i.YNc(49,bp,1,1,"ng-template",33),i.qZA(),i.TgZ(50,"kendo-excelexport-column",35),i.YNc(51,yp,1,1,"ng-template",33),i.qZA(),i.TgZ(52,"kendo-excelexport-column",36),i.YNc(53,vp,1,1,"ng-template",33),i.qZA(),i.TgZ(54,"kendo-excelexport-column",37),i.YNc(55,Dp,1,1,"ng-template",33),i.qZA()()()()}if(2&r){const o=i.MAs(13),l=i.MAs(22);i.xp6(9),i.Q6J("matDatepicker",o)("ngModel",a.selectedStartDate)("max",a.currentDate),i.xp6(1),i.Q6J("for",o),i.xp6(8),i.Q6J("matDatepicker",l)("ngModel",a.selectedEndDate)("max",a.currentDate)("min",a.selectedStartDate),i.xp6(1),i.Q6J("for",l),i.xp6(12),i.Q6J("disableRipple",!0)("disabled",0==a.billList$.getValue().length),i.xp6(2),i.Q6J("disableRipple",!0),i.xp6(3),i.MGl("fileName","Bill Report_",a.exportedFileName,".xlsx"),i.Q6J("data",a.billList$.getValue())("creator",a.env.excelAuthorName),i.xp6(2),i.Q6J("headerCellOptions",i.DdM(57,wp)),i.xp6(1),i.Q6J("width",120)("cellOptions",i.DdM(58,cr))("headerCellOptions",i.DdM(59,xe)),i.xp6(1),i.Q6J("width",150)("cellOptions",i.DdM(60,cr))("headerCellOptions",i.DdM(61,xe)),i.xp6(1),i.Q6J("width",200)("headerCellOptions",i.DdM(62,xe))("cellOptions",i.DdM(63,Si)),i.xp6(1),i.Q6J("width",200)("headerCellOptions",i.DdM(64,xe))("cellOptions",i.DdM(65,cr)),i.xp6(1),i.Q6J("width",80)("headerCellOptions",i.DdM(66,xe))("cellOptions",i.DdM(67,cr)),i.xp6(1),i.Q6J("width",120)("headerCellOptions",i.DdM(68,xe))("cellOptions",i.DdM(69,Si)),i.xp6(1),i.Q6J("width",120)("headerCellOptions",i.DdM(70,xe))("cellOptions",i.DdM(71,Si)),i.xp6(1),i.Q6J("width",120)("headerCellOptions",i.DdM(72,xe))("cellOptions",i.DdM(73,cn))("footerCellOptions",i.DdM(74,un)),i.xp6(2),i.Q6J("width",150)("headerCellOptions",i.DdM(75,xe))("cellOptions",i.DdM(76,cn))("footerCellOptions",i.DdM(77,un)),i.xp6(2),i.Q6J("width",150)("headerCellOptions",i.DdM(78,xe))("cellOptions",i.DdM(79,cn))("footerCellOptions",i.DdM(80,un)),i.xp6(2),i.Q6J("width",150)("headerCellOptions",i.DdM(81,xe))("cellOptions",i.DdM(82,cn))("footerCellOptions",i.DdM(83,un)),i.xp6(2),i.Q6J("width",150)("headerCellOptions",i.DdM(84,xe))("cellOptions",i.DdM(85,cn))("footerCellOptions",i.DdM(86,un))}},dependencies:[qe.G,R.Fj,R.JJ,R.On,te.lW,te.RK,ne.a8,ne.C1,N.Mq,N.hl,N.nW,N.Q0,He.Nt,z.KE,z.hX,z.R9,Ge.L,Xe,et,tt,Ke],styles:[".bill-search-parameter[_ngcontent-%COMP%]{margin-top:11px}.warn-action-btn[_ngcontent-%COMP%]{float:right;margin-top:5px}.primary-action-btn[_ngcontent-%COMP%]{float:right;margin-right:10px;margin-top:5px}.excel-icon-button[_ngcontent-%COMP%]:disabled{opacity:.4}"]}),t})();var Sp=E(3680),kp=E(8525);function Ap(e,t){if(1&e&&(i.TgZ(0,"mat-option",18),i._uU(1),i.qZA()),2&e){const n=t.$implicit;i.Q6J("value",n.eventName),i.xp6(1),i.hij(" ",n.eventName," ")}}let Mp=(()=>{var e;class t{constructor(r,a,o,l,s){this.authService=r,this.toastrService=a,this.loader=o,this.masterService=l,this.commonService=s,this.notificationLogList$=new j.X([]),this.eventList$=new j.X([]),this.inlineEditFlag=!1,this.showLogCheckedFlag=!1,this.gridOptions=new Le.s8,this.changeDetection=new Ie.x,this.destroySubscription$=new Pe.t(1),this.currentDate=new Date,this.selectedStartDate=new Date,this.selectedEndDate=new Date,this.selectedBillDetails={},this.screenWidth=screen.width,this.exportedFileName=(new Date).toISOString(),this.selectedEventID="BILL CANCELLED",this.totalAmount=0,this.totalDiscountAmount=0,this.totalDuesAmount=0,this.kendoGroups=[],this.kendoAggregates=[],this.kendoExcelData=[]}ngOnInit(){this.getEventMasterList().then(r=>{this.eventList$.next(r),this.setNotificationLogList()}).catch(r=>{this.eventList$.next([]),this.toastrService.show({type:"error",text:r})}),this.gridOptions={searchPlaceholder:"Search Notification Log",pageSize:this.authService.pageSize,dateFormat:"yyyy-MM-dd",keyCodeForNextCell:13,showInlineEdit:this.inlineEditFlag,titleForMobileView:"testName",pageSizeArray:[5,10,20],showDeleteButton:!1,showAddButton:!1,showEditButton:!1,showActivateDeactivateButton:!1,showSearchInput:!0,activateDeactivateCondition:{conditionalProperty:"activeFlag",valueForActivation:"1",valueForDeactivation:"0"},columns:[{name:"referralName",label:"Referral Name",enable:!0,searchable:!0,sortable:!1,type:"text",editable:!1,isRequired:!1,footerValue:0},{name:"entityPatientName",label:"Patient Name",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"entityPatientGender",label:"Gender",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"entityPatientAge",label:"Age",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"billingDate",label:"Bill Date",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"departmentName",label:"Department",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"subDepartmentName",label:"Sub department",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"testName",label:"Test Name",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"amount",label:"Amount",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1,footerValue:0},{name:"discount",label:"Discount Amount",enable:!0,searchable:!1,sortable:!0,type:"text",editable:!1,isRequired:!1,footerValue:0},{name:"duesAmount",label:"Referral Amount",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1,footerValue:0}]}}getEventMasterList(){return new Promise((r,a)=>{this.loader.showSpinner("Loading..."),this.masterService.requestApiForNotificationManagement({genericRequestEntity:{companyID:this.authService.companyID}},"masterservice/getAllEventMaster").pipe((0,ee.R)(this.destroySubscription$)).subscribe(l=>{"200"===l.statusCode||"300"===l.statusCode?(l.responseList=null==l.responseList?[]:l.responseList,r(l.responseList)):(this.loader.hideSpinner(),a(l.errorMessage))},l=>{this.loader.hideSpinner(),a("Either Internet is not working or some internal server issue")})})}getNotificationLogList(){var r=this;return new Promise((a,o)=>{this.loader.showSpinner("Referral Charge Report List on the way!");const l={genericManipulationRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,effectiveDateFrom:this.commonService.parseDate(this.selectedStartDate,"yyyy-MM-dd"),effectiveDateTo:this.commonService.parseDate(this.selectedEndDate,"yyyy-MM-dd"),entityParentBusinessName:this.selectedEventID}};this.masterService.requestApiForNotificationManagement(l,"messagelogdetails/getMessageLogDetails").pipe((0,ee.R)(this.destroySubscription$)).subscribe(function(){var s=(0,G.Z)(function*(c){r.loader.hideSpinner(),"200"===c.statusCode?(c.responseList=yield r.extractPatientDetails(c.responseList),a(c.responseList)):o(c.errorMessage)});return function(c){return s.apply(this,arguments)}}(),s=>{this.loader.hideSpinner(),o("Either Internet is not working or some internal server issue")})})}extractPatientDetails(r){var a=this;return(0,G.Z)(function*(){const o=(new Date).toISOString().slice(0,10);return r=yield r.map(l=>{let s=null===l.patitentName?["",o,""]:l.patitentName.split(","),c=s[0],u=a.commonService.findValuesOfYearMonthAndDays(s[1],l.effectiveDateFrom),d=s[2];return{...l,entityPatientName:c,entityPatientAge:0==u.years?u.months+" M , "+u.days+" D":u.years+" Y",entityPatientGender:d,discount:null===l.discount?0:l.discount}}).sort((l,s)=>Date.parse(l.effectiveDateFrom)>Date.parse(s.effectiveDateFrom)?-1:0)})()}ngOnDestroy(){this.destroySubscription$.next(null),this.destroySubscription$.complete()}setNotificationLogList(){this.getNotificationLogList().then(r=>{this.notificationLogList$.next(r)}).catch(r=>{this.notificationLogList$.next([]),this.toastrService.show({type:"error",text:r})})}searchReferralChargeForSelectedDate(){this.setNotificationLogList()}resetDateFilter(){this.selectedStartDate=new Date,this.selectedEndDate=new Date,this.selectedEventID=null,this.setNotificationLogList()}onChangeOfDropdown(r){"Event"===r.type&&(this.selectedEventID=r.viewValue)}}return(e=t).\u0275fac=function(r){return new(r||e)(i.Y36(Be.$),i.Y36(ze.k),i.Y36(Ze.D),i.Y36($e.c),i.Y36(Ue.v))},e.\u0275cmp=i.Xpm({type:e,selectors:[["app-notification-log"]],decls:38,vars:13,consts:[[1,"container-fluid"],[1,"row"],[1,"col-lg-5","col-md-5","col-sm-12"],["childLink","Reports","subchildLink","Notification Log"],[1,"col-lg-3","col-md-3","col-sm-12","bill-search-parameter"],["appearance","outline",2,"width","100%"],["matInput","","placeholder","Start Date","id","referral-charge-report-1","readonly","",3,"matDatepicker","ngModel","max","ngModelChange","click"],["matSuffix","",3,"for"],["aria-label","calendar-icon","matDatepickerToggleIcon","",1,"lms-calendar-icon"],["startDatePicker",""],["matInput","","placeholder","End Date","id","referral-charge-report-2","readonly","",3,"matDatepicker","ngModel","max","min","ngModelChange","click"],["endDatePicker",""],["appearance","outline",1,"event-mat-form-field"],["id","ntf-form-1","required","",3,"ngModel","ngModelChange","selectionChange"],[3,"value",4,"ngFor","ngForOf"],["mat-raised-button","","color","warn",1,"warn-action-btn",3,"click"],["mat-raised-button","","color","primary",1,"primary-action-btn",3,"click"],[1,"mat-elevation-z12","lms-master-card"],[3,"value"]],template:function(r,a){if(1&r){const o=i.EpF();i._UZ(0,"app-header"),i.TgZ(1,"div",0)(2,"div",1)(3,"div",2),i._UZ(4,"app-breadcrumb",3),i.qZA()(),i.TgZ(5,"div",1)(6,"div",4)(7,"mat-form-field",5)(8,"mat-label"),i._uU(9,"Start Date"),i.qZA(),i.TgZ(10,"input",6),i.NdJ("ngModelChange",function(s){return a.selectedStartDate=s})("click",function(){i.CHM(o);const s=i.MAs(14);return i.KtG(s.open())}),i.qZA(),i.TgZ(11,"mat-datepicker-toggle",7),i._UZ(12,"div",8),i.qZA(),i._UZ(13,"mat-datepicker",null,9),i.qZA()(),i.TgZ(15,"div",4)(16,"mat-form-field",5)(17,"mat-label"),i._uU(18,"End Date"),i.qZA(),i.TgZ(19,"input",10),i.NdJ("ngModelChange",function(s){return a.selectedEndDate=s})("click",function(){i.CHM(o);const s=i.MAs(23);return i.KtG(s.open())}),i.qZA(),i.TgZ(20,"mat-datepicker-toggle",7),i._UZ(21,"div",8),i.qZA(),i._UZ(22,"mat-datepicker",null,11),i.qZA()(),i.TgZ(24,"div",4)(25,"mat-form-field",12)(26,"mat-label"),i._uU(27,"Choose Event"),i.qZA(),i.TgZ(28,"mat-select",13),i.NdJ("ngModelChange",function(s){return a.selectedEventID=s})("selectionChange",function(s){return a.onChangeOfDropdown({type:"Event",value:s.value,viewValue:s.source.selected._element.nativeElement.innerText.trim()})}),i.YNc(29,Ap,2,2,"mat-option",14),i.ALo(30,"async"),i.qZA()()(),i.TgZ(31,"div",4)(32,"button",15),i.NdJ("click",function(){return a.resetDateFilter()}),i._uU(33," Reset "),i.qZA(),i.TgZ(34,"button",16),i.NdJ("click",function(){return a.searchReferralChargeForSelectedDate()}),i._uU(35," Search "),i.qZA()()(),i.TgZ(36,"div",1),i._UZ(37,"mat-card",17),i.qZA()()}if(2&r){const o=i.MAs(14),l=i.MAs(23);i.xp6(10),i.Q6J("matDatepicker",o)("ngModel",a.selectedStartDate)("max",a.currentDate),i.xp6(1),i.Q6J("for",o),i.xp6(8),i.Q6J("matDatepicker",l)("ngModel",a.selectedEndDate)("max",a.currentDate)("min",a.selectedStartDate),i.xp6(1),i.Q6J("for",l),i.xp6(8),i.Q6J("ngModel",a.selectedEventID),i.xp6(1),i.Q6J("ngForOf",i.lcZ(30,11,a.eventList$))}},dependencies:[gr.sg,qe.G,R.Fj,R.JJ,R.Q7,R.On,Sp.ey,te.lW,ne.a8,N.Mq,N.hl,N.nW,N.Q0,He.Nt,z.KE,z.hX,z.R9,kp.gD,Ge.L,gr.Ov],styles:[".bill-search-parameter[_ngcontent-%COMP%]{margin-top:11px}.warn-action-btn[_ngcontent-%COMP%]{float:right;margin-top:5px}.primary-action-btn[_ngcontent-%COMP%]{float:right;margin-right:10px;margin-top:5px}.excel-icon-button[_ngcontent-%COMP%]:disabled{opacity:.4}"]}),t})();const Nl=(e,t,n)=>r=>e(r)?t(r):n(r),De=(...e)=>t=>e.reduceRight((n,r)=>r(n),t),B=e=>null!=e,ur=e=>null==e,ki=e=>Array.isArray(e),Ll=e=>"function"==typeof e,Ai=e=>"string"==typeof e,gt=e=>!isNaN(e-parseFloat(e)),nt=e=>e&&e.getTime,dn={},Ip=/\[(?:(\d+)|['"](.*?)['"])\]|((?:(?!\[.*?\]|\.).)+)/g;dn.undefined=e=>e;const Ne=(e,t)=>{const n=e+t;if(dn[n])return dn[n];const r=[];return e.replace(Ip,(a,o,l,s)=>{r.push(B(o)?o:l||s)}),dn[n]=a=>{let o=a;for(let l=0;l<r.length;l++)if(o=o[r[l]],!B(o)&&t)return o;return o},dn[n]},fn=e=>t=>[e,t],$p=()=>null,Mi=e=>t=>B(e(t)),Pl=e=>t=>(e=>B(e)&&ki(e)&&e.length>0)(e(t)),Nt=(e,t)=>Nl(e,t,$p),Oi=(e,t)=>n=>e(n).map(t).join("~"),Gp=De(...[['"',""],[":","-"]].map(([t,n])=>r=>r.replace(new RegExp(t,"g"),n))),Jp=t=>t.slice(0,t.indexOf(".")),Bl=({field:e,dir:t="asc"})=>`${e}-${t}`,zl=Ne("take"),Zl=Ne("aggregates"),Vp=Ne("skip"),$l=Ne("group"),Ri=Ne("sort",!0),Qp=Oi(Ri,Bl),jp=Oi($l,Bl),Wp=Oi(Zl,({field:e,aggregate:t})=>`${e}-${t}`),Xp=De(e=>`datetime'${e}'`,Jp,Gp,JSON.stringify,e=>new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()))),tm=De(fn("page"),({skip:e,take:t})=>Math.floor((e||0)/t)+1),nm=De(fn("pageSize"),zl),rm=De(fn("group"),jp),im=De(fn("sort"),Qp),am=De(fn("aggregate"),Wp),Ti=(Nt(Mi(Vp),tm),Nt(Mi(zl),nm),Nt(Pl($l),rm),Nt(Mi(Zl),am),De(Nt(Pl(Ri),im),e=>Object.assign({},e,{sort:(Ri(e)||[]).filter(({dir:t})=>(e=>!(e=>ur(e)||0===e.trim().length)(e))(t))})),({field:e,operator:t,value:n})=>`${e}~${t}~${n}`),dr=(Nl(e=>nt(e.value),De(Ti,({field:e,value:t,ignoreCase:n,operator:r})=>({value:Xp(t),field:e,ignoreCase:n,operator:r})),Ti),(e,t,n)=>(t[e]=n,t)),Ei=e=>t=>{const n=t[e];return B(n)?n:t[(e=>e.replace(/(^[A-Z])/g,(t,n)=>n.toLowerCase()))(e)]},Gl=(Ei("Member"),Ei("AggregateMethodName"),Ei("Value"),e=>t=>Object.keys(t).reduce(e.bind(null,t),{})),bm=Gl((e,t,n)=>dr(n.toLowerCase(),t,e[n])),ym=Gl((e,t,n)=>dr(n,t,bm(e[n]))),Jl=(e,t)=>B(e)?e:t,Yl=De(({field:e,hasSubgroups:t,value:n,aggregates:r,items:a})=>({aggregates:ym(r),field:e,items:t?a.map(Yl):a,value:n}),e=>({aggregates:e.Aggregates||e.aggregates,field:e.Member||e.member||e.field,hasSubgroups:e.HasSubgroups||e.hasSubgroups||!1,items:e.Items||e.items,value:Jl(e.Key,Jl(e.key,e.value))})),Vl=(e,t)=>ur(e)?e===t?0:-1:ur(t)?1:e.localeCompare?e.localeCompare(t):e>t?1:e<t?-1:0,vm=(e,t)=>Vl(t,e),Dm=e=>{if("function"==typeof e.compare)return e.compare;const t=Ne(e.field,!0);return(n,r)=>("asc"===e.dir?Vl:vm)(t(n),t(r))},wm=(e,t)=>0,Rm=(e,t)=>(e.push(t),e),Ql=e=>t=>(n,r,a)=>t(n,e(r,a)),jl=e=>t=>(n,r)=>e(r)?t(n,r):n,Wl=e=>B(e.__value),Ni=(e,t,n)=>{let r=t;for(let a=0,o=n.length;a<o;a++)if(r=e(r,n[a],a),Wl(r)){r=r.__value;break}return r},Nm=Ql(e=>e),Fm=(e,t=[],n=Nm)=>{const r={};return t.length?((e={})=>(Object.keys(e).forEach(t=>{const n=e[t];Object.keys(n).forEach(r=>{n[r]=n[r].result()})}),e))(Ni(n((e=>{const t=e.map(n=>{const r=Ne(n.field,!0),a=(n.aggregate||"").toLowerCase(),o=Ne(a,!0);return(l,s)=>{const c=l[n.field]||{},u=o(c)||(e=>({average:()=>{let t=0,n=0;return{calc:r=>{gt(r)?(t+=r,n++):t=r},result:()=>gt(t)?t/n:t}},count:()=>{let t=0;return{calc:()=>t++,result:()=>t}},max:()=>{let t=Number.NEGATIVE_INFINITY;return{calc:n=>{t=gt(t)||nt(t)?t:n,t<n&&(gt(n)||nt(n))&&(t=n)},result:()=>t}},min:()=>{let t=Number.POSITIVE_INFINITY;return{calc:n=>{t=gt(t)||nt(t)?t:n,t>n&&(gt(n)||nt(n))&&(t=n)},result:()=>t}},sum:()=>{let t=0;return{calc:n=>{n=B(n)?n:0,t+=n},result:()=>t}}}[e]()))(a);return u.calc(r(s)),c[n.aggregate]=u,l[n.field]=c,l}});return(n,r)=>t.reduce((a,o)=>o(a,r),n)})(t)),r,e)):r},hn=e=>B(e.filters),Kl=e=>{e.filters&&(e.filters=e.filters.map(t=>{const n=Object.assign({},t);return!hn(t)&&Ai(t.operator)&&(n.operator=(e=>({"!=":"neq","<":"lt","<=":"lte","==":"eq",">":"gt",">=":"gte",equal:"eq",equals:"eq",equalto:"eq",ge:"gte",greater:"gt",greaterthan:"gt",greaterthanequal:"gte",isempty:"isempty",isequalto:"eq",isgreaterthan:"gt",isgreaterthanorequalto:"gte",islessthan:"lt",islessthanorequalto:"lte",isnotempty:"isnotempty",isnotequalto:"neq",isnull:"isnull",le:"lte",less:"lt",lessthan:"lt",lessthanequal:"lte",ne:"neq",notequal:"neq",notequals:"neq",notequalto:"neq",notsubstringof:"doesnotcontain"}[e.toLowerCase()]||e))(t.operator)),hn(t)&&Kl(n),n}))},es=e=>(B(e)&&(e=(e=>hn(e)?Object.assign({},e):{filters:ki(e)?e:[e],logic:"and"})(e),Kl(e)),e),Pm={or:{concat:(e,t)=>n=>e(n)||t(n),identity:()=>!1},and:{concat:(e,t)=>n=>e(n)&&t(n),identity:()=>!0}},Bm={contains:(e,t)=>(e||"").indexOf(t)>=0,doesnotcontain:(e,t)=>-1===(e||"").indexOf(t),doesnotendwith:(e,t)=>(e||"").indexOf(t,(e||"").length-(t||"").length)<0,doesnotstartwith:(e,t)=>-1===(e||"").lastIndexOf(t,0),endswith:(e,t)=>(e||"").indexOf(t,(e||"").length-(t||"").length)>=0,eq:(e,t)=>e===t,gt:(e,t)=>e>t,gte:(e,t)=>e>=t,isempty:e=>""===e,isnotempty:e=>""!==e,isnotnull:e=>B(e),isnull:e=>ur(e),lt:(e,t)=>e<t,lte:(e,t)=>e<=t,neq:(e,t)=>e!=t,startswith:(e,t)=>0===(e||"").lastIndexOf(t,0)},ts=/^\/Date\((.*?)\)\/$/,ns=e=>{const t=Pm[e.logic];return e.filters.filter(B).map(n=>hn(n)?ns(n):(({field:e,ignoreCase:t,value:n,operator:r})=>{e=B(e)?e:l=>l,t=!B(t)||t;const a=((e,t,n)=>{if(!B(t))return e;let r=e;if(Ai(t)){const a=ts.exec(t);a?t=new Date(+a[1]):r=o=>{const l=e(o);return"string"==typeof l&&n?l.toLowerCase():gt(l)?l+"":l}}return nt(t)?a=>{const o=r(a);return nt(o)?o.getTime():o}:r})(Ll(e)?e:Ne(e,!0),n,t);n=((e,t)=>{if(null!=e&&Ai(e)){const n=ts.exec(e);if(n)return new Date(+n[1]).getTime();if(t)return e.toLowerCase()}else if(null!=e&&nt(e))return e.getTime();return e})(n,t);const o=Ll(r)?r:Bm[r];return l=>o(a(l),n,t)})(n)).reduce(t.concat,t.identity)},rs=e=>e&&0!==e.filters.length?ns(e):()=>!0,is=e=>(e=ki(e)?e:[e]).map(t=>Object.assign({dir:"asc"},t)),as=Ql(e=>e),Fi=(e,t=[],n=as,r=e)=>{if(!(t=is(t)).length)return e;const a=t[0],l=Ni(n((e=>{const t=Ne(e,!0);let n=0;return(r,a)=>{r[e]=r[e]||{};const o=t(a),l=(e=>(e=B(e)&&e.getTime?e.getTime():e)+"")(o),s=r[e][l]||{__position:n++,aggregates:{},items:[],value:o};return s.items.push(a),r[e][l]=s,r}})(a.field)),{},e),s=[];return Object.keys(l).forEach(c=>{Object.keys(l[c]).forEach(u=>{const d=l[c][u];let m={},f=r;B(a.aggregates)&&(f=((e,t)=>!B(t)||hn(t)&&0===t.filters.length?e:e.filter(rs(es(t))))(r,{field:a.field,ignoreCase:!1,operator:"eq",value:d.value}),m=Fm(f,a.aggregates)),s[d.__position]={aggregates:m,field:c,items:t.length>1?Fi(d.items,t.slice(1),as,f):d.items,value:d.value}})}),s},Vm=(e,t)=>t?e.filter(t):e,Qm=(e,t)=>{const{skip:n,take:r,filter:a,sort:o,group:l}=t,s=[...is(l||[]),...o||[]];s.length&&(e=((e,t)=>{if(t.some(n=>B(n.dir)||B(n.compare))){e=e.slice(0);const n=(e=>e.filter(t=>B(t.dir)||B(t.compare)).map(t=>Dm(t)).reduce((t,n)=>(r,a)=>t(r,a)||n(r,a),wm))(t);e.sort(n)}return e})(e,s));const c=B(a)&&jl.length,u=B(l)&&l.length;if(!c&&!u)return{data:r?e.slice(n,n+r):e,total:e.length};let d;const m=[];let f;if(c?(f=rs(es(a)),d=((e,t)=>{let n=0;for(let r=0,a=e.length;r<a;r++)t(e[r])&&n++;return n})(e,f),m.push(jl(f))):d=e.length,B(n)&&B(r)&&(m.push((e=>t=>(n,r)=>e--<=0?t(n,r):n)(n)),m.push((e=>t=>(n,r)=>e-- >0?t(n,r):(e=>Wl(e)?e:{__value:e,reduced:!0})(n))(r))),m.length){const p=De(...m);return{data:u?Fi(e,l,p,Vm(e,f)):Ni(p(Rm),[],e),total:d}}return{data:u?Fi(e,l):e,total:d}};var os=E(1775);function Wm(e,t){1&e&&i._uU(0),2&e&&i.hij(" Referral Name:",t.value," ")}function Xm(e,t){1&e&&i._uU(0),2&e&&i.hij(" ",t.$implicit.amount.sum," ")}function Km(e,t){1&e&&i._uU(0),2&e&&i.hij(" ",t.$implicit.discount.sum," ")}function eg(e,t){1&e&&i._uU(0),2&e&&i.hij(" ",t.$implicit.duesAmount.sum," ")}const tg=function(){return{textAlign:"center",fontSize:16,bold:!0}},Li=function(){return{textAlign:"center",fontSize:13}},we=function(){return{textAlign:"center",fontSize:14,bold:!0}},pn=function(){return{textAlign:"left",fontSize:13}},Ii=function(){return{textAlign:"right",fontSize:13}},mn=function(){return{textAlign:"right"}};let ng=(()=>{var e;class t{constructor(r,a,o,l,s,c,u,d){this.authService=r,this.toastrService=a,this.loader=o,this.masterService=l,this.commonService=s,this.winRef=c,this.env=u,this._fb=d,this.referralChargeReportList$=new j.X([]),this.departmentList$=new j.X([]),this.subdepartmentList$=new j.X([]),this.referralMasterList$=new j.X([]),this.inlineEditFlag=!1,this.showLogCheckedFlag=!1,this.gridOptions=new Le.s8,this.changeDetection=new Ie.x,this.destroySubscription$=new Pe.t(1),this.currentDate=new Date,this.selectedStartDate=new Date,this.selectedEndDate=new Date,this.selectedBillDetails={},this.screenWidth=screen.width,this.exportedFileName=(new Date).toISOString(),this.selectedDepartmentID=null,this.selectedSubdepartmentID=null,this.selectedReferralID=null,this.totalAmount=0,this.totalDiscountAmount=0,this.totalDuesAmount=0,this.kendoGroups=[],this.kendoAggregates=[],this.kendoExcelData=[]}ngOnInit(){this.setReferralChargeReportList(),this.getDepartmentList().then(r=>{this.departmentList$.next(r),this.getSubdepartmentList(!0).then(a=>{this.subdepartmentList$.next(a),this.getReferralMasterList(!0).then(o=>{this.referralMasterList$.next(o)}).catch(o=>{this.referralMasterList$.next([]),this.toastrService.show({type:"error",text:o})})}).catch(a=>{this.subdepartmentList$.next([]),this.toastrService.show({type:"error",text:a})})}).catch(r=>{this.departmentList$.next([]),this.toastrService.show({type:"error",text:r})}),this.referralChargeReportSearchFormGroup=this._fb.group({departmentID:new R.NI,subDepartmentID:new R.NI,referralID:new R.NI}),this.gridOptions={searchPlaceholder:"Search Test",pageSize:this.authService.pageSize,dateFormat:"yyyy-MM-dd",keyCodeForNextCell:13,showInlineEdit:this.inlineEditFlag,titleForMobileView:"testName",pageSizeArray:[5,10,20],showDeleteButton:!1,showAddButton:!1,showEditButton:!1,showActivateDeactivateButton:!1,showSearchInput:!0,activateDeactivateCondition:{conditionalProperty:"activeFlag",valueForActivation:"1",valueForDeactivation:"0"},columns:[{name:"referralName",label:"Referral Name",enable:!0,searchable:!0,sortable:!1,type:"text",editable:!1,isRequired:!1,footerValue:0},{name:"entityPatientName",label:"Patient Name",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"entityPatientGender",label:"Gender",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"entityPatientAge",label:"Age",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"billingDate",label:"Bill Date",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"departmentName",label:"Department",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"subDepartmentName",label:"Sub department",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"testName",label:"Test Name",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1},{name:"amount",label:"Amount",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1,footerValue:0},{name:"discount",label:"Discount Amount",enable:!0,searchable:!1,sortable:!0,type:"text",editable:!1,isRequired:!1,footerValue:0},{name:"duesAmount",label:"Referral Amount",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1,footerValue:0}]}}setFooterValue(r){this.gridOptions.columns.find(a=>"referralName"==a.name).footerValue=r.length||0,this.totalAmount=r.reduce((a,o)=>a+o.amount,0),this.totalDiscountAmount=Math.round(r.reduce((a,o)=>a+o.discount,0)),this.totalDuesAmount=Math.round(r.reduce((a,o)=>a+o.duesAmount,0)),this.gridOptions.columns.find(a=>"amount"==a.name).footerValue=this.totalAmount||0,this.gridOptions.columns.find(a=>"discount"==a.name).footerValue=this.totalDiscountAmount||0,this.gridOptions.columns.find(a=>"duesAmount"==a.name).footerValue=this.totalDuesAmount||0}exportData(){0==this.referralChargeReportList$.getValue().length?this.toastrService.show({type:"error",text:"List should not empty!"}):this.exportToPdf()}getDepartmentList(){return new Promise((r,a)=>{this.loader.showSpinner("Loading..."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,detailFlag:!1,entityBusinessID:null,mode:"W",dropDown:!0}},"departmentservice/getAllDepartment").pipe((0,ee.R)(this.destroySubscription$)).subscribe(function(){var l=(0,G.Z)(function*(s){"200"===s.statusCode||"300"===s.statusCode?(s.responseList=null===s.responseList?[]:s.responseList,r(s.responseList)):a(s.errorMessage)});return function(s){return l.apply(this,arguments)}}(),l=>{this.loader.hideSpinner(),a("Either Internet is not working or some internal server issue")})})}getSubdepartmentList(r){var a=this;return new Promise((o,l)=>{this.loader.showSpinner(r?"Loading...":"Sub department list is loading..."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,detailFlag:!1,entityBusinessID:this.selectedDepartmentID,mode:"W",dropDown:!0}},"subdepartmentservice/getAllSubDepartment/").pipe((0,ee.R)(this.destroySubscription$)).subscribe(function(){var c=(0,G.Z)(function*(u){r||a.loader.hideSpinner(),"200"===u.statusCode||"300"===u.statusCode?(u.responseList=null===u.responseList?[]:u.responseList,o(u.responseList)):l(u.errorMessage)});return function(u){return c.apply(this,arguments)}}(),c=>{this.loader.hideSpinner(),l("Either Internet is not working or some internal server issue")})})}getReferralMasterList(r){var a=this;return new Promise((o,l)=>{this.loader.showSpinner(r?"Loading...":"Referral master list is loading..."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,detailFlag:!1,mode:"W",dropDown:!0}},"referralservice/getAllReferral/").pipe((0,ee.R)(this.destroySubscription$)).subscribe(function(){var c=(0,G.Z)(function*(u){a.loader.hideSpinner(),"200"===u.statusCode||"300"===u.statusCode?(u.responseList=null===u.responseList?[]:u.responseList,r&&u.responseList.unshift({entityBusinessID:0,entityBusinessName:"ALL"}),o(u.responseList)):l(u.errorMessage)});return function(u){return c.apply(this,arguments)}}(),c=>{this.loader.hideSpinner(),l("Either Internet is not working or some internal server issue")})})}getReferralChargeReportList(){var r=this;return new Promise((a,o)=>{this.loader.showSpinner("Referral Charge Report List on the way!");const l={reportSearchDTO:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W",dropDown:!1,checkFlag:null,fromDate:this.commonService.parseDate(this.selectedStartDate,"yyyy-MM-dd"),toDate:this.commonService.parseDate(this.selectedEndDate,"yyyy-MM-dd"),departmentID:this.selectedDepartmentID,subDepartmentID:this.selectedSubdepartmentID,referralID:this.selectedReferralID}};this.masterService.requestApiForGeneralMaster(l,"reportservice/getReferralChargeReport").pipe((0,ee.R)(this.destroySubscription$)).subscribe(function(){var s=(0,G.Z)(function*(c){r.loader.hideSpinner(),"200"===c.statusCode?(c.responseList=yield r.extractPatientDetails(c.responseList),a(c.responseList)):o(c.errorMessage)});return function(c){return s.apply(this,arguments)}}(),s=>{this.loader.hideSpinner(),o("Either Internet is not working or some internal server issue")})})}extractPatientDetails(r){var a=this;return(0,G.Z)(function*(){const o=(new Date).toISOString().slice(0,10);return r=yield r.map(l=>{let s=null===l.patitentName?["",o,""]:l.patitentName.split(","),c=s[0],u=a.commonService.findValuesOfYearMonthAndDays(s[1],l.effectiveDateFrom),d=s[2];return{...l,entityPatientName:c,entityPatientAge:0==u.years?u.months+" M , "+u.days+" D":u.years+" Y",entityPatientGender:d,discount:null===l.discount?0:l.discount}}).sort((l,s)=>Date.parse(l.effectiveDateFrom)>Date.parse(s.effectiveDateFrom)?-1:0)})()}ngOnDestroy(){this.destroySubscription$.next(null),this.destroySubscription$.complete()}setReferralChargeReportList(){this.getReferralChargeReportList().then(r=>{this.referralChargeReportList$.next(r),this.kendoAggregates=[{field:"amount",aggregate:"sum"},{field:"discount",aggregate:"sum"},{field:"duesAmount",aggregate:"sum"}],this.kendoGroups=[{field:"referralName",aggregates:this.kendoAggregates}],this.kendoExcelData=Qm(r,{group:this.kendoGroups}).data,this.setFooterValue(r)}).catch(r=>{this.referralChargeReportList$.next([]),this.toastrService.show({type:"error",text:r})})}searchReferralChargeForSelectedDate(){this.setReferralChargeReportList()}resetDateFilter(){this.selectedStartDate=new Date,this.selectedEndDate=new Date,this.referralChargeReportSearchFormGroup.reset(),this.selectedDepartmentID=null,this.selectedSubdepartmentID=null,this.selectedReferralID=null,this.setReferralChargeReportList()}onChangeOfDropdown(r){switch(r.type){case"Department":this.selectedDepartmentID=r.value,this.selectedSubdepartmentID=null,this.getSubdepartmentList(!1).then(a=>{this.subdepartmentList$.next(a),this.referralMasterList$.next([])}).catch(a=>{this.subdepartmentList$.next([]),this.referralMasterList$.next([]),this.toastrService.show({type:"error",text:a})});break;case"Subdepartment":this.selectedSubdepartmentID=r.value,this.getReferralMasterList(!1).then(a=>{this.referralMasterList$.next(a)}).catch(a=>{this.referralMasterList$.next([]),this.toastrService.show({type:"error",text:a})});break;case"Referral":this.selectedReferralID=r.value}}exportToPdf(){const r=this.referralChargeReportList$.getValue();var a={info:{title:"Referral Charge Report"},pageSize:"a4",pageMargins:[15,60,15,20],header:function(){return{text:"Referral Charge Report",fontSize:"28",alignment:"center",decoration:"underline",margin:[0,15,0,0]}},footer:function(c){return[{text:"Page: "+c,alignment:"center",fontSize:"8",bold:!0,margin:[1,1,1,1]}]},pageOrientation:"landscape",content:[{margin:[0,0,0,0],border:[!1,!1,!1,!1],table:{widths:[50,85,60,40,55,75,120,80,50,50,50],body:[[{text:"Bill Date",style:"subHeader"},{text:"Patient Name",style:"subHeader"},{text:"Patient Age",style:"subHeader"},{text:"Gender",style:"subHeader"},{text:"Department",style:"subHeader"},{text:"Subdepartment",style:"subHeader"},{text:"Test",style:"subHeader"},{text:"Referral Name",style:"subHeader"},{text:"Amount",style:"subHeader"},{text:"Discount Amount",style:"subHeader"},{text:"Referral",style:"subHeader"}],r,[{text:"",border:[!1,!0,!1,!1]},{text:"",border:[!1,!0,!1,!1]},{text:"",border:[!1,!0,!1,!1]},{text:"",border:[!1,!0,!1,!1]},{text:"",border:[!1,!0,!1,!1]},{text:"",border:[!1,!0,!1,!1]},{text:"",border:[!1,!0,!1,!1]},{text:"Total",border:[!0,!0,!0,!0],style:["value"]},{text:"",border:[!1,!0,!1,!1]},{text:"",border:[!1,!0,!1,!1]},{text:"",border:[!1,!0,!1,!1]}]]}}],styles:{subHeader:{bold:!0,fontSize:10,color:"white",fillColor:"#80b3ff",alignment:"center"},tableHeader:{bold:!0,fontSize:14,fillColor:"Red"},value:{fontSize:8.5,alignment:"center",border:[!1,!0,!1,!1]},value2:{alignment:"right"}}};let o=a.content[0].table.body[2],l=a.content[0].table.body,s=0;for(let c=0;c<r.length;c++)s++,l[s]=[{text:r[c].billingDate,style:"value"},{text:r[c].entityPatientName,style:"value",alignment:"left"},{text:r[c].entityPatientAge,style:"value"},{text:r[c].entityPatientGender,style:"value"},{text:r[c].departmentName,style:"value",alignment:"left"},{text:r[c].subDepartmentName,style:"value",alignment:"left"},{text:r[c].testName,style:"value",alignment:"left"},{text:r[c].referralName,style:"value",alignment:"left"},{text:r[c].amount,style:["value","value2"]},{text:r[c].discount,style:["value","value2"]},{text:r[c].duesAmount,style:["value","value2"]}];o[8]={text:this.totalAmount,style:["value","value2"]},o[9]={text:this.totalDiscountAmount,style:["value","value2"]},o[10]={text:this.totalDuesAmount,style:["value","value2"]},l[s+1]=o,this.winRef.nativeWindow.pdfMake.createPdf(a).open()}}return(e=t).\u0275fac=function(r){return new(r||e)(i.Y36(Be.$),i.Y36(ze.k),i.Y36(Ze.D),i.Y36($e.c),i.Y36(Ue.v),i.Y36(rt.f),i.Y36(it.D),i.Y36(R.qu))},e.\u0275cmp=i.Xpm({type:e,selectors:[["app-referral-charge-report"]],decls:61,vars:101,consts:[[1,"container-fluid"],[1,"row"],[1,"col-lg-5","col-md-5","col-sm-12"],["childLink","Reports","subchildLink","Referral Charge"],[1,"col-lg-2","col-md-2","col-sm-12","bill-search-parameter"],["appearance","outline",2,"width","100%"],["matInput","","placeholder","Start Date","id","referral-charge-report-1","readonly","",3,"matDatepicker","ngModel","max","ngModelChange","click"],["matSuffix","",3,"for"],["aria-label","calendar-icon","matDatepickerToggleIcon","",1,"lms-calendar-icon"],["startDatePicker",""],["matInput","","placeholder","End Date","id","referral-charge-report-2","readonly","",3,"matDatepicker","ngModel","max","min","ngModelChange","click"],["endDatePicker",""],[3,"dropdownFor","isRequired","records","formControlsName","customClass","idForSelect","dropdownChangeEvent"],["mat-raised-button","","color","warn",1,"warn-action-btn",3,"click"],["mat-raised-button","","color","primary",1,"primary-action-btn",3,"click"],[1,"mat-elevation-z12","lms-master-card"],[1,"lms-matcardtitlegroup"],["mat-icon-button","",1,"excel-icon-button",3,"disableRipple","disabled","click"],["aria-label","excel",1,"lms-excel-icon"],["mat-icon-button","",3,"disableRipple","click"],["aria-label","pdf",1,"lms-pdf-icon"],[1,"remaining-space"],[3,"data","group","creator","fileName"],["excelexport",""],["title","Referral Charge Report",3,"headerCellOptions"],["field","billingDate","title","Billing Date",3,"width","cellOptions","headerCellOptions"],["field","entityPatientName","title","Patient Name",3,"width","headerCellOptions","cellOptions"],["field","entityPatientAge","title","Age",3,"width","headerCellOptions","cellOptions"],["field","entityPatientGender","title","Gender",3,"width","headerCellOptions","cellOptions"],["field","departmentName","title","Department Name",3,"width","headerCellOptions","cellOptions"],["field","subDepartmentName","title","SubDepartment Name",3,"width","headerCellOptions","cellOptions"],["field","testName","title","Test Name",3,"width","headerCellOptions","cellOptions"],["field","referralName","title","Referral Name",3,"width","headerCellOptions","cellOptions"],["kendoExcelExportGroupHeaderTemplate",""],["field","amount","title","Amount",3,"width","headerCellOptions","cellOptions","groupFooterCellOptions"],["kendoExcelExportGroupFooterTemplate",""],["field","discount","title","Discount Amount",3,"width","headerCellOptions","cellOptions","footerCellOptions","groupFooterCellOptions"],["field","duesAmount","title","Referral Amount",3,"width","headerCellOptions","cellOptions","footerCellOptions","groupFooterCellOptions"]],template:function(r,a){if(1&r){const o=i.EpF();i._UZ(0,"app-header"),i.TgZ(1,"div",0)(2,"div",1)(3,"div",2),i._UZ(4,"app-breadcrumb",3),i.qZA()(),i.TgZ(5,"div",1)(6,"div",4)(7,"mat-form-field",5)(8,"mat-label"),i._uU(9,"Start Date"),i.qZA(),i.TgZ(10,"input",6),i.NdJ("ngModelChange",function(s){return a.selectedStartDate=s})("click",function(){i.CHM(o);const s=i.MAs(14);return i.KtG(s.open())}),i.qZA(),i.TgZ(11,"mat-datepicker-toggle",7),i._UZ(12,"div",8),i.qZA(),i._UZ(13,"mat-datepicker",null,9),i.qZA()(),i.TgZ(15,"div",4)(16,"mat-form-field",5)(17,"mat-label"),i._uU(18,"End Date"),i.qZA(),i.TgZ(19,"input",10),i.NdJ("ngModelChange",function(s){return a.selectedEndDate=s})("click",function(){i.CHM(o);const s=i.MAs(23);return i.KtG(s.open())}),i.qZA(),i.TgZ(20,"mat-datepicker-toggle",7),i._UZ(21,"div",8),i.qZA(),i._UZ(22,"mat-datepicker",null,11),i.qZA()(),i.TgZ(24,"div",4)(25,"app-lms-select",12),i.NdJ("dropdownChangeEvent",function(s){return a.onChangeOfDropdown(s)}),i.qZA()(),i.TgZ(26,"div",4)(27,"app-lms-select",12),i.NdJ("dropdownChangeEvent",function(s){return a.onChangeOfDropdown(s)}),i.qZA()(),i.TgZ(28,"div",4)(29,"app-lms-select",12),i.NdJ("dropdownChangeEvent",function(s){return a.onChangeOfDropdown(s)}),i.qZA()(),i.TgZ(30,"div",4)(31,"button",13),i.NdJ("click",function(){return a.resetDateFilter()}),i._uU(32," Reset "),i.qZA(),i.TgZ(33,"button",14),i.NdJ("click",function(){return a.searchReferralChargeForSelectedDate()}),i._uU(34," Search "),i.qZA()()(),i.TgZ(35,"div",1)(36,"mat-card",15)(37,"mat-card-title-group",16)(38,"button",17),i.NdJ("click",function(){i.CHM(o);const s=i.MAs(44);return i.KtG(s.save())}),i._UZ(39,"div",18),i.qZA(),i.TgZ(40,"button",19),i.NdJ("click",function(){return a.exportData()}),i._UZ(41,"div",20),i.qZA(),i._UZ(42,"span",21),i.qZA()()(),i.TgZ(43,"kendo-excelexport",22,23)(45,"kendo-excelexport-column-group",24),i._UZ(46,"kendo-excelexport-column",25)(47,"kendo-excelexport-column",26)(48,"kendo-excelexport-column",27)(49,"kendo-excelexport-column",28)(50,"kendo-excelexport-column",29)(51,"kendo-excelexport-column",30)(52,"kendo-excelexport-column",31),i.TgZ(53,"kendo-excelexport-column",32),i.YNc(54,Wm,1,1,"ng-template",33),i.qZA(),i.TgZ(55,"kendo-excelexport-column",34),i.YNc(56,Xm,1,1,"ng-template",35),i.qZA(),i.TgZ(57,"kendo-excelexport-column",36),i.YNc(58,Km,1,1,"ng-template",35),i.qZA(),i.TgZ(59,"kendo-excelexport-column",37),i.YNc(60,eg,1,1,"ng-template",35),i.qZA()()()()}if(2&r){const o=i.MAs(14),l=i.MAs(23);i.xp6(10),i.Q6J("matDatepicker",o)("ngModel",a.selectedStartDate)("max",a.currentDate),i.xp6(1),i.Q6J("for",o),i.xp6(8),i.Q6J("matDatepicker",l)("ngModel",a.selectedEndDate)("max",a.currentDate)("min",a.selectedStartDate),i.xp6(1),i.Q6J("for",l),i.xp6(5),i.Q6J("dropdownFor","Department")("isRequired",!1)("records",a.departmentList$)("formControlsName",a.referralChargeReportSearchFormGroup.get("departmentID"))("customClass","summary-report-select")("idForSelect","referral-charge-report-3"),i.xp6(2),i.Q6J("dropdownFor","Subdepartment")("isRequired",!1)("records",a.subdepartmentList$)("formControlsName",a.referralChargeReportSearchFormGroup.get("subDepartmentID"))("customClass","summary-report-select")("idForSelect","referral-charge-report-4"),i.xp6(2),i.Q6J("dropdownFor","Referral")("isRequired",!1)("records",a.referralMasterList$)("formControlsName",a.referralChargeReportSearchFormGroup.get("referralID"))("customClass","summary-report-select")("idForSelect","referral-charge-report-5"),i.xp6(9),i.Q6J("disableRipple",!0)("disabled",0==a.referralChargeReportList$.getValue().length),i.xp6(2),i.Q6J("disableRipple",!0),i.xp6(3),i.MGl("fileName","Referral Charge Report_",a.exportedFileName,".xlsx"),i.Q6J("data",a.kendoExcelData)("group",a.kendoGroups)("creator",a.env.excelAuthorName),i.xp6(2),i.Q6J("headerCellOptions",i.DdM(73,tg)),i.xp6(1),i.Q6J("width",150)("cellOptions",i.DdM(74,Li))("headerCellOptions",i.DdM(75,we)),i.xp6(1),i.Q6J("width",200)("headerCellOptions",i.DdM(76,we))("cellOptions",i.DdM(77,pn)),i.xp6(1),i.Q6J("width",200)("headerCellOptions",i.DdM(78,we))("cellOptions",i.DdM(79,Li)),i.xp6(1),i.Q6J("width",200)("headerCellOptions",i.DdM(80,we))("cellOptions",i.DdM(81,Li)),i.xp6(1),i.Q6J("width",250)("headerCellOptions",i.DdM(82,we))("cellOptions",i.DdM(83,pn)),i.xp6(1),i.Q6J("width",250)("headerCellOptions",i.DdM(84,we))("cellOptions",i.DdM(85,pn)),i.xp6(1),i.Q6J("width",250)("headerCellOptions",i.DdM(86,we))("cellOptions",i.DdM(87,pn)),i.xp6(1),i.Q6J("width",200)("headerCellOptions",i.DdM(88,we))("cellOptions",i.DdM(89,pn)),i.xp6(2),i.Q6J("width",120)("headerCellOptions",i.DdM(90,we))("cellOptions",i.DdM(91,Ii))("groupFooterCellOptions",i.DdM(92,mn)),i.xp6(2),i.Q6J("width",150)("headerCellOptions",i.DdM(93,we))("cellOptions",i.DdM(94,Ii))("footerCellOptions",i.DdM(95,mn))("groupFooterCellOptions",i.DdM(96,mn)),i.xp6(2),i.Q6J("width",150)("headerCellOptions",i.DdM(97,we))("cellOptions",i.DdM(98,Ii))("footerCellOptions",i.DdM(99,mn))("groupFooterCellOptions",i.DdM(100,mn))}},dependencies:[qe.G,R.Fj,R.JJ,R.On,os.P,te.lW,te.RK,ne.a8,ne.C1,N.Mq,N.hl,N.nW,N.Q0,He.Nt,z.KE,z.hX,z.R9,Ge.L,Xe,et,tt,gi,mi],styles:[".bill-search-parameter[_ngcontent-%COMP%]{margin-top:11px}.warn-action-btn[_ngcontent-%COMP%]{float:right;margin-top:5px}.primary-action-btn[_ngcontent-%COMP%]{float:right;margin-right:10px;margin-top:5px}.excel-icon-button[_ngcontent-%COMP%]:disabled{opacity:.4}"]}),t})();function rg(e,t){1&e&&i._uU(0," Amount ")}function ig(e,t){if(1&e&&i._uU(0),2&e){const n=i.oxw();i.hij(" ",n.totalTestCount," ")}}function ag(e,t){if(1&e&&i._uU(0),2&e){const n=i.oxw();i.hij(" ",n.totalTestRate," ")}}function og(e,t){if(1&e&&i._uU(0),2&e){const n=i.oxw();i.hij(" ",n.totalDiscountAmount," ")}}function lg(e,t){if(1&e&&i._uU(0),2&e){const n=i.oxw();i.hij(" ",n.totalFinalAmount," ")}}const sg=function(){return{textAlign:"center",fontSize:16,bold:!0}},cg=function(){return{textAlign:"left",fontSize:13}},gn=function(){return{textAlign:"center",fontSize:14,bold:!0}},ug=function(){return{textAlign:"center"}},fr=function(){return{textAlign:"right",fontSize:13}},hr=function(){return{textAlign:"right"}},dg=[{path:"billreport",component:Cp},{path:"billcancelled",component:ep},{path:"billdues",component:up},{path:"billrefundlist",component:mp},{path:"billdetaillist",component:ap},{path:"referralchargereport",component:ng},{path:"summarylist",component:(()=>{var e;class t{constructor(r,a,o,l,s,c,u,d){this.authService=r,this.toastrService=a,this.loader=o,this.masterService=l,this.commonService=s,this.winRef=c,this.env=u,this._fb=d,this.testSummaryReportList$=new j.X([]),this.departmentList$=new j.X([]),this.subdepartmentList$=new j.X([]),this.testServiceList$=new j.X([]),this.inlineEditFlag=!1,this.showLogCheckedFlag=!1,this.gridOptions=new Le.s8,this.changeDetection=new Ie.x,this.destroySubscription$=new Pe.t(1),this.currentDate=new Date,this.selectedStartDate=new Date,this.selectedEndDate=new Date,this.selectedBillDetails={},this.screenWidth=screen.width,this.exportedFileName=(new Date).toISOString(),this.selectedDepartmentID=null,this.selectedSubdepartmentID=null,this.selectedTestServiceID=null,this.totalTestCount=0,this.totalTestRate=0,this.totalDiscountAmount=0,this.totalFinalAmount=0}ngOnInit(){this.setTestSummaryReportList(),this.getDepartmentList().then(r=>{this.departmentList$.next(r),this.getSubdepartmentList(!0).then(a=>{this.subdepartmentList$.next(a),this.getTestServiceList(!0).then(o=>{this.testServiceList$.next(o)}).catch(o=>{this.testServiceList$.next([]),this.toastrService.show({type:"error",text:o})})}).catch(a=>{this.subdepartmentList$.next([]),this.toastrService.show({type:"error",text:a})})}).catch(r=>{this.departmentList$.next([]),this.toastrService.show({type:"error",text:r})}),this.summaryReportSearchFormGroup=this._fb.group({departmentID:new R.NI,subDepartmentID:new R.NI,serviceID:new R.NI}),this.gridOptions={searchPlaceholder:"Search Test",pageSize:this.authService.pageSize,dateFormat:"yyyy-MM-dd",keyCodeForNextCell:13,showInlineEdit:this.inlineEditFlag,titleForMobileView:"testName",pageSizeArray:[5,10,20],showDeleteButton:!1,showAddButton:!1,showEditButton:!1,showActivateDeactivateButton:!1,showSearchInput:!0,activateDeactivateCondition:{conditionalProperty:"activeFlag",valueForActivation:"1",valueForDeactivation:"0"},columns:[{name:"testName",label:"Test Name",enable:!0,searchable:!0,sortable:!1,type:"text",editable:!1,isRequired:!1,footerValue:0},{name:"totalCount",label:"Total Count",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1,footerValue:0},{name:"testRate",label:"Test Rate",enable:!0,searchable:!1,sortable:!0,type:"text",editable:!1,isRequired:!1,footerValue:0},{name:"totalDiscountAmount",label:"Discount Amount",enable:!0,searchable:!1,sortable:!0,type:"text",editable:!1,isRequired:!1,footerValue:0},{name:"totalFinalAmount",label:"Final Amount",enable:!0,searchable:!1,sortable:!1,type:"text",editable:!1,isRequired:!1,footerValue:0}]}}setFooterValue(r){this.gridOptions.columns.find(a=>"testName"==a.name).footerValue=r.length||0,this.totalTestCount=r.reduce((a,o)=>a+o.totalCount,0),this.totalTestRate=Math.round(r.reduce((a,o)=>a+o.testRate,0)),this.totalDiscountAmount=Math.round(r.reduce((a,o)=>a+o.totalDiscountAmount,0)),this.totalFinalAmount=Math.round(r.reduce((a,o)=>a+o.totalFinalAmount,0)),this.gridOptions.columns.find(a=>"totalCount"==a.name).footerValue=this.totalTestCount||0,this.gridOptions.columns.find(a=>"testRate"==a.name).footerValue=this.totalTestRate||0,this.gridOptions.columns.find(a=>"totalDiscountAmount"==a.name).footerValue=this.totalDiscountAmount||0,this.gridOptions.columns.find(a=>"totalFinalAmount"==a.name).footerValue=this.totalFinalAmount||0}exportData(){0==this.testSummaryReportList$.getValue().length?this.toastrService.show({type:"error",text:"List should not empty!"}):this.exportToPdf()}getDepartmentList(){return new Promise((r,a)=>{this.loader.showSpinner("Loading..."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,detailFlag:!1,entityBusinessID:null,mode:"W",dropDown:!0}},"departmentservice/getAllDepartment").pipe((0,ee.R)(this.destroySubscription$)).subscribe(function(){var l=(0,G.Z)(function*(s){"200"===s.statusCode||"300"===s.statusCode?(s.responseList=null===s.responseList?[]:s.responseList,r(s.responseList)):a(s.errorMessage)});return function(s){return l.apply(this,arguments)}}(),l=>{this.loader.hideSpinner(),a("Either Internet is not working or some internal server issue")})})}getSubdepartmentList(r){var a=this;return new Promise((o,l)=>{this.loader.showSpinner(r?"Loading...":"Sub department list is loading..."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,detailFlag:!1,entityBusinessID:this.selectedDepartmentID,mode:"W",dropDown:!0}},"subdepartmentservice/getAllSubDepartment/").pipe((0,ee.R)(this.destroySubscription$)).subscribe(function(){var c=(0,G.Z)(function*(u){r||a.loader.hideSpinner(),"200"===u.statusCode||"300"===u.statusCode?(u.responseList=null===u.responseList?[]:u.responseList,o(u.responseList)):l(u.errorMessage)});return function(u){return c.apply(this,arguments)}}(),c=>{this.loader.hideSpinner(),l("Either Internet is not working or some internal server issue")})})}getTestServiceList(r){var a=this;return new Promise((o,l)=>{this.loader.showSpinner(r?"Loading...":"Test service list is loading..."),this.masterService.requestApiForGeneralMaster({genericRequestEntity:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,detailFlag:!1,entityBusinessID:this.selectedSubdepartmentID,mode:"W",dropDown:!0}},"testservice/getAllTest/").pipe((0,ee.R)(this.destroySubscription$)).subscribe(function(){var c=(0,G.Z)(function*(u){a.loader.hideSpinner(),"200"===u.statusCode||"300"===u.statusCode?(u.responseList=null===u.responseList?[]:u.responseList,r&&u.responseList.unshift({entityBusinessID:0,entityBusinessName:"ALL"}),o(u.responseList)):l(u.errorMessage)});return function(u){return c.apply(this,arguments)}}(),c=>{this.loader.hideSpinner(),l("Either Internet is not working or some internal server issue")})})}getTestSummaryReportList(){var r=this;return new Promise((a,o)=>{this.loader.showSpinner("Test Summary Report List on the way!");const l={reportSearchDTO:{companyID:this.authService.companyID,createdBy:this.authService.employeeID,mode:"W",dropDown:!1,checkFlag:null,fromDate:this.commonService.parseDate(this.selectedStartDate,"yyyy-MM-dd"),toDate:this.commonService.parseDate(this.selectedEndDate,"yyyy-MM-dd"),departmentID:this.selectedDepartmentID,subDepartmentID:this.selectedSubdepartmentID,serviceID:this.selectedTestServiceID}};this.masterService.requestApiForGeneralMaster(l,"reportservice/getTestSummaryReport").pipe((0,ee.R)(this.destroySubscription$)).subscribe(function(){var s=(0,G.Z)(function*(c){r.loader.hideSpinner(),"200"===c.statusCode?a(c.responseList):o(c.errorMessage)});return function(c){return s.apply(this,arguments)}}(),s=>{this.loader.hideSpinner(),o("Either Internet is not working or some internal server issue")})})}ngOnDestroy(){this.destroySubscription$.next(null),this.destroySubscription$.complete()}setTestSummaryReportList(){this.getTestSummaryReportList().then(r=>{this.testSummaryReportList$.next(r),this.setFooterValue(r)}).catch(r=>{this.testSummaryReportList$.next([]),this.toastrService.show({type:"error",text:r})})}searchBillForSelectedDate(){this.setTestSummaryReportList()}resetDateFilter(){this.selectedStartDate=new Date,this.selectedEndDate=new Date,this.summaryReportSearchFormGroup.reset(),this.selectedDepartmentID=null,this.selectedSubdepartmentID=null,this.selectedTestServiceID=null,this.setTestSummaryReportList()}onChangeOfDropdown(r){switch(r.type){case"Department":this.selectedDepartmentID=r.value,this.selectedSubdepartmentID=null,this.selectedTestServiceID=null,this.getSubdepartmentList(!1).then(a=>{this.subdepartmentList$.next(a),this.testServiceList$.next([])}).catch(a=>{this.subdepartmentList$.next([]),this.testServiceList$.next([]),this.toastrService.show({type:"error",text:a})});break;case"Subdepartment":this.selectedSubdepartmentID=r.value,this.selectedTestServiceID=null,this.getTestServiceList(!1).then(a=>{this.testServiceList$.next(a)}).catch(a=>{this.testServiceList$.next([]),this.toastrService.show({type:"error",text:a})});break;case"Test Service":this.selectedTestServiceID=r.value}}exportToPdf(){const r=this.testSummaryReportList$.getValue();var a={info:{title:"Summary Report List"},pageSize:"a4",pageMargins:[15,60,15,20],header:function(){return{text:"Summary Report List",fontSize:"28",alignment:"center",decoration:"underline",margin:[0,15,0,0]}},footer:function(c){return[{text:"Page: "+c,alignment:"center",fontSize:"8",bold:!0,margin:[1,1,1,1]}]},content:[{margin:[0,0,0,0],border:[!1,!1,!1,!1],table:{widths:[200,"*","*","*","*"],body:[[{text:"Test Name",style:"subHeader"},{text:"Count",style:"subHeader"},{text:"Test Rate",style:"subHeader"},{text:"Discount Amount",style:"subHeader"},{text:"Final Amount",style:"subHeader"}],r,[{text:"Total",border:[!0,!0,!0,!0],style:["value"],bold:!0},{text:"",border:[!1,!0,!1,!1]},{text:"",border:[!1,!0,!1,!1]},{text:"",border:[!1,!0,!1,!1]},{text:"",border:[!1,!0,!1,!1]}]]}}],styles:{subHeader:{bold:!0,fontSize:10,color:"white",fillColor:"#80b3ff",alignment:"center"},tableHeader:{bold:!0,fontSize:14,fillColor:"Red"},value:{fontSize:8.5,alignment:"center",border:[!1,!0,!1,!1]},value2:{alignment:"right"}}};let o=a.content[0].table.body[2],l=a.content[0].table.body,s=0;for(let c=0;c<r.length;c++)s++,l[s]=[{text:r[c].testName,style:"value",alignment:"left"},{text:r[c].totalCount,style:["value","value2"]},{text:r[c].testRate,style:["value","value2"]},{text:r[c].totalDiscountAmount,style:["value","value2"]},{text:r[c].totalFinalAmount,style:["value","value2"]}];o[1]={text:this.totalTestCount,style:["value","value2"]},o[2]={text:this.totalTestRate,style:["value","value2"]},o[3]={text:this.totalDiscountAmount,style:["value","value2"]},o[4]={text:this.totalFinalAmount,style:["value","value2"]},l[s+1]=o,this.winRef.nativeWindow.pdfMake.createPdf(a).open()}}return(e=t).\u0275fac=function(r){return new(r||e)(i.Y36(Be.$),i.Y36(ze.k),i.Y36(Ze.D),i.Y36($e.c),i.Y36(Ue.v),i.Y36(rt.f),i.Y36(it.D),i.Y36(R.qu))},e.\u0275cmp=i.Xpm({type:e,selectors:[["app-summary-report"]],decls:56,vars:70,consts:[[1,"container-fluid"],[1,"row"],[1,"col-lg-5","col-md-5","col-sm-12"],["childLink","Reports","subchildLink","Summary Report"],[1,"col-lg-2","col-md-4","col-sm-12","bill-search-parameter"],["appearance","outline",2,"width","100%"],["matInput","","placeholder","Start Date","id","summary-report-1","readonly","",3,"matDatepicker","ngModel","max","ngModelChange","click"],["matSuffix","",3,"for"],["aria-label","calendar-icon","matDatepickerToggleIcon","",1,"lms-calendar-icon"],["startDatePicker",""],["matInput","","placeholder","End Date","id","summary-report-2","readonly","",3,"matDatepicker","ngModel","max","min","ngModelChange","click"],["endDatePicker",""],[3,"dropdownFor","isRequired","records","formControlsName","customClass","idForSelect","dropdownChangeEvent"],["mat-raised-button","","color","warn",1,"warn-action-btn",3,"click"],["mat-raised-button","","color","primary",1,"primary-action-btn",3,"click"],[1,"mat-elevation-z12","lms-master-card"],[1,"lms-matcardtitlegroup"],["mat-icon-button","",1,"excel-icon-button",3,"disableRipple","disabled","click"],["aria-label","excel",1,"lms-excel-icon"],["mat-icon-button","",3,"disableRipple","click"],["aria-label","pdf",1,"lms-pdf-icon"],[1,"remaining-space"],[3,"data","creator","fileName"],["excelexport",""],["title","Summary Report",3,"headerCellOptions"],["field","testName","title","Test Name",3,"width","cellOptions","headerCellOptions","footerCellOptions"],["kendoExcelExportFooterTemplate",""],["field","totalCount","title","Total Count",3,"width","cellOptions","headerCellOptions","footerCellOptions"],["field","testRate","title","Test Rate",3,"width","cellOptions","headerCellOptions","footerCellOptions"],["field","totalDiscountAmount","title","Total Discount Amount",3,"width","headerCellOptions","cellOptions","footerCellOptions"],["field","totalFinalAmount","title","Total Final Amount",3,"width","headerCellOptions","cellOptions","footerCellOptions"]],template:function(r,a){if(1&r){const o=i.EpF();i._UZ(0,"app-header"),i.TgZ(1,"div",0)(2,"div",1)(3,"div",2),i._UZ(4,"app-breadcrumb",3),i.qZA()(),i.TgZ(5,"div",1)(6,"div",4)(7,"mat-form-field",5)(8,"mat-label"),i._uU(9,"Start Date"),i.qZA(),i.TgZ(10,"input",6),i.NdJ("ngModelChange",function(s){return a.selectedStartDate=s})("click",function(){i.CHM(o);const s=i.MAs(14);return i.KtG(s.open())}),i.qZA(),i.TgZ(11,"mat-datepicker-toggle",7),i._UZ(12,"div",8),i.qZA(),i._UZ(13,"mat-datepicker",null,9),i.qZA()(),i.TgZ(15,"div",4)(16,"mat-form-field",5)(17,"mat-label"),i._uU(18,"End Date"),i.qZA(),i.TgZ(19,"input",10),i.NdJ("ngModelChange",function(s){return a.selectedEndDate=s})("click",function(){i.CHM(o);const s=i.MAs(23);return i.KtG(s.open())}),i.qZA(),i.TgZ(20,"mat-datepicker-toggle",7),i._UZ(21,"div",8),i.qZA(),i._UZ(22,"mat-datepicker",null,11),i.qZA()(),i.TgZ(24,"div",4)(25,"app-lms-select",12),i.NdJ("dropdownChangeEvent",function(s){return a.onChangeOfDropdown(s)}),i.qZA()(),i.TgZ(26,"div",4)(27,"app-lms-select",12),i.NdJ("dropdownChangeEvent",function(s){return a.onChangeOfDropdown(s)}),i.qZA()(),i.TgZ(28,"div",4)(29,"app-lms-select",12),i.NdJ("dropdownChangeEvent",function(s){return a.onChangeOfDropdown(s)}),i.qZA()(),i.TgZ(30,"div",4)(31,"button",13),i.NdJ("click",function(){return a.resetDateFilter()}),i._uU(32," Reset "),i.qZA(),i.TgZ(33,"button",14),i.NdJ("click",function(){return a.searchBillForSelectedDate()}),i._uU(34," Search "),i.qZA()()(),i.TgZ(35,"div",1)(36,"mat-card",15)(37,"mat-card-title-group",16)(38,"button",17),i.NdJ("click",function(){i.CHM(o);const s=i.MAs(44);return i.KtG(s.save())}),i._UZ(39,"div",18),i.qZA(),i.TgZ(40,"button",19),i.NdJ("click",function(){return a.exportData()}),i._UZ(41,"div",20),i.qZA(),i._UZ(42,"span",21),i.qZA()()(),i.TgZ(43,"kendo-excelexport",22,23)(45,"kendo-excelexport-column-group",24)(46,"kendo-excelexport-column",25),i.YNc(47,rg,1,0,"ng-template",26),i.qZA(),i.TgZ(48,"kendo-excelexport-column",27),i.YNc(49,ig,1,1,"ng-template",26),i.qZA(),i.TgZ(50,"kendo-excelexport-column",28),i.YNc(51,ag,1,1,"ng-template",26),i.qZA(),i.TgZ(52,"kendo-excelexport-column",29),i.YNc(53,og,1,1,"ng-template",26),i.qZA(),i.TgZ(54,"kendo-excelexport-column",30),i.YNc(55,lg,1,1,"ng-template",26),i.qZA()()()()}if(2&r){const o=i.MAs(14),l=i.MAs(23);i.xp6(10),i.Q6J("matDatepicker",o)("ngModel",a.selectedStartDate)("max",a.currentDate),i.xp6(1),i.Q6J("for",o),i.xp6(8),i.Q6J("matDatepicker",l)("ngModel",a.selectedEndDate)("max",a.currentDate)("min",a.selectedStartDate),i.xp6(1),i.Q6J("for",l),i.xp6(5),i.Q6J("dropdownFor","Department")("isRequired",!1)("records",a.departmentList$)("formControlsName",a.summaryReportSearchFormGroup.get("departmentID"))("customClass","summary-report-select")("idForSelect","summary-report-3"),i.xp6(2),i.Q6J("dropdownFor","Subdepartment")("isRequired",!1)("records",a.subdepartmentList$)("formControlsName",a.summaryReportSearchFormGroup.get("subDepartmentID"))("customClass","summary-report-select")("idForSelect","summary-report-4"),i.xp6(2),i.Q6J("dropdownFor","Test Service")("isRequired",!1)("records",a.testServiceList$)("formControlsName",a.summaryReportSearchFormGroup.get("serviceID"))("customClass","summary-report-select")("idForSelect","summary-report-5"),i.xp6(9),i.Q6J("disableRipple",!0)("disabled",0==a.testSummaryReportList$.getValue().length),i.xp6(2),i.Q6J("disableRipple",!0),i.xp6(3),i.MGl("fileName","Summary Report_",a.exportedFileName,".xlsx"),i.Q6J("data",a.testSummaryReportList$.getValue())("creator",a.env.excelAuthorName),i.xp6(2),i.Q6J("headerCellOptions",i.DdM(54,sg)),i.xp6(1),i.Q6J("width",300)("cellOptions",i.DdM(55,cg))("headerCellOptions",i.DdM(56,gn))("footerCellOptions",i.DdM(57,ug)),i.xp6(2),i.Q6J("width",150)("cellOptions",i.DdM(58,fr))("headerCellOptions",i.DdM(59,gn))("footerCellOptions",i.DdM(60,hr)),i.xp6(2),i.Q6J("width",150)("cellOptions",i.DdM(61,fr))("headerCellOptions",i.DdM(62,gn))("footerCellOptions",i.DdM(63,hr)),i.xp6(2),i.Q6J("width",200)("headerCellOptions",i.DdM(64,gn))("cellOptions",i.DdM(65,fr))("footerCellOptions",i.DdM(66,hr)),i.xp6(2),i.Q6J("width",200)("headerCellOptions",i.DdM(67,gn))("cellOptions",i.DdM(68,fr))("footerCellOptions",i.DdM(69,hr))}},dependencies:[qe.G,R.Fj,R.JJ,R.On,os.P,te.lW,te.RK,ne.a8,ne.C1,N.Mq,N.hl,N.nW,N.Q0,He.Nt,z.KE,z.hX,z.R9,Ge.L,Xe,et,tt,Ke],styles:[".bill-search-parameter[_ngcontent-%COMP%]{margin-top:11px}.warn-action-btn[_ngcontent-%COMP%]{float:right;margin-top:5px}.primary-action-btn[_ngcontent-%COMP%]{float:right;margin-right:10px;margin-top:5px}.excel-icon-button[_ngcontent-%COMP%]:disabled{opacity:.4}"]}),t})()},{path:"billreportlog",component:xp},{path:"notificationlog",component:Mp},{path:"",pathMatch:"full",redirectTo:"billreport"}];let fg=(()=>{var e;class t{}return(e=t).\u0275fac=function(r){return new(r||e)},e.\u0275mod=i.oAB({type:e}),e.\u0275inj=i.cJS({imports:[Bi.Bz.forChild(dg),Bi.Bz]}),t})();var hg=E(6611),pg=E(9820);let mg=(()=>{var e;class t{}return(e=t).\u0275fac=function(r){return new(r||e)},e.\u0275mod=i.oAB({type:e}),e.\u0275inj=i.cJS({imports:[gr.ez,fg,pg.m,hg.q,R.u5,R.UX,Vh]}),t})()}}]);